(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))f(m);new MutationObserver(m=>{for(const x of m)if(x.type==="childList")for(const v of x.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&f(v)}).observe(document,{childList:!0,subtree:!0});function l(m){const x={};return m.integrity&&(x.integrity=m.integrity),m.referrerPolicy&&(x.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?x.credentials="include":m.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function f(m){if(m.ep)return;m.ep=!0;const x=l(m);fetch(m.href,x)}})();/**
* @vue/shared v3.4.19
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function dm(i,s){const l=new Set(i.split(","));return s?f=>l.has(f.toLowerCase()):f=>l.has(f)}const Wi={},Ul=[],jn=()=>{},ow=()=>!1,Rd=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&(i.charCodeAt(2)>122||i.charCodeAt(2)<97),fm=i=>i.startsWith("onUpdate:"),Er=Object.assign,pm=(i,s)=>{const l=i.indexOf(s);l>-1&&i.splice(l,1)},lw=Object.prototype.hasOwnProperty,_i=(i,s)=>lw.call(i,s),Vt=Array.isArray,$l=i=>Dd(i)==="[object Map]",Nv=i=>Dd(i)==="[object Set]",Yt=i=>typeof i=="function",ir=i=>typeof i=="string",ec=i=>typeof i=="symbol",Ui=i=>i!==null&&typeof i=="object",Vv=i=>(Ui(i)||Yt(i))&&Yt(i.then)&&Yt(i.catch),Uv=Object.prototype.toString,Dd=i=>Uv.call(i),cw=i=>Dd(i).slice(8,-1),$v=i=>Dd(i)==="[object Object]",mm=i=>ir(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,hu=dm(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),zd=i=>{const s=Object.create(null);return l=>s[l]||(s[l]=i(l))},uw=/-(\w)/g,Cs=zd(i=>i.replace(uw,(s,l)=>l?l.toUpperCase():"")),hw=/\B([A-Z])/g,tc=zd(i=>i.replace(hw,"-$1").toLowerCase()),Ou=zd(i=>i.charAt(0).toUpperCase()+i.slice(1)),op=zd(i=>i?`on${Ou(i)}`:""),Va=(i,s)=>!Object.is(i,s),lp=(i,s)=>{for(let l=0;l<i.length;l++)i[l](s)},_d=(i,s,l)=>{Object.defineProperty(i,s,{configurable:!0,enumerable:!1,value:l})},dw=i=>{const s=parseFloat(i);return isNaN(s)?i:s},fw=i=>{const s=ir(i)?Number(i):NaN;return isNaN(s)?i:s};let T_;const jv=()=>T_||(T_=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Fu(i){if(Vt(i)){const s={};for(let l=0;l<i.length;l++){const f=i[l],m=ir(f)?_w(f):Fu(f);if(m)for(const x in m)s[x]=m[x]}return s}else if(ir(i)||Ui(i))return i}const pw=/;(?![^(]*\))/g,mw=/:([^]+)/,gw=/\/\*[^]*?\*\//g;function _w(i){const s={};return i.replace(gw,"").split(pw).forEach(l=>{if(l){const f=l.split(mw);f.length>1&&(s[f[0].trim()]=f[1].trim())}}),s}function Od(i){let s="";if(ir(i))s=i;else if(Vt(i))for(let l=0;l<i.length;l++){const f=Od(i[l]);f&&(s+=f+" ")}else if(Ui(i))for(const l in i)i[l]&&(s+=l+" ");return s.trim()}function YP(i){if(!i)return null;let{class:s,style:l}=i;return s&&!ir(s)&&(i.class=Od(s)),l&&(i.style=Fu(l)),i}const yw="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",vw=dm(yw);function Hv(i){return!!i||i===""}const XP=i=>ir(i)?i:i==null?"":Vt(i)||Ui(i)&&(i.toString===Uv||!Yt(i.toString))?JSON.stringify(i,Gv,2):String(i),Gv=(i,s)=>s&&s.__v_isRef?Gv(i,s.value):$l(s)?{[`Map(${s.size})`]:[...s.entries()].reduce((l,[f,m],x)=>(l[cp(f,x)+" =>"]=m,l),{})}:Nv(s)?{[`Set(${s.size})`]:[...s.values()].map(l=>cp(l))}:ec(s)?cp(s):Ui(s)&&!Vt(s)&&!$v(s)?String(s):s,cp=(i,s="")=>{var l;return ec(i)?`Symbol(${(l=i.description)!=null?l:s})`:i};/**
* @vue/reactivity v3.4.19
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let $n;class qv{constructor(s=!1){this.detached=s,this._active=!0,this.effects=[],this.cleanups=[],this.parent=$n,!s&&$n&&(this.index=($n.scopes||($n.scopes=[])).push(this)-1)}get active(){return this._active}run(s){if(this._active){const l=$n;try{return $n=this,s()}finally{$n=l}}}on(){$n=this}off(){$n=this.parent}stop(s){if(this._active){let l,f;for(l=0,f=this.effects.length;l<f;l++)this.effects[l].stop();for(l=0,f=this.cleanups.length;l<f;l++)this.cleanups[l]();if(this.scopes)for(l=0,f=this.scopes.length;l<f;l++)this.scopes[l].stop(!0);if(!this.detached&&this.parent&&!s){const m=this.parent.scopes.pop();m&&m!==this&&(this.parent.scopes[this.index]=m,m.index=this.index)}this.parent=void 0,this._active=!1}}}function Fd(i){return new qv(i)}function xw(i,s=$n){s&&s.active&&s.effects.push(i)}function Wv(){return $n}function Zv(i){$n&&$n.cleanups.push(i)}let Lo;class gm{constructor(s,l,f,m){this.fn=s,this.trigger=l,this.scheduler=f,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,xw(this,m)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,zo();for(let s=0;s<this._depsLength;s++){const l=this.deps[s];if(l.computed&&(bw(l.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),Oo()}return this._dirtyLevel>=4}set dirty(s){this._dirtyLevel=s?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let s=Fa,l=Lo;try{return Fa=!0,Lo=this,this._runnings++,E_(this),this.fn()}finally{I_(this),this._runnings--,Lo=l,Fa=s}}stop(){var s;this.active&&(E_(this),I_(this),(s=this.onStop)==null||s.call(this),this.active=!1)}}function bw(i){return i.value}function E_(i){i._trackId++,i._depsLength=0}function I_(i){if(i.deps.length>i._depsLength){for(let s=i._depsLength;s<i.deps.length;s++)Kv(i.deps[s],i);i.deps.length=i._depsLength}}function Kv(i,s){const l=i.get(s);l!==void 0&&s._trackId!==l&&(i.delete(s),i.size===0&&i.cleanup())}let Fa=!0,Pp=0;const Yv=[];function zo(){Yv.push(Fa),Fa=!1}function Oo(){const i=Yv.pop();Fa=i===void 0?!0:i}function _m(){Pp++}function ym(){for(Pp--;!Pp&&Mp.length;)Mp.shift()()}function Xv(i,s,l){if(s.get(i)!==i._trackId){s.set(i,i._trackId);const f=i.deps[i._depsLength];f!==s?(f&&Kv(f,i),i.deps[i._depsLength++]=s):i._depsLength++}}const Mp=[];function Jv(i,s,l){_m();for(const f of i.keys()){let m;f._dirtyLevel<s&&(m??(m=i.get(f)===f._trackId))&&(f._shouldSchedule||(f._shouldSchedule=f._dirtyLevel===0),f._dirtyLevel=s),f._shouldSchedule&&(m??(m=i.get(f)===f._trackId))&&(f.trigger(),(!f._runnings||f.allowRecurse)&&f._dirtyLevel!==2&&(f._shouldSchedule=!1,f.scheduler&&Mp.push(f.scheduler)))}ym()}const Qv=(i,s)=>{const l=new Map;return l.cleanup=i,l.computed=s,l},yd=new WeakMap,Ro=Symbol(""),kp=Symbol("");function Dn(i,s,l){if(Fa&&Lo){let f=yd.get(i);f||yd.set(i,f=new Map);let m=f.get(l);m||f.set(l,m=Qv(()=>f.delete(l))),Xv(Lo,m)}}function ea(i,s,l,f,m,x){const v=yd.get(i);if(!v)return;let c=[];if(s==="clear")c=[...v.values()];else if(l==="length"&&Vt(i)){const A=Number(f);v.forEach((R,z)=>{(z==="length"||!ec(z)&&z>=A)&&c.push(R)})}else switch(l!==void 0&&c.push(v.get(l)),s){case"add":Vt(i)?mm(l)&&c.push(v.get("length")):(c.push(v.get(Ro)),$l(i)&&c.push(v.get(kp)));break;case"delete":Vt(i)||(c.push(v.get(Ro)),$l(i)&&c.push(v.get(kp)));break;case"set":$l(i)&&c.push(v.get(Ro));break}_m();for(const A of c)A&&Jv(A,4);ym()}function ww(i,s){var l;return(l=yd.get(i))==null?void 0:l.get(s)}const Sw=dm("__proto__,__v_isRef,__isVue"),e0=new Set(Object.getOwnPropertyNames(Symbol).filter(i=>i!=="arguments"&&i!=="caller").map(i=>Symbol[i]).filter(ec)),A_=Tw();function Tw(){const i={};return["includes","indexOf","lastIndexOf"].forEach(s=>{i[s]=function(...l){const f=hi(this);for(let x=0,v=this.length;x<v;x++)Dn(f,"get",x+"");const m=f[s](...l);return m===-1||m===!1?f[s](...l.map(hi)):m}}),["push","pop","shift","unshift","splice"].forEach(s=>{i[s]=function(...l){zo(),_m();const f=hi(this)[s].apply(this,l);return ym(),Oo(),f}}),i}function Ew(i){const s=hi(this);return Dn(s,"has",i),s.hasOwnProperty(i)}class t0{constructor(s=!1,l=!1){this._isReadonly=s,this._shallow=l}get(s,l,f){const m=this._isReadonly,x=this._shallow;if(l==="__v_isReactive")return!m;if(l==="__v_isReadonly")return m;if(l==="__v_isShallow")return x;if(l==="__v_raw")return f===(m?x?Bw:s0:x?n0:r0).get(s)||Object.getPrototypeOf(s)===Object.getPrototypeOf(f)?s:void 0;const v=Vt(s);if(!m){if(v&&_i(A_,l))return Reflect.get(A_,l,f);if(l==="hasOwnProperty")return Ew}const c=Reflect.get(s,l,f);return(ec(l)?e0.has(l):Sw(l))||(m||Dn(s,"get",l),x)?c:Fi(c)?v&&mm(l)?c:c.value:Ui(c)?m?Nd(c):Xr(c):c}}class i0 extends t0{constructor(s=!1){super(!1,s)}set(s,l,f,m){let x=s[l];if(!this._shallow){const A=Gl(x);if(!vd(f)&&!Gl(f)&&(x=hi(x),f=hi(f)),!Vt(s)&&Fi(x)&&!Fi(f))return A?!1:(x.value=f,!0)}const v=Vt(s)&&mm(l)?Number(l)<s.length:_i(s,l),c=Reflect.set(s,l,f,m);return s===hi(m)&&(v?Va(f,x)&&ea(s,"set",l,f):ea(s,"add",l,f)),c}deleteProperty(s,l){const f=_i(s,l);s[l];const m=Reflect.deleteProperty(s,l);return m&&f&&ea(s,"delete",l,void 0),m}has(s,l){const f=Reflect.has(s,l);return(!ec(l)||!e0.has(l))&&Dn(s,"has",l),f}ownKeys(s){return Dn(s,"iterate",Vt(s)?"length":Ro),Reflect.ownKeys(s)}}class Iw extends t0{constructor(s=!1){super(!0,s)}set(s,l){return!0}deleteProperty(s,l){return!0}}const Aw=new i0,Cw=new Iw,Pw=new i0(!0),vm=i=>i,Bd=i=>Reflect.getPrototypeOf(i);function Yh(i,s,l=!1,f=!1){i=i.__v_raw;const m=hi(i),x=hi(s);l||(Va(s,x)&&Dn(m,"get",s),Dn(m,"get",x));const{has:v}=Bd(m),c=f?vm:l?wm:vu;if(v.call(m,s))return c(i.get(s));if(v.call(m,x))return c(i.get(x));i!==m&&i.get(s)}function Xh(i,s=!1){const l=this.__v_raw,f=hi(l),m=hi(i);return s||(Va(i,m)&&Dn(f,"has",i),Dn(f,"has",m)),i===m?l.has(i):l.has(i)||l.has(m)}function Jh(i,s=!1){return i=i.__v_raw,!s&&Dn(hi(i),"iterate",Ro),Reflect.get(i,"size",i)}function C_(i){i=hi(i);const s=hi(this);return Bd(s).has.call(s,i)||(s.add(i),ea(s,"add",i,i)),this}function P_(i,s){s=hi(s);const l=hi(this),{has:f,get:m}=Bd(l);let x=f.call(l,i);x||(i=hi(i),x=f.call(l,i));const v=m.call(l,i);return l.set(i,s),x?Va(s,v)&&ea(l,"set",i,s):ea(l,"add",i,s),this}function M_(i){const s=hi(this),{has:l,get:f}=Bd(s);let m=l.call(s,i);m||(i=hi(i),m=l.call(s,i)),f&&f.call(s,i);const x=s.delete(i);return m&&ea(s,"delete",i,void 0),x}function k_(){const i=hi(this),s=i.size!==0,l=i.clear();return s&&ea(i,"clear",void 0,void 0),l}function Qh(i,s){return function(f,m){const x=this,v=x.__v_raw,c=hi(v),A=s?vm:i?wm:vu;return!i&&Dn(c,"iterate",Ro),v.forEach((R,z)=>f.call(m,A(R),A(z),x))}}function ed(i,s,l){return function(...f){const m=this.__v_raw,x=hi(m),v=$l(x),c=i==="entries"||i===Symbol.iterator&&v,A=i==="keys"&&v,R=m[i](...f),z=l?vm:s?wm:vu;return!s&&Dn(x,"iterate",A?kp:Ro),{next(){const{value:B,done:M}=R.next();return M?{value:B,done:M}:{value:c?[z(B[0]),z(B[1])]:z(B),done:M}},[Symbol.iterator](){return this}}}}function Ea(i){return function(...s){return i==="delete"?!1:i==="clear"?void 0:this}}function Mw(){const i={get(x){return Yh(this,x)},get size(){return Jh(this)},has:Xh,add:C_,set:P_,delete:M_,clear:k_,forEach:Qh(!1,!1)},s={get(x){return Yh(this,x,!1,!0)},get size(){return Jh(this)},has:Xh,add:C_,set:P_,delete:M_,clear:k_,forEach:Qh(!1,!0)},l={get(x){return Yh(this,x,!0)},get size(){return Jh(this,!0)},has(x){return Xh.call(this,x,!0)},add:Ea("add"),set:Ea("set"),delete:Ea("delete"),clear:Ea("clear"),forEach:Qh(!0,!1)},f={get(x){return Yh(this,x,!0,!0)},get size(){return Jh(this,!0)},has(x){return Xh.call(this,x,!0)},add:Ea("add"),set:Ea("set"),delete:Ea("delete"),clear:Ea("clear"),forEach:Qh(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(x=>{i[x]=ed(x,!1,!1),l[x]=ed(x,!0,!1),s[x]=ed(x,!1,!0),f[x]=ed(x,!0,!0)}),[i,l,s,f]}const[kw,Lw,Rw,Dw]=Mw();function xm(i,s){const l=s?i?Dw:Rw:i?Lw:kw;return(f,m,x)=>m==="__v_isReactive"?!i:m==="__v_isReadonly"?i:m==="__v_raw"?f:Reflect.get(_i(l,m)&&m in f?l:f,m,x)}const zw={get:xm(!1,!1)},Ow={get:xm(!1,!0)},Fw={get:xm(!0,!1)},r0=new WeakMap,n0=new WeakMap,s0=new WeakMap,Bw=new WeakMap;function Nw(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Vw(i){return i.__v_skip||!Object.isExtensible(i)?0:Nw(cw(i))}function Xr(i){return Gl(i)?i:bm(i,!1,Aw,zw,r0)}function a0(i){return bm(i,!1,Pw,Ow,n0)}function Nd(i){return bm(i,!0,Cw,Fw,s0)}function bm(i,s,l,f,m){if(!Ui(i)||i.__v_raw&&!(s&&i.__v_isReactive))return i;const x=m.get(i);if(x)return x;const v=Vw(i);if(v===0)return i;const c=new Proxy(i,v===2?f:l);return m.set(i,c),c}function Ba(i){return Gl(i)?Ba(i.__v_raw):!!(i&&i.__v_isReactive)}function Gl(i){return!!(i&&i.__v_isReadonly)}function vd(i){return!!(i&&i.__v_isShallow)}function o0(i){return Ba(i)||Gl(i)}function hi(i){const s=i&&i.__v_raw;return s?hi(s):i}function ql(i){return Object.isExtensible(i)&&_d(i,"__v_skip",!0),i}const vu=i=>Ui(i)?Xr(i):i,wm=i=>Ui(i)?Nd(i):i;class l0{constructor(s,l,f,m){this._setter=l,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new gm(()=>s(this._value),()=>hd(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!m,this.__v_isReadonly=f}get value(){const s=hi(this);return(!s._cacheable||s.effect.dirty)&&Va(s._value,s._value=s.effect.run())&&hd(s,4),c0(s),s.effect._dirtyLevel>=2&&hd(s,2),s._value}set value(s){this._setter(s)}get _dirty(){return this.effect.dirty}set _dirty(s){this.effect.dirty=s}}function Uw(i,s,l=!1){let f,m;const x=Yt(i);return x?(f=i,m=jn):(f=i.get,m=i.set),new l0(f,m,x||!m,l)}function c0(i){var s;Fa&&Lo&&(i=hi(i),Xv(Lo,(s=i.dep)!=null?s:i.dep=Qv(()=>i.dep=void 0,i instanceof l0?i:void 0)))}function hd(i,s=4,l){i=hi(i);const f=i.dep;f&&Jv(f,s)}function Fi(i){return!!(i&&i.__v_isRef===!0)}function yi(i){return u0(i,!1)}function En(i){return u0(i,!0)}function u0(i,s){return Fi(i)?i:new $w(i,s)}class $w{constructor(s,l){this.__v_isShallow=l,this.dep=void 0,this.__v_isRef=!0,this._rawValue=l?s:hi(s),this._value=l?s:vu(s)}get value(){return c0(this),this._value}set value(s){const l=this.__v_isShallow||vd(s)||Gl(s);s=l?s:hi(s),Va(s,this._rawValue)&&(this._rawValue=s,this._value=l?s:vu(s),hd(this,4))}}function Sr(i){return Fi(i)?i.value:i}const jw={get:(i,s,l)=>Sr(Reflect.get(i,s,l)),set:(i,s,l,f)=>{const m=i[s];return Fi(m)&&!Fi(l)?(m.value=l,!0):Reflect.set(i,s,l,f)}};function h0(i){return Ba(i)?i:new Proxy(i,jw)}function Sm(i){const s=Vt(i)?new Array(i.length):{};for(const l in i)s[l]=d0(i,l);return s}class Hw{constructor(s,l,f){this._object=s,this._key=l,this._defaultValue=f,this.__v_isRef=!0}get value(){const s=this._object[this._key];return s===void 0?this._defaultValue:s}set value(s){this._object[this._key]=s}get dep(){return ww(hi(this._object),this._key)}}class Gw{constructor(s){this._getter=s,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function JP(i,s,l){return Fi(i)?i:Yt(i)?new Gw(i):Ui(i)&&arguments.length>1?d0(i,s,l):yi(i)}function d0(i,s,l){const f=i[s];return Fi(f)?f:new Hw(i,s,l)}/**
* @vue/runtime-core v3.4.19
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Na(i,s,l,f){try{return f?i(...f):i()}catch(m){Bu(m,s,l)}}function es(i,s,l,f){if(Yt(i)){const x=Na(i,s,l,f);return x&&Vv(x)&&x.catch(v=>{Bu(v,s,l)}),x}const m=[];for(let x=0;x<i.length;x++)m.push(es(i[x],s,l,f));return m}function Bu(i,s,l,f=!0){const m=s?s.vnode:null;if(s){let x=s.parent;const v=s.proxy,c=`https://vuejs.org/error-reference/#runtime-${l}`;for(;x;){const R=x.ec;if(R){for(let z=0;z<R.length;z++)if(R[z](i,v,c)===!1)return}x=x.parent}const A=s.appContext.config.errorHandler;if(A){Na(A,null,10,[i,v,c]);return}}qw(i,l,m,f)}function qw(i,s,l,f=!0){console.error(i)}let xu=!1,Lp=!1;const fn=[];let Is=0;const jl=[];let La=null,Po=0;const f0=Promise.resolve();let Tm=null;function Ha(i){const s=Tm||f0;return i?s.then(this?i.bind(this):i):s}function Ww(i){let s=Is+1,l=fn.length;for(;s<l;){const f=s+l>>>1,m=fn[f],x=bu(m);x<i||x===i&&m.pre?s=f+1:l=f}return s}function Vd(i){(!fn.length||!fn.includes(i,xu&&i.allowRecurse?Is+1:Is))&&(i.id==null?fn.push(i):fn.splice(Ww(i.id),0,i),p0())}function p0(){!xu&&!Lp&&(Lp=!0,Tm=f0.then(g0))}function Zw(i){const s=fn.indexOf(i);s>Is&&fn.splice(s,1)}function Kw(i){Vt(i)?jl.push(...i):(!La||!La.includes(i,i.allowRecurse?Po+1:Po))&&jl.push(i),p0()}function L_(i,s,l=xu?Is+1:0){for(;l<fn.length;l++){const f=fn[l];if(f&&f.pre){if(i&&f.id!==i.uid)continue;fn.splice(l,1),l--,f()}}}function m0(i){if(jl.length){const s=[...new Set(jl)].sort((l,f)=>bu(l)-bu(f));if(jl.length=0,La){La.push(...s);return}for(La=s,Po=0;Po<La.length;Po++)La[Po]();La=null,Po=0}}const bu=i=>i.id==null?1/0:i.id,Yw=(i,s)=>{const l=bu(i)-bu(s);if(l===0){if(i.pre&&!s.pre)return-1;if(s.pre&&!i.pre)return 1}return l};function g0(i){Lp=!1,xu=!0,fn.sort(Yw);try{for(Is=0;Is<fn.length;Is++){const s=fn[Is];s&&s.active!==!1&&Na(s,null,14)}}finally{Is=0,fn.length=0,m0(),xu=!1,Tm=null,(fn.length||jl.length)&&g0()}}function Xw(i,s,...l){if(i.isUnmounted)return;const f=i.vnode.props||Wi;let m=l;const x=s.startsWith("update:"),v=x&&s.slice(7);if(v&&v in f){const z=`${v==="modelValue"?"model":v}Modifiers`,{number:B,trim:M}=f[z]||Wi;M&&(m=l.map(re=>ir(re)?re.trim():re)),B&&(m=l.map(dw))}let c,A=f[c=op(s)]||f[c=op(Cs(s))];!A&&x&&(A=f[c=op(tc(s))]),A&&es(A,i,6,m);const R=f[c+"Once"];if(R){if(!i.emitted)i.emitted={};else if(i.emitted[c])return;i.emitted[c]=!0,es(R,i,6,m)}}function _0(i,s,l=!1){const f=s.emitsCache,m=f.get(i);if(m!==void 0)return m;const x=i.emits;let v={},c=!1;if(!Yt(i)){const A=R=>{const z=_0(R,s,!0);z&&(c=!0,Er(v,z))};!l&&s.mixins.length&&s.mixins.forEach(A),i.extends&&A(i.extends),i.mixins&&i.mixins.forEach(A)}return!x&&!c?(Ui(i)&&f.set(i,null),null):(Vt(x)?x.forEach(A=>v[A]=null):Er(v,x),Ui(i)&&f.set(i,v),v)}function Ud(i,s){return!i||!Rd(s)?!1:(s=s.slice(2).replace(/Once$/,""),_i(i,s[0].toLowerCase()+s.slice(1))||_i(i,tc(s))||_i(i,s))}let Tr=null,$d=null;function xd(i){const s=Tr;return Tr=i,$d=i&&i.type.__scopeId||null,s}function QP(i){$d=i}function eM(){$d=null}function bd(i,s=Tr,l){if(!s||i._n)return i;const f=(...m)=>{f._d&&q_(-1);const x=xd(s);let v;try{v=i(...m)}finally{xd(x),f._d&&q_(1)}return v};return f._n=!0,f._c=!0,f._d=!0,f}function up(i){const{type:s,vnode:l,proxy:f,withProxy:m,props:x,propsOptions:[v],slots:c,attrs:A,emit:R,render:z,renderCache:B,data:M,setupState:re,ctx:se,inheritAttrs:ue}=i;let ae,Z;const me=xd(i);try{if(l.shapeFlag&4){const be=m||f,Re=be;ae=Es(z.call(Re,be,B,x,re,M,se)),Z=A}else{const be=s;ae=Es(be.length>1?be(x,{attrs:A,slots:c,emit:R}):be(x,null)),Z=s.props?A:Jw(A)}}catch(be){mu.length=0,Bu(be,i,1),ae=ci(Gn)}let Ce=ae;if(Z&&ue!==!1){const be=Object.keys(Z),{shapeFlag:Re}=Ce;be.length&&Re&7&&(v&&be.some(fm)&&(Z=Qw(Z,v)),Ce=Ua(Ce,Z))}return l.dirs&&(Ce=Ua(Ce),Ce.dirs=Ce.dirs?Ce.dirs.concat(l.dirs):l.dirs),l.transition&&(Ce.transition=l.transition),ae=Ce,xd(me),ae}const Jw=i=>{let s;for(const l in i)(l==="class"||l==="style"||Rd(l))&&((s||(s={}))[l]=i[l]);return s},Qw=(i,s)=>{const l={};for(const f in i)(!fm(f)||!(f.slice(9)in s))&&(l[f]=i[f]);return l};function eS(i,s,l){const{props:f,children:m,component:x}=i,{props:v,children:c,patchFlag:A}=s,R=x.emitsOptions;if(s.dirs||s.transition)return!0;if(l&&A>=0){if(A&1024)return!0;if(A&16)return f?R_(f,v,R):!!v;if(A&8){const z=s.dynamicProps;for(let B=0;B<z.length;B++){const M=z[B];if(v[M]!==f[M]&&!Ud(R,M))return!0}}}else return(m||c)&&(!c||!c.$stable)?!0:f===v?!1:f?v?R_(f,v,R):!0:!!v;return!1}function R_(i,s,l){const f=Object.keys(s);if(f.length!==Object.keys(i).length)return!0;for(let m=0;m<f.length;m++){const x=f[m];if(s[x]!==i[x]&&!Ud(l,x))return!0}return!1}function tS({vnode:i,parent:s},l){for(;s;){const f=s.subTree;if(f.suspense&&f.suspense.activeBranch===i&&(f.el=i.el),f===i)(i=s.vnode).el=l,s=s.parent;else break}}const Em="components",iS="directives";function rS(i,s){return Im(Em,i,!0,s)||i}const y0=Symbol.for("v-ndc");function tM(i){return ir(i)?Im(Em,i,!1)||i:i||y0}function iM(i){return Im(iS,i)}function Im(i,s,l=!0,f=!1){const m=Tr||Ar;if(m){const x=m.type;if(i===Em){const c=KS(x,!1);if(c&&(c===s||c===Cs(s)||c===Ou(Cs(s))))return x}const v=D_(m[i]||x[i],s)||D_(m.appContext[i],s);return!v&&f?x:v}}function D_(i,s){return i&&(i[s]||i[Cs(s)]||i[Ou(Cs(s))])}const nS=i=>i.__isSuspense;function sS(i,s){s&&s.pendingBranch?Vt(i)?s.effects.push(...i):s.effects.push(i):Kw(i)}const aS=Symbol.for("v-scx"),oS=()=>et(aS);function jd(i,s){return Am(i,null,s)}const td={};function Mt(i,s,l){return Am(i,s,l)}function Am(i,s,{immediate:l,deep:f,flush:m,once:x,onTrack:v,onTrigger:c}=Wi){if(s&&x){const Ae=s;s=(...$e)=>{Ae(...$e),Re()}}const A=Ar,R=Ae=>f===!0?Ae:ko(Ae,f===!1?1:void 0);let z,B=!1,M=!1;if(Fi(i)?(z=()=>i.value,B=vd(i)):Ba(i)?(z=()=>R(i),B=!0):Vt(i)?(M=!0,B=i.some(Ae=>Ba(Ae)||vd(Ae)),z=()=>i.map(Ae=>{if(Fi(Ae))return Ae.value;if(Ba(Ae))return R(Ae);if(Yt(Ae))return Na(Ae,A,2)})):Yt(i)?s?z=()=>Na(i,A,2):z=()=>(re&&re(),es(i,A,3,[se])):z=jn,s&&f){const Ae=z;z=()=>ko(Ae())}let re,se=Ae=>{re=Ce.onStop=()=>{Na(Ae,A,4),re=Ce.onStop=void 0}},ue;if($u)if(se=jn,s?l&&es(s,A,3,[z(),M?[]:void 0,se]):z(),m==="sync"){const Ae=oS();ue=Ae.__watcherHandles||(Ae.__watcherHandles=[])}else return jn;let ae=M?new Array(i.length).fill(td):td;const Z=()=>{if(!(!Ce.active||!Ce.dirty))if(s){const Ae=Ce.run();(f||B||(M?Ae.some(($e,Se)=>Va($e,ae[Se])):Va(Ae,ae)))&&(re&&re(),es(s,A,3,[Ae,ae===td?void 0:M&&ae[0]===td?[]:ae,se]),ae=Ae)}else Ce.run()};Z.allowRecurse=!!s;let me;m==="sync"?me=Z:m==="post"?me=()=>Ln(Z,A&&A.suspense):(Z.pre=!0,A&&(Z.id=A.uid),me=()=>Vd(Z));const Ce=new gm(z,jn,me),be=Wv(),Re=()=>{Ce.stop(),be&&pm(be.effects,Ce)};return s?l?Z():ae=Ce.run():m==="post"?Ln(Ce.run.bind(Ce),A&&A.suspense):Ce.run(),ue&&ue.push(Re),Re}function lS(i,s,l){const f=this.proxy,m=ir(i)?i.includes(".")?v0(f,i):()=>f[i]:i.bind(f,f);let x;Yt(s)?x=s:(x=s.handler,l=s);const v=Uu(this),c=Am(m,x.bind(f),l);return v(),c}function v0(i,s){const l=s.split(".");return()=>{let f=i;for(let m=0;m<l.length&&f;m++)f=f[l[m]];return f}}function ko(i,s,l=0,f){if(!Ui(i)||i.__v_skip)return i;if(s&&s>0){if(l>=s)return i;l++}if(f=f||new Set,f.has(i))return i;if(f.add(i),Fi(i))ko(i.value,s,l,f);else if(Vt(i))for(let m=0;m<i.length;m++)ko(i[m],s,l,f);else if(Nv(i)||$l(i))i.forEach(m=>{ko(m,s,l,f)});else if($v(i))for(const m in i)ko(i[m],s,l,f);return i}function rM(i,s){if(Tr===null)return i;const l=Wd(Tr)||Tr.proxy,f=i.dirs||(i.dirs=[]);for(let m=0;m<s.length;m++){let[x,v,c,A=Wi]=s[m];x&&(Yt(x)&&(x={mounted:x,updated:x}),x.deep&&ko(v),f.push({dir:x,instance:l,value:v,oldValue:void 0,arg:c,modifiers:A}))}return i}function So(i,s,l,f){const m=i.dirs,x=s&&s.dirs;for(let v=0;v<m.length;v++){const c=m[v];x&&(c.oldValue=x[v].value);let A=c.dir[f];A&&(zo(),es(A,l,8,[i.el,c,i,s]),Oo())}}const Ra=Symbol("_leaveCb"),id=Symbol("_enterCb");function x0(){const i={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return ic(()=>{i.isMounted=!0}),pn(()=>{i.isUnmounting=!0}),i}const Jn=[Function,Array],b0={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Jn,onEnter:Jn,onAfterEnter:Jn,onEnterCancelled:Jn,onBeforeLeave:Jn,onLeave:Jn,onAfterLeave:Jn,onLeaveCancelled:Jn,onBeforeAppear:Jn,onAppear:Jn,onAfterAppear:Jn,onAppearCancelled:Jn},cS={name:"BaseTransition",props:b0,setup(i,{slots:s}){const l=Nr(),f=x0();let m;return()=>{const x=s.default&&Cm(s.default(),!0);if(!x||!x.length)return;let v=x[0];if(x.length>1){for(const ue of x)if(ue.type!==Gn){v=ue;break}}const c=hi(i),{mode:A}=c;if(f.isLeaving)return hp(v);const R=z_(v);if(!R)return hp(v);const z=wu(R,c,f,l);Su(R,z);const B=l.subTree,M=B&&z_(B);let re=!1;const{getTransitionKey:se}=R.type;if(se){const ue=se();m===void 0?m=ue:ue!==m&&(m=ue,re=!0)}if(M&&M.type!==Gn&&(!Mo(R,M)||re)){const ue=wu(M,c,f,l);if(Su(M,ue),A==="out-in")return f.isLeaving=!0,ue.afterLeave=()=>{f.isLeaving=!1,l.update.active!==!1&&(l.effect.dirty=!0,l.update())},hp(v);A==="in-out"&&R.type!==Gn&&(ue.delayLeave=(ae,Z,me)=>{const Ce=w0(f,M);Ce[String(M.key)]=M,ae[Ra]=()=>{Z(),ae[Ra]=void 0,delete z.delayedLeave},z.delayedLeave=me})}return v}}},uS=cS;function w0(i,s){const{leavingVNodes:l}=i;let f=l.get(s.type);return f||(f=Object.create(null),l.set(s.type,f)),f}function wu(i,s,l,f){const{appear:m,mode:x,persisted:v=!1,onBeforeEnter:c,onEnter:A,onAfterEnter:R,onEnterCancelled:z,onBeforeLeave:B,onLeave:M,onAfterLeave:re,onLeaveCancelled:se,onBeforeAppear:ue,onAppear:ae,onAfterAppear:Z,onAppearCancelled:me}=s,Ce=String(i.key),be=w0(l,i),Re=(Se,Ge)=>{Se&&es(Se,f,9,Ge)},Ae=(Se,Ge)=>{const ot=Ge[1];Re(Se,Ge),Vt(Se)?Se.every(_t=>_t.length<=1)&&ot():Se.length<=1&&ot()},$e={mode:x,persisted:v,beforeEnter(Se){let Ge=c;if(!l.isMounted)if(m)Ge=ue||c;else return;Se[Ra]&&Se[Ra](!0);const ot=be[Ce];ot&&Mo(i,ot)&&ot.el[Ra]&&ot.el[Ra](),Re(Ge,[Se])},enter(Se){let Ge=A,ot=R,_t=z;if(!l.isMounted)if(m)Ge=ae||A,ot=Z||R,_t=me||z;else return;let He=!1;const bt=Se[id]=qt=>{He||(He=!0,qt?Re(_t,[Se]):Re(ot,[Se]),$e.delayedLeave&&$e.delayedLeave(),Se[id]=void 0)};Ge?Ae(Ge,[Se,bt]):bt()},leave(Se,Ge){const ot=String(i.key);if(Se[id]&&Se[id](!0),l.isUnmounting)return Ge();Re(B,[Se]);let _t=!1;const He=Se[Ra]=bt=>{_t||(_t=!0,Ge(),bt?Re(se,[Se]):Re(re,[Se]),Se[Ra]=void 0,be[ot]===i&&delete be[ot])};be[ot]=i,M?Ae(M,[Se,He]):He()},clone(Se){return wu(Se,s,l,f)}};return $e}function hp(i){if(Nu(i))return i=Ua(i),i.children=null,i}function z_(i){return Nu(i)?i.children?i.children[0]:void 0:i}function Su(i,s){i.shapeFlag&6&&i.component?Su(i.component.subTree,s):i.shapeFlag&128?(i.ssContent.transition=s.clone(i.ssContent),i.ssFallback.transition=s.clone(i.ssFallback)):i.transition=s}function Cm(i,s=!1,l){let f=[],m=0;for(let x=0;x<i.length;x++){let v=i[x];const c=l==null?v.key:String(l)+String(v.key!=null?v.key:x);v.type===Yr?(v.patchFlag&128&&m++,f=f.concat(Cm(v.children,s,c))):(s||v.type!==Gn)&&f.push(c!=null?Ua(v,{key:c}):v)}if(m>1)for(let x=0;x<f.length;x++)f[x].patchFlag=-2;return f}/*! #__NO_SIDE_EFFECTS__ */function di(i,s){return Yt(i)?Er({name:i.name},s,{setup:i}):i}const du=i=>!!i.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function S0(i){Yt(i)&&(i={loader:i});const{loader:s,loadingComponent:l,errorComponent:f,delay:m=200,timeout:x,suspensible:v=!0,onError:c}=i;let A=null,R,z=0;const B=()=>(z++,A=null,M()),M=()=>{let re;return A||(re=A=s().catch(se=>{if(se=se instanceof Error?se:new Error(String(se)),c)return new Promise((ue,ae)=>{c(se,()=>ue(B()),()=>ae(se),z+1)});throw se}).then(se=>re!==A&&A?A:(se&&(se.__esModule||se[Symbol.toStringTag]==="Module")&&(se=se.default),R=se,se)))};return di({name:"AsyncComponentWrapper",__asyncLoader:M,get __asyncResolved(){return R},setup(){const re=Ar;if(R)return()=>dp(R,re);const se=me=>{A=null,Bu(me,re,13,!f)};if(v&&re.suspense||$u)return M().then(me=>()=>dp(me,re)).catch(me=>(se(me),()=>f?ci(f,{error:me}):null));const ue=yi(!1),ae=yi(),Z=yi(!!m);return m&&setTimeout(()=>{Z.value=!1},m),x!=null&&setTimeout(()=>{if(!ue.value&&!ae.value){const me=new Error(`Async component timed out after ${x}ms.`);se(me),ae.value=me}},x),M().then(()=>{ue.value=!0,re.parent&&Nu(re.parent.vnode)&&(re.parent.effect.dirty=!0,Vd(re.parent.update))}).catch(me=>{se(me),ae.value=me}),()=>{if(ue.value&&R)return dp(R,re);if(ae.value&&f)return ci(f,{error:ae.value});if(l&&!Z.value)return ci(l)}}})}function dp(i,s){const{ref:l,props:f,children:m,ce:x}=s.vnode,v=ci(i,f,m);return v.ref=l,v.ce=x,delete s.vnode.ce,v}const Nu=i=>i.type.__isKeepAlive;function T0(i,s){I0(i,"a",s)}function E0(i,s){I0(i,"da",s)}function I0(i,s,l=Ar){const f=i.__wdc||(i.__wdc=()=>{let m=l;for(;m;){if(m.isDeactivated)return;m=m.parent}return i()});if(Hd(s,f,l),l){let m=l.parent;for(;m&&m.parent;)Nu(m.parent.vnode)&&hS(f,s,l,m),m=m.parent}}function hS(i,s,l,f){const m=Hd(s,i,f,!0);Pm(()=>{pm(f[s],m)},l)}function Hd(i,s,l=Ar,f=!1){if(l){const m=l[i]||(l[i]=[]),x=s.__weh||(s.__weh=(...v)=>{if(l.isUnmounted)return;zo();const c=Uu(l),A=es(s,l,i,v);return c(),Oo(),A});return f?m.unshift(x):m.push(x),x}}const ta=i=>(s,l=Ar)=>(!$u||i==="sp")&&Hd(i,(...f)=>s(...f),l),A0=ta("bm"),ic=ta("m"),dS=ta("bu"),C0=ta("u"),pn=ta("bum"),Pm=ta("um"),fS=ta("sp"),pS=ta("rtg"),mS=ta("rtc");function gS(i,s=Ar){Hd("ec",i,s)}function nM(i,s,l,f){let m;const x=l&&l[f];if(Vt(i)||ir(i)){m=new Array(i.length);for(let v=0,c=i.length;v<c;v++)m[v]=s(i[v],v,void 0,x&&x[v])}else if(typeof i=="number"){m=new Array(i);for(let v=0;v<i;v++)m[v]=s(v+1,v,void 0,x&&x[v])}else if(Ui(i))if(i[Symbol.iterator])m=Array.from(i,(v,c)=>s(v,c,void 0,x&&x[c]));else{const v=Object.keys(i);m=new Array(v.length);for(let c=0,A=v.length;c<A;c++){const R=v[c];m[c]=s(i[R],R,c,x&&x[c])}}else m=[];return l&&(l[f]=m),m}function sM(i,s){for(let l=0;l<s.length;l++){const f=s[l];if(Vt(f))for(let m=0;m<f.length;m++)i[f[m].name]=f[m].fn;else f&&(i[f.name]=f.key?(...m)=>{const x=f.fn(...m);return x&&(x.key=f.key),x}:f.fn)}return i}function aM(i,s,l={},f,m){if(Tr.isCE||Tr.parent&&du(Tr.parent)&&Tr.parent.isCE)return s!=="default"&&(l.name=s),ci("slot",l,f&&f());let x=i[s];x&&x._c&&(x._d=!1),Tu();const v=x&&P0(x(l)),c=Gd(Yr,{key:l.key||v&&v.key||`_${s}`},v||(f?f():[]),v&&i._===1?64:-2);return!m&&c.scopeId&&(c.slotScopeIds=[c.scopeId+"-s"]),x&&x._c&&(x._d=!0),c}function P0(i){return i.some(s=>Iu(s)?!(s.type===Gn||s.type===Yr&&!P0(s.children)):!0)?i:null}const Rp=i=>i?H0(i)?Wd(i)||i.proxy:Rp(i.parent):null,fu=Er(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>Rp(i.parent),$root:i=>Rp(i.root),$emit:i=>i.emit,$options:i=>Mm(i),$forceUpdate:i=>i.f||(i.f=()=>{i.effect.dirty=!0,Vd(i.update)}),$nextTick:i=>i.n||(i.n=Ha.bind(i.proxy)),$watch:i=>lS.bind(i)}),fp=(i,s)=>i!==Wi&&!i.__isScriptSetup&&_i(i,s),_S={get({_:i},s){const{ctx:l,setupState:f,data:m,props:x,accessCache:v,type:c,appContext:A}=i;let R;if(s[0]!=="$"){const re=v[s];if(re!==void 0)switch(re){case 1:return f[s];case 2:return m[s];case 4:return l[s];case 3:return x[s]}else{if(fp(f,s))return v[s]=1,f[s];if(m!==Wi&&_i(m,s))return v[s]=2,m[s];if((R=i.propsOptions[0])&&_i(R,s))return v[s]=3,x[s];if(l!==Wi&&_i(l,s))return v[s]=4,l[s];Dp&&(v[s]=0)}}const z=fu[s];let B,M;if(z)return s==="$attrs"&&Dn(i,"get",s),z(i);if((B=c.__cssModules)&&(B=B[s]))return B;if(l!==Wi&&_i(l,s))return v[s]=4,l[s];if(M=A.config.globalProperties,_i(M,s))return M[s]},set({_:i},s,l){const{data:f,setupState:m,ctx:x}=i;return fp(m,s)?(m[s]=l,!0):f!==Wi&&_i(f,s)?(f[s]=l,!0):_i(i.props,s)||s[0]==="$"&&s.slice(1)in i?!1:(x[s]=l,!0)},has({_:{data:i,setupState:s,accessCache:l,ctx:f,appContext:m,propsOptions:x}},v){let c;return!!l[v]||i!==Wi&&_i(i,v)||fp(s,v)||(c=x[0])&&_i(c,v)||_i(f,v)||_i(fu,v)||_i(m.config.globalProperties,v)},defineProperty(i,s,l){return l.get!=null?i._.accessCache[s]=0:_i(l,"value")&&this.set(i,s,l.value,null),Reflect.defineProperty(i,s,l)}};function oM(){return yS().slots}function yS(){const i=Nr();return i.setupContext||(i.setupContext=q0(i))}function O_(i){return Vt(i)?i.reduce((s,l)=>(s[l]=null,s),{}):i}let Dp=!0;function vS(i){const s=Mm(i),l=i.proxy,f=i.ctx;Dp=!1,s.beforeCreate&&F_(s.beforeCreate,i,"bc");const{data:m,computed:x,methods:v,watch:c,provide:A,inject:R,created:z,beforeMount:B,mounted:M,beforeUpdate:re,updated:se,activated:ue,deactivated:ae,beforeDestroy:Z,beforeUnmount:me,destroyed:Ce,unmounted:be,render:Re,renderTracked:Ae,renderTriggered:$e,errorCaptured:Se,serverPrefetch:Ge,expose:ot,inheritAttrs:_t,components:He,directives:bt,filters:qt}=s;if(R&&xS(R,f,null),v)for(const jt in v){const Dt=v[jt];Yt(Dt)&&(f[jt]=Dt.bind(l))}if(m){const jt=m.call(l,l);Ui(jt)&&(i.data=Xr(jt))}if(Dp=!0,x)for(const jt in x){const Dt=x[jt],Ci=Yt(Dt)?Dt.bind(l,l):Yt(Dt.get)?Dt.get.bind(l,l):jn,mi=!Yt(Dt)&&Yt(Dt.set)?Dt.set.bind(l):jn,ai=Rt({get:Ci,set:mi});Object.defineProperty(f,jt,{enumerable:!0,configurable:!0,get:()=>ai.value,set:Xt=>ai.value=Xt})}if(c)for(const jt in c)M0(c[jt],f,l,jt);if(A){const jt=Yt(A)?A.call(l):A;Reflect.ownKeys(jt).forEach(Dt=>{Ai(Dt,jt[Dt])})}z&&F_(z,i,"c");function Lt(jt,Dt){Vt(Dt)?Dt.forEach(Ci=>jt(Ci.bind(l))):Dt&&jt(Dt.bind(l))}if(Lt(A0,B),Lt(ic,M),Lt(dS,re),Lt(C0,se),Lt(T0,ue),Lt(E0,ae),Lt(gS,Se),Lt(mS,Ae),Lt(pS,$e),Lt(pn,me),Lt(Pm,be),Lt(fS,Ge),Vt(ot))if(ot.length){const jt=i.exposed||(i.exposed={});ot.forEach(Dt=>{Object.defineProperty(jt,Dt,{get:()=>l[Dt],set:Ci=>l[Dt]=Ci})})}else i.exposed||(i.exposed={});Re&&i.render===jn&&(i.render=Re),_t!=null&&(i.inheritAttrs=_t),He&&(i.components=He),bt&&(i.directives=bt)}function xS(i,s,l=jn){Vt(i)&&(i=zp(i));for(const f in i){const m=i[f];let x;Ui(m)?"default"in m?x=et(m.from||f,m.default,!0):x=et(m.from||f):x=et(m),Fi(x)?Object.defineProperty(s,f,{enumerable:!0,configurable:!0,get:()=>x.value,set:v=>x.value=v}):s[f]=x}}function F_(i,s,l){es(Vt(i)?i.map(f=>f.bind(s.proxy)):i.bind(s.proxy),s,l)}function M0(i,s,l,f){const m=f.includes(".")?v0(l,f):()=>l[f];if(ir(i)){const x=s[i];Yt(x)&&Mt(m,x)}else if(Yt(i))Mt(m,i.bind(l));else if(Ui(i))if(Vt(i))i.forEach(x=>M0(x,s,l,f));else{const x=Yt(i.handler)?i.handler.bind(l):s[i.handler];Yt(x)&&Mt(m,x,i)}}function Mm(i){const s=i.type,{mixins:l,extends:f}=s,{mixins:m,optionsCache:x,config:{optionMergeStrategies:v}}=i.appContext,c=x.get(s);let A;return c?A=c:!m.length&&!l&&!f?A=s:(A={},m.length&&m.forEach(R=>wd(A,R,v,!0)),wd(A,s,v)),Ui(s)&&x.set(s,A),A}function wd(i,s,l,f=!1){const{mixins:m,extends:x}=s;x&&wd(i,x,l,!0),m&&m.forEach(v=>wd(i,v,l,!0));for(const v in s)if(!(f&&v==="expose")){const c=bS[v]||l&&l[v];i[v]=c?c(i[v],s[v]):s[v]}return i}const bS={data:B_,props:N_,emits:N_,methods:cu,computed:cu,beforeCreate:Sn,created:Sn,beforeMount:Sn,mounted:Sn,beforeUpdate:Sn,updated:Sn,beforeDestroy:Sn,beforeUnmount:Sn,destroyed:Sn,unmounted:Sn,activated:Sn,deactivated:Sn,errorCaptured:Sn,serverPrefetch:Sn,components:cu,directives:cu,watch:SS,provide:B_,inject:wS};function B_(i,s){return s?i?function(){return Er(Yt(i)?i.call(this,this):i,Yt(s)?s.call(this,this):s)}:s:i}function wS(i,s){return cu(zp(i),zp(s))}function zp(i){if(Vt(i)){const s={};for(let l=0;l<i.length;l++)s[i[l]]=i[l];return s}return i}function Sn(i,s){return i?[...new Set([].concat(i,s))]:s}function cu(i,s){return i?Er(Object.create(null),i,s):s}function N_(i,s){return i?Vt(i)&&Vt(s)?[...new Set([...i,...s])]:Er(Object.create(null),O_(i),O_(s??{})):s}function SS(i,s){if(!i)return s;if(!s)return i;const l=Er(Object.create(null),i);for(const f in s)l[f]=Sn(i[f],s[f]);return l}function k0(){return{app:null,config:{isNativeTag:ow,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let TS=0;function ES(i,s){return function(f,m=null){Yt(f)||(f=Er({},f)),m!=null&&!Ui(m)&&(m=null);const x=k0(),v=new WeakSet;let c=!1;const A=x.app={_uid:TS++,_component:f,_props:m,_container:null,_context:x,_instance:null,version:XS,get config(){return x.config},set config(R){},use(R,...z){return v.has(R)||(R&&Yt(R.install)?(v.add(R),R.install(A,...z)):Yt(R)&&(v.add(R),R(A,...z))),A},mixin(R){return x.mixins.includes(R)||x.mixins.push(R),A},component(R,z){return z?(x.components[R]=z,A):x.components[R]},directive(R,z){return z?(x.directives[R]=z,A):x.directives[R]},mount(R,z,B){if(!c){const M=ci(f,m);return M.appContext=x,B===!0?B="svg":B===!1&&(B=void 0),z&&s?s(M,R):i(M,R,B),c=!0,A._container=R,R.__vue_app__=A,Wd(M.component)||M.component.proxy}},unmount(){c&&(i(null,A._container),delete A._container.__vue_app__)},provide(R,z){return x.provides[R]=z,A},runWithContext(R){const z=Hl;Hl=A;try{return R()}finally{Hl=z}}};return A}}let Hl=null;function Ai(i,s){if(Ar){let l=Ar.provides;const f=Ar.parent&&Ar.parent.provides;f===l&&(l=Ar.provides=Object.create(f)),l[i]=s}}function et(i,s,l=!1){const f=Ar||Tr;if(f||Hl){const m=f?f.parent==null?f.vnode.appContext&&f.vnode.appContext.provides:f.parent.provides:Hl._context.provides;if(m&&i in m)return m[i];if(arguments.length>1)return l&&Yt(s)?s.call(f&&f.proxy):s}}function IS(){return!!(Ar||Tr||Hl)}function AS(i,s,l,f=!1){const m={},x={};_d(x,qd,1),i.propsDefaults=Object.create(null),L0(i,s,m,x);for(const v in i.propsOptions[0])v in m||(m[v]=void 0);l?i.props=f?m:a0(m):i.type.props?i.props=m:i.props=x,i.attrs=x}function CS(i,s,l,f){const{props:m,attrs:x,vnode:{patchFlag:v}}=i,c=hi(m),[A]=i.propsOptions;let R=!1;if((f||v>0)&&!(v&16)){if(v&8){const z=i.vnode.dynamicProps;for(let B=0;B<z.length;B++){let M=z[B];if(Ud(i.emitsOptions,M))continue;const re=s[M];if(A)if(_i(x,M))re!==x[M]&&(x[M]=re,R=!0);else{const se=Cs(M);m[se]=Op(A,c,se,re,i,!1)}else re!==x[M]&&(x[M]=re,R=!0)}}}else{L0(i,s,m,x)&&(R=!0);let z;for(const B in c)(!s||!_i(s,B)&&((z=tc(B))===B||!_i(s,z)))&&(A?l&&(l[B]!==void 0||l[z]!==void 0)&&(m[B]=Op(A,c,B,void 0,i,!0)):delete m[B]);if(x!==c)for(const B in x)(!s||!_i(s,B))&&(delete x[B],R=!0)}R&&ea(i,"set","$attrs")}function L0(i,s,l,f){const[m,x]=i.propsOptions;let v=!1,c;if(s)for(let A in s){if(hu(A))continue;const R=s[A];let z;m&&_i(m,z=Cs(A))?!x||!x.includes(z)?l[z]=R:(c||(c={}))[z]=R:Ud(i.emitsOptions,A)||(!(A in f)||R!==f[A])&&(f[A]=R,v=!0)}if(x){const A=hi(l),R=c||Wi;for(let z=0;z<x.length;z++){const B=x[z];l[B]=Op(m,A,B,R[B],i,!_i(R,B))}}return v}function Op(i,s,l,f,m,x){const v=i[l];if(v!=null){const c=_i(v,"default");if(c&&f===void 0){const A=v.default;if(v.type!==Function&&!v.skipFactory&&Yt(A)){const{propsDefaults:R}=m;if(l in R)f=R[l];else{const z=Uu(m);f=R[l]=A.call(null,s),z()}}else f=A}v[0]&&(x&&!c?f=!1:v[1]&&(f===""||f===tc(l))&&(f=!0))}return f}function R0(i,s,l=!1){const f=s.propsCache,m=f.get(i);if(m)return m;const x=i.props,v={},c=[];let A=!1;if(!Yt(i)){const z=B=>{A=!0;const[M,re]=R0(B,s,!0);Er(v,M),re&&c.push(...re)};!l&&s.mixins.length&&s.mixins.forEach(z),i.extends&&z(i.extends),i.mixins&&i.mixins.forEach(z)}if(!x&&!A)return Ui(i)&&f.set(i,Ul),Ul;if(Vt(x))for(let z=0;z<x.length;z++){const B=Cs(x[z]);V_(B)&&(v[B]=Wi)}else if(x)for(const z in x){const B=Cs(z);if(V_(B)){const M=x[z],re=v[B]=Vt(M)||Yt(M)?{type:M}:Er({},M);if(re){const se=j_(Boolean,re.type),ue=j_(String,re.type);re[0]=se>-1,re[1]=ue<0||se<ue,(se>-1||_i(re,"default"))&&c.push(B)}}}const R=[v,c];return Ui(i)&&f.set(i,R),R}function V_(i){return i[0]!=="$"&&!hu(i)}function U_(i){return i===null?"null":typeof i=="function"?i.name||"":typeof i=="object"&&i.constructor&&i.constructor.name||""}function $_(i,s){return U_(i)===U_(s)}function j_(i,s){return Vt(s)?s.findIndex(l=>$_(l,i)):Yt(s)&&$_(s,i)?0:-1}const D0=i=>i[0]==="_"||i==="$stable",km=i=>Vt(i)?i.map(Es):[Es(i)],PS=(i,s,l)=>{if(s._n)return s;const f=bd((...m)=>km(s(...m)),l);return f._c=!1,f},z0=(i,s,l)=>{const f=i._ctx;for(const m in i){if(D0(m))continue;const x=i[m];if(Yt(x))s[m]=PS(m,x,f);else if(x!=null){const v=km(x);s[m]=()=>v}}},O0=(i,s)=>{const l=km(s);i.slots.default=()=>l},MS=(i,s)=>{if(i.vnode.shapeFlag&32){const l=s._;l?(i.slots=hi(s),_d(s,"_",l)):z0(s,i.slots={})}else i.slots={},s&&O0(i,s);_d(i.slots,qd,1)},kS=(i,s,l)=>{const{vnode:f,slots:m}=i;let x=!0,v=Wi;if(f.shapeFlag&32){const c=s._;c?l&&c===1?x=!1:(Er(m,s),!l&&c===1&&delete m._):(x=!s.$stable,z0(s,m)),v=s}else s&&(O0(i,s),v={default:1});if(x)for(const c in m)!D0(c)&&v[c]==null&&delete m[c]};function Fp(i,s,l,f,m=!1){if(Vt(i)){i.forEach((M,re)=>Fp(M,s&&(Vt(s)?s[re]:s),l,f,m));return}if(du(f)&&!m)return;const x=f.shapeFlag&4?Wd(f.component)||f.component.proxy:f.el,v=m?null:x,{i:c,r:A}=i,R=s&&s.r,z=c.refs===Wi?c.refs={}:c.refs,B=c.setupState;if(R!=null&&R!==A&&(ir(R)?(z[R]=null,_i(B,R)&&(B[R]=null)):Fi(R)&&(R.value=null)),Yt(A))Na(A,c,12,[v,z]);else{const M=ir(A),re=Fi(A);if(M||re){const se=()=>{if(i.f){const ue=M?_i(B,A)?B[A]:z[A]:A.value;m?Vt(ue)&&pm(ue,x):Vt(ue)?ue.includes(x)||ue.push(x):M?(z[A]=[x],_i(B,A)&&(B[A]=z[A])):(A.value=[x],i.k&&(z[i.k]=A.value))}else M?(z[A]=v,_i(B,A)&&(B[A]=v)):re&&(A.value=v,i.k&&(z[i.k]=v))};v?(se.id=-1,Ln(se,l)):se()}}}const Ln=sS;function LS(i){return RS(i)}function RS(i,s){const l=jv();l.__VUE__=!0;const{insert:f,remove:m,patchProp:x,createElement:v,createText:c,createComment:A,setText:R,setElementText:z,parentNode:B,nextSibling:M,setScopeId:re=jn,insertStaticContent:se}=i,ue=(O,D,Y,ye=null,K=null,Be=null,Qe=void 0,Me=null,Ke=!!D.dynamicChildren)=>{if(O===D)return;O&&!Mo(O,D)&&(ye=ke(O),Xt(O,K,Be,!0),O=null),D.patchFlag===-2&&(Ke=!1,D.dynamicChildren=null);const{type:qe,ref:ft,shapeFlag:ct}=D;switch(qe){case Vu:ae(O,D,Y,ye);break;case Gn:Z(O,D,Y,ye);break;case mp:O==null&&me(D,Y,ye,Qe);break;case Yr:He(O,D,Y,ye,K,Be,Qe,Me,Ke);break;default:ct&1?Re(O,D,Y,ye,K,Be,Qe,Me,Ke):ct&6?bt(O,D,Y,ye,K,Be,Qe,Me,Ke):(ct&64||ct&128)&&qe.process(O,D,Y,ye,K,Be,Qe,Me,Ke,ht)}ft!=null&&K&&Fp(ft,O&&O.ref,Be,D||O,!D)},ae=(O,D,Y,ye)=>{if(O==null)f(D.el=c(D.children),Y,ye);else{const K=D.el=O.el;D.children!==O.children&&R(K,D.children)}},Z=(O,D,Y,ye)=>{O==null?f(D.el=A(D.children||""),Y,ye):D.el=O.el},me=(O,D,Y,ye)=>{[O.el,O.anchor]=se(O.children,D,Y,ye,O.el,O.anchor)},Ce=({el:O,anchor:D},Y,ye)=>{let K;for(;O&&O!==D;)K=M(O),f(O,Y,ye),O=K;f(D,Y,ye)},be=({el:O,anchor:D})=>{let Y;for(;O&&O!==D;)Y=M(O),m(O),O=Y;m(D)},Re=(O,D,Y,ye,K,Be,Qe,Me,Ke)=>{D.type==="svg"?Qe="svg":D.type==="math"&&(Qe="mathml"),O==null?Ae(D,Y,ye,K,Be,Qe,Me,Ke):Ge(O,D,K,Be,Qe,Me,Ke)},Ae=(O,D,Y,ye,K,Be,Qe,Me)=>{let Ke,qe;const{props:ft,shapeFlag:ct,transition:xe,dirs:Pe}=O;if(Ke=O.el=v(O.type,Be,ft&&ft.is,ft),ct&8?z(Ke,O.children):ct&16&&Se(O.children,Ke,null,ye,K,pp(O,Be),Qe,Me),Pe&&So(O,null,ye,"created"),$e(Ke,O,O.scopeId,Qe,ye),ft){for(const Ct in ft)Ct!=="value"&&!hu(Ct)&&x(Ke,Ct,null,ft[Ct],Be,O.children,ye,K,Wt);"value"in ft&&x(Ke,"value",null,ft.value,Be),(qe=ft.onVnodeBeforeMount)&&ws(qe,ye,O)}Pe&&So(O,null,ye,"beforeMount");const yt=DS(K,xe);yt&&xe.beforeEnter(Ke),f(Ke,D,Y),((qe=ft&&ft.onVnodeMounted)||yt||Pe)&&Ln(()=>{qe&&ws(qe,ye,O),yt&&xe.enter(Ke),Pe&&So(O,null,ye,"mounted")},K)},$e=(O,D,Y,ye,K)=>{if(Y&&re(O,Y),ye)for(let Be=0;Be<ye.length;Be++)re(O,ye[Be]);if(K){let Be=K.subTree;if(D===Be){const Qe=K.vnode;$e(O,Qe,Qe.scopeId,Qe.slotScopeIds,K.parent)}}},Se=(O,D,Y,ye,K,Be,Qe,Me,Ke=0)=>{for(let qe=Ke;qe<O.length;qe++){const ft=O[qe]=Me?Da(O[qe]):Es(O[qe]);ue(null,ft,D,Y,ye,K,Be,Qe,Me)}},Ge=(O,D,Y,ye,K,Be,Qe)=>{const Me=D.el=O.el;let{patchFlag:Ke,dynamicChildren:qe,dirs:ft}=D;Ke|=O.patchFlag&16;const ct=O.props||Wi,xe=D.props||Wi;let Pe;if(Y&&To(Y,!1),(Pe=xe.onVnodeBeforeUpdate)&&ws(Pe,Y,D,O),ft&&So(D,O,Y,"beforeUpdate"),Y&&To(Y,!0),qe?ot(O.dynamicChildren,qe,Me,Y,ye,pp(D,K),Be):Qe||Dt(O,D,Me,null,Y,ye,pp(D,K),Be,!1),Ke>0){if(Ke&16)_t(Me,D,ct,xe,Y,ye,K);else if(Ke&2&&ct.class!==xe.class&&x(Me,"class",null,xe.class,K),Ke&4&&x(Me,"style",ct.style,xe.style,K),Ke&8){const yt=D.dynamicProps;for(let Ct=0;Ct<yt.length;Ct++){const Oe=yt[Ct],oi=ct[Oe],fi=xe[Oe];(fi!==oi||Oe==="value")&&x(Me,Oe,oi,fi,K,O.children,Y,ye,Wt)}}Ke&1&&O.children!==D.children&&z(Me,D.children)}else!Qe&&qe==null&&_t(Me,D,ct,xe,Y,ye,K);((Pe=xe.onVnodeUpdated)||ft)&&Ln(()=>{Pe&&ws(Pe,Y,D,O),ft&&So(D,O,Y,"updated")},ye)},ot=(O,D,Y,ye,K,Be,Qe)=>{for(let Me=0;Me<D.length;Me++){const Ke=O[Me],qe=D[Me],ft=Ke.el&&(Ke.type===Yr||!Mo(Ke,qe)||Ke.shapeFlag&70)?B(Ke.el):Y;ue(Ke,qe,ft,null,ye,K,Be,Qe,!0)}},_t=(O,D,Y,ye,K,Be,Qe)=>{if(Y!==ye){if(Y!==Wi)for(const Me in Y)!hu(Me)&&!(Me in ye)&&x(O,Me,Y[Me],null,Qe,D.children,K,Be,Wt);for(const Me in ye){if(hu(Me))continue;const Ke=ye[Me],qe=Y[Me];Ke!==qe&&Me!=="value"&&x(O,Me,qe,Ke,Qe,D.children,K,Be,Wt)}"value"in ye&&x(O,"value",Y.value,ye.value,Qe)}},He=(O,D,Y,ye,K,Be,Qe,Me,Ke)=>{const qe=D.el=O?O.el:c(""),ft=D.anchor=O?O.anchor:c("");let{patchFlag:ct,dynamicChildren:xe,slotScopeIds:Pe}=D;Pe&&(Me=Me?Me.concat(Pe):Pe),O==null?(f(qe,Y,ye),f(ft,Y,ye),Se(D.children||[],Y,ft,K,Be,Qe,Me,Ke)):ct>0&&ct&64&&xe&&O.dynamicChildren?(ot(O.dynamicChildren,xe,Y,K,Be,Qe,Me),(D.key!=null||K&&D===K.subTree)&&Lm(O,D,!0)):Dt(O,D,Y,ft,K,Be,Qe,Me,Ke)},bt=(O,D,Y,ye,K,Be,Qe,Me,Ke)=>{D.slotScopeIds=Me,O==null?D.shapeFlag&512?K.ctx.activate(D,Y,ye,Qe,Ke):qt(D,Y,ye,K,Be,Qe,Ke):pi(O,D,Ke)},qt=(O,D,Y,ye,K,Be,Qe)=>{const Me=O.component=GS(O,ye,K);if(Nu(O)&&(Me.ctx.renderer=ht),qS(Me),Me.asyncDep){if(K&&K.registerDep(Me,Lt),!O.el){const Ke=Me.subTree=ci(Gn);Z(null,Ke,D,Y)}}else Lt(Me,O,D,Y,K,Be,Qe)},pi=(O,D,Y)=>{const ye=D.component=O.component;if(eS(O,D,Y))if(ye.asyncDep&&!ye.asyncResolved){jt(ye,D,Y);return}else ye.next=D,Zw(ye.update),ye.effect.dirty=!0,ye.update();else D.el=O.el,ye.vnode=D},Lt=(O,D,Y,ye,K,Be,Qe)=>{const Me=()=>{if(O.isMounted){let{next:ft,bu:ct,u:xe,parent:Pe,vnode:yt}=O;{const rn=F0(O);if(rn){ft&&(ft.el=yt.el,jt(O,ft,Qe)),rn.asyncDep.then(()=>{O.isUnmounted||Me()});return}}let Ct=ft,Oe;To(O,!1),ft?(ft.el=yt.el,jt(O,ft,Qe)):ft=yt,ct&&lp(ct),(Oe=ft.props&&ft.props.onVnodeBeforeUpdate)&&ws(Oe,Pe,ft,yt),To(O,!0);const oi=up(O),fi=O.subTree;O.subTree=oi,ue(fi,oi,B(fi.el),ke(fi),O,K,Be),ft.el=oi.el,Ct===null&&tS(O,oi.el),xe&&Ln(xe,K),(Oe=ft.props&&ft.props.onVnodeUpdated)&&Ln(()=>ws(Oe,Pe,ft,yt),K)}else{let ft;const{el:ct,props:xe}=D,{bm:Pe,m:yt,parent:Ct}=O,Oe=du(D);if(To(O,!1),Pe&&lp(Pe),!Oe&&(ft=xe&&xe.onVnodeBeforeMount)&&ws(ft,Ct,D),To(O,!0),ct&&ei){const oi=()=>{O.subTree=up(O),ei(ct,O.subTree,O,K,null)};Oe?D.type.__asyncLoader().then(()=>!O.isUnmounted&&oi()):oi()}else{const oi=O.subTree=up(O);ue(null,oi,Y,ye,O,K,Be),D.el=oi.el}if(yt&&Ln(yt,K),!Oe&&(ft=xe&&xe.onVnodeMounted)){const oi=D;Ln(()=>ws(ft,Ct,oi),K)}(D.shapeFlag&256||Ct&&du(Ct.vnode)&&Ct.vnode.shapeFlag&256)&&O.a&&Ln(O.a,K),O.isMounted=!0,D=Y=ye=null}},Ke=O.effect=new gm(Me,jn,()=>Vd(qe),O.scope),qe=O.update=()=>{Ke.dirty&&Ke.run()};qe.id=O.uid,To(O,!0),qe()},jt=(O,D,Y)=>{D.component=O;const ye=O.vnode.props;O.vnode=D,O.next=null,CS(O,D.props,ye,Y),kS(O,D.children,Y),zo(),L_(O),Oo()},Dt=(O,D,Y,ye,K,Be,Qe,Me,Ke=!1)=>{const qe=O&&O.children,ft=O?O.shapeFlag:0,ct=D.children,{patchFlag:xe,shapeFlag:Pe}=D;if(xe>0){if(xe&128){mi(qe,ct,Y,ye,K,Be,Qe,Me,Ke);return}else if(xe&256){Ci(qe,ct,Y,ye,K,Be,Qe,Me,Ke);return}}Pe&8?(ft&16&&Wt(qe,K,Be),ct!==qe&&z(Y,ct)):ft&16?Pe&16?mi(qe,ct,Y,ye,K,Be,Qe,Me,Ke):Wt(qe,K,Be,!0):(ft&8&&z(Y,""),Pe&16&&Se(ct,Y,ye,K,Be,Qe,Me,Ke))},Ci=(O,D,Y,ye,K,Be,Qe,Me,Ke)=>{O=O||Ul,D=D||Ul;const qe=O.length,ft=D.length,ct=Math.min(qe,ft);let xe;for(xe=0;xe<ct;xe++){const Pe=D[xe]=Ke?Da(D[xe]):Es(D[xe]);ue(O[xe],Pe,Y,null,K,Be,Qe,Me,Ke)}qe>ft?Wt(O,K,Be,!0,!1,ct):Se(D,Y,ye,K,Be,Qe,Me,Ke,ct)},mi=(O,D,Y,ye,K,Be,Qe,Me,Ke)=>{let qe=0;const ft=D.length;let ct=O.length-1,xe=ft-1;for(;qe<=ct&&qe<=xe;){const Pe=O[qe],yt=D[qe]=Ke?Da(D[qe]):Es(D[qe]);if(Mo(Pe,yt))ue(Pe,yt,Y,null,K,Be,Qe,Me,Ke);else break;qe++}for(;qe<=ct&&qe<=xe;){const Pe=O[ct],yt=D[xe]=Ke?Da(D[xe]):Es(D[xe]);if(Mo(Pe,yt))ue(Pe,yt,Y,null,K,Be,Qe,Me,Ke);else break;ct--,xe--}if(qe>ct){if(qe<=xe){const Pe=xe+1,yt=Pe<ft?D[Pe].el:ye;for(;qe<=xe;)ue(null,D[qe]=Ke?Da(D[qe]):Es(D[qe]),Y,yt,K,Be,Qe,Me,Ke),qe++}}else if(qe>xe)for(;qe<=ct;)Xt(O[qe],K,Be,!0),qe++;else{const Pe=qe,yt=qe,Ct=new Map;for(qe=yt;qe<=xe;qe++){const Et=D[qe]=Ke?Da(D[qe]):Es(D[qe]);Et.key!=null&&Ct.set(Et.key,qe)}let Oe,oi=0;const fi=xe-yt+1;let rn=!1,rr=0;const Ye=new Array(fi);for(qe=0;qe<fi;qe++)Ye[qe]=0;for(qe=Pe;qe<=ct;qe++){const Et=O[qe];if(oi>=fi){Xt(Et,K,Be,!0);continue}let gi;if(Et.key!=null)gi=Ct.get(Et.key);else for(Oe=yt;Oe<=xe;Oe++)if(Ye[Oe-yt]===0&&Mo(Et,D[Oe])){gi=Oe;break}gi===void 0?Xt(Et,K,Be,!0):(Ye[gi-yt]=qe+1,gi>=rr?rr=gi:rn=!0,ue(Et,D[gi],Y,null,K,Be,Qe,Me,Ke),oi++)}const Ot=rn?zS(Ye):Ul;for(Oe=Ot.length-1,qe=fi-1;qe>=0;qe--){const Et=yt+qe,gi=D[Et],mn=Et+1<ft?D[Et+1].el:ye;Ye[qe]===0?ue(null,gi,Y,mn,K,Be,Qe,Me,Ke):rn&&(Oe<0||qe!==Ot[Oe]?ai(gi,Y,mn,2):Oe--)}}},ai=(O,D,Y,ye,K=null)=>{const{el:Be,type:Qe,transition:Me,children:Ke,shapeFlag:qe}=O;if(qe&6){ai(O.component.subTree,D,Y,ye);return}if(qe&128){O.suspense.move(D,Y,ye);return}if(qe&64){Qe.move(O,D,Y,ht);return}if(Qe===Yr){f(Be,D,Y);for(let ct=0;ct<Ke.length;ct++)ai(Ke[ct],D,Y,ye);f(O.anchor,D,Y);return}if(Qe===mp){Ce(O,D,Y);return}if(ye!==2&&qe&1&&Me)if(ye===0)Me.beforeEnter(Be),f(Be,D,Y),Ln(()=>Me.enter(Be),K);else{const{leave:ct,delayLeave:xe,afterLeave:Pe}=Me,yt=()=>f(Be,D,Y),Ct=()=>{ct(Be,()=>{yt(),Pe&&Pe()})};xe?xe(Be,yt,Ct):Ct()}else f(Be,D,Y)},Xt=(O,D,Y,ye=!1,K=!1)=>{const{type:Be,props:Qe,ref:Me,children:Ke,dynamicChildren:qe,shapeFlag:ft,patchFlag:ct,dirs:xe}=O;if(Me!=null&&Fp(Me,null,Y,O,!0),ft&256){D.ctx.deactivate(O);return}const Pe=ft&1&&xe,yt=!du(O);let Ct;if(yt&&(Ct=Qe&&Qe.onVnodeBeforeUnmount)&&ws(Ct,D,O),ft&6)Yi(O.component,Y,ye);else{if(ft&128){O.suspense.unmount(Y,ye);return}Pe&&So(O,null,D,"beforeUnmount"),ft&64?O.type.remove(O,D,Y,K,ht,ye):qe&&(Be!==Yr||ct>0&&ct&64)?Wt(qe,D,Y,!1,!0):(Be===Yr&&ct&384||!K&&ft&16)&&Wt(Ke,D,Y),ye&&Bi(O)}(yt&&(Ct=Qe&&Qe.onVnodeUnmounted)||Pe)&&Ln(()=>{Ct&&ws(Ct,D,O),Pe&&So(O,null,D,"unmounted")},Y)},Bi=O=>{const{type:D,el:Y,anchor:ye,transition:K}=O;if(D===Yr){Pi(Y,ye);return}if(D===mp){be(O);return}const Be=()=>{m(Y),K&&!K.persisted&&K.afterLeave&&K.afterLeave()};if(O.shapeFlag&1&&K&&!K.persisted){const{leave:Qe,delayLeave:Me}=K,Ke=()=>Qe(Y,Be);Me?Me(O.el,Be,Ke):Ke()}else Be()},Pi=(O,D)=>{let Y;for(;O!==D;)Y=M(O),m(O),O=Y;m(D)},Yi=(O,D,Y)=>{const{bum:ye,scope:K,update:Be,subTree:Qe,um:Me}=O;ye&&lp(ye),K.stop(),Be&&(Be.active=!1,Xt(Qe,O,D,Y)),Me&&Ln(Me,D),Ln(()=>{O.isUnmounted=!0},D),D&&D.pendingBranch&&!D.isUnmounted&&O.asyncDep&&!O.asyncResolved&&O.suspenseId===D.pendingId&&(D.deps--,D.deps===0&&D.resolve())},Wt=(O,D,Y,ye=!1,K=!1,Be=0)=>{for(let Qe=Be;Qe<O.length;Qe++)Xt(O[Qe],D,Y,ye,K)},ke=O=>O.shapeFlag&6?ke(O.component.subTree):O.shapeFlag&128?O.suspense.next():M(O.anchor||O.el);let nt=!1;const it=(O,D,Y)=>{O==null?D._vnode&&Xt(D._vnode,null,null,!0):ue(D._vnode||null,O,D,null,null,null,Y),nt||(nt=!0,L_(),m0(),nt=!1),D._vnode=O},ht={p:ue,um:Xt,m:ai,r:Bi,mt:qt,mc:Se,pc:Dt,pbc:ot,n:ke,o:i};let Ht,ei;return s&&([Ht,ei]=s(ht)),{render:it,hydrate:Ht,createApp:ES(it,Ht)}}function pp({type:i,props:s},l){return l==="svg"&&i==="foreignObject"||l==="mathml"&&i==="annotation-xml"&&s&&s.encoding&&s.encoding.includes("html")?void 0:l}function To({effect:i,update:s},l){i.allowRecurse=s.allowRecurse=l}function DS(i,s){return(!i||i&&!i.pendingBranch)&&s&&!s.persisted}function Lm(i,s,l=!1){const f=i.children,m=s.children;if(Vt(f)&&Vt(m))for(let x=0;x<f.length;x++){const v=f[x];let c=m[x];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=m[x]=Da(m[x]),c.el=v.el),l||Lm(v,c)),c.type===Vu&&(c.el=v.el)}}function zS(i){const s=i.slice(),l=[0];let f,m,x,v,c;const A=i.length;for(f=0;f<A;f++){const R=i[f];if(R!==0){if(m=l[l.length-1],i[m]<R){s[f]=m,l.push(f);continue}for(x=0,v=l.length-1;x<v;)c=x+v>>1,i[l[c]]<R?x=c+1:v=c;R<i[l[x]]&&(x>0&&(s[f]=l[x-1]),l[x]=f)}}for(x=l.length,v=l[x-1];x-- >0;)l[x]=v,v=s[v];return l}function F0(i){const s=i.subTree.component;if(s)return s.asyncDep&&!s.asyncResolved?s:F0(s)}const OS=i=>i.__isTeleport,pu=i=>i&&(i.disabled||i.disabled===""),H_=i=>typeof SVGElement<"u"&&i instanceof SVGElement,G_=i=>typeof MathMLElement=="function"&&i instanceof MathMLElement,Bp=(i,s)=>{const l=i&&i.to;return ir(l)?s?s(l):null:l},FS={name:"Teleport",__isTeleport:!0,process(i,s,l,f,m,x,v,c,A,R){const{mc:z,pc:B,pbc:M,o:{insert:re,querySelector:se,createText:ue,createComment:ae}}=R,Z=pu(s.props);let{shapeFlag:me,children:Ce,dynamicChildren:be}=s;if(i==null){const Re=s.el=ue(""),Ae=s.anchor=ue("");re(Re,l,f),re(Ae,l,f);const $e=s.target=Bp(s.props,se),Se=s.targetAnchor=ue("");$e&&(re(Se,$e),v==="svg"||H_($e)?v="svg":(v==="mathml"||G_($e))&&(v="mathml"));const Ge=(ot,_t)=>{me&16&&z(Ce,ot,_t,m,x,v,c,A)};Z?Ge(l,Ae):$e&&Ge($e,Se)}else{s.el=i.el;const Re=s.anchor=i.anchor,Ae=s.target=i.target,$e=s.targetAnchor=i.targetAnchor,Se=pu(i.props),Ge=Se?l:Ae,ot=Se?Re:$e;if(v==="svg"||H_(Ae)?v="svg":(v==="mathml"||G_(Ae))&&(v="mathml"),be?(M(i.dynamicChildren,be,Ge,m,x,v,c),Lm(i,s,!0)):A||B(i,s,Ge,ot,m,x,v,c,!1),Z)Se?s.props&&i.props&&s.props.to!==i.props.to&&(s.props.to=i.props.to):rd(s,l,Re,R,1);else if((s.props&&s.props.to)!==(i.props&&i.props.to)){const _t=s.target=Bp(s.props,se);_t&&rd(s,_t,null,R,0)}else Se&&rd(s,Ae,$e,R,1)}N0(s)},remove(i,s,l,f,{um:m,o:{remove:x}},v){const{shapeFlag:c,children:A,anchor:R,targetAnchor:z,target:B,props:M}=i;if(B&&x(z),v&&x(R),c&16){const re=v||!pu(M);for(let se=0;se<A.length;se++){const ue=A[se];m(ue,s,l,re,!!ue.dynamicChildren)}}},move:rd,hydrate:BS};function rd(i,s,l,{o:{insert:f},m},x=2){x===0&&f(i.targetAnchor,s,l);const{el:v,anchor:c,shapeFlag:A,children:R,props:z}=i,B=x===2;if(B&&f(v,s,l),(!B||pu(z))&&A&16)for(let M=0;M<R.length;M++)m(R[M],s,l,2);B&&f(c,s,l)}function BS(i,s,l,f,m,x,{o:{nextSibling:v,parentNode:c,querySelector:A}},R){const z=s.target=Bp(s.props,A);if(z){const B=z._lpa||z.firstChild;if(s.shapeFlag&16)if(pu(s.props))s.anchor=R(v(i),s,c(i),l,f,m,x),s.targetAnchor=B;else{s.anchor=v(i);let M=B;for(;M;)if(M=v(M),M&&M.nodeType===8&&M.data==="teleport anchor"){s.targetAnchor=M,z._lpa=s.targetAnchor&&v(s.targetAnchor);break}R(B,s,z,l,f,m,x)}N0(s)}return s.anchor&&v(s.anchor)}const B0=FS;function N0(i){const s=i.ctx;if(s&&s.ut){let l=i.children[0].el;for(;l&&l!==i.targetAnchor;)l.nodeType===1&&l.setAttribute("data-v-owner",s.uid),l=l.nextSibling;s.ut()}}const Yr=Symbol.for("v-fgt"),Vu=Symbol.for("v-txt"),Gn=Symbol.for("v-cmt"),mp=Symbol.for("v-stc"),mu=[];let cs=null;function Tu(i=!1){mu.push(cs=i?null:[])}function NS(){mu.pop(),cs=mu[mu.length-1]||null}let Eu=1;function q_(i){Eu+=i}function V0(i){return i.dynamicChildren=Eu>0?cs||Ul:null,NS(),Eu>0&&cs&&cs.push(i),i}function VS(i,s,l,f,m,x){return V0($0(i,s,l,f,m,x,!0))}function Gd(i,s,l,f,m){return V0(ci(i,s,l,f,m,!0))}function Iu(i){return i?i.__v_isVNode===!0:!1}function Mo(i,s){return i.type===s.type&&i.key===s.key}const qd="__vInternal",U0=({key:i})=>i??null,dd=({ref:i,ref_key:s,ref_for:l})=>(typeof i=="number"&&(i=""+i),i!=null?ir(i)||Fi(i)||Yt(i)?{i:Tr,r:i,k:s,f:!!l}:i:null);function $0(i,s=null,l=null,f=0,m=null,x=i===Yr?0:1,v=!1,c=!1){const A={__v_isVNode:!0,__v_skip:!0,type:i,props:s,key:s&&U0(s),ref:s&&dd(s),scopeId:$d,slotScopeIds:null,children:l,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:x,patchFlag:f,dynamicProps:m,dynamicChildren:null,appContext:null,ctx:Tr};return c?(Rm(A,l),x&128&&i.normalize(A)):l&&(A.shapeFlag|=ir(l)?8:16),Eu>0&&!v&&cs&&(A.patchFlag>0||x&6)&&A.patchFlag!==32&&cs.push(A),A}const ci=US;function US(i,s=null,l=null,f=0,m=null,x=!1){if((!i||i===y0)&&(i=Gn),Iu(i)){const c=Ua(i,s,!0);return l&&Rm(c,l),Eu>0&&!x&&cs&&(c.shapeFlag&6?cs[cs.indexOf(i)]=c:cs.push(c)),c.patchFlag|=-2,c}if(YS(i)&&(i=i.__vccOpts),s){s=$S(s);let{class:c,style:A}=s;c&&!ir(c)&&(s.class=Od(c)),Ui(A)&&(o0(A)&&!Vt(A)&&(A=Er({},A)),s.style=Fu(A))}const v=ir(i)?1:nS(i)?128:OS(i)?64:Ui(i)?4:Yt(i)?2:0;return $0(i,s,l,f,m,v,x,!0)}function $S(i){return i?o0(i)||qd in i?Er({},i):i:null}function Ua(i,s,l=!1){const{props:f,ref:m,patchFlag:x,children:v}=i,c=s?j0(f||{},s):f;return{__v_isVNode:!0,__v_skip:!0,type:i.type,props:c,key:c&&U0(c),ref:s&&s.ref?l&&m?Vt(m)?m.concat(dd(s)):[m,dd(s)]:dd(s):m,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:v,target:i.target,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:s&&i.type!==Yr?x===-1?16:x|16:x,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:i.transition,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&Ua(i.ssContent),ssFallback:i.ssFallback&&Ua(i.ssFallback),el:i.el,anchor:i.anchor,ctx:i.ctx,ce:i.ce}}function Np(i=" ",s=0){return ci(Vu,null,i,s)}function Mr(i="",s=!1){return s?(Tu(),Gd(Gn,null,i)):ci(Gn,null,i)}function Es(i){return i==null||typeof i=="boolean"?ci(Gn):Vt(i)?ci(Yr,null,i.slice()):typeof i=="object"?Da(i):ci(Vu,null,String(i))}function Da(i){return i.el===null&&i.patchFlag!==-1||i.memo?i:Ua(i)}function Rm(i,s){let l=0;const{shapeFlag:f}=i;if(s==null)s=null;else if(Vt(s))l=16;else if(typeof s=="object")if(f&65){const m=s.default;m&&(m._c&&(m._d=!1),Rm(i,m()),m._c&&(m._d=!0));return}else{l=32;const m=s._;!m&&!(qd in s)?s._ctx=Tr:m===3&&Tr&&(Tr.slots._===1?s._=1:(s._=2,i.patchFlag|=1024))}else Yt(s)?(s={default:s,_ctx:Tr},l=32):(s=String(s),f&64?(l=16,s=[Np(s)]):l=8);i.children=s,i.shapeFlag|=l}function j0(...i){const s={};for(let l=0;l<i.length;l++){const f=i[l];for(const m in f)if(m==="class")s.class!==f.class&&(s.class=Od([s.class,f.class]));else if(m==="style")s.style=Fu([s.style,f.style]);else if(Rd(m)){const x=s[m],v=f[m];v&&x!==v&&!(Vt(x)&&x.includes(v))&&(s[m]=x?[].concat(x,v):v)}else m!==""&&(s[m]=f[m])}return s}function ws(i,s,l,f=null){es(i,s,7,[l,f])}const jS=k0();let HS=0;function GS(i,s,l){const f=i.type,m=(s?s.appContext:i.appContext)||jS,x={uid:HS++,vnode:i,type:f,parent:s,appContext:m,root:null,next:null,subTree:null,effect:null,update:null,scope:new qv(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:s?s.provides:Object.create(m.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:R0(f,m),emitsOptions:_0(f,m),emit:null,emitted:null,propsDefaults:Wi,inheritAttrs:f.inheritAttrs,ctx:Wi,data:Wi,props:Wi,attrs:Wi,slots:Wi,refs:Wi,setupState:Wi,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:l,suspenseId:l?l.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return x.ctx={_:x},x.root=s?s.root:x,x.emit=Xw.bind(null,x),i.ce&&i.ce(x),x}let Ar=null;const Nr=()=>Ar||Tr;let Sd,Vp;{const i=jv(),s=(l,f)=>{let m;return(m=i[l])||(m=i[l]=[]),m.push(f),x=>{m.length>1?m.forEach(v=>v(x)):m[0](x)}};Sd=s("__VUE_INSTANCE_SETTERS__",l=>Ar=l),Vp=s("__VUE_SSR_SETTERS__",l=>$u=l)}const Uu=i=>{const s=Ar;return Sd(i),i.scope.on(),()=>{i.scope.off(),Sd(s)}},W_=()=>{Ar&&Ar.scope.off(),Sd(null)};function H0(i){return i.vnode.shapeFlag&4}let $u=!1;function qS(i,s=!1){s&&Vp(s);const{props:l,children:f}=i.vnode,m=H0(i);AS(i,l,m,s),MS(i,f);const x=m?WS(i,s):void 0;return s&&Vp(!1),x}function WS(i,s){const l=i.type;i.accessCache=Object.create(null),i.proxy=ql(new Proxy(i.ctx,_S));const{setup:f}=l;if(f){const m=i.setupContext=f.length>1?q0(i):null,x=Uu(i);zo();const v=Na(f,i,0,[i.props,m]);if(Oo(),x(),Vv(v)){if(v.then(W_,W_),s)return v.then(c=>{Z_(i,c,s)}).catch(c=>{Bu(c,i,0)});i.asyncDep=v}else Z_(i,v,s)}else G0(i,s)}function Z_(i,s,l){Yt(s)?i.type.__ssrInlineRender?i.ssrRender=s:i.render=s:Ui(s)&&(i.setupState=h0(s)),G0(i,l)}let K_;function G0(i,s,l){const f=i.type;if(!i.render){if(!s&&K_&&!f.render){const m=f.template||Mm(i).template;if(m){const{isCustomElement:x,compilerOptions:v}=i.appContext.config,{delimiters:c,compilerOptions:A}=f,R=Er(Er({isCustomElement:x,delimiters:c},v),A);f.render=K_(m,R)}}i.render=f.render||jn}{const m=Uu(i);zo();try{vS(i)}finally{Oo(),m()}}}function ZS(i){return i.attrsProxy||(i.attrsProxy=new Proxy(i.attrs,{get(s,l){return Dn(i,"get","$attrs"),s[l]}}))}function q0(i){const s=l=>{i.exposed=l||{}};return{get attrs(){return ZS(i)},slots:i.slots,emit:i.emit,expose:s}}function Wd(i){if(i.exposed)return i.exposeProxy||(i.exposeProxy=new Proxy(h0(ql(i.exposed)),{get(s,l){if(l in s)return s[l];if(l in fu)return fu[l](i)},has(s,l){return l in s||l in fu}}))}function KS(i,s=!0){return Yt(i)?i.displayName||i.name:i.name||s&&i.__name}function YS(i){return Yt(i)&&"__vccOpts"in i}const Rt=(i,s)=>Uw(i,s,$u);function Fr(i,s,l){const f=arguments.length;return f===2?Ui(s)&&!Vt(s)?Iu(s)?ci(i,null,[s]):ci(i,s):ci(i,null,s):(f>3?l=Array.prototype.slice.call(arguments,2):f===3&&Iu(l)&&(l=[l]),ci(i,s,l))}const XS="3.4.19",JS=jn;/**
* @vue/runtime-dom v3.4.19
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const QS="http://www.w3.org/2000/svg",e2="http://www.w3.org/1998/Math/MathML",za=typeof document<"u"?document:null,Y_=za&&za.createElement("template"),t2={insert:(i,s,l)=>{s.insertBefore(i,l||null)},remove:i=>{const s=i.parentNode;s&&s.removeChild(i)},createElement:(i,s,l,f)=>{const m=s==="svg"?za.createElementNS(QS,i):s==="mathml"?za.createElementNS(e2,i):za.createElement(i,l?{is:l}:void 0);return i==="select"&&f&&f.multiple!=null&&m.setAttribute("multiple",f.multiple),m},createText:i=>za.createTextNode(i),createComment:i=>za.createComment(i),setText:(i,s)=>{i.nodeValue=s},setElementText:(i,s)=>{i.textContent=s},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>za.querySelector(i),setScopeId(i,s){i.setAttribute(s,"")},insertStaticContent(i,s,l,f,m,x){const v=l?l.previousSibling:s.lastChild;if(m&&(m===x||m.nextSibling))for(;s.insertBefore(m.cloneNode(!0),l),!(m===x||!(m=m.nextSibling)););else{Y_.innerHTML=f==="svg"?`<svg>${i}</svg>`:f==="mathml"?`<math>${i}</math>`:i;const c=Y_.content;if(f==="svg"||f==="mathml"){const A=c.firstChild;for(;A.firstChild;)c.appendChild(A.firstChild);c.removeChild(A)}s.insertBefore(c,l)}return[v?v.nextSibling:s.firstChild,l?l.previousSibling:s.lastChild]}},Ia="transition",su="animation",Wl=Symbol("_vtc"),W0=(i,{slots:s})=>Fr(uS,K0(i),s);W0.displayName="Transition";const Z0={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},i2=W0.props=Er({},b0,Z0),Eo=(i,s=[])=>{Vt(i)?i.forEach(l=>l(...s)):i&&i(...s)},X_=i=>i?Vt(i)?i.some(s=>s.length>1):i.length>1:!1;function K0(i){const s={};for(const He in i)He in Z0||(s[He]=i[He]);if(i.css===!1)return s;const{name:l="v",type:f,duration:m,enterFromClass:x=`${l}-enter-from`,enterActiveClass:v=`${l}-enter-active`,enterToClass:c=`${l}-enter-to`,appearFromClass:A=x,appearActiveClass:R=v,appearToClass:z=c,leaveFromClass:B=`${l}-leave-from`,leaveActiveClass:M=`${l}-leave-active`,leaveToClass:re=`${l}-leave-to`}=i,se=r2(m),ue=se&&se[0],ae=se&&se[1],{onBeforeEnter:Z,onEnter:me,onEnterCancelled:Ce,onLeave:be,onLeaveCancelled:Re,onBeforeAppear:Ae=Z,onAppear:$e=me,onAppearCancelled:Se=Ce}=s,Ge=(He,bt,qt)=>{Ma(He,bt?z:c),Ma(He,bt?R:v),qt&&qt()},ot=(He,bt)=>{He._isLeaving=!1,Ma(He,B),Ma(He,re),Ma(He,M),bt&&bt()},_t=He=>(bt,qt)=>{const pi=He?$e:me,Lt=()=>Ge(bt,He,qt);Eo(pi,[bt,Lt]),J_(()=>{Ma(bt,He?A:x),Xs(bt,He?z:c),X_(pi)||Q_(bt,f,ue,Lt)})};return Er(s,{onBeforeEnter(He){Eo(Z,[He]),Xs(He,x),Xs(He,v)},onBeforeAppear(He){Eo(Ae,[He]),Xs(He,A),Xs(He,R)},onEnter:_t(!1),onAppear:_t(!0),onLeave(He,bt){He._isLeaving=!0;const qt=()=>ot(He,bt);Xs(He,B),X0(),Xs(He,M),J_(()=>{He._isLeaving&&(Ma(He,B),Xs(He,re),X_(be)||Q_(He,f,ae,qt))}),Eo(be,[He,qt])},onEnterCancelled(He){Ge(He,!1),Eo(Ce,[He])},onAppearCancelled(He){Ge(He,!0),Eo(Se,[He])},onLeaveCancelled(He){ot(He),Eo(Re,[He])}})}function r2(i){if(i==null)return null;if(Ui(i))return[gp(i.enter),gp(i.leave)];{const s=gp(i);return[s,s]}}function gp(i){return fw(i)}function Xs(i,s){s.split(/\s+/).forEach(l=>l&&i.classList.add(l)),(i[Wl]||(i[Wl]=new Set)).add(s)}function Ma(i,s){s.split(/\s+/).forEach(f=>f&&i.classList.remove(f));const l=i[Wl];l&&(l.delete(s),l.size||(i[Wl]=void 0))}function J_(i){requestAnimationFrame(()=>{requestAnimationFrame(i)})}let n2=0;function Q_(i,s,l,f){const m=i._endId=++n2,x=()=>{m===i._endId&&f()};if(l)return setTimeout(x,l);const{type:v,timeout:c,propCount:A}=Y0(i,s);if(!v)return f();const R=v+"end";let z=0;const B=()=>{i.removeEventListener(R,M),x()},M=re=>{re.target===i&&++z>=A&&B()};setTimeout(()=>{z<A&&B()},c+1),i.addEventListener(R,M)}function Y0(i,s){const l=window.getComputedStyle(i),f=se=>(l[se]||"").split(", "),m=f(`${Ia}Delay`),x=f(`${Ia}Duration`),v=ey(m,x),c=f(`${su}Delay`),A=f(`${su}Duration`),R=ey(c,A);let z=null,B=0,M=0;s===Ia?v>0&&(z=Ia,B=v,M=x.length):s===su?R>0&&(z=su,B=R,M=A.length):(B=Math.max(v,R),z=B>0?v>R?Ia:su:null,M=z?z===Ia?x.length:A.length:0);const re=z===Ia&&/\b(transform|all)(,|$)/.test(f(`${Ia}Property`).toString());return{type:z,timeout:B,propCount:M,hasTransform:re}}function ey(i,s){for(;i.length<s.length;)i=i.concat(i);return Math.max(...s.map((l,f)=>ty(l)+ty(i[f])))}function ty(i){return i==="auto"?0:Number(i.slice(0,-1).replace(",","."))*1e3}function X0(){return document.body.offsetHeight}function s2(i,s,l){const f=i[Wl];f&&(s=(s?[s,...f]:[...f]).join(" ")),s==null?i.removeAttribute("class"):l?i.setAttribute("class",s):i.className=s}const Au=Symbol("_vod"),lM={beforeMount(i,{value:s},{transition:l}){i[Au]=i.style.display==="none"?"":i.style.display,l&&s?l.beforeEnter(i):au(i,s)},mounted(i,{value:s},{transition:l}){l&&s&&l.enter(i)},updated(i,{value:s,oldValue:l},{transition:f}){!s==!l&&(i.style.display===i[Au]||!s)||(f?s?(f.beforeEnter(i),au(i,!0),f.enter(i)):f.leave(i,()=>{au(i,!1)}):au(i,s))},beforeUnmount(i,{value:s}){au(i,s)}};function au(i,s){i.style.display=s?i[Au]:"none"}const a2=Symbol(""),o2=/(^|;)\s*display\s*:/;function l2(i,s,l){const f=i.style,m=ir(l),x=f.display;let v=!1;if(l&&!m){if(s&&!ir(s))for(const c in s)l[c]==null&&Up(f,c,"");for(const c in l)c==="display"&&(v=!0),Up(f,c,l[c])}else if(m){if(s!==l){const c=f[a2];c&&(l+=";"+c),f.cssText=l,v=o2.test(l)}}else s&&i.removeAttribute("style");Au in i&&(i[Au]=v?f.display:"",f.display=x)}const iy=/\s*!important$/;function Up(i,s,l){if(Vt(l))l.forEach(f=>Up(i,s,f));else if(l==null&&(l=""),s.startsWith("--"))i.setProperty(s,l);else{const f=c2(i,s);iy.test(l)?i.setProperty(tc(f),l.replace(iy,""),"important"):i[f]=l}}const ry=["Webkit","Moz","ms"],_p={};function c2(i,s){const l=_p[s];if(l)return l;let f=Cs(s);if(f!=="filter"&&f in i)return _p[s]=f;f=Ou(f);for(let m=0;m<ry.length;m++){const x=ry[m]+f;if(x in i)return _p[s]=x}return s}const ny="http://www.w3.org/1999/xlink";function u2(i,s,l,f,m){if(f&&s.startsWith("xlink:"))l==null?i.removeAttributeNS(ny,s.slice(6,s.length)):i.setAttributeNS(ny,s,l);else{const x=vw(s);l==null||x&&!Hv(l)?i.removeAttribute(s):i.setAttribute(s,x?"":l)}}function h2(i,s,l,f,m,x,v){if(s==="innerHTML"||s==="textContent"){f&&v(f,m,x),i[s]=l??"";return}const c=i.tagName;if(s==="value"&&c!=="PROGRESS"&&!c.includes("-")){i._value=l;const R=c==="OPTION"?i.getAttribute("value"):i.value,z=l??"";R!==z&&(i.value=z),l==null&&i.removeAttribute(s);return}let A=!1;if(l===""||l==null){const R=typeof i[s];R==="boolean"?l=Hv(l):l==null&&R==="string"?(l="",A=!0):R==="number"&&(l=0,A=!0)}try{i[s]=l}catch{}A&&i.removeAttribute(s)}function d2(i,s,l,f){i.addEventListener(s,l,f)}function f2(i,s,l,f){i.removeEventListener(s,l,f)}const sy=Symbol("_vei");function p2(i,s,l,f,m=null){const x=i[sy]||(i[sy]={}),v=x[s];if(f&&v)v.value=f;else{const[c,A]=m2(s);if(f){const R=x[s]=y2(f,m);d2(i,c,R,A)}else v&&(f2(i,c,v,A),x[s]=void 0)}}const ay=/(?:Once|Passive|Capture)$/;function m2(i){let s;if(ay.test(i)){s={};let f;for(;f=i.match(ay);)i=i.slice(0,i.length-f[0].length),s[f[0].toLowerCase()]=!0}return[i[2]===":"?i.slice(3):tc(i.slice(2)),s]}let yp=0;const g2=Promise.resolve(),_2=()=>yp||(g2.then(()=>yp=0),yp=Date.now());function y2(i,s){const l=f=>{if(!f._vts)f._vts=Date.now();else if(f._vts<=l.attached)return;es(v2(f,l.value),s,5,[f])};return l.value=i,l.attached=_2(),l}function v2(i,s){if(Vt(s)){const l=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{l.call(i),i._stopped=!0},s.map(f=>m=>!m._stopped&&f&&f(m))}else return s}const oy=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)>96&&i.charCodeAt(2)<123,x2=(i,s,l,f,m,x,v,c,A)=>{const R=m==="svg";s==="class"?s2(i,f,R):s==="style"?l2(i,l,f):Rd(s)?fm(s)||p2(i,s,l,f,v):(s[0]==="."?(s=s.slice(1),!0):s[0]==="^"?(s=s.slice(1),!1):b2(i,s,f,R))?h2(i,s,f,x,v,c,A):(s==="true-value"?i._trueValue=f:s==="false-value"&&(i._falseValue=f),u2(i,s,f,R))};function b2(i,s,l,f){if(f)return!!(s==="innerHTML"||s==="textContent"||s in i&&oy(s)&&Yt(l));if(s==="spellcheck"||s==="draggable"||s==="translate"||s==="form"||s==="list"&&i.tagName==="INPUT"||s==="type"&&i.tagName==="TEXTAREA")return!1;if(s==="width"||s==="height"){const m=i.tagName;if(m==="IMG"||m==="VIDEO"||m==="CANVAS"||m==="SOURCE")return!1}return oy(s)&&ir(l)?!1:s in i}const J0=new WeakMap,Q0=new WeakMap,Td=Symbol("_moveCb"),ly=Symbol("_enterCb"),ex={name:"TransitionGroup",props:Er({},i2,{tag:String,moveClass:String}),setup(i,{slots:s}){const l=Nr(),f=x0();let m,x;return C0(()=>{if(!m.length)return;const v=i.moveClass||`${i.name||"v"}-move`;if(!I2(m[0].el,l.vnode.el,v))return;m.forEach(S2),m.forEach(T2);const c=m.filter(E2);X0(),c.forEach(A=>{const R=A.el,z=R.style;Xs(R,v),z.transform=z.webkitTransform=z.transitionDuration="";const B=R[Td]=M=>{M&&M.target!==R||(!M||/transform$/.test(M.propertyName))&&(R.removeEventListener("transitionend",B),R[Td]=null,Ma(R,v))};R.addEventListener("transitionend",B)})}),()=>{const v=hi(i),c=K0(v);let A=v.tag||Yr;m=x,x=s.default?Cm(s.default()):[];for(let R=0;R<x.length;R++){const z=x[R];z.key!=null&&Su(z,wu(z,c,f,l))}if(m)for(let R=0;R<m.length;R++){const z=m[R];Su(z,wu(z,c,f,l)),J0.set(z,z.el.getBoundingClientRect())}return ci(A,null,x)}}},w2=i=>delete i.mode;ex.props;const cM=ex;function S2(i){const s=i.el;s[Td]&&s[Td](),s[ly]&&s[ly]()}function T2(i){Q0.set(i,i.el.getBoundingClientRect())}function E2(i){const s=J0.get(i),l=Q0.get(i),f=s.left-l.left,m=s.top-l.top;if(f||m){const x=i.el.style;return x.transform=x.webkitTransform=`translate(${f}px,${m}px)`,x.transitionDuration="0s",i}}function I2(i,s,l){const f=i.cloneNode(),m=i[Wl];m&&m.forEach(c=>{c.split(/\s+/).forEach(A=>A&&f.classList.remove(A))}),l.split(/\s+/).forEach(c=>c&&f.classList.add(c)),f.style.display="none";const x=s.nodeType===1?s:s.parentNode;x.appendChild(f);const{hasTransform:v}=Y0(f);return x.removeChild(f),v}const A2=Er({patchProp:x2},t2);let cy;function tx(){return cy||(cy=LS(A2))}const uM=(...i)=>{tx().render(...i)},C2=(...i)=>{const s=tx().createApp(...i),{mount:l}=s;return s.mount=f=>{const m=M2(f);if(!m)return;const x=s._component;!Yt(x)&&!x.render&&!x.template&&(x.template=m.innerHTML),m.innerHTML="";const v=l(m,!1,P2(m));return m instanceof Element&&(m.removeAttribute("v-cloak"),m.setAttribute("data-v-app","")),v},s};function P2(i){if(i instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&i instanceof MathMLElement)return"mathml"}function M2(i){return ir(i)?document.querySelector(i):i}function k2(i,s){let l;function f(){l=Fd(),l.run(()=>s.length?s(()=>{l==null||l.stop(),f()}):s())}Mt(i,m=>{m&&!l?f():m||(l==null||l.stop(),l=void 0)},{immediate:!0}),Zv(()=>{l==null||l.stop()})}const Rn=typeof window<"u",hM=Rn&&"IntersectionObserver"in window,L2=Rn&&("ontouchstart"in window||window.navigator.maxTouchPoints>0);function uy(i,s,l){R2(i,s),s.set(i,l)}function R2(i,s){if(s.has(i))throw new TypeError("Cannot initialize the same private elements twice on an object")}function D2(i,s,l){var f=ix(i,s,"set");return z2(i,f,l),l}function z2(i,s,l){if(s.set)s.set.call(i,l);else{if(!s.writable)throw new TypeError("attempted to set read only private field");s.value=l}}function Io(i,s){var l=ix(i,s,"get");return O2(i,l)}function ix(i,s,l){if(!s.has(i))throw new TypeError("attempted to "+l+" private field on non-instance");return s.get(i)}function O2(i,s){return s.get?s.get.call(i):s.value}function rx(i,s,l){const f=s.length-1;if(f<0)return i===void 0?l:i;for(let m=0;m<f;m++){if(i==null)return l;i=i[s[m]]}return i==null||i[s[f]]===void 0?l:i[s[f]]}function F2(i,s){if(i===s)return!0;if(i instanceof Date&&s instanceof Date&&i.getTime()!==s.getTime()||i!==Object(i)||s!==Object(s))return!1;const l=Object.keys(i);return l.length!==Object.keys(s).length?!1:l.every(f=>F2(i[f],s[f]))}function $p(i,s,l){return i==null||!s||typeof s!="string"?l:i[s]!==void 0?i[s]:(s=s.replace(/\[(\w+)\]/g,".$1"),s=s.replace(/^\./,""),rx(i,s.split("."),l))}function dM(i,s,l){if(s===!0)return i===void 0?l:i;if(s==null||typeof s=="boolean")return l;if(i!==Object(i)){if(typeof s!="function")return l;const m=s(i,l);return typeof m>"u"?l:m}if(typeof s=="string")return $p(i,s,l);if(Array.isArray(s))return rx(i,s,l);if(typeof s!="function")return l;const f=s(i,l);return typeof f>"u"?l:f}function nx(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:i},(l,f)=>s+f)}function nd(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(!(i==null||i===""))return isNaN(+i)?String(i):isFinite(+i)?`${Number(i)}${s}`:void 0}function hy(i){return i!==null&&typeof i=="object"&&!Array.isArray(i)}function dy(i){if(i&&"$el"in i){const s=i.$el;return(s==null?void 0:s.nodeType)===Node.TEXT_NODE?s.nextElementSibling:s}return i}const fM=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16});function vp(i,s){return s.every(l=>i.hasOwnProperty(l))}function B2(i,s){const l={},f=new Set(Object.keys(i));for(const m of s)f.has(m)&&(l[m]=i[m]);return l}function fy(i,s,l){const f=Object.create(null),m=Object.create(null);for(const x in i)s.some(v=>v instanceof RegExp?v.test(x):v===x)&&!(l!=null&&l.some(v=>v===x))?f[x]=i[x]:m[x]=i[x];return[f,m]}function N2(i,s){const l={...i};return s.forEach(f=>delete l[f]),l}const sx=/^on[^a-z]/,pM=i=>sx.test(i),V2=["onAfterscriptexecute","onAnimationcancel","onAnimationend","onAnimationiteration","onAnimationstart","onAuxclick","onBeforeinput","onBeforescriptexecute","onChange","onClick","onCompositionend","onCompositionstart","onCompositionupdate","onContextmenu","onCopy","onCut","onDblclick","onFocusin","onFocusout","onFullscreenchange","onFullscreenerror","onGesturechange","onGestureend","onGesturestart","onGotpointercapture","onInput","onKeydown","onKeypress","onKeyup","onLostpointercapture","onMousedown","onMousemove","onMouseout","onMouseover","onMouseup","onMousewheel","onPaste","onPointercancel","onPointerdown","onPointerenter","onPointerleave","onPointermove","onPointerout","onPointerover","onPointerup","onReset","onSelect","onSubmit","onTouchcancel","onTouchend","onTouchmove","onTouchstart","onTransitioncancel","onTransitionend","onTransitionrun","onTransitionstart","onWheel"];function mM(i){const[s,l]=fy(i,[sx]),f=N2(s,V2),[m,x]=fy(l,["class","style","id",/^data-/]);return Object.assign(m,s),Object.assign(x,f),[m,x]}function gM(i){return i==null?[]:Array.isArray(i)?i:[i]}function _M(i,s){let l=0;const f=function(){for(var m=arguments.length,x=new Array(m),v=0;v<m;v++)x[v]=arguments[v];clearTimeout(l),l=setTimeout(()=>i(...x),Sr(s))};return f.clear=()=>{clearTimeout(l)},f.immediate=i,f}function U2(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(s,Math.min(l,i))}function py(i,s){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return i+l.repeat(Math.max(0,s-i.length))}function my(i,s){return(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0").repeat(Math.max(0,s-i.length))+i}function $2(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const l=[];let f=0;for(;f<i.length;)l.push(i.substr(f,s)),f+=s;return l}function Hn(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0;const f={};for(const m in i)f[m]=i[m];for(const m in s){const x=i[m],v=s[m];if(hy(x)&&hy(v)){f[m]=Hn(x,v,l);continue}if(Array.isArray(x)&&Array.isArray(v)&&l){f[m]=l(x,v);continue}f[m]=v}return f}function j2(i){return i.map(s=>s.type===Yr?j2(s.children):s).flat()}function Do(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(Do.cache.has(i))return Do.cache.get(i);const s=i.replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase();return Do.cache.set(i,s),s}Do.cache=new Map;function fd(i,s){if(!s||typeof s!="object")return[];if(Array.isArray(s))return s.map(l=>fd(i,l)).flat(1);if(Array.isArray(s.children))return s.children.map(l=>fd(i,l)).flat(1);if(s.component){if(Object.getOwnPropertySymbols(s.component.provides).includes(i))return[s.component];if(s.component.subTree)return fd(i,s.component.subTree).flat(1)}return[]}var sd=new WeakMap,Dl=new WeakMap;class yM{constructor(s){uy(this,sd,{writable:!0,value:[]}),uy(this,Dl,{writable:!0,value:0}),this.size=s}push(s){Io(this,sd)[Io(this,Dl)]=s,D2(this,Dl,(Io(this,Dl)+1)%this.size)}values(){return Io(this,sd).slice(Io(this,Dl)).concat(Io(this,sd).slice(0,Io(this,Dl)))}}function vM(i){const s=Xr({}),l=Rt(i);return jd(()=>{for(const f in l.value)s[f]=l.value[f]},{flush:"sync"}),Sm(s)}function xM(i,s){return i.includes(s)}function bM(i){return i[2].toLowerCase()+i.slice(3)}const wM=()=>[Function,Array];function SM(i,s){return s="on"+Ou(s),!!(i[s]||i[`${s}Once`]||i[`${s}Capture`]||i[`${s}OnceCapture`]||i[`${s}CaptureOnce`])}function TM(i){for(var s=arguments.length,l=new Array(s>1?s-1:0),f=1;f<s;f++)l[f-1]=arguments[f];if(Array.isArray(i))for(const m of i)m(...l);else typeof i=="function"&&i(...l)}function H2(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const l=["button","[href]",'input:not([type="hidden"])',"select","textarea","[tabindex]"].map(f=>`${f}${s?':not([tabindex="-1"])':""}:not([disabled])`).join(", ");return[...i.querySelectorAll(l)]}function G2(i,s,l){let f,m=i.indexOf(document.activeElement);const x=s==="next"?1:-1;do m+=x,f=i[m];while((!f||f.offsetParent==null||!((l==null?void 0:l(f))??!0))&&m<i.length&&m>=0);return f}function q2(i,s){var f,m,x,v;const l=H2(i);if(!s)(i===document.activeElement||!i.contains(document.activeElement))&&((f=l[0])==null||f.focus());else if(s==="first")(m=l[0])==null||m.focus();else if(s==="last")(x=l.at(-1))==null||x.focus();else if(typeof s=="number")(v=l[s])==null||v.focus();else{const c=G2(l,s);c?c.focus():q2(i,s==="next"?"first":"last")}}function EM(){}function IM(i,s){if(!(Rn&&typeof CSS<"u"&&typeof CSS.supports<"u"&&CSS.supports(`selector(${s})`)))return null;try{return!!i&&i.matches(s)}catch{return null}}function W2(i){return i.some(s=>Iu(s)?s.type===Gn?!1:s.type!==Yr||W2(s.children):!0)?i:null}function AM(i,s){if(!Rn||i===0)return s(),()=>{};const l=window.setTimeout(s,i);return()=>window.clearTimeout(l)}const zl=2.4,gy=.2126729,_y=.7151522,yy=.072175,Z2=.55,K2=.58,Y2=.57,X2=.62,ad=.03,vy=1.45,J2=5e-4,Q2=1.25,eT=1.25,xy=.078,by=12.82051282051282,od=.06,wy=.001;function Sy(i,s){const l=(i.r/255)**zl,f=(i.g/255)**zl,m=(i.b/255)**zl,x=(s.r/255)**zl,v=(s.g/255)**zl,c=(s.b/255)**zl;let A=l*gy+f*_y+m*yy,R=x*gy+v*_y+c*yy;if(A<=ad&&(A+=(ad-A)**vy),R<=ad&&(R+=(ad-R)**vy),Math.abs(R-A)<J2)return 0;let z;if(R>A){const B=(R**Z2-A**K2)*Q2;z=B<wy?0:B<xy?B-B*by*od:B-od}else{const B=(R**X2-A**Y2)*eT;z=B>-wy?0:B>-xy?B-B*by*od:B+od}return z*100}function CM(i,s){s=Array.isArray(s)?s.slice(0,-1).map(l=>`'${l}'`).join(", ")+` or '${s.at(-1)}'`:`'${s}'`}const Ed=.20689655172413793,tT=i=>i>Ed**3?Math.cbrt(i):i/(3*Ed**2)+4/29,iT=i=>i>Ed?i**3:3*Ed**2*(i-4/29);function ax(i){const s=tT,l=s(i[1]);return[116*l-16,500*(s(i[0]/.95047)-l),200*(l-s(i[2]/1.08883))]}function ox(i){const s=iT,l=(i[0]+16)/116;return[s(l+i[1]/500)*.95047,s(l),s(l-i[2]/200)*1.08883]}const rT=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],nT=i=>i<=.0031308?i*12.92:1.055*i**(1/2.4)-.055,sT=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],aT=i=>i<=.04045?i/12.92:((i+.055)/1.055)**2.4;function lx(i){const s=Array(3),l=nT,f=rT;for(let m=0;m<3;++m)s[m]=Math.round(U2(l(f[m][0]*i[0]+f[m][1]*i[1]+f[m][2]*i[2]))*255);return{r:s[0],g:s[1],b:s[2]}}function Dm(i){let{r:s,g:l,b:f}=i;const m=[0,0,0],x=aT,v=sT;s=x(s/255),l=x(l/255),f=x(f/255);for(let c=0;c<3;++c)m[c]=v[c][0]*s+v[c][1]*l+v[c][2]*f;return m}function oT(i){return!!i&&/^(#|var\(--|(rgb|hsl)a?\()/.test(i)}function PM(i){return oT(i)&&!/^((rgb|hsl)a?\()?var\(--/.test(i)}const Ty=/^(?<fn>(?:rgb|hsl)a?)\((?<values>.+)\)/,lT={rgb:(i,s,l,f)=>({r:i,g:s,b:l,a:f}),rgba:(i,s,l,f)=>({r:i,g:s,b:l,a:f}),hsl:(i,s,l,f)=>Ey({h:i,s,l,a:f}),hsla:(i,s,l,f)=>Ey({h:i,s,l,a:f}),hsv:(i,s,l,f)=>Cu({h:i,s,v:l,a:f}),hsva:(i,s,l,f)=>Cu({h:i,s,v:l,a:f})};function Qs(i){if(typeof i=="number")return{r:(i&16711680)>>16,g:(i&65280)>>8,b:i&255};if(typeof i=="string"&&Ty.test(i)){const{groups:s}=i.match(Ty),{fn:l,values:f}=s,m=f.split(/,\s*/).map(x=>x.endsWith("%")&&["hsl","hsla","hsv","hsva"].includes(l)?parseFloat(x)/100:parseFloat(x));return lT[l](...m)}else if(typeof i=="string"){let s=i.startsWith("#")?i.slice(1):i;return[3,4].includes(s.length)?s=s.split("").map(l=>l+l).join(""):[6,8].includes(s.length),uT(s)}else if(typeof i=="object"){if(vp(i,["r","g","b"]))return i;if(vp(i,["h","s","l"]))return Cu(cx(i));if(vp(i,["h","s","v"]))return Cu(i)}throw new TypeError(`Invalid color: ${i==null?i:String(i)||i.constructor.name}
Expected #hex, #hexa, rgb(), rgba(), hsl(), hsla(), object or number`)}function Cu(i){const{h:s,s:l,v:f,a:m}=i,x=c=>{const A=(c+s/60)%6;return f-f*l*Math.max(Math.min(A,4-A,1),0)},v=[x(5),x(3),x(1)].map(c=>Math.round(c*255));return{r:v[0],g:v[1],b:v[2],a:m}}function Ey(i){return Cu(cx(i))}function cx(i){const{h:s,s:l,l:f,a:m}=i,x=f+l*Math.min(f,1-f),v=x===0?0:2-2*f/x;return{h:s,s:v,v:x,a:m}}function ld(i){const s=Math.round(i).toString(16);return("00".substr(0,2-s.length)+s).toUpperCase()}function cT(i){let{r:s,g:l,b:f,a:m}=i;return`#${[ld(s),ld(l),ld(f),m!==void 0?ld(Math.round(m*255)):""].join("")}`}function uT(i){i=hT(i);let[s,l,f,m]=$2(i,2).map(x=>parseInt(x,16));return m=m===void 0?m:m/255,{r:s,g:l,b:f,a:m}}function hT(i){return i.startsWith("#")&&(i=i.slice(1)),i=i.replace(/([^0-9a-f])/gi,"F"),(i.length===3||i.length===4)&&(i=i.split("").map(s=>s+s).join("")),i.length!==6&&(i=py(py(i,6),8,"F")),i}function dT(i,s){const l=ax(Dm(i));return l[0]=l[0]+s*10,lx(ox(l))}function fT(i,s){const l=ax(Dm(i));return l[0]=l[0]-s*10,lx(ox(l))}function pT(i){const s=Qs(i);return Dm(s)[1]}function mT(i){const s=Math.abs(Sy(Qs(0),Qs(i)));return Math.abs(Sy(Qs(16777215),Qs(i)))>Math.min(s,50)?"#fff":"#000"}function Ps(i,s){return l=>Object.keys(i).reduce((f,m)=>{const v=typeof i[m]=="object"&&i[m]!=null&&!Array.isArray(i[m])?i[m]:{type:i[m]};return l&&m in l?f[m]={...v,default:l[m]}:f[m]=v,s&&!f[m].source&&(f[m].source=s),f},{})}const ux=Ps({class:[String,Array],style:{type:[String,Array,Object],default:null}},"component"),Zl=Symbol.for("vuetify:defaults");function gT(i){return yi(i)}function zm(){const i=et(Zl);if(!i)throw new Error("[Vuetify] Could not find defaults instance");return i}function MM(i,s){const l=zm(),f=yi(i),m=Rt(()=>{if(Sr(s==null?void 0:s.disabled))return l.value;const v=Sr(s==null?void 0:s.scoped),c=Sr(s==null?void 0:s.reset),A=Sr(s==null?void 0:s.root);if(f.value==null&&!(v||c||A))return l.value;let R=Hn(f.value,{prev:l.value});if(v)return R;if(c||A){const z=Number(c||1/0);for(let B=0;B<=z&&!(!R||!("prev"in R));B++)R=R.prev;return R&&typeof A=="string"&&A in R&&(R=Hn(Hn(R,{prev:R}),R[A])),R}return R.prev?Hn(R.prev,R):R});return Ai(Zl,m),m}function _T(i,s){var l,f;return typeof((l=i.props)==null?void 0:l[s])<"u"||typeof((f=i.props)==null?void 0:f[Do(s)])<"u"}function yT(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:zm();const f=Ms("useDefaults");if(s=s??f.type.name??f.type.__name,!s)throw new Error("[Vuetify] Could not determine component name");const m=Rt(()=>{var A;return(A=l.value)==null?void 0:A[i._as??s]}),x=new Proxy(i,{get(A,R){var B,M,re,se;const z=Reflect.get(A,R);return R==="class"||R==="style"?[(B=m.value)==null?void 0:B[R],z].filter(ue=>ue!=null):typeof R=="string"&&!_T(f.vnode,R)?((M=m.value)==null?void 0:M[R])??((se=(re=l.value)==null?void 0:re.global)==null?void 0:se[R])??z:z}}),v=En();jd(()=>{if(m.value){const A=Object.entries(m.value).filter(R=>{let[z]=R;return z.startsWith(z[0].toUpperCase())});v.value=A.length?Object.fromEntries(A):void 0}else v.value=void 0});function c(){const A=xT(Zl,f);Ai(Zl,Rt(()=>v.value?Hn((A==null?void 0:A.value)??{},v.value):A==null?void 0:A.value))}return{props:x,provideSubDefaults:c}}function ju(i){if(i._setup=i._setup??i.setup,!i.name)return i;if(i._setup){i.props=Ps(i.props??{},i.name)();const s=Object.keys(i.props).filter(l=>l!=="class"&&l!=="style");i.filterProps=function(f){return B2(f,s)},i.props._as=String,i.setup=function(f,m){const x=zm();if(!x.value)return i._setup(f,m);const{props:v,provideSubDefaults:c}=yT(f,f._as??i.name,x),A=i._setup(v,m);return c(),A}}return i}function Om(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return s=>(i?ju:di)(s)}function Ms(i,s){const l=Nr();if(!l)throw new Error(`[Vuetify] ${i} ${s||"must be called from inside a setup function"}`);return l}function vT(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const s=Ms(i).type;return Do((s==null?void 0:s.aliasName)||(s==null?void 0:s.name))}let hx=0,pd=new WeakMap;function Fm(){const i=Ms("getUid");if(pd.has(i))return pd.get(i);{const s=hx++;return pd.set(i,s),s}}Fm.reset=()=>{hx=0,pd=new WeakMap};function xT(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ms("injectSelf");const{provides:l}=s;if(l&&i in l)return l[i]}function dx(i){const s=Ms("useRender");s.render=i}function bT(i,s,l){let f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:B=>B,m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:B=>B;const x=Ms("useProxiedModel"),v=yi(i[s]!==void 0?i[s]:l),c=Do(s),R=Rt(c!==s?()=>{var B,M,re,se;return i[s],!!(((B=x.vnode.props)!=null&&B.hasOwnProperty(s)||(M=x.vnode.props)!=null&&M.hasOwnProperty(c))&&((re=x.vnode.props)!=null&&re.hasOwnProperty(`onUpdate:${s}`)||(se=x.vnode.props)!=null&&se.hasOwnProperty(`onUpdate:${c}`)))}:()=>{var B,M;return i[s],!!((B=x.vnode.props)!=null&&B.hasOwnProperty(s)&&((M=x.vnode.props)!=null&&M.hasOwnProperty(`onUpdate:${s}`)))});k2(()=>!R.value,()=>{Mt(()=>i[s],B=>{v.value=B})});const z=Rt({get(){const B=i[s];return f(R.value?B:v.value)},set(B){const M=m(B),re=hi(R.value?i[s]:v.value);re===M||f(re)===B||(v.value=M,x==null||x.emit(`update:${s}`,M))}});return Object.defineProperty(z,"externalValue",{get:()=>R.value?i[s]:v.value}),z}const wT={badge:"Badge",open:"Open",close:"Close",confirmEdit:{ok:"OK",cancel:"Cancel"},dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},dateRangeInput:{divider:"to"},datePicker:{itemsSelected:"{0} selected",range:{title:"Select dates",header:"Enter dates"},title:"Select date",header:"Enter date",input:{placeholder:"Enter date"}},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more",today:"Today"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action",otp:"Please enter OTP character {0}"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Go to page {0}",currentPage:"Page {0}, Current page",first:"First page",last:"Last page"}},stepper:{next:"Next",prev:"Previous"},rating:{ariaLabel:{item:"Rating {0} of {1}"}},loading:"Loading...",infiniteScroll:{loadMore:"Load more",empty:"No more"}},Iy="$vuetify.",Ay=(i,s)=>i.replace(/\{(\d+)\}/g,(l,f)=>String(s[+f])),fx=(i,s,l)=>function(f){for(var m=arguments.length,x=new Array(m>1?m-1:0),v=1;v<m;v++)x[v-1]=arguments[v];if(!f.startsWith(Iy))return Ay(f,x);const c=f.replace(Iy,""),A=i.value&&l.value[i.value],R=s.value&&l.value[s.value];let z=$p(A,c,null);return z||(`${f}${i.value}`,z=$p(R,c,null)),z||(z=f),typeof z!="string"&&(z=f),Ay(z,x)};function px(i,s){return(l,f)=>new Intl.NumberFormat([i.value,s.value],f).format(l)}function xp(i,s,l){const f=bT(i,s,i[s]??l.value);return f.value=i[s]??l.value,Mt(l,m=>{i[s]==null&&(f.value=l.value)}),f}function mx(i){return s=>{const l=xp(s,"locale",i.current),f=xp(s,"fallback",i.fallback),m=xp(s,"messages",i.messages);return{name:"vuetify",current:l,fallback:f,messages:m,t:fx(l,f,m),n:px(l,f),provide:mx({current:l,fallback:f,messages:m})}}}function ST(i){const s=En((i==null?void 0:i.locale)??"en"),l=En((i==null?void 0:i.fallback)??"en"),f=yi({en:wT,...i==null?void 0:i.messages});return{name:"vuetify",current:s,fallback:l,messages:f,t:fx(s,l,f),n:px(s,l),provide:mx({current:s,fallback:l,messages:f})}}const Id=Symbol.for("vuetify:locale");function TT(i){return i.name!=null}function ET(i){const s=i!=null&&i.adapter&&TT(i==null?void 0:i.adapter)?i==null?void 0:i.adapter:ST(i),l=AT(s,i);return{...s,...l}}function kM(){const i=et(Id);if(!i)throw new Error("[Vuetify] Could not find injected locale instance");return i}function IT(){return{af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!0,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,km:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1}}function AT(i,s){const l=yi((s==null?void 0:s.rtl)??IT()),f=Rt(()=>l.value[i.current.value]??!1);return{isRtl:f,rtl:l,rtlClasses:Rt(()=>`v-locale--is-${f.value?"rtl":"ltr"}`)}}function LM(){const i=et(Id);if(!i)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:i.isRtl,rtlClasses:i.rtlClasses}}const jp={"001":1,AD:1,AE:6,AF:6,AG:0,AI:1,AL:1,AM:1,AN:1,AR:1,AS:0,AT:1,AU:1,AX:1,AZ:1,BA:1,BD:0,BE:1,BG:1,BH:6,BM:1,BN:1,BR:0,BS:0,BT:0,BW:0,BY:1,BZ:0,CA:0,CH:1,CL:1,CM:1,CN:1,CO:0,CR:1,CY:1,CZ:1,DE:1,DJ:6,DK:1,DM:0,DO:0,DZ:6,EC:1,EE:1,EG:6,ES:1,ET:0,FI:1,FJ:1,FO:1,FR:1,GB:1,"GB-alt-variant":0,GE:1,GF:1,GP:1,GR:1,GT:0,GU:0,HK:0,HN:0,HR:1,HU:1,ID:0,IE:1,IL:0,IN:0,IQ:6,IR:6,IS:1,IT:1,JM:0,JO:6,JP:0,KE:0,KG:1,KH:0,KR:0,KW:6,KZ:1,LA:0,LB:1,LI:1,LK:1,LT:1,LU:1,LV:1,LY:6,MC:1,MD:1,ME:1,MH:0,MK:1,MM:0,MN:1,MO:0,MQ:1,MT:0,MV:5,MX:0,MY:1,MZ:0,NI:0,NL:1,NO:1,NP:0,NZ:1,OM:6,PA:0,PE:0,PH:0,PK:0,PL:1,PR:0,PT:0,PY:0,QA:6,RE:1,RO:1,RS:1,RU:1,SA:0,SD:6,SE:1,SG:0,SI:1,SK:1,SM:1,SV:0,SY:6,TH:0,TJ:1,TM:1,TR:1,TT:0,TW:0,UA:1,UM:0,US:0,UY:1,UZ:1,VA:1,VE:0,VI:0,VN:1,WS:0,XK:1,YE:0,ZA:0,ZW:0};function CT(i,s){const l=[];let f=[];const m=gx(i),x=_x(i),v=(m.getDay()-jp[s.slice(-2).toUpperCase()]+7)%7,c=(x.getDay()-jp[s.slice(-2).toUpperCase()]+7)%7;for(let A=0;A<v;A++){const R=new Date(m);R.setDate(R.getDate()-(v-A)),f.push(R)}for(let A=1;A<=x.getDate();A++){const R=new Date(i.getFullYear(),i.getMonth(),A);f.push(R),f.length===7&&(l.push(f),f=[])}for(let A=1;A<7-c;A++){const R=new Date(x);R.setDate(R.getDate()+A),f.push(R)}return f.length>0&&l.push(f),l}function PT(i){const s=new Date(i);for(;s.getDay()!==0;)s.setDate(s.getDate()-1);return s}function MT(i){const s=new Date(i);for(;s.getDay()!==6;)s.setDate(s.getDate()+1);return s}function gx(i){return new Date(i.getFullYear(),i.getMonth(),1)}function _x(i){return new Date(i.getFullYear(),i.getMonth()+1,0)}function kT(i){const s=i.split("-").map(Number);return new Date(s[0],s[1]-1,s[2])}const LT=/^([12]\d{3}-([1-9]|0[1-9]|1[0-2])-([1-9]|0[1-9]|[12]\d|3[01]))$/;function yx(i){if(i==null)return new Date;if(i instanceof Date)return i;if(typeof i=="string"){let s;if(LT.test(i))return kT(i);if(s=Date.parse(i),!isNaN(s))return new Date(s)}return null}const Cy=new Date(2e3,0,2);function RT(i){const s=jp[i.slice(-2).toUpperCase()];return nx(7).map(l=>{const f=new Date(Cy);return f.setDate(Cy.getDate()+s+l),new Intl.DateTimeFormat(i,{weekday:"narrow"}).format(f)})}function DT(i,s,l,f){const m=yx(i)??new Date,x=f==null?void 0:f[s];if(typeof x=="function")return x(m,s,l);let v={};switch(s){case"fullDateWithWeekday":v={weekday:"long",day:"numeric",month:"long",year:"numeric"};break;case"hours12h":v={hour:"numeric",hour12:!0};break;case"normalDateWithWeekday":v={weekday:"short",day:"numeric",month:"short"};break;case"keyboardDate":v={day:"2-digit",month:"2-digit",year:"numeric"};break;case"monthAndDate":v={month:"long",day:"numeric"};break;case"monthAndYear":v={month:"long",year:"numeric"};break;case"month":v={month:"long"};break;case"monthShort":v={month:"short"};break;case"dayOfMonth":return new Intl.NumberFormat(l).format(m.getDate());case"shortDate":v={year:"2-digit",month:"numeric",day:"numeric"};break;case"weekdayShort":v={weekday:"short"};break;case"year":v={year:"numeric"};break;default:v=x??{timeZone:"UTC",timeZoneName:"short"}}return new Intl.DateTimeFormat(l,v).format(m)}function zT(i,s){const l=i.toJsDate(s),f=l.getFullYear(),m=my(String(l.getMonth()+1),2,"0"),x=my(String(l.getDate()),2,"0");return`${f}-${m}-${x}`}function OT(i){const[s,l,f]=i.split("-").map(Number);return new Date(s,l-1,f)}function FT(i,s){const l=new Date(i);return l.setMinutes(l.getMinutes()+s),l}function BT(i,s){const l=new Date(i);return l.setHours(l.getHours()+s),l}function NT(i,s){const l=new Date(i);return l.setDate(l.getDate()+s),l}function VT(i,s){const l=new Date(i);return l.setDate(l.getDate()+s*7),l}function UT(i,s){const l=new Date(i);return l.setMonth(l.getMonth()+s),l}function $T(i){return i.getFullYear()}function jT(i){return i.getMonth()}function HT(i){return new Date(i.getFullYear(),i.getMonth()+1,1)}function GT(i){return i.getHours()}function qT(i){return i.getMinutes()}function WT(i){return new Date(i.getFullYear(),0,1)}function ZT(i){return new Date(i.getFullYear(),11,31)}function KT(i,s){return Hp(i,s[0])&&XT(i,s[1])}function YT(i){const s=new Date(i);return s instanceof Date&&!isNaN(s.getTime())}function Hp(i,s){return i.getTime()>s.getTime()}function XT(i,s){return i.getTime()<s.getTime()}function Py(i,s){return i.getTime()===s.getTime()}function JT(i,s){return i.getDate()===s.getDate()&&i.getMonth()===s.getMonth()&&i.getFullYear()===s.getFullYear()}function QT(i,s){return i.getMonth()===s.getMonth()&&i.getFullYear()===s.getFullYear()}function eE(i,s,l){const f=new Date(i),m=new Date(s);return l==="month"?f.getMonth()-m.getMonth()+(f.getFullYear()-m.getFullYear())*12:Math.floor((f.getTime()-m.getTime())/(1e3*60*60*24))}function tE(i,s){const l=new Date(i);return l.setHours(s),l}function iE(i,s){const l=new Date(i);return l.setMinutes(s),l}function rE(i,s){const l=new Date(i);return l.setMonth(s),l}function nE(i,s){const l=new Date(i);return l.setFullYear(s),l}function sE(i){return new Date(i.getFullYear(),i.getMonth(),i.getDate())}function aE(i){return new Date(i.getFullYear(),i.getMonth(),i.getDate(),23,59,59,999)}class oE{constructor(s){this.locale=s.locale,this.formats=s.formats}date(s){return yx(s)}toJsDate(s){return s}toISO(s){return zT(this,s)}parseISO(s){return OT(s)}addMinutes(s,l){return FT(s,l)}addHours(s,l){return BT(s,l)}addDays(s,l){return NT(s,l)}addWeeks(s,l){return VT(s,l)}addMonths(s,l){return UT(s,l)}getWeekArray(s){return CT(s,this.locale)}startOfWeek(s){return PT(s)}endOfWeek(s){return MT(s)}startOfMonth(s){return gx(s)}endOfMonth(s){return _x(s)}format(s,l){return DT(s,l,this.locale,this.formats)}isEqual(s,l){return Py(s,l)}isValid(s){return YT(s)}isWithinRange(s,l){return KT(s,l)}isAfter(s,l){return Hp(s,l)}isBefore(s,l){return!Hp(s,l)&&!Py(s,l)}isSameDay(s,l){return JT(s,l)}isSameMonth(s,l){return QT(s,l)}setMinutes(s,l){return iE(s,l)}setHours(s,l){return tE(s,l)}setMonth(s,l){return rE(s,l)}setYear(s,l){return nE(s,l)}getDiff(s,l,f){return eE(s,l,f)}getWeekdays(){return RT(this.locale)}getYear(s){return $T(s)}getMonth(s){return jT(s)}getNextMonth(s){return HT(s)}getHours(s){return GT(s)}getMinutes(s){return qT(s)}startOfDay(s){return sE(s)}endOfDay(s){return aE(s)}startOfYear(s){return WT(s)}endOfYear(s){return ZT(s)}}const lE=Symbol.for("vuetify:date-options"),My=Symbol.for("vuetify:date-adapter");function cE(i,s){const l=Hn({adapter:oE,locale:{af:"af-ZA",bg:"bg-BG",ca:"ca-ES",ckb:"",cs:"cs-CZ",de:"de-DE",el:"el-GR",en:"en-US",et:"et-EE",fa:"fa-IR",fi:"fi-FI",hr:"hr-HR",hu:"hu-HU",he:"he-IL",id:"id-ID",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lv:"lv-LV",lt:"lt-LT",nl:"nl-NL",no:"no-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",srCyrl:"sr-SP",srLatn:"sr-SP",sv:"sv-SE",th:"th-TH",tr:"tr-TR",az:"az-AZ",uk:"uk-UA",vi:"vi-VN",zhHans:"zh-CN",zhHant:"zh-TW"}},i);return{options:l,instance:uE(l,s)}}function uE(i,s){const l=Xr(typeof i.adapter=="function"?new i.adapter({locale:i.locale[s.current.value]??s.current.value,formats:i.formats}):i.adapter);return Mt(s.current,f=>{l.locale=i.locale[f]??f??l.locale}),l}const Gp=Symbol.for("vuetify:display"),ky={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},hE=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ky;return Hn(ky,i)};function Ly(i){return Rn&&!i?window.innerWidth:typeof i=="object"&&i.clientWidth||0}function Ry(i){return Rn&&!i?window.innerHeight:typeof i=="object"&&i.clientHeight||0}function Dy(i){const s=Rn&&!i?window.navigator.userAgent:"ssr";function l(se){return!!s.match(se)}const f=l(/android/i),m=l(/iphone|ipad|ipod/i),x=l(/cordova/i),v=l(/electron/i),c=l(/chrome/i),A=l(/edge/i),R=l(/firefox/i),z=l(/opera/i),B=l(/win/i),M=l(/mac/i),re=l(/linux/i);return{android:f,ios:m,cordova:x,electron:v,chrome:c,edge:A,firefox:R,opera:z,win:B,mac:M,linux:re,touch:L2,ssr:s==="ssr"}}function dE(i,s){const{thresholds:l,mobileBreakpoint:f}=hE(i),m=En(Ry(s)),x=En(Dy(s)),v=Xr({}),c=En(Ly(s));function A(){m.value=Ry(),c.value=Ly()}function R(){A(),x.value=Dy()}return jd(()=>{const z=c.value<l.sm,B=c.value<l.md&&!z,M=c.value<l.lg&&!(B||z),re=c.value<l.xl&&!(M||B||z),se=c.value<l.xxl&&!(re||M||B||z),ue=c.value>=l.xxl,ae=z?"xs":B?"sm":M?"md":re?"lg":se?"xl":"xxl",Z=typeof f=="number"?f:l[f],me=c.value<Z;v.xs=z,v.sm=B,v.md=M,v.lg=re,v.xl=se,v.xxl=ue,v.smAndUp=!z,v.mdAndUp=!(z||B),v.lgAndUp=!(z||B||M),v.xlAndUp=!(z||B||M||re),v.smAndDown=!(M||re||se||ue),v.mdAndDown=!(re||se||ue),v.lgAndDown=!(se||ue),v.xlAndDown=!ue,v.name=ae,v.height=m.value,v.width=c.value,v.mobile=me,v.mobileBreakpoint=f,v.platform=x.value,v.thresholds=l}),Rn&&window.addEventListener("resize",A,{passive:!0}),{...Sm(v),update:R,ssr:!!s}}const RM=Ps({mobileBreakpoint:[Number,String]},"display");function DM(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vT();const l=et(Gp);if(!l)throw new Error("Could not find Vuetify display injection");const f=Rt(()=>{if(!i.mobileBreakpoint)return l.mobile.value;const x=typeof i.mobileBreakpoint=="number"?i.mobileBreakpoint:l.thresholds.value[i.mobileBreakpoint];return l.width.value<x}),m=Rt(()=>s?{[`${s}--mobile`]:f.value}:{});return{...l,displayClasses:m,mobile:f}}const fE=Symbol.for("vuetify:goto");function pE(){return{container:void 0,duration:300,layout:!1,offset:0,easing:"easeInOutCubic",patterns:{linear:i=>i,easeInQuad:i=>i**2,easeOutQuad:i=>i*(2-i),easeInOutQuad:i=>i<.5?2*i**2:-1+(4-2*i)*i,easeInCubic:i=>i**3,easeOutCubic:i=>--i**3+1,easeInOutCubic:i=>i<.5?4*i**3:(i-1)*(2*i-2)*(2*i-2)+1,easeInQuart:i=>i**4,easeOutQuart:i=>1- --i**4,easeInOutQuart:i=>i<.5?8*i**4:1-8*--i**4,easeInQuint:i=>i**5,easeOutQuint:i=>1+--i**5,easeInOutQuint:i=>i<.5?16*i**5:1+16*--i**5}}}function mE(i,s){return{rtl:s.isRtl,options:Hn(pE(),i)}}const gE={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sortAsc:"mdi-arrow-up",sortDesc:"mdi-arrow-down",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus",calendar:"mdi-calendar",eyeDropper:"mdi-eyedropper"},_E={component:i=>Fr(xx,{...i,class:"mdi"})},yE=[String,Function,Object,Array],qp=Symbol.for("vuetify:icons"),Zd=Ps({icon:{type:yE},tag:{type:String,required:!0}},"icon"),zy=Om()({name:"VComponentIcon",props:Zd(),setup(i,s){let{slots:l}=s;return()=>{const f=i.icon;return ci(i.tag,null,{default:()=>{var m;return[i.icon?ci(f,null,null):(m=l.default)==null?void 0:m.call(l)]}})}}}),vx=ju({name:"VSvgIcon",inheritAttrs:!1,props:Zd(),setup(i,s){let{attrs:l}=s;return()=>ci(i.tag,j0(l,{style:null}),{default:()=>[ci("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[Array.isArray(i.icon)?i.icon.map(f=>Array.isArray(f)?ci("path",{d:f[0],"fill-opacity":f[1]},null):ci("path",{d:f},null)):ci("path",{d:i.icon},null)])]})}});ju({name:"VLigatureIcon",props:Zd(),setup(i){return()=>ci(i.tag,null,{default:()=>[i.icon]})}});const xx=ju({name:"VClassIcon",props:Zd(),setup(i){return()=>ci(i.tag,{class:i.icon},null)}}),vE={svg:{component:vx},class:{component:xx}};function xE(i){return Hn({defaultSet:"mdi",sets:{...vE,mdi:_E},aliases:{...gE,vuetify:["M8.2241 14.2009L12 21L22 3H14.4459L8.2241 14.2009Z",["M7.26303 12.4733L7.00113 12L2 3H12.5261C12.5261 3 12.5261 3 12.5261 3L7.26303 12.4733Z",.6]],"vuetify-outline":"svg:M7.26 12.47 12.53 3H2L7.26 12.47ZM14.45 3 8.22 14.2 12 21 22 3H14.45ZM18.6 5 12 16.88 10.51 14.2 15.62 5ZM7.26 8.35 5.4 5H9.13L7.26 8.35Z"}},i)}const zM=i=>{const s=et(qp);if(!s)throw new Error("Missing Vuetify Icons provide!");return{iconData:Rt(()=>{var A;const f=Sr(i);if(!f)return{component:zy};let m=f;if(typeof m=="string"&&(m=m.trim(),m.startsWith("$")&&(m=(A=s.aliases)==null?void 0:A[m.slice(1)])),!m)throw new Error(`Could not find aliased icon "${f}"`);if(Array.isArray(m))return{component:vx,icon:m};if(typeof m!="string")return{component:zy,icon:m};const x=Object.keys(s.sets).find(R=>typeof m=="string"&&m.startsWith(`${R}:`)),v=x?m.slice(x.length+1):m;return{component:s.sets[x??s.defaultSet].component,icon:v}})}},Pu=Symbol.for("vuetify:theme"),OM=Ps({theme:String},"theme");function Oy(){return{defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-bright":"#FFFFFF","surface-light":"#EEEEEE","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#1867C0","primary-darken-1":"#1F5592",secondary:"#48A9A6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-bright":"#ccbfd6","surface-light":"#424242","surface-variant":"#a3a3a3","on-surface-variant":"#424242",primary:"#2196F3","primary-darken-1":"#277CC1",secondary:"#54B6B2","secondary-darken-1":"#48A9A6",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":1,"medium-emphasis-opacity":.7,"disabled-opacity":.5,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}}}function bE(){var f,m;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Oy();const s=Oy();if(!i)return{...s,isDisabled:!0};const l={};for(const[x,v]of Object.entries(i.themes??{})){const c=v.dark||x==="dark"?(f=s.themes)==null?void 0:f.dark:(m=s.themes)==null?void 0:m.light;l[x]=Hn(c,v)}return Hn(s,{...i,themes:l})}function wE(i){const s=bE(i),l=yi(s.defaultTheme),f=yi(s.themes),m=Rt(()=>{const z={};for(const[B,M]of Object.entries(f.value)){const re=z[B]={...M,colors:{...M.colors}};if(s.variations)for(const se of s.variations.colors){const ue=re.colors[se];if(ue)for(const ae of["lighten","darken"]){const Z=ae==="lighten"?dT:fT;for(const me of nx(s.variations[ae],1))re.colors[`${se}-${ae}-${me}`]=cT(Z(Qs(ue),me))}}for(const se of Object.keys(re.colors)){if(/^on-[a-z]/.test(se)||re.colors[`on-${se}`])continue;const ue=`on-${se}`,ae=Qs(re.colors[se]);re.colors[ue]=mT(ae)}}return z}),x=Rt(()=>m.value[l.value]),v=Rt(()=>{const z=[];x.value.dark&&Ao(z,":root",["color-scheme: dark"]),Ao(z,":root",Fy(x.value));for(const[se,ue]of Object.entries(m.value))Ao(z,`.v-theme--${se}`,[`color-scheme: ${ue.dark?"dark":"normal"}`,...Fy(ue)]);const B=[],M=[],re=new Set(Object.values(m.value).flatMap(se=>Object.keys(se.colors)));for(const se of re)/^on-[a-z]/.test(se)?Ao(M,`.${se}`,[`color: rgb(var(--v-theme-${se})) !important`]):(Ao(B,`.bg-${se}`,[`--v-theme-overlay-multiplier: var(--v-theme-${se}-overlay-multiplier)`,`background-color: rgb(var(--v-theme-${se})) !important`,`color: rgb(var(--v-theme-on-${se})) !important`]),Ao(M,`.text-${se}`,[`color: rgb(var(--v-theme-${se})) !important`]),Ao(M,`.border-${se}`,[`--v-border-color: var(--v-theme-${se})`]));return z.push(...B,...M),z.map((se,ue)=>ue===0?se:`    ${se}`).join("")});function c(){return{style:[{children:v.value,id:"vuetify-theme-stylesheet",nonce:s.cspNonce||!1}]}}function A(z){if(s.isDisabled)return;const B=z._context.provides.usehead;if(B)if(B.push){const M=B.push(c);Rn&&Mt(v,()=>{M.patch(c)})}else Rn?(B.addHeadObjs(Rt(c)),jd(()=>B.updateDOM())):B.addHeadObjs(c());else{let re=function(){if(typeof document<"u"&&!M){const se=document.createElement("style");se.type="text/css",se.id="vuetify-theme-stylesheet",s.cspNonce&&se.setAttribute("nonce",s.cspNonce),M=se,document.head.appendChild(M)}M&&(M.innerHTML=v.value)},M=Rn?document.getElementById("vuetify-theme-stylesheet"):null;Rn?Mt(v,re,{immediate:!0}):re()}}const R=Rt(()=>s.isDisabled?void 0:`v-theme--${l.value}`);return{install:A,isDisabled:s.isDisabled,name:l,themes:f,current:x,computedThemes:m,themeClasses:R,styles:v,global:{name:l,current:x}}}function FM(i){Ms("provideTheme");const s=et(Pu,null);if(!s)throw new Error("Could not find Vuetify theme injection");const l=Rt(()=>i.theme??s.name.value),f=Rt(()=>s.themes.value[l.value]),m=Rt(()=>s.isDisabled?void 0:`v-theme--${l.value}`),x={...s,name:l,current:f,themeClasses:m};return Ai(Pu,x),x}function BM(){Ms("useTheme");const i=et(Pu,null);if(!i)throw new Error("Could not find Vuetify theme injection");return i}function Ao(i,s,l){i.push(`${s} {
`,...l.map(f=>`  ${f};
`),`}
`)}function Fy(i){const s=i.dark?2:1,l=i.dark?1:2,f=[];for(const[m,x]of Object.entries(i.colors)){const v=Qs(x);f.push(`--v-theme-${m}: ${v.r},${v.g},${v.b}`),m.startsWith("on-")||f.push(`--v-theme-${m}-overlay-multiplier: ${pT(x)>.18?s:l}`)}for(const[m,x]of Object.entries(i.variables)){const v=typeof x=="string"&&x.startsWith("#")?Qs(x):void 0,c=v?`${v.r}, ${v.g}, ${v.b}`:void 0;f.push(`--v-${m}: ${c??x}`)}return f}function SE(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"content";const l=yi(),f=yi();if(Rn){const m=new ResizeObserver(x=>{i==null||i(x,m),x.length&&(s==="content"?f.value=x[0].contentRect:f.value=x[0].target.getBoundingClientRect())});pn(()=>{m.disconnect()}),Mt(l,(x,v)=>{v&&(m.unobserve(dy(v)),f.value=void 0),x&&m.observe(dy(x))},{flush:"post"})}return{resizeRef:l,contentRect:Nd(f)}}const Ad=Symbol.for("vuetify:layout"),bx=Symbol.for("vuetify:layout-item"),By=1e3,TE=Ps({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),NM=Ps({name:{type:String},order:{type:[Number,String],default:0},absolute:Boolean},"layout-item");function EE(){const i=et(Ad);if(!i)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:i.getLayoutItem,mainRect:i.mainRect,mainStyles:i.mainStyles}}function VM(i){const s=et(Ad);if(!s)throw new Error("[Vuetify] Could not find injected layout");const l=i.id??`layout-item-${Fm()}`,f=Ms("useLayoutItem");Ai(bx,{id:l});const m=En(!1);E0(()=>m.value=!0),T0(()=>m.value=!1);const{layoutItemStyles:x,layoutItemScrimStyles:v}=s.register(f,{...i,active:Rt(()=>m.value?!1:i.active.value),id:l});return pn(()=>s.unregister(l)),{layoutItemStyles:x,layoutRect:s.layoutRect,layoutItemScrimStyles:v}}const IE=(i,s,l,f)=>{let m={top:0,left:0,right:0,bottom:0};const x=[{id:"",layer:{...m}}];for(const v of i){const c=s.get(v),A=l.get(v),R=f.get(v);if(!c||!A||!R)continue;const z={...m,[c.value]:parseInt(m[c.value],10)+(R.value?parseInt(A.value,10):0)};x.push({id:v,layer:z}),m=z}return x};function AE(i){const s=et(Ad,null),l=Rt(()=>s?s.rootZIndex.value-100:By),f=yi([]),m=Xr(new Map),x=Xr(new Map),v=Xr(new Map),c=Xr(new Map),A=Xr(new Map),{resizeRef:R,contentRect:z}=SE(),B=Rt(()=>{const Ae=new Map,$e=i.overlaps??[];for(const Se of $e.filter(Ge=>Ge.includes(":"))){const[Ge,ot]=Se.split(":");if(!f.value.includes(Ge)||!f.value.includes(ot))continue;const _t=m.get(Ge),He=m.get(ot),bt=x.get(Ge),qt=x.get(ot);!_t||!He||!bt||!qt||(Ae.set(ot,{position:_t.value,amount:parseInt(bt.value,10)}),Ae.set(Ge,{position:He.value,amount:-parseInt(qt.value,10)}))}return Ae}),M=Rt(()=>{const Ae=[...new Set([...v.values()].map(Se=>Se.value))].sort((Se,Ge)=>Se-Ge),$e=[];for(const Se of Ae){const Ge=f.value.filter(ot=>{var _t;return((_t=v.get(ot))==null?void 0:_t.value)===Se});$e.push(...Ge)}return IE($e,m,x,c)}),re=Rt(()=>!Array.from(A.values()).some(Ae=>Ae.value)),se=Rt(()=>M.value[M.value.length-1].layer),ue=Rt(()=>({"--v-layout-left":nd(se.value.left),"--v-layout-right":nd(se.value.right),"--v-layout-top":nd(se.value.top),"--v-layout-bottom":nd(se.value.bottom),...re.value?void 0:{transition:"none"}})),ae=Rt(()=>M.value.slice(1).map((Ae,$e)=>{let{id:Se}=Ae;const{layer:Ge}=M.value[$e],ot=x.get(Se),_t=m.get(Se);return{id:Se,...Ge,size:Number(ot.value),position:_t.value}})),Z=Ae=>ae.value.find($e=>$e.id===Ae),me=Ms("createLayout"),Ce=En(!1);ic(()=>{Ce.value=!0}),Ai(Ad,{register:(Ae,$e)=>{let{id:Se,order:Ge,position:ot,layoutSize:_t,elementSize:He,active:bt,disableTransitions:qt,absolute:pi}=$e;v.set(Se,Ge),m.set(Se,ot),x.set(Se,_t),c.set(Se,bt),qt&&A.set(Se,qt);const jt=fd(bx,me==null?void 0:me.vnode).indexOf(Ae);jt>-1?f.value.splice(jt,0,Se):f.value.push(Se);const Dt=Rt(()=>ae.value.findIndex(Xt=>Xt.id===Se)),Ci=Rt(()=>l.value+M.value.length*2-Dt.value*2),mi=Rt(()=>{const Xt=ot.value==="left"||ot.value==="right",Bi=ot.value==="right",Pi=ot.value==="bottom",Yi={[ot.value]:0,zIndex:Ci.value,transform:`translate${Xt?"X":"Y"}(${(bt.value?0:-110)*(Bi||Pi?-1:1)}%)`,position:pi.value||l.value!==By?"absolute":"fixed",...re.value?void 0:{transition:"none"}};if(!Ce.value)return Yi;const Wt=ae.value[Dt.value];if(!Wt)throw new Error(`[Vuetify] Could not find layout item "${Se}"`);const ke=B.value.get(Se);return ke&&(Wt[ke.position]+=ke.amount),{...Yi,height:Xt?`calc(100% - ${Wt.top}px - ${Wt.bottom}px)`:He.value?`${He.value}px`:void 0,left:Bi?void 0:`${Wt.left}px`,right:Bi?`${Wt.right}px`:void 0,top:ot.value!=="bottom"?`${Wt.top}px`:void 0,bottom:ot.value!=="top"?`${Wt.bottom}px`:void 0,width:Xt?He.value?`${He.value}px`:void 0:`calc(100% - ${Wt.left}px - ${Wt.right}px)`}}),ai=Rt(()=>({zIndex:Ci.value-1}));return{layoutItemStyles:mi,layoutItemScrimStyles:ai,zIndex:Ci}},unregister:Ae=>{v.delete(Ae),m.delete(Ae),x.delete(Ae),c.delete(Ae),A.delete(Ae),f.value=f.value.filter($e=>$e!==Ae)},mainRect:se,mainStyles:ue,getLayoutItem:Z,items:ae,layoutRect:z,rootZIndex:l});const be=Rt(()=>["v-layout",{"v-layout--full-height":i.fullHeight}]),Re=Rt(()=>({zIndex:s?l.value:void 0,position:s?"relative":void 0,overflow:s?"hidden":void 0}));return{layoutClasses:be,layoutStyles:Re,getLayoutItem:Z,items:ae,layoutRect:z,layoutRef:R}}function wx(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:s,...l}=i,f=Hn(s,l),{aliases:m={},components:x={},directives:v={}}=f,c=gT(f.defaults),A=dE(f.display,f.ssr),R=wE(f.theme),z=xE(f.icons),B=ET(f.locale),M=cE(f.date,B),re=mE(f.goTo,B);return{install:ue=>{for(const ae in v)ue.directive(ae,v[ae]);for(const ae in x)ue.component(ae,x[ae]);for(const ae in m)ue.component(ae,ju({...m[ae],name:ae,aliasName:m[ae].name}));if(R.install(ue),ue.provide(Zl,c),ue.provide(Gp,A),ue.provide(Pu,R),ue.provide(qp,z),ue.provide(Id,B),ue.provide(lE,M.options),ue.provide(My,M.instance),ue.provide(fE,re),Rn&&f.ssr)if(ue.$nuxt)ue.$nuxt.hook("app:suspense:resolve",()=>{A.update()});else{const{mount:ae}=ue;ue.mount=function(){const Z=ae(...arguments);return Ha(()=>A.update()),ue.mount=ae,Z}}Fm.reset(),ue.mixin({computed:{$vuetify(){return Xr({defaults:Ol.call(this,Zl),display:Ol.call(this,Gp),theme:Ol.call(this,Pu),icons:Ol.call(this,qp),locale:Ol.call(this,Id),date:Ol.call(this,My)})}}})},defaults:c,display:A,theme:R,icons:z,locale:B,date:M,goTo:re}}const CE="3.5.4";wx.version=CE;function Ol(i){var f,m;const s=this.$,l=((f=s.parent)==null?void 0:f.provides)??((m=s.vnode.appContext)==null?void 0:m.provides);if(l&&i in l)return l[i]}const PE=wx({});var ME=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Sx={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.1.0/LICENSE.txt
 */(function(i,s){(function(l,f){i.exports=f()})(ME,function(){var l={},f={};function m(v,c,A){if(f[v]=A,v==="index"){var R="var sharedModule = {}; ("+f.shared+")(sharedModule); ("+f.worker+")(sharedModule);",z={};return f.shared(z),f.index(l,z),typeof window<"u"&&l.setWorkerUrl(window.URL.createObjectURL(new Blob([R],{type:"text/javascript"}))),l}}m("shared",["exports"],function(v){function c(r,e,n,o){return new(n||(n=Promise))(function(h,_){function y(I){try{S(o.next(I))}catch(P){_(P)}}function b(I){try{S(o.throw(I))}catch(P){_(P)}}function S(I){var P;I.done?h(I.value):(P=I.value,P instanceof n?P:new n(function(L){L(P)})).then(y,b)}S((o=o.apply(r,e||[])).next())})}function A(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}typeof SuppressedError=="function"&&SuppressedError;var R=z;function z(r,e){this.x=r,this.y=e}z.prototype={clone:function(){return new z(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,n=r.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),n=Math.sin(r),o=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=o,this},_rotateAround:function(r,e){var n=Math.cos(r),o=Math.sin(r),h=e.y+o*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-o*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},z.convert=function(r){return r instanceof z?r:Array.isArray(r)?new z(r[0],r[1]):r};var B=A(R),M=re;function re(r,e,n,o){this.cx=3*r,this.bx=3*(n-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(o-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=n,this.p2y=o}re.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(e===void 0&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var n=r,o=0;o<8;o++){var h=this.sampleCurveX(n)-r;if(Math.abs(h)<e)return n;var _=this.sampleCurveDerivativeX(n);if(Math.abs(_)<1e-6)break;n-=h/_}var y=0,b=1;for(n=r,o=0;o<20&&(h=this.sampleCurveX(n),!(Math.abs(h-r)<e));o++)r>h?y=n:b=n,n=.5*(b-y)+y;return n},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};var se=A(M);let ue,ae;function Z(){return ue==null&&(ue=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ue}function me(){if(ae==null&&(ae=!1,Z())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let o=0;o<5*5;o++){const h=4*o;e.fillStyle=`rgb(${h},${h+1},${h+2})`,e.fillRect(o%5,Math.floor(o/5),1,1)}const n=e.getImageData(0,0,5,5).data;for(let o=0;o<5*5*4;o++)if(o%4!=3&&n[o]!==o){ae=!0;break}}}return ae||!1}function Ce(r,e,n,o){const h=new se(r,e,n,o);return function(_){return h.solve(_)}}const be=Ce(.25,.1,.25,1);function Re(r,e,n){return Math.min(n,Math.max(e,r))}function Ae(r,e,n){const o=n-e,h=((r-e)%o+o)%o+e;return h===e?n:h}function $e(r,...e){for(const n of e)for(const o in n)r[o]=n[o];return r}let Se=1;function Ge(r,e,n){const o={};for(const h in r)o[h]=e.call(n||this,r[h],h,r);return o}function ot(r,e,n){const o={};for(const h in r)e.call(n||this,r[h],h,r)&&(o[h]=r[h]);return o}function _t(r){return Array.isArray(r)?r.map(_t):typeof r=="object"&&r?Ge(r,_t):r}const He={};function bt(r){He[r]||(typeof console<"u"&&console.warn(r),He[r]=!0)}function qt(r,e,n){return(n.y-r.y)*(e.x-r.x)>(e.y-r.y)*(n.x-r.x)}function pi(r){let e=0;for(let n,o,h=0,_=r.length,y=_-1;h<_;y=h++)n=r[h],o=r[y],e+=(o.x-n.x)*(n.y+o.y);return e}function Lt(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let jt=null;function Dt(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const Ci="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function mi(r,e,n,o,h){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(r,{timestamp:0});try{const y=_==null?void 0:_.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);const b=y.startsWith("BGR"),S=new Uint8ClampedArray(o*h*4);if(yield _.copyTo(S,function(I,P,L,V,$){const H=4*Math.max(-P,0),q=(Math.max(0,L)-L)*V*4+H,te=4*V,oe=Math.max(0,P),ve=Math.max(0,L);return{rect:{x:oe,y:ve,width:Math.min(I.width,P+V)-oe,height:Math.min(I.height,L+$)-ve},layout:[{offset:q,stride:te}]}}(r,e,n,o,h)),b)for(let I=0;I<S.length;I+=4){const P=S[I];S[I]=S[I+2],S[I+2]=P}return S}finally{_.close()}})}let ai,Xt;const Bi="AbortError";function Pi(){return new Error(Bi)}const Yi={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Wt(r){return Yi.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const ke="global-dispatcher";class nt extends Error{constructor(e,n,o,h){super(`AJAXError: ${n} (${e}): ${o}`),this.status=e,this.statusText=n,this.url=o,this.body=h}}const it=()=>Lt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,ht=function(r,e){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const o=Wt(r.url);if(o)return o(r,e);if(Lt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:r,targetMapId:ke},e)}if(!(/^file:/.test(n=r.url)||/^file:/.test(it())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(o,h){return c(this,void 0,void 0,function*(){const _=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,cache:o.cache,referrer:it(),signal:h.signal});o.type==="json"&&_.headers.set("Accept","application/json");const y=yield fetch(_);if(!y.ok){const I=yield y.blob();throw new nt(y.status,y.statusText,o.url,I)}const b=o.type==="arrayBuffer"||o.type==="image"?y.arrayBuffer():o.type==="json"?y.json():y.text(),S=yield b;if(h.signal.aborted)throw Pi();return{data:S,cacheControl:y.headers.get("Cache-Control"),expires:y.headers.get("Expires")}})}(r,e);if(Lt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:r,mustQueue:!0,targetMapId:ke},e)}var n;return function(o,h){return new Promise((_,y)=>{const b=new XMLHttpRequest;b.open(o.method||"GET",o.url,!0),o.type!=="arrayBuffer"&&o.type!=="image"||(b.responseType="arraybuffer");for(const S in o.headers)b.setRequestHeader(S,o.headers[S]);o.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=o.credentials==="include",b.onerror=()=>{y(new Error(b.statusText))},b.onload=()=>{if(!h.signal.aborted)if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let S=b.response;if(o.type==="json")try{S=JSON.parse(b.response)}catch(I){return void y(I)}_({data:S,cacheControl:b.getResponseHeader("Cache-Control"),expires:b.getResponseHeader("Expires")})}else{const S=new Blob([b.response],{type:b.getResponseHeader("Content-Type")});y(new nt(b.status,b.statusText,o.url,S))}},h.signal.addEventListener("abort",()=>{b.abort(),y(Pi())}),b.send(o.body)})}(r,e)};function Ht(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const e=new URL(r),n=window.location;return e.protocol===n.protocol&&e.host===n.host}function ei(r,e,n){n[r]&&n[r].indexOf(e)!==-1||(n[r]=n[r]||[],n[r].push(e))}function O(r,e,n){if(n&&n[r]){const o=n[r].indexOf(e);o!==-1&&n[r].splice(o,1)}}class D{constructor(e,n={}){$e(this,n),this.type=e}}class Y extends D{constructor(e,n={}){super("error",$e({error:e},n))}}class ye{on(e,n){return this._listeners=this._listeners||{},ei(e,n,this._listeners),this}off(e,n){return O(e,n,this._listeners),O(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},ei(e,n,this._oneTimeListeners),this):new Promise(o=>this.once(e,o))}fire(e,n){typeof e=="string"&&(e=new D(e,n||{}));const o=e.type;if(this.listens(o)){e.target=this;const h=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const b of h)b.call(this,e);const _=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const b of _)O(o,b,this._oneTimeListeners),b.call(this,e);const y=this._eventedParent;y&&($e(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof Y&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var K={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Be=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Qe(r,e){const n={};for(const o in r)o!=="ref"&&(n[o]=r[o]);return Be.forEach(o=>{o in e&&(n[o]=e[o])}),n}function Me(r,e){if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;for(let n=0;n<r.length;n++)if(!Me(r[n],e[n]))return!1;return!0}if(typeof r=="object"&&r!==null&&e!==null){if(typeof e!="object"||Object.keys(r).length!==Object.keys(e).length)return!1;for(const n in r)if(!Me(r[n],e[n]))return!1;return!0}return r===e}function Ke(r,e){r.push(e)}function qe(r,e,n){Ke(n,{command:"addSource",args:[r,e[r]]})}function ft(r,e,n){Ke(e,{command:"removeSource",args:[r]}),n[r]=!0}function ct(r,e,n,o){ft(r,n,o),qe(r,e,n)}function xe(r,e,n){let o;for(o in r[n])if(Object.prototype.hasOwnProperty.call(r[n],o)&&o!=="data"&&!Me(r[n][o],e[n][o]))return!1;for(o in e[n])if(Object.prototype.hasOwnProperty.call(e[n],o)&&o!=="data"&&!Me(r[n][o],e[n][o]))return!1;return!0}function Pe(r,e,n,o,h,_){r=r||{},e=e||{};for(const y in r)Object.prototype.hasOwnProperty.call(r,y)&&(Me(r[y],e[y])||n.push({command:_,args:[o,y,e[y],h]}));for(const y in e)Object.prototype.hasOwnProperty.call(e,y)&&!Object.prototype.hasOwnProperty.call(r,y)&&(Me(r[y],e[y])||n.push({command:_,args:[o,y,e[y],h]}))}function yt(r){return r.id}function Ct(r,e){return r[e.id]=e,r}class Oe{constructor(e,n,o,h){this.message=(e?`${e}: `:"")+o,h&&(this.identifier=h),n!=null&&n.__line__&&(this.line=n.__line__)}}function oi(r,...e){for(const n of e)for(const o in n)r[o]=n[o];return r}class fi extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}class rn{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[o,h]of n)this.bindings[o]=h}concat(e){return new rn(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const rr={kind:"null"},Ye={kind:"number"},Ot={kind:"string"},Et={kind:"boolean"},gi={kind:"color"},mn={kind:"object"},Ft={kind:"value"},ks={kind:"collator"},or={kind:"formatted"},ie={kind:"padding"},N={kind:"resolvedImage"},U={kind:"variableAnchorOffsetCollection"};function G(r,e){return{kind:"array",itemType:r,N:e}}function J(r){if(r.kind==="array"){const e=J(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const de=[rr,Ye,Ot,Et,gi,or,mn,G(Ft),ie,N,U];function fe(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!fe(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const n of de)if(!fe(n,e))return null}}return`Expected ${J(r)} but found ${J(e)} instead.`}function _e(r,e){return e.some(n=>n.kind===r.kind)}function ce(r,e){return e.some(n=>n==="null"?r===null:n==="array"?Array.isArray(r):n==="object"?r&&!Array.isArray(r)&&typeof r=="object":n===typeof r)}function we(r,e){return r.kind==="array"&&e.kind==="array"?r.itemType.kind===e.itemType.kind&&typeof r.N=="number":r.kind===e.kind}const Ve=.96422,De=.82521,ze=4/29,St=6/29,It=3*St*St,Bt=St*St*St,zt=Math.PI/180,ii=180/Math.PI;function bi(r){return(r%=360)<0&&(r+=360),r}function zi([r,e,n,o]){let h,_;const y=Ut((.2225045*(r=nr(r))+.7168786*(e=nr(e))+.0606169*(n=nr(n)))/1);r===e&&e===n?h=_=y:(h=Ut((.4360747*r+.3850649*e+.1430804*n)/Ve),_=Ut((.0139322*r+.0971045*e+.7141733*n)/De));const b=116*y-16;return[b<0?0:b,500*(h-y),200*(y-_),o]}function nr(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Ut(r){return r>Bt?Math.pow(r,1/3):r/It+ze}function $i([r,e,n,o]){let h=(r+16)/116,_=isNaN(e)?h:h+e/500,y=isNaN(n)?h:h-n/200;return h=1*Vr(h),_=Ve*Vr(_),y=De*Vr(y),[lr(3.1338561*_-1.6168667*h-.4906146*y),lr(-.9787684*_+1.9161415*h+.033454*y),lr(.0719453*_-.2289914*h+1.4052427*y),o]}function lr(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function Vr(r){return r>St?r*r*r:It*(r-ze)}function nn(r){return parseInt(r.padEnd(2,r),16)/255}function vr(r,e){return Wn(e?r/100:r,0,1)}function Wn(r,e,n){return Math.min(Math.max(e,r),n)}function Hu(r){return!r.some(Number.isNaN)}const tf={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class vi{constructor(e,n,o,h=1,_=!0){this.r=e,this.g=n,this.b=o,this.a=h,_||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[e,n,o,h]))}static parse(e){if(e instanceof vi)return e;if(typeof e!="string")return;const n=function(o){if((o=o.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=tf[o];if(h){const[y,b,S]=h;return[y/255,b/255,S/255,1]}if(o.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(o)){const y=o.length<6?1:2;let b=1;return[nn(o.slice(b,b+=y)),nn(o.slice(b,b+=y)),nn(o.slice(b,b+=y)),nn(o.slice(b,b+y)||"ff")]}if(o.startsWith("rgb")){const y=o.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[b,S,I,P,L,V,$,H,q,te,oe,ve]=y,le=[P||" ",$||" ",te].join("");if(le==="  "||le==="  /"||le===",,"||le===",,,"){const pe=[I,V,q].join(""),Le=pe==="%%%"?100:pe===""?255:0;if(Le){const Ne=[Wn(+S/Le,0,1),Wn(+L/Le,0,1),Wn(+H/Le,0,1),oe?vr(+oe,ve):1];if(Hu(Ne))return Ne}}return}}const _=o.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[y,b,S,I,P,L,V,$,H]=_,q=[S||" ",P||" ",V].join("");if(q==="  "||q==="  /"||q===",,"||q===",,,"){const te=[+b,Wn(+I,0,100),Wn(+L,0,100),$?vr(+$,H):1];if(Hu(te))return function([oe,ve,le,pe]){function Le(Ne){const lt=(Ne+oe/30)%12,vt=ve*Math.min(le,1-le);return le-vt*Math.max(-1,Math.min(lt-3,9-lt,1))}return oe=bi(oe),ve/=100,le/=100,[Le(0),Le(8),Le(4),pe]}(te)}}}(e);return n?new vi(...n,!1):void 0}get rgb(){const{r:e,g:n,b:o,a:h}=this,_=h||1/0;return this.overwriteGetter("rgb",[e/_,n/_,o/_,h])}get hcl(){return this.overwriteGetter("hcl",function(e){const[n,o,h,_]=zi(e),y=Math.sqrt(o*o+h*h);return[Math.round(1e4*y)?bi(Math.atan2(h,o)*ii):NaN,y,n,_]}(this.rgb))}get lab(){return this.overwriteGetter("lab",zi(this.rgb))}overwriteGetter(e,n){return Object.defineProperty(this,e,{value:n}),n}toString(){const[e,n,o,h]=this.rgb;return`rgba(${[e,n,o].map(_=>Math.round(255*_)).join(",")},${h})`}}vi.black=new vi(0,0,0,1),vi.white=new vi(1,1,1,1),vi.transparent=new vi(0,0,0,0),vi.red=new vi(1,0,0,1);class nc{constructor(e,n,o){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class sc{constructor(e,n,o,h,_){this.text=e,this.image=n,this.scale=o,this.fontStack=h,this.textColor=_}}class gn{constructor(e){this.sections=e}static fromString(e){return new gn([new sc(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof gn?e:gn.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class sn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof sn)return e;if(typeof e=="number")return new sn([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const n of e)if(typeof n!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new sn(e)}}toString(){return JSON.stringify(this.values)}}const Ya=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class In{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof In)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let n=0;n<e.length;n+=2){const o=e[n],h=e[n+1];if(typeof o!="string"||!Ya.has(o)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new In(e)}}toString(){return JSON.stringify(this.values)}}class An{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new An({name:e,available:!1}):null}}function aa(r,e,n,o){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[r,e,n,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[r,e,n,o]:[r,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Vo(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof vi||r instanceof nc||r instanceof gn||r instanceof sn||r instanceof In||r instanceof An)return!0;if(Array.isArray(r)){for(const e of r)if(!Vo(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!Vo(r[e]))return!1;return!0}return!1}function sr(r){if(r===null)return rr;if(typeof r=="string")return Ot;if(typeof r=="boolean")return Et;if(typeof r=="number")return Ye;if(r instanceof vi)return gi;if(r instanceof nc)return ks;if(r instanceof gn)return or;if(r instanceof sn)return ie;if(r instanceof In)return U;if(r instanceof An)return N;if(Array.isArray(r)){const e=r.length;let n;for(const o of r){const h=sr(o);if(n){if(n===h)continue;n=Ft;break}n=h}return G(n||Ft,e)}return mn}function Xa(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof vi||r instanceof gn||r instanceof sn||r instanceof In||r instanceof An?r.toString():JSON.stringify(r)}class fs{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Vo(e[1]))return n.error("invalid value");const o=e[1];let h=sr(o);const _=n.expectedType;return h.kind!=="array"||h.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(h=_),new fs(h,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Ni{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const Uo={string:Ot,number:Ye,boolean:Et,object:mn};class _n{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let o,h=1;const _=e[0];if(_==="array"){let b,S;if(e.length>2){const I=e[1];if(typeof I!="string"||!(I in Uo)||I==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);b=Uo[I],h++}else b=Ft;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);S=e[2],h++}o=G(b,S)}else{if(!Uo[_])throw new Error(`Types doesn't contain name = ${_}`);o=Uo[_]}const y=[];for(;h<e.length;h++){const b=n.parse(e[h],h,Ft);if(!b)return null;y.push(b)}return new _n(o,y)}evaluate(e){for(let n=0;n<this.args.length;n++){const o=this.args[n].evaluate(e);if(!fe(this.type,sr(o)))return o;if(n===this.args.length-1)throw new Ni(`Expected value to be of type ${J(this.type)}, but found ${J(sr(o))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const $o={"to-boolean":Et,"to-color":gi,"to-number":Ye,"to-string":Ot};class Zn{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const o=e[0];if(!$o[o])throw new Error(`Can't parse ${o} as it is not part of the known types`);if((o==="to-boolean"||o==="to-string")&&e.length!==2)return n.error("Expected one argument.");const h=$o[o],_=[];for(let y=1;y<e.length;y++){const b=n.parse(e[y],y,Ft);if(!b)return null;_.push(b)}return new Zn(h,_)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let n,o;for(const h of this.args){if(n=h.evaluate(e),o=null,n instanceof vi)return n;if(typeof n=="string"){const _=e.parseColor(n);if(_)return _}else if(Array.isArray(n)&&(o=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:aa(n[0],n[1],n[2],n[3]),!o))return new vi(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Ni(o||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const o of this.args){n=o.evaluate(e);const h=sn.parse(n);if(h)return h}throw new Ni(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const o of this.args){n=o.evaluate(e);const h=In.parse(n);if(h)return h}throw new Ni(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const o of this.args){if(n=o.evaluate(e),n===null)return 0;const h=Number(n);if(!isNaN(h))return h}throw new Ni(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return gn.fromString(Xa(this.args[0].evaluate(e)));case"resolvedImage":return An.fromString(Xa(this.args[0].evaluate(e)));default:return Xa(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const Ja=["Unknown","Point","LineString","Polygon"];class xi{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ja[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let n=this._parseColorCache[e];return n||(n=this._parseColorCache[e]=vi.parse(e)),n}}class jo{constructor(e,n,o=[],h,_=new rn,y=[]){this.registry=e,this.path=o,this.key=o.map(b=>`[${b}]`).join(""),this.scope=_,this.errors=y,this.expectedType=h,this._isConstant=n}parse(e,n,o,h,_={}){return n?this.concat(n,o,h)._parse(e,_):this._parse(e,_)}_parse(e,n){function o(h,_,y){return y==="assert"?new _n(_,[h]):y==="coerce"?new Zn(_,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[h];if(_){let y=_.parse(e,this);if(!y)return null;if(this.expectedType){const b=this.expectedType,S=y.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||S.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(b.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(b.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(b,S))return null}else y=o(y,b,n.typeAnnotation||"coerce");else y=o(y,b,n.typeAnnotation||"coerce");else y=o(y,b,n.typeAnnotation||"coerce");else y=o(y,b,n.typeAnnotation||"assert")}if(!(y instanceof fs)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const b=new xi;try{y=new fs(y.type,y.evaluate(b))}catch(S){return this.error(S.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,o){const h=typeof e=="number"?this.path.concat(e):this.path,_=o?this.scope.concat(o):this.scope;return new jo(this.registry,this._isConstant,h,n||null,_,this.errors)}error(e,...n){const o=`${this.key}${n.map(h=>`[${h}]`).join("")}`;this.errors.push(new fi(o,e))}checkSubtype(e,n){const o=fe(e,n);return o&&this.error(o),o}}class oa{constructor(e,n,o){this.type=ks,this.locale=o,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const o=e[1];if(typeof o!="object"||Array.isArray(o))return n.error("Collator options argument must be an object.");const h=n.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,Et);if(!h)return null;const _=n.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,Et);if(!_)return null;let y=null;return o.locale&&(y=n.parse(o.locale,1,Ot),!y)?null:new oa(h,_,y)}evaluate(e){return new nc(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const ps=8192;function Ho(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function Qa(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function rf(r,e){const n=(180+r[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(n*h*ps),Math.round(o*h*ps)]}function Gu(r,e,n){const o=r[0]-e[0],h=r[1]-e[1],_=r[0]-n[0],y=r[1]-n[1];return o*y-_*h==0&&o*_<=0&&h*y<=0}function Go(r,e){let n=!1;for(let y=0,b=e.length;y<b;y++){const S=e[y];for(let I=0,P=S.length;I<P-1;I++){if(Gu(r,S[I],S[I+1]))return!1;(h=S[I])[1]>(o=r)[1]!=(_=S[I+1])[1]>o[1]&&o[0]<(_[0]-h[0])*(o[1]-h[1])/(_[1]-h[1])+h[0]&&(n=!n)}}var o,h,_;return n}function nf(r,e){for(let n=0;n<e.length;n++)if(Go(r,e[n]))return!0;return!1}function qu(r,e,n,o){const h=o[0]-n[0],_=o[1]-n[1],y=(r[0]-n[0])*_-h*(r[1]-n[1]),b=(e[0]-n[0])*_-h*(e[1]-n[1]);return y>0&&b<0||y<0&&b>0}function sf(r,e,n){for(const I of n)for(let P=0;P<I.length-1;++P)if((b=[(y=I[P+1])[0]-(_=I[P])[0],y[1]-_[1]])[0]*(S=[(h=e)[0]-(o=r)[0],h[1]-o[1]])[1]-b[1]*S[0]!=0&&qu(o,h,_,y)&&qu(_,y,o,h))return!0;var o,h,_,y,b,S;return!1}function Wu(r,e){for(let n=0;n<r.length;++n)if(!Go(r[n],e))return!1;for(let n=0;n<r.length-1;++n)if(sf(r[n],r[n+1],e))return!1;return!0}function Zu(r,e){for(let n=0;n<e.length;n++)if(Wu(r,e[n]))return!0;return!1}function qo(r,e,n){const o=[];for(let h=0;h<r.length;h++){const _=[];for(let y=0;y<r[h].length;y++){const b=rf(r[h][y],n);Ho(e,b),_.push(b)}o.push(_)}return o}function Ku(r,e,n){const o=[];for(let h=0;h<r.length;h++){const _=qo(r[h],e,n);o.push(_)}return o}function Yu(r,e,n,o){if(r[0]<n[0]||r[0]>n[2]){const h=.5*o;let _=r[0]-n[0]>h?-o:n[0]-r[0]>h?o:0;_===0&&(_=r[0]-n[2]>h?-o:n[2]-r[0]>h?o:0),r[0]+=_}Ho(e,r)}function Wo(r,e,n,o){const h=Math.pow(2,o.z)*ps,_=[o.x*ps,o.y*ps],y=[];for(const b of r)for(const S of b){const I=[S.x+_[0],S.y+_[1]];Yu(I,e,n,h),y.push(I)}return y}function Xu(r,e,n,o){const h=Math.pow(2,o.z)*ps,_=[o.x*ps,o.y*ps],y=[];for(const S of r){const I=[];for(const P of S){const L=[P.x+_[0],P.y+_[1]];Ho(e,L),I.push(L)}y.push(I)}if(e[2]-e[0]<=h/2){(b=e)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const S of y)for(const I of S)Yu(I,e,n,h)}var b;return y}class Ls{constructor(e,n){this.type=Et,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Vo(e[1])){const o=e[1];if(o.type==="FeatureCollection"){const h=[];for(const _ of o.features){const{type:y,coordinates:b}=_.geometry;y==="Polygon"&&h.push(b),y==="MultiPolygon"&&h.push(...b)}if(h.length)return new Ls(o,{type:"MultiPolygon",coordinates:h})}else if(o.type==="Feature"){const h=o.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Ls(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new Ls(o,o)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,o){const h=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(o.type==="Polygon"){const b=qo(o.coordinates,_,y),S=Wo(n.geometry(),h,_,y);if(!Qa(h,_))return!1;for(const I of S)if(!Go(I,b))return!1}if(o.type==="MultiPolygon"){const b=Ku(o.coordinates,_,y),S=Wo(n.geometry(),h,_,y);if(!Qa(h,_))return!1;for(const I of S)if(!nf(I,b))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,o){const h=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(o.type==="Polygon"){const b=qo(o.coordinates,_,y),S=Xu(n.geometry(),h,_,y);if(!Qa(h,_))return!1;for(const I of S)if(!Wu(I,b))return!1}if(o.type==="MultiPolygon"){const b=Ku(o.coordinates,_,y),S=Xu(n.geometry(),h,_,y);if(!Qa(h,_))return!1;for(const I of S)if(!Zu(I,b))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Zo{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const o=e[1];return n.scope.has(o)?new Zo(o,n.scope.get(o)):n.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class yn{constructor(e,n,o,h){this.name=e,this.type=n,this._evaluate=o,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,n){const o=e[0],h=yn.definitions[o];if(!h)return n.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,b=y.filter(([I])=>!Array.isArray(I)||I.length===e.length-1);let S=null;for(const[I,P]of b){S=new jo(n.registry,eo,n.path,null,n.scope);const L=[];let V=!1;for(let $=1;$<e.length;$++){const H=e[$],q=Array.isArray(I)?I[$-1]:I.type,te=S.parse(H,1+L.length,q);if(!te){V=!0;break}L.push(te)}if(!V)if(Array.isArray(I)&&I.length!==L.length)S.error(`Expected ${I.length} arguments, but found ${L.length} instead.`);else{for(let $=0;$<L.length;$++){const H=Array.isArray(I)?I[$]:I.type,q=L[$];S.concat($+1).checkSubtype(H,q.type)}if(S.errors.length===0)return new yn(o,_,P,L)}}if(b.length===1)n.errors.push(...S.errors);else{const I=(b.length?b:y).map(([L])=>{return V=L,Array.isArray(V)?`(${V.map(J).join(", ")})`:`(${J(V.type)}...)`;var V}).join(" | "),P=[];for(let L=1;L<e.length;L++){const V=n.parse(e[L],1+P.length);if(!V)return null;P.push(J(V.type))}n.error(`Expected arguments of type ${I}, but found (${P.join(", ")}) instead.`)}return null}static register(e,n){yn.definitions=n;for(const o in n)e[o]=yn}}function eo(r){if(r instanceof Zo)return eo(r.boundExpression);if(r instanceof yn&&r.name==="error"||r instanceof oa||r instanceof Ls)return!1;const e=r instanceof Zn||r instanceof _n;let n=!0;return r.eachChild(o=>{n=e?n&&eo(o):n&&o instanceof fs}),!!n&&Ko(r)&&io(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ko(r){if(r instanceof yn&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Ls)return!1;let e=!0;return r.eachChild(n=>{e&&!Ko(n)&&(e=!1)}),e}function to(r){if(r instanceof yn&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(n=>{e&&!to(n)&&(e=!1)}),e}function io(r,e){if(r instanceof yn&&e.indexOf(r.name)>=0)return!1;let n=!0;return r.eachChild(o=>{n&&!io(o,e)&&(n=!1)}),n}function ro(r,e){const n=r.length-1;let o,h,_=0,y=n,b=0;for(;_<=y;)if(b=Math.floor((_+y)/2),o=r[b],h=r[b+1],o<=e){if(b===n||e<h)return b;_=b+1}else{if(!(o>e))throw new Ni("Input is not a number.");y=b-1}return 0}class no{constructor(e,n,o){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[h,_]of o)this.labels.push(h),this.outputs.push(_)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const o=n.parse(e[1],1,Ye);if(!o)return null;const h=[];let _=null;n.expectedType&&n.expectedType.kind!=="value"&&(_=n.expectedType);for(let y=1;y<e.length;y+=2){const b=y===1?-1/0:e[y],S=e[y+1],I=y,P=y+1;if(typeof b!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(h.length&&h[h.length-1][0]>=b)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const L=n.parse(S,P,_);if(!L)return null;_=_||L.type,h.push([b,L])}return new no(_,o,h)}evaluate(e){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(e);const h=this.input.evaluate(e);if(h<=n[0])return o[0].evaluate(e);const _=n.length;return h>=n[_-1]?o[_-1].evaluate(e):o[ro(n,h)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function af(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var of=Ju;function Ju(r,e,n,o){this.cx=3*r,this.bx=3*(n-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(o-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=n,this.p2y=o}Ju.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(e===void 0&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var n=r,o=0;o<8;o++){var h=this.sampleCurveX(n)-r;if(Math.abs(h)<e)return n;var _=this.sampleCurveDerivativeX(n);if(Math.abs(_)<1e-6)break;n-=h/_}var y=0,b=1;for(n=r,o=0;o<20&&(h=this.sampleCurveX(n),!(Math.abs(h-r)<e));o++)r>h?y=n:b=n,n=.5*(b-y)+y;return n},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};var lf=af(of);function Rs(r,e,n){return r+n*(e-r)}function Yo(r,e,n){return r.map((o,h)=>Rs(o,e[h],n))}const Ur={number:Rs,color:function(r,e,n,o="rgb"){switch(o){case"rgb":{const[h,_,y,b]=Yo(r.rgb,e.rgb,n);return new vi(h,_,y,b,!1)}case"hcl":{const[h,_,y,b]=r.hcl,[S,I,P,L]=e.hcl;let V,$;if(isNaN(h)||isNaN(S))isNaN(h)?isNaN(S)?V=NaN:(V=S,y!==1&&y!==0||($=I)):(V=h,P!==1&&P!==0||($=_));else{let ve=S-h;S>h&&ve>180?ve-=360:S<h&&h-S>180&&(ve+=360),V=h+n*ve}const[H,q,te,oe]=function([ve,le,pe,Le]){return ve=isNaN(ve)?0:ve*zt,$i([pe,Math.cos(ve)*le,Math.sin(ve)*le,Le])}([V,$??Rs(_,I,n),Rs(y,P,n),Rs(b,L,n)]);return new vi(H,q,te,oe,!1)}case"lab":{const[h,_,y,b]=$i(Yo(r.lab,e.lab,n));return new vi(h,_,y,b,!1)}}},array:Yo,padding:function(r,e,n){return new sn(Yo(r.values,e.values,n))},variableAnchorOffsetCollection:function(r,e,n){const o=r.values,h=e.values;if(o.length!==h.length)throw new Ni(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${e.toString()}`);const _=[];for(let y=0;y<o.length;y+=2){if(o[y]!==h[y])throw new Ni(`Cannot interpolate values containing mismatched anchors. from[${y}]: ${o[y]}, to[${y}]: ${h[y]}`);_.push(o[y]);const[b,S]=o[y+1],[I,P]=h[y+1];_.push([Rs(b,I,n),Rs(S,P,n)])}return new In(_)}};class kr{constructor(e,n,o,h,_){this.type=e,this.operator=n,this.interpolation=o,this.input=h,this.labels=[],this.outputs=[];for(const[y,b]of _)this.labels.push(y),this.outputs.push(b)}static interpolationFactor(e,n,o,h){let _=0;if(e.name==="exponential")_=li(n,e.base,o,h);else if(e.name==="linear")_=li(n,1,o,h);else if(e.name==="cubic-bezier"){const y=e.controlPoints;_=new lf(y[0],y[1],y[2],y[3]).solve(li(n,1,o,h))}return _}static parse(e,n){let[o,h,_,...y]=e;if(!Array.isArray(h)||h.length===0)return n.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const I=h[1];if(typeof I!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:I}}else{if(h[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const I=h.slice(1);if(I.length!==4||I.some(P=>typeof P!="number"||P<0||P>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:I}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(_=n.parse(_,2,Ye),!_)return null;const b=[];let S=null;o==="interpolate-hcl"||o==="interpolate-lab"?S=gi:n.expectedType&&n.expectedType.kind!=="value"&&(S=n.expectedType);for(let I=0;I<y.length;I+=2){const P=y[I],L=y[I+1],V=I+3,$=I+4;if(typeof P!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(b.length&&b[b.length-1][0]>=P)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const H=n.parse(L,$,S);if(!H)return null;S=S||H.type,b.push([P,H])}return we(S,Ye)||we(S,gi)||we(S,ie)||we(S,U)||we(S,G(Ye))?new kr(S,o,h,_,b):n.error(`Type ${J(S)} is not interpolatable.`)}evaluate(e){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(e);const h=this.input.evaluate(e);if(h<=n[0])return o[0].evaluate(e);const _=n.length;if(h>=n[_-1])return o[_-1].evaluate(e);const y=ro(n,h),b=kr.interpolationFactor(this.interpolation,h,n[y],n[y+1]),S=o[y].evaluate(e),I=o[y+1].evaluate(e);switch(this.operator){case"interpolate":return Ur[this.type.kind](S,I,b);case"interpolate-hcl":return Ur.color(S,I,b,"hcl");case"interpolate-lab":return Ur.color(S,I,b,"lab")}}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function li(r,e,n,o){const h=o-n,_=r-n;return h===0?0:e===1?_/h:(Math.pow(e,_)-1)/(Math.pow(e,h)-1)}class Xo{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let o=null;const h=n.expectedType;h&&h.kind!=="value"&&(o=h);const _=[];for(const b of e.slice(1)){const S=n.parse(b,1+_.length,o,void 0,{typeAnnotation:"omit"});if(!S)return null;o=o||S.type,_.push(S)}if(!o)throw new Error("No output type");const y=h&&_.some(b=>fe(h,b.type));return new Xo(y?Ft:o,_)}evaluate(e){let n,o=null,h=0;for(const _ of this.args)if(h++,o=_.evaluate(e),o&&o instanceof An&&!o.available&&(n||(n=o.name),o=null,h===this.args.length&&(o=n)),o!==null)break;return o}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class Jo{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const o=[];for(let _=1;_<e.length-1;_+=2){const y=e[_];if(typeof y!="string")return n.error(`Expected string, but found ${typeof y} instead.`,_);if(/[^a-zA-Z0-9_]/.test(y))return n.error("Variable names must contain only alphanumeric characters or '_'.",_);const b=n.parse(e[_+1],_+1);if(!b)return null;o.push([y,b])}const h=n.parse(e[e.length-1],e.length-1,n.expectedType,o);return h?new Jo(o,h):null}outputDefined(){return this.result.outputDefined()}}class ac{constructor(e,n,o){this.type=e,this.index=n,this.input=o}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,Ye),h=n.parse(e[2],2,G(n.expectedType||Ft));return o&&h?new ac(h.type.itemType,o,h):null}evaluate(e){const n=this.index.evaluate(e),o=this.input.evaluate(e);if(n<0)throw new Ni(`Array index out of bounds: ${n} < 0.`);if(n>=o.length)throw new Ni(`Array index out of bounds: ${n} > ${o.length-1}.`);if(n!==Math.floor(n))throw new Ni(`Array index must be an integer, but found ${n} instead.`);return o[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class oc{constructor(e,n){this.type=Et,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,Ft),h=n.parse(e[2],2,Ft);return o&&h?_e(o.type,[Et,Ot,Ye,rr,Ft])?new oc(o,h):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${J(o.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!o)return!1;if(!ce(n,["boolean","string","number","null"]))throw new Ni(`Expected first argument to be of type boolean, string, number or null, but found ${J(sr(n))} instead.`);if(!ce(o,["string","array"]))throw new Ni(`Expected second argument to be of type array or string, but found ${J(sr(o))} instead.`);return o.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Qo{constructor(e,n,o){this.type=Ye,this.needle=e,this.haystack=n,this.fromIndex=o}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,Ft),h=n.parse(e[2],2,Ft);if(!o||!h)return null;if(!_e(o.type,[Et,Ot,Ye,rr,Ft]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${J(o.type)} instead`);if(e.length===4){const _=n.parse(e[3],3,Ye);return _?new Qo(o,h,_):null}return new Qo(o,h)}evaluate(e){const n=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!ce(n,["boolean","string","number","null"]))throw new Ni(`Expected first argument to be of type boolean, string, number or null, but found ${J(sr(n))} instead.`);if(!ce(o,["string","array"]))throw new Ni(`Expected second argument to be of type array or string, but found ${J(sr(o))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return o.indexOf(n,h)}return o.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class lc{constructor(e,n,o,h,_,y){this.inputType=e,this.type=n,this.input=o,this.cases=h,this.outputs=_,this.otherwise=y}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let o,h;n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);const _={},y=[];for(let I=2;I<e.length-1;I+=2){let P=e[I];const L=e[I+1];Array.isArray(P)||(P=[P]);const V=n.concat(I);if(P.length===0)return V.error("Expected at least one branch label.");for(const H of P){if(typeof H!="number"&&typeof H!="string")return V.error("Branch labels must be numbers or strings.");if(typeof H=="number"&&Math.abs(H)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof H=="number"&&Math.floor(H)!==H)return V.error("Numeric branch labels must be integer values.");if(o){if(V.checkSubtype(o,sr(H)))return null}else o=sr(H);if(_[String(H)]!==void 0)return V.error("Branch labels must be unique.");_[String(H)]=y.length}const $=n.parse(L,I,h);if(!$)return null;h=h||$.type,y.push($)}const b=n.parse(e[1],1,Ft);if(!b)return null;const S=n.parse(e[e.length-1],e.length-1,h);return S?b.type.kind!=="value"&&n.concat(1).checkSubtype(o,b.type)?null:new lc(o,h,b,_,y,S):null}evaluate(e){const n=this.input.evaluate(e);return(sr(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class cc{constructor(e,n,o){this.type=e,this.branches=n,this.otherwise=o}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let o;n.expectedType&&n.expectedType.kind!=="value"&&(o=n.expectedType);const h=[];for(let y=1;y<e.length-1;y+=2){const b=n.parse(e[y],y,Et);if(!b)return null;const S=n.parse(e[y+1],y+1,o);if(!S)return null;h.push([b,S]),o=o||S.type}const _=n.parse(e[e.length-1],e.length-1,o);if(!_)return null;if(!o)throw new Error("Can't infer output type");return new cc(o,h,_)}evaluate(e){for(const[n,o]of this.branches)if(n.evaluate(e))return o.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,o]of this.branches)e(n),e(o);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}}class el{constructor(e,n,o,h){this.type=e,this.input=n,this.beginIndex=o,this.endIndex=h}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,Ft),h=n.parse(e[2],2,Ye);if(!o||!h)return null;if(!_e(o.type,[G(Ft),Ot,Ft]))return n.error(`Expected first argument to be of type array or string, but found ${J(o.type)} instead`);if(e.length===4){const _=n.parse(e[3],3,Ye);return _?new el(o.type,o,h,_):null}return new el(o.type,o,h)}evaluate(e){const n=this.input.evaluate(e),o=this.beginIndex.evaluate(e);if(!ce(n,["string","array"]))throw new Ni(`Expected first argument to be of type array or string, but found ${J(sr(n))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return n.slice(o,h)}return n.slice(o)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Qu(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function eh(r,e,n,o){return o.compare(e,n)===0}function la(r,e,n){const o=r!=="=="&&r!=="!=";return class Tx{constructor(_,y,b){this.type=Et,this.lhs=_,this.rhs=y,this.collator=b,this.hasUntypedArgument=_.type.kind==="value"||y.type.kind==="value"}static parse(_,y){if(_.length!==3&&_.length!==4)return y.error("Expected two or three arguments.");const b=_[0];let S=y.parse(_[1],1,Ft);if(!S)return null;if(!Qu(b,S.type))return y.concat(1).error(`"${b}" comparisons are not supported for type '${J(S.type)}'.`);let I=y.parse(_[2],2,Ft);if(!I)return null;if(!Qu(b,I.type))return y.concat(2).error(`"${b}" comparisons are not supported for type '${J(I.type)}'.`);if(S.type.kind!==I.type.kind&&S.type.kind!=="value"&&I.type.kind!=="value")return y.error(`Cannot compare types '${J(S.type)}' and '${J(I.type)}'.`);o&&(S.type.kind==="value"&&I.type.kind!=="value"?S=new _n(I.type,[S]):S.type.kind!=="value"&&I.type.kind==="value"&&(I=new _n(S.type,[I])));let P=null;if(_.length===4){if(S.type.kind!=="string"&&I.type.kind!=="string"&&S.type.kind!=="value"&&I.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(P=y.parse(_[3],3,ks),!P)return null}return new Tx(S,I,P)}evaluate(_){const y=this.lhs.evaluate(_),b=this.rhs.evaluate(_);if(o&&this.hasUntypedArgument){const S=sr(y),I=sr(b);if(S.kind!==I.kind||S.kind!=="string"&&S.kind!=="number")throw new Ni(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${S.kind}, ${I.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const S=sr(y),I=sr(b);if(S.kind!=="string"||I.kind!=="string")return e(_,y,b)}return this.collator?n(_,y,b,this.collator.evaluate(_)):e(_,y,b)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const cf=la("==",function(r,e,n){return e===n},eh),uf=la("!=",function(r,e,n){return e!==n},function(r,e,n,o){return!eh(0,e,n,o)}),hf=la("<",function(r,e,n){return e<n},function(r,e,n,o){return o.compare(e,n)<0}),df=la(">",function(r,e,n){return e>n},function(r,e,n,o){return o.compare(e,n)>0}),ff=la("<=",function(r,e,n){return e<=n},function(r,e,n,o){return o.compare(e,n)<=0}),pf=la(">=",function(r,e,n){return e>=n},function(r,e,n,o){return o.compare(e,n)>=0});class uc{constructor(e,n,o,h,_){this.type=Ot,this.number=e,this.locale=n,this.currency=o,this.minFractionDigits=h,this.maxFractionDigits=_}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const o=n.parse(e[1],1,Ye);if(!o)return null;const h=e[2];if(typeof h!="object"||Array.isArray(h))return n.error("NumberFormat options argument must be an object.");let _=null;if(h.locale&&(_=n.parse(h.locale,1,Ot),!_))return null;let y=null;if(h.currency&&(y=n.parse(h.currency,1,Ot),!y))return null;let b=null;if(h["min-fraction-digits"]&&(b=n.parse(h["min-fraction-digits"],1,Ye),!b))return null;let S=null;return h["max-fraction-digits"]&&(S=n.parse(h["max-fraction-digits"],1,Ye),!S)?null:new uc(o,_,y,b,S)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class tl{constructor(e){this.type=or,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const o=e[1];if(!Array.isArray(o)&&typeof o=="object")return n.error("First argument must be an image or text section.");const h=[];let _=!1;for(let y=1;y<=e.length-1;++y){const b=e[y];if(_&&typeof b=="object"&&!Array.isArray(b)){_=!1;let S=null;if(b["font-scale"]&&(S=n.parse(b["font-scale"],1,Ye),!S))return null;let I=null;if(b["text-font"]&&(I=n.parse(b["text-font"],1,G(Ot)),!I))return null;let P=null;if(b["text-color"]&&(P=n.parse(b["text-color"],1,gi),!P))return null;const L=h[h.length-1];L.scale=S,L.font=I,L.textColor=P}else{const S=n.parse(e[y],1,Ft);if(!S)return null;const I=S.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,h.push({content:S,scale:null,font:null,textColor:null})}}return new tl(h)}evaluate(e){return new gn(this.sections.map(n=>{const o=n.content.evaluate(e);return sr(o)===N?new sc("",o,null,null,null):new sc(Xa(o),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}}class hc{constructor(e){this.type=N,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const o=n.parse(e[1],1,Ot);return o?new hc(o):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),o=An.fromString(n);return o&&e.availableImages&&(o.available=e.availableImages.indexOf(n)>-1),o}eachChild(e){e(this.input)}outputDefined(){return!1}}class dc{constructor(e){this.type=Ye,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const o=n.parse(e[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${J(o.type)} instead.`):new dc(o):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new Ni(`Expected value to be of type string or array, but found ${J(sr(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const ca={"==":cf,"!=":uf,">":df,"<":hf,">=":pf,"<=":ff,array:_n,at:ac,boolean:_n,case:cc,coalesce:Xo,collator:oa,format:tl,image:hc,in:oc,"index-of":Qo,interpolate:kr,"interpolate-hcl":kr,"interpolate-lab":kr,length:dc,let:Jo,literal:fs,match:lc,number:_n,"number-format":uc,object:_n,slice:el,step:no,string:_n,"to-boolean":Zn,"to-color":Zn,"to-number":Zn,"to-string":Zn,var:Zo,within:Ls};function th(r,[e,n,o,h]){e=e.evaluate(r),n=n.evaluate(r),o=o.evaluate(r);const _=h?h.evaluate(r):1,y=aa(e,n,o,_);if(y)throw new Ni(y);return new vi(e/255,n/255,o/255,_,!1)}function ih(r,e){return r in e}function fc(r,e){const n=e[r];return n===void 0?null:n}function Ds(r){return{type:r}}function rh(r){return{result:"success",value:r}}function ua(r){return{result:"error",value:r}}function ha(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function nh(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function pc(r){return!!r.expression&&r.expression.interpolated}function ni(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function il(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function mf(r){return r}function sh(r,e){const n=e.type==="color",o=r.stops&&typeof r.stops[0][0]=="object",h=o||!(o||r.property!==void 0),_=r.type||(pc(e)?"exponential":"interval");if(n||e.type==="padding"){const P=n?vi.parse:sn.parse;(r=oi({},r)).stops&&(r.stops=r.stops.map(L=>[L[0],P(L[1])])),r.default=P(r.default?r.default:e.default)}if(r.colorSpace&&(y=r.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var y;let b,S,I;if(_==="exponential")b=ri;else if(_==="interval")b=gf;else if(_==="categorical"){b=Xi,S=Object.create(null);for(const P of r.stops)S[P[0]]=P[1];I=typeof r.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);b=mc}if(o){const P={},L=[];for(let H=0;H<r.stops.length;H++){const q=r.stops[H],te=q[0].zoom;P[te]===void 0&&(P[te]={zoom:te,type:r.type,property:r.property,default:r.default,stops:[]},L.push(te)),P[te].stops.push([q[0].value,q[1]])}const V=[];for(const H of L)V.push([P[H].zoom,sh(P[H],e)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:kr.interpolationFactor.bind(void 0,$),zoomStops:V.map(H=>H[0]),evaluate:({zoom:H},q)=>ri({stops:V,base:r.base},e,H).evaluate(H,q)}}if(h){const P=_==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:kr.interpolationFactor.bind(void 0,P),zoomStops:r.stops.map(L=>L[0]),evaluate:({zoom:L})=>b(r,e,L,S,I)}}return{kind:"source",evaluate(P,L){const V=L&&L.properties?L.properties[r.property]:void 0;return V===void 0?so(r.default,e.default):b(r,e,V,S,I)}}}function so(r,e,n){return r!==void 0?r:e!==void 0?e:n!==void 0?n:void 0}function Xi(r,e,n,o,h){return so(typeof n===h?o[n]:void 0,r.default,e.default)}function gf(r,e,n){if(ni(n)!=="number")return so(r.default,e.default);const o=r.stops.length;if(o===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[o-1][0])return r.stops[o-1][1];const h=ro(r.stops.map(_=>_[0]),n);return r.stops[h][1]}function ri(r,e,n){const o=r.base!==void 0?r.base:1;if(ni(n)!=="number")return so(r.default,e.default);const h=r.stops.length;if(h===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[h-1][0])return r.stops[h-1][1];const _=ro(r.stops.map(P=>P[0]),n),y=function(P,L,V,$){const H=$-V,q=P-V;return H===0?0:L===1?q/H:(Math.pow(L,q)-1)/(Math.pow(L,H)-1)}(n,o,r.stops[_][0],r.stops[_+1][0]),b=r.stops[_][1],S=r.stops[_+1][1],I=Ur[e.type]||mf;return typeof b.evaluate=="function"?{evaluate(...P){const L=b.evaluate.apply(void 0,P),V=S.evaluate.apply(void 0,P);if(L!==void 0&&V!==void 0)return I(L,V,y,r.colorSpace)}}:I(b,S,y,r.colorSpace)}function mc(r,e,n){switch(e.type){case"color":n=vi.parse(n);break;case"formatted":n=gn.fromString(n.toString());break;case"resolvedImage":n=An.fromString(n.toString());break;case"padding":n=sn.parse(n);break;default:ni(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0)}return so(n,r.default,e.default)}yn.register(ca,{error:[{kind:"error"},[Ot],(r,[e])=>{throw new Ni(e.evaluate(r))}],typeof:[Ot,[Ft],(r,[e])=>J(sr(e.evaluate(r)))],"to-rgba":[G(Ye,4),[gi],(r,[e])=>{const[n,o,h,_]=e.evaluate(r).rgb;return[255*n,255*o,255*h,_]}],rgb:[gi,[Ye,Ye,Ye],th],rgba:[gi,[Ye,Ye,Ye,Ye],th],has:{type:Et,overloads:[[[Ot],(r,[e])=>ih(e.evaluate(r),r.properties())],[[Ot,mn],(r,[e,n])=>ih(e.evaluate(r),n.evaluate(r))]]},get:{type:Ft,overloads:[[[Ot],(r,[e])=>fc(e.evaluate(r),r.properties())],[[Ot,mn],(r,[e,n])=>fc(e.evaluate(r),n.evaluate(r))]]},"feature-state":[Ft,[Ot],(r,[e])=>fc(e.evaluate(r),r.featureState||{})],properties:[mn,[],r=>r.properties()],"geometry-type":[Ot,[],r=>r.geometryType()],id:[Ft,[],r=>r.id()],zoom:[Ye,[],r=>r.globals.zoom],"heatmap-density":[Ye,[],r=>r.globals.heatmapDensity||0],"line-progress":[Ye,[],r=>r.globals.lineProgress||0],accumulated:[Ft,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Ye,Ds(Ye),(r,e)=>{let n=0;for(const o of e)n+=o.evaluate(r);return n}],"*":[Ye,Ds(Ye),(r,e)=>{let n=1;for(const o of e)n*=o.evaluate(r);return n}],"-":{type:Ye,overloads:[[[Ye,Ye],(r,[e,n])=>e.evaluate(r)-n.evaluate(r)],[[Ye],(r,[e])=>-e.evaluate(r)]]},"/":[Ye,[Ye,Ye],(r,[e,n])=>e.evaluate(r)/n.evaluate(r)],"%":[Ye,[Ye,Ye],(r,[e,n])=>e.evaluate(r)%n.evaluate(r)],ln2:[Ye,[],()=>Math.LN2],pi:[Ye,[],()=>Math.PI],e:[Ye,[],()=>Math.E],"^":[Ye,[Ye,Ye],(r,[e,n])=>Math.pow(e.evaluate(r),n.evaluate(r))],sqrt:[Ye,[Ye],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[Ye,[Ye],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[Ye,[Ye],(r,[e])=>Math.log(e.evaluate(r))],log2:[Ye,[Ye],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[Ye,[Ye],(r,[e])=>Math.sin(e.evaluate(r))],cos:[Ye,[Ye],(r,[e])=>Math.cos(e.evaluate(r))],tan:[Ye,[Ye],(r,[e])=>Math.tan(e.evaluate(r))],asin:[Ye,[Ye],(r,[e])=>Math.asin(e.evaluate(r))],acos:[Ye,[Ye],(r,[e])=>Math.acos(e.evaluate(r))],atan:[Ye,[Ye],(r,[e])=>Math.atan(e.evaluate(r))],min:[Ye,Ds(Ye),(r,e)=>Math.min(...e.map(n=>n.evaluate(r)))],max:[Ye,Ds(Ye),(r,e)=>Math.max(...e.map(n=>n.evaluate(r)))],abs:[Ye,[Ye],(r,[e])=>Math.abs(e.evaluate(r))],round:[Ye,[Ye],(r,[e])=>{const n=e.evaluate(r);return n<0?-Math.round(-n):Math.round(n)}],floor:[Ye,[Ye],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[Ye,[Ye],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[Et,[Ot,Ft],(r,[e,n])=>r.properties()[e.value]===n.value],"filter-id-==":[Et,[Ft],(r,[e])=>r.id()===e.value],"filter-type-==":[Et,[Ot],(r,[e])=>r.geometryType()===e.value],"filter-<":[Et,[Ot,Ft],(r,[e,n])=>{const o=r.properties()[e.value],h=n.value;return typeof o==typeof h&&o<h}],"filter-id-<":[Et,[Ft],(r,[e])=>{const n=r.id(),o=e.value;return typeof n==typeof o&&n<o}],"filter->":[Et,[Ot,Ft],(r,[e,n])=>{const o=r.properties()[e.value],h=n.value;return typeof o==typeof h&&o>h}],"filter-id->":[Et,[Ft],(r,[e])=>{const n=r.id(),o=e.value;return typeof n==typeof o&&n>o}],"filter-<=":[Et,[Ot,Ft],(r,[e,n])=>{const o=r.properties()[e.value],h=n.value;return typeof o==typeof h&&o<=h}],"filter-id-<=":[Et,[Ft],(r,[e])=>{const n=r.id(),o=e.value;return typeof n==typeof o&&n<=o}],"filter->=":[Et,[Ot,Ft],(r,[e,n])=>{const o=r.properties()[e.value],h=n.value;return typeof o==typeof h&&o>=h}],"filter-id->=":[Et,[Ft],(r,[e])=>{const n=r.id(),o=e.value;return typeof n==typeof o&&n>=o}],"filter-has":[Et,[Ft],(r,[e])=>e.value in r.properties()],"filter-has-id":[Et,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Et,[G(Ot)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[Et,[G(Ft)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[Et,[Ot,G(Ft)],(r,[e,n])=>n.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[Et,[Ot,G(Ft)],(r,[e,n])=>function(o,h,_,y){for(;_<=y;){const b=_+y>>1;if(h[b]===o)return!0;h[b]>o?y=b-1:_=b+1}return!1}(r.properties()[e.value],n.value,0,n.value.length-1)],all:{type:Et,overloads:[[[Et,Et],(r,[e,n])=>e.evaluate(r)&&n.evaluate(r)],[Ds(Et),(r,e)=>{for(const n of e)if(!n.evaluate(r))return!1;return!0}]]},any:{type:Et,overloads:[[[Et,Et],(r,[e,n])=>e.evaluate(r)||n.evaluate(r)],[Ds(Et),(r,e)=>{for(const n of e)if(n.evaluate(r))return!0;return!1}]]},"!":[Et,[Et],(r,[e])=>!e.evaluate(r)],"is-supported-script":[Et,[Ot],(r,[e])=>{const n=r.globals&&r.globals.isSupportedScript;return!n||n(e.evaluate(r))}],upcase:[Ot,[Ot],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[Ot,[Ot],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[Ot,Ds(Ft),(r,e)=>e.map(n=>Xa(n.evaluate(r))).join("")],"resolved-locale":[Ot,[ks],(r,[e])=>e.evaluate(r).resolvedLocale()]});class Mi{constructor(e,n){var o;this.expression=e,this._warningHistory={},this._evaluator=new xi,this._defaultValue=n?(o=n).type==="color"&&il(o.default)?new vi(0,0,0,0):o.type==="color"?vi.parse(o.default)||null:o.type==="padding"?sn.parse(o.default)||null:o.type==="variableAnchorOffsetCollection"?In.parse(o.default)||null:o.default===void 0?null:o.default:null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,o,h,_,y){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=o,this._evaluator.canonical=h,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(e,n,o,h,_,y){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=o||null,this._evaluator.canonical=h,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Ni(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function Ti(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in ca}function zs(r,e){const n=new jo(ca,eo,[],e?function(h){const _={color:gi,string:Ot,number:Ye,enum:Ot,boolean:Et,formatted:or,padding:ie,resolvedImage:N,variableAnchorOffsetCollection:U};return h.type==="array"?G(_[h.value]||Ft,h.length):_[h.type]}(e):void 0),o=n.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return o?rh(new Mi(o,e)):ua(n.errors)}class rl{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!to(n.expression)}evaluateWithoutErrorHandling(e,n,o,h,_,y){return this._styleExpression.evaluateWithoutErrorHandling(e,n,o,h,_,y)}evaluate(e,n,o,h,_,y){return this._styleExpression.evaluate(e,n,o,h,_,y)}}class gc{constructor(e,n,o,h){this.kind=e,this.zoomStops=o,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!to(n.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,n,o,h,_,y){return this._styleExpression.evaluateWithoutErrorHandling(e,n,o,h,_,y)}evaluate(e,n,o,h,_,y){return this._styleExpression.evaluate(e,n,o,h,_,y)}interpolationFactor(e,n,o){return this.interpolationType?kr.interpolationFactor(this.interpolationType,e,n,o):0}}function ah(r,e){const n=zs(r,e);if(n.result==="error")return n;const o=n.value.expression,h=Ko(o);if(!h&&!ha(e))return ua([new fi("","data expressions not supported")]);const _=io(o,["zoom"]);if(!_&&!nh(e))return ua([new fi("","zoom expressions not supported")]);const y=sl(o);return y||_?y instanceof fi?ua([y]):y instanceof kr&&!pc(e)?ua([new fi("",'"interpolate" expressions cannot be used with this property')]):rh(y?new gc(h?"camera":"composite",n.value,y.labels,y instanceof kr?y.interpolation:void 0):new rl(h?"constant":"source",n.value)):ua([new fi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class nl{constructor(e,n){this._parameters=e,this._specification=n,oi(this,sh(this._parameters,this._specification))}static deserialize(e){return new nl(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function sl(r){let e=null;if(r instanceof Jo)e=sl(r.result);else if(r instanceof Xo){for(const n of r.args)if(e=sl(n),e)break}else(r instanceof no||r instanceof kr)&&r.input instanceof yn&&r.input.name==="zoom"&&(e=r);return e instanceof fi||r.eachChild(n=>{const o=sl(n);o instanceof fi?e=o:!e&&o?e=new fi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&o&&e!==o&&(e=new fi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function al(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!al(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const oh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ol(r){if(r==null)return{filter:()=>!0,needGeometry:!1};al(r)||(r=cl(r));const e=zs(r,oh);if(e.result==="error")throw new Error(e.value.map(n=>`${n.key}: ${n.message}`).join(", "));return{filter:(n,o,h)=>e.value.evaluate(n,o,{},h),needGeometry:ll(r)}}function lh(r,e){return r<e?-1:r>e?1:0}function ll(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let e=1;e<r.length;e++)if(ll(r[e]))return!0;return!1}function cl(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?_c(r[1],r[2],"=="):e==="!="?ul(_c(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?_c(r[1],r[2],e):e==="any"?(n=r.slice(1),["any"].concat(n.map(cl))):e==="all"?["all"].concat(r.slice(1).map(cl)):e==="none"?["all"].concat(r.slice(1).map(cl).map(ul)):e==="in"?ch(r[1],r.slice(2)):e==="!in"?ul(ch(r[1],r.slice(2))):e==="has"?uh(r[1]):e==="!has"?ul(uh(r[1])):e!=="within"||r;var n}function _c(r,e,n){switch(r){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,r,e]}}function ch(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",r,["literal",e.sort(lh)]]:["filter-in-small",r,["literal",e]]}}function uh(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function ul(r){return["!",r]}function yc(r){const e=typeof r;if(e==="number"||e==="boolean"||e==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let h="[";for(const _ of r)h+=`${yc(_)},`;return`${h}]`}const n=Object.keys(r).sort();let o="{";for(let h=0;h<n.length;h++)o+=`${JSON.stringify(n[h])}:${yc(r[n[h]])},`;return`${o}}`}function _f(r){let e="";for(const n of Be)e+=`/${yc(r[n])}`;return e}function hh(r){const e=r.value;return e?[new Oe(r.key,e,"constants have been deprecated as of v8")]:[]}function ji(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function ms(r){if(Array.isArray(r))return r.map(ms);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const n in r)e[n]=ms(r[n]);return e}return ji(r)}function $r(r){const e=r.key,n=r.value,o=r.valueSpec||{},h=r.objectElementValidators||{},_=r.style,y=r.styleSpec,b=r.validateSpec;let S=[];const I=ni(n);if(I!=="object")return[new Oe(e,n,`object expected, ${I} found`)];for(const P in n){const L=P.split(".")[0],V=o[L]||o["*"];let $;if(h[L])$=h[L];else if(o[L])$=b;else if(h["*"])$=h["*"];else{if(!o["*"]){S.push(new Oe(e,n[P],`unknown property "${P}"`));continue}$=b}S=S.concat($({key:(e&&`${e}.`)+P,value:n[P],valueSpec:V,style:_,styleSpec:y,object:n,objectKey:P,validateSpec:b},n))}for(const P in o)h[P]||o[P].required&&o[P].default===void 0&&n[P]===void 0&&S.push(new Oe(e,n,`missing required property "${P}"`));return S}function vc(r){const e=r.value,n=r.valueSpec,o=r.style,h=r.styleSpec,_=r.key,y=r.arrayElementValidator||r.validateSpec;if(ni(e)!=="array")return[new Oe(_,e,`array expected, ${ni(e)} found`)];if(n.length&&e.length!==n.length)return[new Oe(_,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new Oe(_,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let b={type:n.value,values:n.values};h.$version<7&&(b.function=n.function),ni(n.value)==="object"&&(b=n.value);let S=[];for(let I=0;I<e.length;I++)S=S.concat(y({array:e,arrayIndex:I,value:e[I],valueSpec:b,validateSpec:r.validateSpec,style:o,styleSpec:h,key:`${_}[${I}]`}));return S}function hl(r){const e=r.key,n=r.value,o=r.valueSpec;let h=ni(n);return h==="number"&&n!=n&&(h="NaN"),h!=="number"?[new Oe(e,n,`number expected, ${h} found`)]:"minimum"in o&&n<o.minimum?[new Oe(e,n,`${n} is less than the minimum value ${o.minimum}`)]:"maximum"in o&&n>o.maximum?[new Oe(e,n,`${n} is greater than the maximum value ${o.maximum}`)]:[]}function dh(r){const e=r.valueSpec,n=ji(r.value.type);let o,h,_,y={};const b=n!=="categorical"&&r.value.property===void 0,S=!b,I=ni(r.value.stops)==="array"&&ni(r.value.stops[0])==="array"&&ni(r.value.stops[0][0])==="object",P=$r({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function($){if(n==="identity")return[new Oe($.key,$.value,'identity function may not have a "stops" property')];let H=[];const q=$.value;return H=H.concat(vc({key:$.key,value:q,valueSpec:$.valueSpec,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:L})),ni(q)==="array"&&q.length===0&&H.push(new Oe($.key,q,"array must have at least one stop")),H},default:function($){return $.validateSpec({key:$.key,value:$.value,valueSpec:e,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec})}}});return n==="identity"&&b&&P.push(new Oe(r.key,r.value,'missing required property "property"')),n==="identity"||r.value.stops||P.push(new Oe(r.key,r.value,'missing required property "stops"')),n==="exponential"&&r.valueSpec.expression&&!pc(r.valueSpec)&&P.push(new Oe(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(S&&!ha(r.valueSpec)?P.push(new Oe(r.key,r.value,"property functions not supported")):b&&!nh(r.valueSpec)&&P.push(new Oe(r.key,r.value,"zoom functions not supported"))),n!=="categorical"&&!I||r.value.property!==void 0||P.push(new Oe(r.key,r.value,'"property" property is required')),P;function L($){let H=[];const q=$.value,te=$.key;if(ni(q)!=="array")return[new Oe(te,q,`array expected, ${ni(q)} found`)];if(q.length!==2)return[new Oe(te,q,`array length 2 expected, length ${q.length} found`)];if(I){if(ni(q[0])!=="object")return[new Oe(te,q,`object expected, ${ni(q[0])} found`)];if(q[0].zoom===void 0)return[new Oe(te,q,"object stop key must have zoom")];if(q[0].value===void 0)return[new Oe(te,q,"object stop key must have value")];if(_&&_>ji(q[0].zoom))return[new Oe(te,q[0].zoom,"stop zoom values must appear in ascending order")];ji(q[0].zoom)!==_&&(_=ji(q[0].zoom),h=void 0,y={}),H=H.concat($r({key:`${te}[0]`,value:q[0],valueSpec:{zoom:{}},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:hl,value:V}}))}else H=H.concat(V({key:`${te}[0]`,value:q[0],valueSpec:{},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec},q));return Ti(ms(q[1]))?H.concat([new Oe(`${te}[1]`,q[1],"expressions are not allowed in function stops.")]):H.concat($.validateSpec({key:`${te}[1]`,value:q[1],valueSpec:e,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec}))}function V($,H){const q=ni($.value),te=ji($.value),oe=$.value!==null?$.value:H;if(o){if(q!==o)return[new Oe($.key,oe,`${q} stop domain type must match previous stop domain type ${o}`)]}else o=q;if(q!=="number"&&q!=="string"&&q!=="boolean")return[new Oe($.key,oe,"stop domain value must be a number, string, or boolean")];if(q!=="number"&&n!=="categorical"){let ve=`number expected, ${q} found`;return ha(e)&&n===void 0&&(ve+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Oe($.key,oe,ve)]}return n!=="categorical"||q!=="number"||isFinite(te)&&Math.floor(te)===te?n!=="categorical"&&q==="number"&&h!==void 0&&te<h?[new Oe($.key,oe,"stop domain values must appear in ascending order")]:(h=te,n==="categorical"&&te in y?[new Oe($.key,oe,"stop domain values must be unique")]:(y[te]=!0,[])):[new Oe($.key,oe,`integer expected, found ${te}`)]}}function gs(r){const e=(r.expressionContext==="property"?ah:zs)(ms(r.value),r.valueSpec);if(e.result==="error")return e.value.map(o=>new Oe(`${r.key}${o.key}`,r.value,o.message));const n=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!n.outputDefined())return[new Oe(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!to(n))return[new Oe(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!to(n))return[new Oe(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!io(n,["zoom","feature-state"]))return[new Oe(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Ko(n))return[new Oe(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function _s(r){const e=r.key,n=r.value,o=r.valueSpec,h=[];return Array.isArray(o.values)?o.values.indexOf(ji(n))===-1&&h.push(new Oe(e,n,`expected one of [${o.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(o.values).indexOf(ji(n))===-1&&h.push(new Oe(e,n,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(n)} found`)),h}function da(r){return al(ms(r.value))?gs(oi({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):dl(r)}function dl(r){const e=r.value,n=r.key;if(ni(e)!=="array")return[new Oe(n,e,`array expected, ${ni(e)} found`)];const o=r.styleSpec;let h,_=[];if(e.length<1)return[new Oe(n,e,"filter array must have at least 1 element")];switch(_=_.concat(_s({key:`${n}[0]`,value:e[0],valueSpec:o.filter_operator,style:r.style,styleSpec:r.styleSpec})),ji(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&ji(e[1])==="$type"&&_.push(new Oe(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&_.push(new Oe(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=ni(e[1]),h!=="string"&&_.push(new Oe(`${n}[1]`,e[1],`string expected, ${h} found`)));for(let y=2;y<e.length;y++)h=ni(e[y]),ji(e[1])==="$type"?_=_.concat(_s({key:`${n}[${y}]`,value:e[y],valueSpec:o.geometry_type,style:r.style,styleSpec:r.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&_.push(new Oe(`${n}[${y}]`,e[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)_=_.concat(dl({key:`${n}[${y}]`,value:e[y],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":h=ni(e[1]),e.length!==2?_.push(new Oe(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="string"&&_.push(new Oe(`${n}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=ni(e[1]),e.length!==2?_.push(new Oe(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="object"&&_.push(new Oe(`${n}[1]`,e[1],`object expected, ${h} found`))}return _}function xc(r,e){const n=r.key,o=r.validateSpec,h=r.style,_=r.styleSpec,y=r.value,b=r.objectKey,S=_[`${e}_${r.layerType}`];if(!S)return[];const I=b.match(/^(.*)-transition$/);if(e==="paint"&&I&&S[I[1]]&&S[I[1]].transition)return o({key:n,value:y,valueSpec:_.transition,style:h,styleSpec:_});const P=r.valueSpec||S[b];if(!P)return[new Oe(n,y,`unknown property "${b}"`)];let L;if(ni(y)==="string"&&ha(P)&&!P.tokens&&(L=/^{([^}]+)}$/.exec(y)))return[new Oe(n,y,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const V=[];return r.layerType==="symbol"&&(b==="text-field"&&h&&!h.glyphs&&V.push(new Oe(n,y,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&il(ms(y))&&ji(y.type)==="identity"&&V.push(new Oe(n,y,'"text-font" does not support identity functions'))),V.concat(o({key:r.key,value:y,valueSpec:P,style:h,styleSpec:_,expressionContext:"property",propertyType:e,propertyKey:b}))}function bc(r){return xc(r,"paint")}function ao(r){return xc(r,"layout")}function fh(r){let e=[];const n=r.value,o=r.key,h=r.style,_=r.styleSpec;n.type||n.ref||e.push(new Oe(o,n,'either "type" or "ref" is required'));let y=ji(n.type);const b=ji(n.ref);if(n.id){const S=ji(n.id);for(let I=0;I<r.arrayIndex;I++){const P=h.layers[I];ji(P.id)===S&&e.push(new Oe(o,n.id,`duplicate layer id "${n.id}", previously used at line ${P.id.__line__}`))}}if("ref"in n){let S;["type","source","source-layer","filter","layout"].forEach(I=>{I in n&&e.push(new Oe(o,n[I],`"${I}" is prohibited for ref layers`))}),h.layers.forEach(I=>{ji(I.id)===b&&(S=I)}),S?S.ref?e.push(new Oe(o,n.ref,"ref cannot reference another ref layer")):y=ji(S.type):e.push(new Oe(o,n.ref,`ref layer "${b}" not found`))}else if(y!=="background")if(n.source){const S=h.sources&&h.sources[n.source],I=S&&ji(S.type);S?I==="vector"&&y==="raster"?e.push(new Oe(o,n.source,`layer "${n.id}" requires a raster source`)):I!=="raster-dem"&&y==="hillshade"?e.push(new Oe(o,n.source,`layer "${n.id}" requires a raster-dem source`)):I==="raster"&&y!=="raster"?e.push(new Oe(o,n.source,`layer "${n.id}" requires a vector source`)):I!=="vector"||n["source-layer"]?I==="raster-dem"&&y!=="hillshade"?e.push(new Oe(o,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!n.paint||!n.paint["line-gradient"]||I==="geojson"&&S.lineMetrics||e.push(new Oe(o,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Oe(o,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new Oe(o,n.source,`source "${n.source}" not found`))}else e.push(new Oe(o,n,'missing required property "source"'));return e=e.concat($r({key:o,value:n,valueSpec:_.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${o}.type`,value:n.type,valueSpec:_.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:n,objectKey:"type"}),filter:da,layout:S=>$r({layer:n,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":I=>ao(oi({layerType:y},I))}}),paint:S=>$r({layer:n,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":I=>bc(oi({layerType:y},I))}})}})),e}function Os(r){const e=r.value,n=r.key,o=ni(e);return o!=="string"?[new Oe(n,e,`string expected, ${o} found`)]:[]}const ph={promoteId:function({key:r,value:e}){if(ni(e)==="string")return Os({key:r,value:e});{const n=[];for(const o in e)n.push(...Os({key:`${r}.${o}`,value:e[o]}));return n}}};function mh(r){const e=r.value,n=r.key,o=r.styleSpec,h=r.style,_=r.validateSpec;if(!e.type)return[new Oe(n,e,'"type" is required')];const y=ji(e.type);let b;switch(y){case"vector":case"raster":return b=$r({key:n,value:e,valueSpec:o[`source_${y.replace("-","_")}`],style:r.style,styleSpec:o,objectElementValidators:ph,validateSpec:_}),b;case"raster-dem":return b=function(S){var I;const P=(I=S.sourceName)!==null&&I!==void 0?I:"",L=S.value,V=S.styleSpec,$=V.source_raster_dem,H=S.style;let q=[];const te=ni(L);if(L===void 0)return q;if(te!=="object")return q.push(new Oe("source_raster_dem",L,`object expected, ${te} found`)),q;const oe=ji(L.encoding)==="custom",ve=["redFactor","greenFactor","blueFactor","baseShift"],le=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const pe in L)!oe&&ve.includes(pe)?q.push(new Oe(pe,L[pe],`In "${P}": "${pe}" is only valid when "encoding" is set to "custom". ${le} encoding found`)):$[pe]?q=q.concat(S.validateSpec({key:pe,value:L[pe],valueSpec:$[pe],validateSpec:S.validateSpec,style:H,styleSpec:V})):q.push(new Oe(pe,L[pe],`unknown property "${pe}"`));return q}({sourceName:n,value:e,style:r.style,styleSpec:o,validateSpec:_}),b;case"geojson":if(b=$r({key:n,value:e,valueSpec:o.source_geojson,style:h,styleSpec:o,validateSpec:_,objectElementValidators:ph}),e.cluster)for(const S in e.clusterProperties){const[I,P]=e.clusterProperties[S],L=typeof I=="string"?[I,["accumulated"],["get",S]]:I;b.push(...gs({key:`${n}.${S}.map`,value:P,validateSpec:_,expressionContext:"cluster-map"})),b.push(...gs({key:`${n}.${S}.reduce`,value:L,validateSpec:_,expressionContext:"cluster-reduce"}))}return b;case"video":return $r({key:n,value:e,valueSpec:o.source_video,style:h,validateSpec:_,styleSpec:o});case"image":return $r({key:n,value:e,valueSpec:o.source_image,style:h,validateSpec:_,styleSpec:o});case"canvas":return[new Oe(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _s({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,validateSpec:_,styleSpec:o})}}function gh(r){const e=r.value,n=r.styleSpec,o=n.light,h=r.style;let _=[];const y=ni(e);if(e===void 0)return _;if(y!=="object")return _=_.concat([new Oe("light",e,`object expected, ${y} found`)]),_;for(const b in e){const S=b.match(/^(.*)-transition$/);_=_.concat(S&&o[S[1]]&&o[S[1]].transition?r.validateSpec({key:b,value:e[b],valueSpec:n.transition,validateSpec:r.validateSpec,style:h,styleSpec:n}):o[b]?r.validateSpec({key:b,value:e[b],valueSpec:o[b],validateSpec:r.validateSpec,style:h,styleSpec:n}):[new Oe(b,e[b],`unknown property "${b}"`)])}return _}function oo(r){const e=r.value,n=r.styleSpec,o=n.sky,h=r.style,_=ni(e);if(e===void 0)return[];if(_!=="object")return[new Oe("sky",e,`object expected, ${_} found`)];let y=[];for(const b in e)y=y.concat(o[b]?Fs({key:b,value:e[b],valueSpec:o[b],style:h,styleSpec:n}):[new Oe(b,e[b],`unknown property "${b}"`)]);return y}function lo(r){const e=r.value,n=r.styleSpec,o=n.terrain,h=r.style;let _=[];const y=ni(e);if(e===void 0)return _;if(y!=="object")return _=_.concat([new Oe("terrain",e,`object expected, ${y} found`)]),_;for(const b in e)_=_.concat(o[b]?r.validateSpec({key:b,value:e[b],valueSpec:o[b],validateSpec:r.validateSpec,style:h,styleSpec:n}):[new Oe(b,e[b],`unknown property "${b}"`)]);return _}function an(r){let e=[];const n=r.value,o=r.key;if(Array.isArray(n)){const h=[],_=[];for(const y in n)n[y].id&&h.includes(n[y].id)&&e.push(new Oe(o,n,`all the sprites' ids must be unique, but ${n[y].id} is duplicated`)),h.push(n[y].id),n[y].url&&_.includes(n[y].url)&&e.push(new Oe(o,n,`all the sprites' URLs must be unique, but ${n[y].url} is duplicated`)),_.push(n[y].url),e=e.concat($r({key:`${o}[${y}]`,value:n[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return e}return Os({key:o,value:n})}const fa={"*":()=>[],array:vc,boolean:function(r){const e=r.value,n=r.key,o=ni(e);return o!=="boolean"?[new Oe(n,e,`boolean expected, ${o} found`)]:[]},number:hl,color:function(r){const e=r.key,n=r.value,o=ni(n);return o!=="string"?[new Oe(e,n,`color expected, ${o} found`)]:vi.parse(String(n))?[]:[new Oe(e,n,`color expected, "${n}" found`)]},constants:hh,enum:_s,filter:da,function:dh,layer:fh,object:$r,source:mh,light:gh,sky:oo,terrain:lo,string:Os,formatted:function(r){return Os(r).length===0?[]:gs(r)},resolvedImage:function(r){return Os(r).length===0?[]:gs(r)},padding:function(r){const e=r.key,n=r.value;if(ni(n)==="array"){if(n.length<1||n.length>4)return[new Oe(e,n,`padding requires 1 to 4 values; ${n.length} values found`)];const o={type:"number"};let h=[];for(let _=0;_<n.length;_++)h=h.concat(r.validateSpec({key:`${e}[${_}]`,value:n[_],validateSpec:r.validateSpec,valueSpec:o}));return h}return hl({key:e,value:n,valueSpec:{}})},variableAnchorOffsetCollection:function(r){const e=r.key,n=r.value,o=ni(n),h=r.styleSpec;if(o!=="array"||n.length<1||n.length%2!=0)return[new Oe(e,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let y=0;y<n.length;y+=2)_=_.concat(_s({key:`${e}[${y}]`,value:n[y],valueSpec:h.layout_symbol["text-anchor"]})),_=_.concat(vc({key:`${e}[${y+1}]`,value:n[y+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:h}));return _},sprite:an};function Fs(r){const e=r.value,n=r.valueSpec,o=r.styleSpec;return r.validateSpec=Fs,n.expression&&il(ji(e))?dh(r):n.expression&&Ti(ms(e))?gs(r):n.type&&fa[n.type]?fa[n.type](r):$r(oi({},r,{valueSpec:n.type?o[n.type]:n}))}function _h(r){const e=r.value,n=r.key,o=Os(r);return o.length||(e.indexOf("{fontstack}")===-1&&o.push(new Oe(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&o.push(new Oe(n,e,'"glyphs" url must include a "{range}" token'))),o}function zn(r,e=K){let n=[];return n=n.concat(Fs({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,validateSpec:Fs,objectElementValidators:{glyphs:_h,"*":()=>[]}})),r.constants&&(n=n.concat(hh({key:"constants",value:r.constants,style:r,styleSpec:e,validateSpec:Fs}))),wc(n)}function on(r){return function(e){return r({...e,validateSpec:Fs})}}function wc(r){return[].concat(r).sort((e,n)=>e.line-n.line)}function Cn(r){return function(...e){return wc(r.apply(this,e))}}zn.source=Cn(on(mh)),zn.sprite=Cn(on(an)),zn.glyphs=Cn(on(_h)),zn.light=Cn(on(gh)),zn.sky=Cn(on(oo)),zn.terrain=Cn(on(lo)),zn.layer=Cn(on(fh)),zn.filter=Cn(on(da)),zn.paintProperty=Cn(on(bc)),zn.layoutProperty=Cn(on(ao));const co=zn,Sc=co.light,yf=co.paintProperty,uo=co.layoutProperty;function yh(r,e){let n=!1;if(e&&e.length)for(const o of e)r.fire(new Y(new Error(o.message))),n=!0;return n}class Bs{constructor(e,n,o){const h=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const y=new Int32Array(this.arrayBuffer);e=y[0],this.d=(n=y[1])+2*(o=y[2]);for(let S=0;S<this.d*this.d;S++){const I=y[3+S],P=y[3+S+1];h.push(I===P?null:y.subarray(I,P))}const b=y[3+h.length+1];this.keys=y.subarray(y[3+h.length],b),this.bboxes=y.subarray(b),this.insert=this._insertReadonly}else{this.d=n+2*o;for(let y=0;y<this.d*this.d;y++)h.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=e,this.padding=o,this.scale=n/e,this.uid=0;const _=o/n*e;this.min=-_,this.max=e+_}insert(e,n,o,h,_){this._forEachCell(n,o,h,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(n),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,n,o,h,_,y){this.cells[_].push(y)}query(e,n,o,h,_){const y=this.min,b=this.max;if(e<=y&&n<=y&&b<=o&&b<=h&&!_)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(e,n,o,h,this._queryCell,S,{},_),S}}_queryCell(e,n,o,h,_,y,b,S){const I=this.cells[_];if(I!==null){const P=this.keys,L=this.bboxes;for(let V=0;V<I.length;V++){const $=I[V];if(b[$]===void 0){const H=4*$;(S?S(L[H+0],L[H+1],L[H+2],L[H+3]):e<=L[H+2]&&n<=L[H+3]&&o>=L[H+0]&&h>=L[H+1])?(b[$]=!0,y.push(P[$])):b[$]=!1}}}}_forEachCell(e,n,o,h,_,y,b,S){const I=this._convertToCellCoord(e),P=this._convertToCellCoord(n),L=this._convertToCellCoord(o),V=this._convertToCellCoord(h);for(let $=I;$<=L;$++)for(let H=P;H<=V;H++){const q=this.d*H+$;if((!S||S(this._convertFromCellCoord($),this._convertFromCellCoord(H),this._convertFromCellCoord($+1),this._convertFromCellCoord(H+1)))&&_.call(this,e,n,o,h,q,y,b,S))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,n=3+this.cells.length+1+1;let o=0;for(let y=0;y<this.cells.length;y++)o+=this.cells[y].length;const h=new Int32Array(n+o+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let _=n;for(let y=0;y<e.length;y++){const b=e[y];h[3+y]=_,h.set(b,_),_+=b.length}return h[3+e.length]=_,h.set(this.keys,_),_+=this.keys.length,h[3+e.length+1]=_,h.set(this.bboxes,_),_+=this.bboxes.length,h.buffer}static serialize(e,n){const o=e.toArrayBuffer();return n&&n.push(o),{buffer:o}}static deserialize(e){return new Bs(e.buffer)}}const ts={};function ut(r,e,n={}){if(ts[r])throw new Error(`${r} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:r,writeable:!1}),ts[r]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}ut("Object",Object),ut("TransferableGridIndex",Bs),ut("Color",vi),ut("Error",Error),ut("AJAXError",nt),ut("ResolvedImage",An),ut("StylePropertyFunction",nl),ut("StyleExpression",Mi,{omit:["_evaluator"]}),ut("ZoomDependentExpression",gc),ut("ZoomConstantExpression",rl),ut("CompoundExpression",yn,{omit:["_evaluate"]});for(const r in ca)ca[r]._classRegistryKey||ut(`Expression_${r}`,ca[r]);function Tc(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function pa(r,e){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error)return r;if(Tc(r)||Dt(r))return e&&e.push(r),r;if(ArrayBuffer.isView(r)){const n=r;return e&&e.push(n.buffer),n}if(r instanceof ImageData)return e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const n=[];for(const o of r)n.push(pa(o,e));return n}if(typeof r=="object"){const n=r.constructor,o=n._classRegistryKey;if(!o)throw new Error(`can't serialize object of unregistered class ${n.name}`);if(!ts[o])throw new Error(`${o} is not registered.`);const h=n.serialize?n.serialize(r,e):{};if(n.serialize){if(e&&h===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in r){if(!r.hasOwnProperty(_)||ts[o].omit.indexOf(_)>=0)continue;const y=r[_];h[_]=ts[o].shallow.indexOf(_)>=0?y:pa(y,e)}r instanceof Error&&(h.message=r.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(h.$name=o),h}throw new Error("can't serialize object of type "+typeof r)}function ho(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||Tc(r)||Dt(r)||ArrayBuffer.isView(r)||r instanceof ImageData)return r;if(Array.isArray(r))return r.map(ho);if(typeof r=="object"){const e=r.$name||"Object";if(!ts[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:n}=ts[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(r);const o=Object.create(n.prototype);for(const h of Object.keys(r)){if(h==="$name")continue;const _=r[h];o[h]=ts[e].shallow.indexOf(h)>=0?_:ho(_)}return o}throw new Error("can't deserialize object of type "+typeof r)}class fl{constructor(){this.first=!0}update(e,n){const o=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=o,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=o,!0):(this.lastFloorZoom>o?(this.lastIntegerZoom=o+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<o&&(this.lastIntegerZoom=o,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=o,!0))}}const st={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function pl(r){for(const e of r)if(ml(e.charCodeAt(0)))return!0;return!1}function vh(r){for(const e of r)if(!xh(e.charCodeAt(0)))return!1;return!0}function xh(r){return!(st.Arabic(r)||st["Arabic Supplement"](r)||st["Arabic Extended-A"](r)||st["Arabic Presentation Forms-A"](r)||st["Arabic Presentation Forms-B"](r))}function ml(r){return!(r!==746&&r!==747&&(r<4352||!(st["Bopomofo Extended"](r)||st.Bopomofo(r)||st["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||st["CJK Compatibility Ideographs"](r)||st["CJK Compatibility"](r)||st["CJK Radicals Supplement"](r)||st["CJK Strokes"](r)||!(!st["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||st["CJK Unified Ideographs Extension A"](r)||st["CJK Unified Ideographs"](r)||st["Enclosed CJK Letters and Months"](r)||st["Hangul Compatibility Jamo"](r)||st["Hangul Jamo Extended-A"](r)||st["Hangul Jamo Extended-B"](r)||st["Hangul Jamo"](r)||st["Hangul Syllables"](r)||st.Hiragana(r)||st["Ideographic Description Characters"](r)||st.Kanbun(r)||st["Kangxi Radicals"](r)||st["Katakana Phonetic Extensions"](r)||st.Katakana(r)&&r!==12540||!(!st["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!st["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||st["Unified Canadian Aboriginal Syllabics"](r)||st["Unified Canadian Aboriginal Syllabics Extended"](r)||st["Vertical Forms"](r)||st["Yijing Hexagram Symbols"](r)||st["Yi Syllables"](r)||st["Yi Radicals"](r))))}function gl(r){return!(ml(r)||function(e){return!!(st["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||st["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||st["Letterlike Symbols"](e)||st["Number Forms"](e)||st["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||st["Control Pictures"](e)&&e!==9251||st["Optical Character Recognition"](e)||st["Enclosed Alphanumerics"](e)||st["Geometric Shapes"](e)||st["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||st["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||st["CJK Symbols and Punctuation"](e)||st.Katakana(e)||st["Private Use Area"](e)||st["CJK Compatibility Forms"](e)||st["Small Form Variants"](e)||st["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(r))}function Ec(r){return r>=1424&&r<=2303||st["Arabic Presentation Forms-A"](r)||st["Arabic Presentation Forms-B"](r)}function vf(r,e){return!(!e&&Ec(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||st.Khmer(r))}function bh(r){for(const e of r)if(Ec(e.charCodeAt(0)))return!0;return!1}const Ns=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}setMethods(r){this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class ki{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new fl,this.transition={})}isSupportedScript(e){return function(n,o){for(const h of n)if(!vf(h.charCodeAt(0),o))return!1;return!0}(e,Ns.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,n=e-Math.floor(e),o=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*o}:{fromScale:.5,toScale:1,t:1-(1-o)*n}}}class fo{constructor(e,n){this.property=e,this.value=n,this.expression=function(o,h){if(il(o))return new nl(o,h);if(Ti(o)){const _=ah(o,h);if(_.result==="error")throw new Error(_.value.map(y=>`${y.key}: ${y.message}`).join(", "));return _.value}{let _=o;return h.type==="color"&&typeof o=="string"?_=vi.parse(o):h.type!=="padding"||typeof o!="number"&&!Array.isArray(o)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(o)&&(_=In.parse(o)):_=sn.parse(o),{kind:"constant",evaluate:()=>_}}}(n===void 0?e.specification.default:n,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,o){return this.property.possiblyEvaluate(this,e,n,o)}}class _l{constructor(e){this.property=e,this.value=new fo(e,void 0)}transitioned(e,n){return new Sh(this.property,this.value,n,$e({},e.transition,this.transition),e.now)}untransitioned(){return new Sh(this.property,this.value,null,{},0)}}class wh{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return _t(this._values[e].value.value)}setValue(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new _l(this._values[e].property)),this._values[e].value=new fo(this._values[e].property,n===null?void 0:_t(n))}getTransition(e){return _t(this._values[e].transition)}setTransition(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new _l(this._values[e].property)),this._values[e].transition=_t(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(e[n]=o);const h=this.getTransition(n);h!==void 0&&(e[`${n}-transition`]=h)}return e}transitioned(e,n){const o=new Ic(this._properties);for(const h of Object.keys(this._values))o._values[h]=this._values[h].transitioned(e,n._values[h]);return o}untransitioned(){const e=new Ic(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class Sh{constructor(e,n,o,h,_){this.property=e,this.value=n,this.begin=_+h.delay||0,this.end=this.begin+h.duration||0,e.specification.transition&&(h.delay||h.duration)&&(this.prior=o)}possiblyEvaluate(e,n,o){const h=e.now||0,_=this.value.possiblyEvaluate(e,n,o),y=this.prior;if(y){if(h>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(h<this.begin)return y.possiblyEvaluate(e,n,o);{const b=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,n,o),_,function(S){if(S<=0)return 0;if(S>=1)return 1;const I=S*S,P=I*S;return 4*(S<.5?P:3*(S-I)+P-.75)}(b))}}return _}}class Ic{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,o){const h=new po(this._properties);for(const _ of Object.keys(this._values))h._values[_]=this._values[_].possiblyEvaluate(e,n,o);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Th{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return _t(this._values[e].value)}setValue(e,n){this._values[e]=new fo(this._values[e].property,n===null?void 0:_t(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(e[n]=o)}return e}possiblyEvaluate(e,n,o){const h=new po(this._properties);for(const _ of Object.keys(this._values))h._values[_]=this._values[_].possiblyEvaluate(e,n,o);return h}}class On{constructor(e,n,o){this.property=e,this.value=n,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,o,h){return this.property.evaluate(this.value,this.parameters,e,n,o,h)}}class po{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class xt{constructor(e){this.specification=e}possiblyEvaluate(e,n){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(n)}interpolate(e,n,o){const h=Ur[this.specification.type];return h?h(e,n,o):e}}class kt{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,o,h){return new On(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},o,h)}:e.expression,n)}interpolate(e,n,o){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new On(this,{kind:"constant",value:void 0},e.parameters);const h=Ur[this.specification.type];if(h){const _=h(e.value.value,n.value.value,o);return new On(this,{kind:"constant",value:_},e.parameters)}return e}evaluate(e,n,o,h,_,y){return e.kind==="constant"?e.value:e.evaluate(n,o,h,_,y)}}class ma extends kt{possiblyEvaluate(e,n,o,h){if(e.value===void 0)return new On(this,{kind:"constant",value:void 0},n);if(e.expression.kind==="constant"){const _=e.expression.evaluate(n,null,{},o,h),y=e.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,b=this._calculate(y,y,y,n);return new On(this,{kind:"constant",value:b},n)}if(e.expression.kind==="camera"){const _=this._calculate(e.expression.evaluate({zoom:n.zoom-1}),e.expression.evaluate({zoom:n.zoom}),e.expression.evaluate({zoom:n.zoom+1}),n);return new On(this,{kind:"constant",value:_},n)}return new On(this,e.expression,n)}evaluate(e,n,o,h,_,y){if(e.kind==="source"){const b=e.evaluate(n,o,h,_,y);return this._calculate(b,b,b,n)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(n.zoom)-1},o,h),e.evaluate({zoom:Math.floor(n.zoom)},o,h),e.evaluate({zoom:Math.floor(n.zoom)+1},o,h),n):e.value}_calculate(e,n,o,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:o,to:n}}interpolate(e){return e}}class Ac{constructor(e){this.specification=e}possiblyEvaluate(e,n,o,h){if(e.value!==void 0){if(e.expression.kind==="constant"){const _=e.expression.evaluate(n,null,{},o,h);return this._calculate(_,_,_,n)}return this._calculate(e.expression.evaluate(new ki(Math.floor(n.zoom-1),n)),e.expression.evaluate(new ki(Math.floor(n.zoom),n)),e.expression.evaluate(new ki(Math.floor(n.zoom+1),n)),n)}}_calculate(e,n,o,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:o,to:n}}interpolate(e){return e}}class Cc{constructor(e){this.specification=e}possiblyEvaluate(e,n,o,h){return!!e.expression.evaluate(n,null,{},o,h)}interpolate(){return!1}}class jr{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in e){const o=e[n];o.specification.overridable&&this.overridableProperties.push(n);const h=this.defaultPropertyValues[n]=new fo(o,void 0),_=this.defaultTransitionablePropertyValues[n]=new _l(o);this.defaultTransitioningPropertyValues[n]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=h.possiblyEvaluate({})}}}ut("DataDrivenProperty",kt),ut("DataConstantProperty",xt),ut("CrossFadedDataDrivenProperty",ma),ut("CrossFadedProperty",Ac),ut("ColorRampProperty",Cc);const Pc="-transition";class Fn extends ye{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new Th(n.layout)),n.paint)){this._transitionablePaint=new wh(n.paint);for(const o in e.paint)this.setPaintProperty(o,e.paint[o],{validate:!1});for(const o in e.layout)this.setLayoutProperty(o,e.layout[o],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new po(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,o={}){n!=null&&this._validate(uo,`layers.${this.id}.layout.${e}`,e,n,o)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return e.endsWith(Pc)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,o={}){if(n!=null&&this._validate(yf,`layers.${this.id}.paint.${e}`,e,n,o))return!1;if(e.endsWith(Pc))return this._transitionablePaint.setTransition(e.slice(0,-11),n||void 0),!1;{const h=this._transitionablePaint._values[e],_=h.property.specification["property-type"]==="cross-faded-data-driven",y=h.value.isDataDriven(),b=h.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const S=this._transitionablePaint._values[e].value;return S.isDataDriven()||y||_||this._handleOverridablePaintPropertyUpdate(e,b,S)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,n,o){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),ot(e,(n,o)=>!(n===void 0||o==="layout"&&!Object.keys(n).length||o==="paint"&&!Object.keys(n).length))}_validate(e,n,o,h,_={}){return(!_||_.validate!==!1)&&yh(this,e.call(co,{key:n,layerType:this.type,objectKey:o,value:h,styleSpec:K,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof On&&ha(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const xf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class mo{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Hi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ji(r,e=1){let n=0,o=0;return{members:r.map(h=>{const _=xf[h.type].BYTES_PER_ELEMENT,y=n=Eh(n,Math.max(e,_)),b=h.components||1;return o=Math.max(o,_),n+=_*b,{name:h.name,type:h.type,components:b,offset:y}}),size:Eh(n,Math.max(o,e)),alignment:e}}function Eh(r,e){return Math.ceil(r/e)*e}class Kn extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const h=2*e;return this.int16[h+0]=n,this.int16[h+1]=o,e}}Kn.prototype.bytesPerElement=4,ut("StructArrayLayout2i4",Kn);class yl extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,o)}emplace(e,n,o,h){const _=3*e;return this.int16[_+0]=n,this.int16[_+1]=o,this.int16[_+2]=h,e}}yl.prototype.bytesPerElement=6,ut("StructArrayLayout3i6",yl);class Mc extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,h){const _=this.length;return this.resize(_+1),this.emplace(_,e,n,o,h)}emplace(e,n,o,h,_){const y=4*e;return this.int16[y+0]=n,this.int16[y+1]=o,this.int16[y+2]=h,this.int16[y+3]=_,e}}Mc.prototype.bytesPerElement=8,ut("StructArrayLayout4i8",Mc);class kc extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,_,y){const b=this.length;return this.resize(b+1),this.emplace(b,e,n,o,h,_,y)}emplace(e,n,o,h,_,y,b){const S=6*e;return this.int16[S+0]=n,this.int16[S+1]=o,this.int16[S+2]=h,this.int16[S+3]=_,this.int16[S+4]=y,this.int16[S+5]=b,e}}kc.prototype.bytesPerElement=12,ut("StructArrayLayout2i4i12",kc);class Lc extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,_,y){const b=this.length;return this.resize(b+1),this.emplace(b,e,n,o,h,_,y)}emplace(e,n,o,h,_,y,b){const S=4*e,I=8*e;return this.int16[S+0]=n,this.int16[S+1]=o,this.uint8[I+4]=h,this.uint8[I+5]=_,this.uint8[I+6]=y,this.uint8[I+7]=b,e}}Lc.prototype.bytesPerElement=8,ut("StructArrayLayout2i4ub8",Lc);class ga extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const h=2*e;return this.float32[h+0]=n,this.float32[h+1]=o,e}}ga.prototype.bytesPerElement=8,ut("StructArrayLayout2f8",ga);class Rc extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,_,y,b,S,I,P){const L=this.length;return this.resize(L+1),this.emplace(L,e,n,o,h,_,y,b,S,I,P)}emplace(e,n,o,h,_,y,b,S,I,P,L){const V=10*e;return this.uint16[V+0]=n,this.uint16[V+1]=o,this.uint16[V+2]=h,this.uint16[V+3]=_,this.uint16[V+4]=y,this.uint16[V+5]=b,this.uint16[V+6]=S,this.uint16[V+7]=I,this.uint16[V+8]=P,this.uint16[V+9]=L,e}}Rc.prototype.bytesPerElement=20,ut("StructArrayLayout10ui20",Rc);class Dc extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,_,y,b,S,I,P,L,V){const $=this.length;return this.resize($+1),this.emplace($,e,n,o,h,_,y,b,S,I,P,L,V)}emplace(e,n,o,h,_,y,b,S,I,P,L,V,$){const H=12*e;return this.int16[H+0]=n,this.int16[H+1]=o,this.int16[H+2]=h,this.int16[H+3]=_,this.uint16[H+4]=y,this.uint16[H+5]=b,this.uint16[H+6]=S,this.uint16[H+7]=I,this.int16[H+8]=P,this.int16[H+9]=L,this.int16[H+10]=V,this.int16[H+11]=$,e}}Dc.prototype.bytesPerElement=24,ut("StructArrayLayout4i4ui4i24",Dc);class is extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,o)}emplace(e,n,o,h){const _=3*e;return this.float32[_+0]=n,this.float32[_+1]=o,this.float32[_+2]=h,e}}is.prototype.bytesPerElement=12,ut("StructArrayLayout3f12",is);class vl extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}vl.prototype.bytesPerElement=4,ut("StructArrayLayout1ul4",vl);class go extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,_,y,b,S,I){const P=this.length;return this.resize(P+1),this.emplace(P,e,n,o,h,_,y,b,S,I)}emplace(e,n,o,h,_,y,b,S,I,P){const L=10*e,V=5*e;return this.int16[L+0]=n,this.int16[L+1]=o,this.int16[L+2]=h,this.int16[L+3]=_,this.int16[L+4]=y,this.int16[L+5]=b,this.uint32[V+3]=S,this.uint16[L+8]=I,this.uint16[L+9]=P,e}}go.prototype.bytesPerElement=20,ut("StructArrayLayout6i1ul2ui20",go);class xl extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,_,y){const b=this.length;return this.resize(b+1),this.emplace(b,e,n,o,h,_,y)}emplace(e,n,o,h,_,y,b){const S=6*e;return this.int16[S+0]=n,this.int16[S+1]=o,this.int16[S+2]=h,this.int16[S+3]=_,this.int16[S+4]=y,this.int16[S+5]=b,e}}xl.prototype.bytesPerElement=12,ut("StructArrayLayout2i2i2i12",xl);class _o extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,_){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,o,h,_)}emplace(e,n,o,h,_,y){const b=4*e,S=8*e;return this.float32[b+0]=n,this.float32[b+1]=o,this.float32[b+2]=h,this.int16[S+6]=_,this.int16[S+7]=y,e}}_o.prototype.bytesPerElement=16,ut("StructArrayLayout2f1f2i16",_o);class zc extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,h){const _=this.length;return this.resize(_+1),this.emplace(_,e,n,o,h)}emplace(e,n,o,h,_){const y=12*e,b=3*e;return this.uint8[y+0]=n,this.uint8[y+1]=o,this.float32[b+1]=h,this.float32[b+2]=_,e}}zc.prototype.bytesPerElement=12,ut("StructArrayLayout2ub2f12",zc);class Vs extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,o)}emplace(e,n,o,h){const _=3*e;return this.uint16[_+0]=n,this.uint16[_+1]=o,this.uint16[_+2]=h,e}}Vs.prototype.bytesPerElement=6,ut("StructArrayLayout3ui6",Vs);class Us extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,h,_,y,b,S,I,P,L,V,$,H,q,te,oe){const ve=this.length;return this.resize(ve+1),this.emplace(ve,e,n,o,h,_,y,b,S,I,P,L,V,$,H,q,te,oe)}emplace(e,n,o,h,_,y,b,S,I,P,L,V,$,H,q,te,oe,ve){const le=24*e,pe=12*e,Le=48*e;return this.int16[le+0]=n,this.int16[le+1]=o,this.uint16[le+2]=h,this.uint16[le+3]=_,this.uint32[pe+2]=y,this.uint32[pe+3]=b,this.uint32[pe+4]=S,this.uint16[le+10]=I,this.uint16[le+11]=P,this.uint16[le+12]=L,this.float32[pe+7]=V,this.float32[pe+8]=$,this.uint8[Le+36]=H,this.uint8[Le+37]=q,this.uint8[Le+38]=te,this.uint32[pe+10]=oe,this.int16[le+22]=ve,e}}Us.prototype.bytesPerElement=48,ut("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Us);class Oc extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,h,_,y,b,S,I,P,L,V,$,H,q,te,oe,ve,le,pe,Le,Ne,lt,vt,at,rt,Xe,pt){const Je=this.length;return this.resize(Je+1),this.emplace(Je,e,n,o,h,_,y,b,S,I,P,L,V,$,H,q,te,oe,ve,le,pe,Le,Ne,lt,vt,at,rt,Xe,pt)}emplace(e,n,o,h,_,y,b,S,I,P,L,V,$,H,q,te,oe,ve,le,pe,Le,Ne,lt,vt,at,rt,Xe,pt,Je){const We=32*e,Tt=16*e;return this.int16[We+0]=n,this.int16[We+1]=o,this.int16[We+2]=h,this.int16[We+3]=_,this.int16[We+4]=y,this.int16[We+5]=b,this.int16[We+6]=S,this.int16[We+7]=I,this.uint16[We+8]=P,this.uint16[We+9]=L,this.uint16[We+10]=V,this.uint16[We+11]=$,this.uint16[We+12]=H,this.uint16[We+13]=q,this.uint16[We+14]=te,this.uint16[We+15]=oe,this.uint16[We+16]=ve,this.uint16[We+17]=le,this.uint16[We+18]=pe,this.uint16[We+19]=Le,this.uint16[We+20]=Ne,this.uint16[We+21]=lt,this.uint16[We+22]=vt,this.uint32[Tt+12]=at,this.float32[Tt+13]=rt,this.float32[Tt+14]=Xe,this.uint16[We+30]=pt,this.uint16[We+31]=Je,e}}Oc.prototype.bytesPerElement=64,ut("StructArrayLayout8i15ui1ul2f2ui64",Oc);class yo extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}yo.prototype.bytesPerElement=4,ut("StructArrayLayout1f4",yo);class $s extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,o)}emplace(e,n,o,h){const _=3*e;return this.uint16[6*e+0]=n,this.float32[_+1]=o,this.float32[_+2]=h,e}}$s.prototype.bytesPerElement=12,ut("StructArrayLayout1ui2f12",$s);class Fc extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,o)}emplace(e,n,o,h){const _=4*e;return this.uint32[2*e+0]=n,this.uint16[_+2]=o,this.uint16[_+3]=h,e}}Fc.prototype.bytesPerElement=8,ut("StructArrayLayout1ul2ui8",Fc);class Bc extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const h=2*e;return this.uint16[h+0]=n,this.uint16[h+1]=o,e}}Bc.prototype.bytesPerElement=4,ut("StructArrayLayout2ui4",Bc);class bl extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}bl.prototype.bytesPerElement=2,ut("StructArrayLayout1ui2",bl);class Nc extends Hi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,h){const _=this.length;return this.resize(_+1),this.emplace(_,e,n,o,h)}emplace(e,n,o,h,_){const y=4*e;return this.float32[y+0]=n,this.float32[y+1]=o,this.float32[y+2]=h,this.float32[y+3]=_,e}}Nc.prototype.bytesPerElement=16,ut("StructArrayLayout4f16",Nc);class p extends mo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new B(this.anchorPointX,this.anchorPointY)}}p.prototype.size=20;class t extends go{get(e){return new p(this,e)}}ut("CollisionBoxArray",t);class a extends mo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}a.prototype.size=48;class u extends Us{get(e){return new a(this,e)}}ut("PlacedSymbolArray",u);class d extends mo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}d.prototype.size=64;class g extends Oc{get(e){return new d(this,e)}}ut("SymbolInstanceArray",g);class w extends yo{getoffsetX(e){return this.float32[1*e+0]}}ut("GlyphOffsetArray",w);class T extends yl{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}ut("SymbolLineVertexArray",T);class E extends mo{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}E.prototype.size=12;class C extends $s{get(e){return new E(this,e)}}ut("TextAnchorOffsetArray",C);class k extends mo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}k.prototype.size=8;class F extends Fc{get(e){return new k(this,e)}}ut("FeatureIndexArray",F);class j extends Kn{}class Q extends Kn{}class X extends Kn{}class ee extends kc{}class W extends Lc{}class he extends ga{}class Te extends Rc{}class ne extends Dc{}class ge extends is{}class Ie extends vl{}class Ee extends xl{}class Fe extends zc{}class je extends Vs{}class Ue extends Bc{}const Ze=Ji([{name:"a_pos",components:2,type:"Int16"}],4),{members:dt}=Ze;class Pt{constructor(e=[]){this.segments=e}prepareSegment(e,n,o,h){let _=this.segments[this.segments.length-1];return e>Pt.MAX_VERTEX_ARRAY_LENGTH&&bt(`Max vertices per segment is ${Pt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!_||_.vertexLength+e>Pt.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==h)&&(_={vertexOffset:n.length,primitiveOffset:o.length,vertexLength:0,primitiveLength:0},h!==void 0&&(_.sortKey=h),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,o,h){return new Pt([{vertexOffset:e,primitiveOffset:n,vertexLength:o,primitiveLength:h,vaos:{},sortKey:0}])}}function tt(r,e){return 256*(r=Re(Math.floor(r),0,255))+Re(Math.floor(e),0,255)}Pt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ut("SegmentVector",Pt);const At=Ji([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var mt={exports:{}},Li={exports:{}};Li.exports=function(r,e){var n,o,h,_,y,b,S,I;for(o=r.length-(n=3&r.length),h=e,y=3432918353,b=461845907,I=0;I<o;)S=255&r.charCodeAt(I)|(255&r.charCodeAt(++I))<<8|(255&r.charCodeAt(++I))<<16|(255&r.charCodeAt(++I))<<24,++I,h=27492+(65535&(_=5*(65535&(h=(h^=S=(65535&(S=(S=(65535&S)*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(S=0,n){case 3:S^=(255&r.charCodeAt(I+2))<<16;case 2:S^=(255&r.charCodeAt(I+1))<<8;case 1:h^=S=(65535&(S=(S=(65535&(S^=255&r.charCodeAt(I)))*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295}return h^=r.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var Jt=Li.exports,$t={exports:{}};$t.exports=function(r,e){for(var n,o=r.length,h=e^o,_=0;o>=4;)n=1540483477*(65535&(n=255&r.charCodeAt(_)|(255&r.charCodeAt(++_))<<8|(255&r.charCodeAt(++_))<<16|(255&r.charCodeAt(++_))<<24))+((1540483477*(n>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),o-=4,++_;switch(o){case 3:h^=(255&r.charCodeAt(_+2))<<16;case 2:h^=(255&r.charCodeAt(_+1))<<8;case 1:h=1540483477*(65535&(h^=255&r.charCodeAt(_)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var Qt=Jt,Qi=$t.exports;mt.exports=Qt,mt.exports.murmur3=Qt,mt.exports.murmur2=Qi;var wi=A(mt.exports);class Hr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,o,h){this.ids.push(xr(e)),this.positions.push(n,o,h)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=xr(e);let o=0,h=this.ids.length-1;for(;o<h;){const y=o+h>>1;this.ids[y]>=n?h=y:o=y+1}const _=[];for(;this.ids[o]===n;)_.push({index:this.positions[3*o],start:this.positions[3*o+1],end:this.positions[3*o+2]}),o++;return _}static serialize(e,n){const o=new Float64Array(e.ids),h=new Uint32Array(e.positions);return Gi(o,h,0,o.length-1),n&&n.push(o.buffer,h.buffer),{ids:o,positions:h}}static deserialize(e){const n=new Hr;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function xr(r){const e=+r;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:wi(String(r))}function Gi(r,e,n,o){for(;n<o;){const h=r[n+o>>1];let _=n-1,y=o+1;for(;;){do _++;while(r[_]<h);do y--;while(r[y]>h);if(_>=y)break;Lr(r,_,y),Lr(e,3*_,3*y),Lr(e,3*_+1,3*y+1),Lr(e,3*_+2,3*y+2)}y-n<o-y?(Gi(r,e,n,y),n=y+1):(Gi(r,e,y+1,o),o=y)}}function Lr(r,e,n){const o=r[e];r[e]=r[n],r[n]=o}ut("FeaturePositionMap",Hr);class Rr{constructor(e,n){this.gl=e.gl,this.location=n}}class Pn extends Rr{constructor(e,n){super(e,n),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class ys extends Rr{constructor(e,n){super(e,n),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class _a extends Rr{constructor(e,n){super(e,n),this.current=vi.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const ya=new Float32Array(16);function vs(r){return[tt(255*r.r,255*r.g),tt(255*r.b,255*r.a)]}class cr{constructor(e,n,o){this.value=e,this.uniformNames=n.map(h=>`u_${h}`),this.type=o}setUniform(e,n,o){e.set(o.constantOr(this.value))}getBinding(e,n,o){return this.type==="color"?new _a(e,n):new Pn(e,n)}}class er{constructor(e,n){this.uniformNames=n.map(o=>`u_${o}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=e.tlbr}setUniform(e,n,o,h){const _=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&e.set(_)}getBinding(e,n,o){return o.substr(0,9)==="u_pattern"?new ys(e,n):new Pn(e,n)}}class qi{constructor(e,n,o,h){this.expression=e,this.type=o,this.maxValue=0,this.paintVertexAttributes=n.map(_=>({name:`a_${_}`,type:"Float32",components:o==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,n,o,h,_){const y=this.paintVertexArray.length,b=this.expression.evaluate(new ki(0),n,{},h,[],_);this.paintVertexArray.resize(e),this._setPaintValue(y,e,b)}updatePaintArray(e,n,o,h){const _=this.expression.evaluate({zoom:0},o,h);this._setPaintValue(e,n,_)}_setPaintValue(e,n,o){if(this.type==="color"){const h=vs(o);for(let _=e;_<n;_++)this.paintVertexArray.emplace(_,h[0],h[1])}else{for(let h=e;h<n;h++)this.paintVertexArray.emplace(h,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gr{constructor(e,n,o,h,_,y){this.expression=e,this.uniformNames=n.map(b=>`u_${b}_t`),this.type=o,this.useIntegerZoom=h,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=n.map(b=>({name:`a_${b}`,type:"Float32",components:o==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,n,o,h,_){const y=this.expression.evaluate(new ki(this.zoom),n,{},h,[],_),b=this.expression.evaluate(new ki(this.zoom+1),n,{},h,[],_),S=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(S,e,y,b)}updatePaintArray(e,n,o,h){const _=this.expression.evaluate({zoom:this.zoom},o,h),y=this.expression.evaluate({zoom:this.zoom+1},o,h);this._setPaintValue(e,n,_,y)}_setPaintValue(e,n,o,h){if(this.type==="color"){const _=vs(o),y=vs(h);for(let b=e;b<n;b++)this.paintVertexArray.emplace(b,_[0],_[1],y[0],y[1])}else{for(let _=e;_<n;_++)this.paintVertexArray.emplace(_,o,h);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n){const o=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,h=Re(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);e.set(h)}getBinding(e,n,o){return new Pn(e,n)}}class Ri{constructor(e,n,o,h,_,y){this.expression=e,this.type=n,this.useIntegerZoom=o,this.zoom=h,this.layerId=y,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(e,n,o){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(h,e,n.patterns&&n.patterns[this.layerId],o)}updatePaintArray(e,n,o,h,_){this._setPaintValues(e,n,o.patterns&&o.patterns[this.layerId],_)}_setPaintValues(e,n,o,h){if(!h||!o)return;const{min:_,mid:y,max:b}=o,S=h[_],I=h[y],P=h[b];if(S&&I&&P)for(let L=e;L<n;L++)this.zoomInPaintVertexArray.emplace(L,I.tl[0],I.tl[1],I.br[0],I.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],I.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(L,I.tl[0],I.tl[1],I.br[0],I.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],I.pixelRatio,P.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,At.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,At.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class ur{constructor(e,n,o){this.binders={},this._buffers=[];const h=[];for(const _ in e.paint._values){if(!o(_))continue;const y=e.paint.get(_);if(!(y instanceof On&&ha(y.property.specification)))continue;const b=hr(_,e.type),S=y.value,I=y.property.specification.type,P=y.property.useIntegerZoom,L=y.property.specification["property-type"],V=L==="cross-faded"||L==="cross-faded-data-driven";if(S.kind==="constant")this.binders[_]=V?new er(S.value,b):new cr(S.value,b,I),h.push(`/u_${_}`);else if(S.kind==="source"||V){const $=Ih(_,I,"source");this.binders[_]=V?new Ri(S,I,P,n,$,e.id):new qi(S,b,I,$),h.push(`/a_${_}`)}else{const $=Ih(_,I,"composite");this.binders[_]=new Gr(S,b,I,P,n,$),h.push(`/z_${_}`)}}this.cacheKey=h.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof qi||n instanceof Gr?n.maxValue:0}populatePaintArrays(e,n,o,h,_){for(const y in this.binders){const b=this.binders[y];(b instanceof qi||b instanceof Gr||b instanceof Ri)&&b.populatePaintArray(e,n,o,h,_)}}setConstantPatternPositions(e,n){for(const o in this.binders){const h=this.binders[o];h instanceof er&&h.setConstantPatternPositions(e,n)}}updatePaintArrays(e,n,o,h,_){let y=!1;for(const b in e){const S=n.getPositions(b);for(const I of S){const P=o.feature(I.index);for(const L in this.binders){const V=this.binders[L];if((V instanceof qi||V instanceof Gr||V instanceof Ri)&&V.expression.isStateDependent===!0){const $=h.paint.get(L);V.expression=$.value,V.updatePaintArray(I.start,I.end,P,e[b],_),y=!0}}}}return y}defines(){const e=[];for(const n in this.binders){const o=this.binders[n];(o instanceof cr||o instanceof er)&&e.push(...o.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof qi||o instanceof Gr)for(let h=0;h<o.paintVertexAttributes.length;h++)e.push(o.paintVertexAttributes[h].name);else if(o instanceof Ri)for(let h=0;h<At.members.length;h++)e.push(At.members[h].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof cr||o instanceof er||o instanceof Gr)for(const h of o.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,n){const o=[];for(const h in this.binders){const _=this.binders[h];if(_ instanceof cr||_ instanceof er||_ instanceof Gr){for(const y of _.uniformNames)if(n[y]){const b=_.getBinding(e,n[y],y);o.push({name:y,property:h,binding:b})}}}return o}setUniforms(e,n,o,h){for(const{name:_,property:y,binding:b}of n)this.binders[y].setUniform(b,h,o.get(y),_)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){const o=this.binders[n];if(e&&o instanceof Ri){const h=e.fromScale===2?o.zoomInPaintVertexBuffer:o.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(o instanceof qi||o instanceof Gr)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(e){for(const n in this.binders){const o=this.binders[n];(o instanceof qi||o instanceof Gr||o instanceof Ri)&&o.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof qi||n instanceof Gr||n instanceof Ri)&&n.destroy()}}}class br{constructor(e,n,o=()=>!0){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new ur(h,n,o);this.needsUpload=!1,this._featureMap=new Hr,this._bufferOffset=0}populatePaintArrays(e,n,o,h,_,y){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(e,n,h,_,y);n.id!==void 0&&this._featureMap.add(n.id,o,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,o,h){for(const _ of o)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(e,this._featureMap,n,_,h)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function hr(r,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}function Ih(r,e,n){const o={color:{source:ga,composite:Nc},number:{source:yo,composite:ga}},h=function(_){return{"line-pattern":{source:Te,composite:Te},"fill-pattern":{source:Te,composite:Te},"fill-extrusion-pattern":{source:Te,composite:Te}}[_]}(r);return h&&h[n]||o[e][n]}ut("ConstantBinder",cr),ut("CrossFadedConstantBinder",er),ut("SourceExpressionBinder",qi),ut("CrossFadedCompositeBinder",Ri),ut("CompositeExpressionBinder",Gr),ut("ProgramConfiguration",ur,{omit:["_buffers"]}),ut("ProgramConfigurationSet",br);const Ki=8192,Vc=Math.pow(2,14)-1,Ah=-Vc-1;function js(r){const e=Ki/r.extent,n=r.loadGeometry();for(let o=0;o<n.length;o++){const h=n[o];for(let _=0;_<h.length;_++){const y=h[_],b=Math.round(y.x*e),S=Math.round(y.y*e);y.x=Re(b,Ah,Vc),y.y=Re(S,Ah,Vc),(b<y.x||b>y.x+1||S<y.y||S>y.y+1)&&bt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Hs(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?js(r):[]}}function rs(r,e,n,o,h){r.emplaceBack(2*e+(o+1)/2,2*n+(h+1)/2)}class wl{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Q,this.indexArray=new je,this.segments=new Pt,this.programConfigurations=new br(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,o){const h=this.layers[0],_=[];let y=null,b=!1;h.type==="circle"&&(y=h.layout.get("circle-sort-key"),b=!y.isConstant());for(const{feature:S,id:I,index:P,sourceLayerIndex:L}of e){const V=this.layers[0]._featureFilter.needGeometry,$=Hs(S,V);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom),$,o))continue;const H=b?y.evaluate($,{},o):void 0,q={id:I,properties:S.properties,type:S.type,sourceLayerIndex:L,index:P,geometry:V?$.geometry:js(S),patterns:{},sortKey:H};_.push(q)}b&&_.sort((S,I)=>S.sortKey-I.sortKey);for(const S of _){const{geometry:I,index:P,sourceLayerIndex:L}=S,V=e[P].feature;this.addFeature(S,I,P,o),n.featureIndex.insert(V,I,P,L,this.index)}}update(e,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,o)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,dt),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,o,h){for(const _ of n)for(const y of _){const b=y.x,S=y.y;if(b<0||b>=Ki||S<0||S>=Ki)continue;const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),P=I.vertexLength;rs(this.layoutVertexArray,b,S,-1,-1),rs(this.layoutVertexArray,b,S,1,-1),rs(this.layoutVertexArray,b,S,1,1),rs(this.layoutVertexArray,b,S,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+3,P+2),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{},h)}}function Uc(r,e){for(let n=0;n<r.length;n++)if(Tl(e,r[n]))return!0;for(let n=0;n<e.length;n++)if(Tl(r,e[n]))return!0;return!!vo(r,e)}function Ch(r,e,n){return!!Tl(r,e)||!!bf(e,r,n)}function Sl(r,e){if(r.length===1)return Ym(e,r[0]);for(let n=0;n<e.length;n++){const o=e[n];for(let h=0;h<o.length;h++)if(Tl(r,o[h]))return!0}for(let n=0;n<r.length;n++)if(Ym(e,r[n]))return!0;for(let n=0;n<e.length;n++)if(vo(r,e[n]))return!0;return!1}function Ph(r,e,n){if(r.length>1){if(vo(r,e))return!0;for(let o=0;o<e.length;o++)if(bf(e[o],r,n))return!0}for(let o=0;o<r.length;o++)if(bf(r[o],e,n))return!0;return!1}function vo(r,e){if(r.length===0||e.length===0)return!1;for(let n=0;n<r.length-1;n++){const o=r[n],h=r[n+1];for(let _=0;_<e.length-1;_++)if(gb(o,h,e[_],e[_+1]))return!0}return!1}function gb(r,e,n,o){return qt(r,n,o)!==qt(e,n,o)&&qt(r,e,n)!==qt(r,e,o)}function bf(r,e,n){const o=n*n;if(e.length===1)return r.distSqr(e[0])<o;for(let h=1;h<e.length;h++)if(Km(r,e[h-1],e[h])<o)return!0;return!1}function Km(r,e,n){const o=e.distSqr(n);if(o===0)return r.distSqr(e);const h=((r.x-e.x)*(n.x-e.x)+(r.y-e.y)*(n.y-e.y))/o;return r.distSqr(h<0?e:h>1?n:n.sub(e)._mult(h)._add(e))}function Ym(r,e){let n,o,h,_=!1;for(let y=0;y<r.length;y++){n=r[y];for(let b=0,S=n.length-1;b<n.length;S=b++)o=n[b],h=n[S],o.y>e.y!=h.y>e.y&&e.x<(h.x-o.x)*(e.y-o.y)/(h.y-o.y)+o.x&&(_=!_)}return _}function Tl(r,e){let n=!1;for(let o=0,h=r.length-1;o<r.length;h=o++){const _=r[o],y=r[h];_.y>e.y!=y.y>e.y&&e.x<(y.x-_.x)*(e.y-_.y)/(y.y-_.y)+_.x&&(n=!n)}return n}function _b(r,e,n){const o=n[0],h=n[2];if(r.x<o.x&&e.x<o.x||r.x>h.x&&e.x>h.x||r.y<o.y&&e.y<o.y||r.y>h.y&&e.y>h.y)return!1;const _=qt(r,e,n[0]);return _!==qt(r,e,n[1])||_!==qt(r,e,n[2])||_!==qt(r,e,n[3])}function $c(r,e,n){const o=e.paint.get(r).value;return o.kind==="constant"?o.value:n.programConfigurations.get(e.id).getMaxValue(r)}function Mh(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function kh(r,e,n,o,h){if(!e[0]&&!e[1])return r;const _=B.convert(e)._mult(h);n==="viewport"&&_._rotate(-o);const y=[];for(let b=0;b<r.length;b++)y.push(r[b].sub(_));return y}let Xm,Jm;ut("CircleBucket",wl,{omit:["layers"]});var yb={get paint(){return Jm=Jm||new jr({"circle-radius":new kt(K.paint_circle["circle-radius"]),"circle-color":new kt(K.paint_circle["circle-color"]),"circle-blur":new kt(K.paint_circle["circle-blur"]),"circle-opacity":new kt(K.paint_circle["circle-opacity"]),"circle-translate":new xt(K.paint_circle["circle-translate"]),"circle-translate-anchor":new xt(K.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new xt(K.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new xt(K.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new kt(K.paint_circle["circle-stroke-width"]),"circle-stroke-color":new kt(K.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new kt(K.paint_circle["circle-stroke-opacity"])})},get layout(){return Xm=Xm||new jr({"circle-sort-key":new kt(K.layout_circle["circle-sort-key"])})}},ln=1e-6,El=typeof Float32Array<"u"?Float32Array:Array;function wf(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Qm(r,e,n){var o=e[0],h=e[1],_=e[2],y=e[3],b=e[4],S=e[5],I=e[6],P=e[7],L=e[8],V=e[9],$=e[10],H=e[11],q=e[12],te=e[13],oe=e[14],ve=e[15],le=n[0],pe=n[1],Le=n[2],Ne=n[3];return r[0]=le*o+pe*b+Le*L+Ne*q,r[1]=le*h+pe*S+Le*V+Ne*te,r[2]=le*_+pe*I+Le*$+Ne*oe,r[3]=le*y+pe*P+Le*H+Ne*ve,r[4]=(le=n[4])*o+(pe=n[5])*b+(Le=n[6])*L+(Ne=n[7])*q,r[5]=le*h+pe*S+Le*V+Ne*te,r[6]=le*_+pe*I+Le*$+Ne*oe,r[7]=le*y+pe*P+Le*H+Ne*ve,r[8]=(le=n[8])*o+(pe=n[9])*b+(Le=n[10])*L+(Ne=n[11])*q,r[9]=le*h+pe*S+Le*V+Ne*te,r[10]=le*_+pe*I+Le*$+Ne*oe,r[11]=le*y+pe*P+Le*H+Ne*ve,r[12]=(le=n[12])*o+(pe=n[13])*b+(Le=n[14])*L+(Ne=n[15])*q,r[13]=le*h+pe*S+Le*V+Ne*te,r[14]=le*_+pe*I+Le*$+Ne*oe,r[15]=le*y+pe*P+Le*H+Ne*ve,r}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var jc,vb=Qm;function Lh(r,e,n){var o=e[0],h=e[1],_=e[2],y=e[3];return r[0]=n[0]*o+n[4]*h+n[8]*_+n[12]*y,r[1]=n[1]*o+n[5]*h+n[9]*_+n[13]*y,r[2]=n[2]*o+n[6]*h+n[10]*_+n[14]*y,r[3]=n[3]*o+n[7]*h+n[11]*_+n[15]*y,r}jc=new El(4),El!=Float32Array&&(jc[0]=0,jc[1]=0,jc[2]=0,jc[3]=0);class xb extends Fn{constructor(e){super(e,yb)}createBucket(e){return new wl(e)}queryRadius(e){const n=e;return $c("circle-radius",this,n)+$c("circle-stroke-width",this,n)+Mh(this.paint.get("circle-translate"))}queryIntersectsFeature(e,n,o,h,_,y,b,S){const I=kh(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,b),P=this.paint.get("circle-radius").evaluate(n,o)+this.paint.get("circle-stroke-width").evaluate(n,o),L=this.paint.get("circle-pitch-alignment")==="map",V=L?I:function(H,q){return H.map(te=>eg(te,q))}(I,S),$=L?P*b:P;for(const H of h)for(const q of H){const te=L?q:eg(q,S);let oe=$;const ve=Lh([],[q.x,q.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?oe*=ve[3]/y.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(oe*=y.cameraToCenterDistance/ve[3]),Ch(V,te,oe))return!0}return!1}}function eg(r,e){const n=Lh([],[r.x,r.y,0,1],e);return new B(n[0]/n[3],n[1]/n[3])}class tg extends wl{}let ig;ut("HeatmapBucket",tg,{omit:["layers"]});var bb={get paint(){return ig=ig||new jr({"heatmap-radius":new kt(K.paint_heatmap["heatmap-radius"]),"heatmap-weight":new kt(K.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new xt(K.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Cc(K.paint_heatmap["heatmap-color"]),"heatmap-opacity":new xt(K.paint_heatmap["heatmap-opacity"])})}};function Sf(r,{width:e,height:n},o,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*n*o)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${e*n*o}`)}else h=new Uint8Array(e*n*o);return r.width=e,r.height=n,r.data=h,r}function rg(r,{width:e,height:n},o){if(e===r.width&&n===r.height)return;const h=Sf({},{width:e,height:n},o);Tf(r,h,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,e),height:Math.min(r.height,n)},o),r.width=e,r.height=n,r.data=h.data}function Tf(r,e,n,o,h,_){if(h.width===0||h.height===0)return e;if(h.width>r.width||h.height>r.height||n.x>r.width-h.width||n.y>r.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||o.x>e.width-h.width||o.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=r.data,b=e.data;if(y===b)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<h.height;S++){const I=((n.y+S)*r.width+n.x)*_,P=((o.y+S)*e.width+o.x)*_;for(let L=0;L<h.width*_;L++)b[P+L]=y[I+L]}return e}class Hc{constructor(e,n){Sf(this,e,1,n)}resize(e){rg(this,e,1)}clone(){return new Hc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,o,h,_){Tf(e,n,o,h,_,1)}}class Bn{constructor(e,n){Sf(this,e,4,n)}resize(e){rg(this,e,4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Bn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,o,h,_){Tf(e,n,o,h,_,4)}}function ng(r){const e={},n=r.resolution||256,o=r.clips?r.clips.length:1,h=r.image||new Bn({width:n,height:o});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const _=(y,b,S)=>{e[r.evaluationKey]=S;const I=r.expression.evaluate(e);h.data[y+b+0]=Math.floor(255*I.r/I.a),h.data[y+b+1]=Math.floor(255*I.g/I.a),h.data[y+b+2]=Math.floor(255*I.b/I.a),h.data[y+b+3]=Math.floor(255*I.a)};if(r.clips)for(let y=0,b=0;y<o;++y,b+=4*n)for(let S=0,I=0;S<n;S++,I+=4){const P=S/(n-1),{start:L,end:V}=r.clips[y];_(b,I,L*(1-P)+V*P)}else for(let y=0,b=0;y<n;y++,b+=4)_(0,b,y/(n-1));return h}ut("AlphaImage",Hc),ut("RGBAImage",Bn);class wb extends Fn{createBucket(e){return new tg(e)}constructor(e){super(e,bb),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ng({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let sg;var Sb={get paint(){return sg=sg||new jr({"hillshade-illumination-direction":new xt(K.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new xt(K.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new xt(K.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new xt(K.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new xt(K.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new xt(K.paint_hillshade["hillshade-accent-color"])})}};class Tb extends Fn{constructor(e){super(e,Sb)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Eb=Ji([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ib}=Eb;var Ef={exports:{}};function Rh(r,e,n){n=n||2;var o,h,_,y,b,S,I,P=e&&e.length,L=P?e[0]*n:r.length,V=ag(r,0,L,n,!0),$=[];if(!V||V.next===V.prev)return $;if(P&&(V=function(q,te,oe,ve){var le,pe,Le,Ne=[];for(le=0,pe=te.length;le<pe;le++)(Le=ag(q,te[le]*ve,le<pe-1?te[le+1]*ve:q.length,ve,!1))===Le.next&&(Le.steiner=!0),Ne.push(Db(Le));for(Ne.sort(kb),le=0;le<Ne.length;le++)oe=Lb(Ne[le],oe);return oe}(r,e,V,n)),r.length>80*n){o=_=r[0],h=y=r[1];for(var H=n;H<L;H+=n)(b=r[H])<o&&(o=b),(S=r[H+1])<h&&(h=S),b>_&&(_=b),S>y&&(y=S);I=(I=Math.max(_-o,y-h))!==0?32767/I:0}return Gc(V,$,n,o,h,I,0),$}function ag(r,e,n,o,h){var _,y;if(h===Cf(r,e,n,o)>0)for(_=e;_<n;_+=o)y=cg(_,r[_],r[_+1],y);else for(_=n-o;_>=e;_-=o)y=cg(_,r[_],r[_+1],y);return y&&Dh(y,y.next)&&(Wc(y),y=y.next),y}function xo(r,e){if(!r)return r;e||(e=r);var n,o=r;do if(n=!1,o.steiner||!Dh(o,o.next)&&tr(o.prev,o,o.next)!==0)o=o.next;else{if(Wc(o),(o=e=o.prev)===o.next)break;n=!0}while(n||o!==e);return e}function Gc(r,e,n,o,h,_,y){if(r){!y&&_&&function(P,L,V,$){var H=P;do H.z===0&&(H.z=If(H.x,H.y,L,V,$)),H.prevZ=H.prev,H.nextZ=H.next,H=H.next;while(H!==P);H.prevZ.nextZ=null,H.prevZ=null,function(q){var te,oe,ve,le,pe,Le,Ne,lt,vt=1;do{for(oe=q,q=null,pe=null,Le=0;oe;){for(Le++,ve=oe,Ne=0,te=0;te<vt&&(Ne++,ve=ve.nextZ);te++);for(lt=vt;Ne>0||lt>0&&ve;)Ne!==0&&(lt===0||!ve||oe.z<=ve.z)?(le=oe,oe=oe.nextZ,Ne--):(le=ve,ve=ve.nextZ,lt--),pe?pe.nextZ=le:q=le,le.prevZ=pe,pe=le;oe=ve}pe.nextZ=null,vt*=2}while(Le>1)}(H)}(r,o,h,_);for(var b,S,I=r;r.prev!==r.next;)if(b=r.prev,S=r.next,_?Cb(r,o,h,_):Ab(r))e.push(b.i/n|0),e.push(r.i/n|0),e.push(S.i/n|0),Wc(r),r=S.next,I=S.next;else if((r=S)===I){y?y===1?Gc(r=Pb(xo(r),e,n),e,n,o,h,_,2):y===2&&Mb(r,e,n,o,h,_):Gc(xo(r),e,n,o,h,_,1);break}}}function Ab(r){var e=r.prev,n=r,o=r.next;if(tr(e,n,o)>=0)return!1;for(var h=e.x,_=n.x,y=o.x,b=e.y,S=n.y,I=o.y,P=h<_?h<y?h:y:_<y?_:y,L=b<S?b<I?b:I:S<I?S:I,V=h>_?h>y?h:y:_>y?_:y,$=b>S?b>I?b:I:S>I?S:I,H=o.next;H!==e;){if(H.x>=P&&H.x<=V&&H.y>=L&&H.y<=$&&Il(h,b,_,S,y,I,H.x,H.y)&&tr(H.prev,H,H.next)>=0)return!1;H=H.next}return!0}function Cb(r,e,n,o){var h=r.prev,_=r,y=r.next;if(tr(h,_,y)>=0)return!1;for(var b=h.x,S=_.x,I=y.x,P=h.y,L=_.y,V=y.y,$=b<S?b<I?b:I:S<I?S:I,H=P<L?P<V?P:V:L<V?L:V,q=b>S?b>I?b:I:S>I?S:I,te=P>L?P>V?P:V:L>V?L:V,oe=If($,H,e,n,o),ve=If(q,te,e,n,o),le=r.prevZ,pe=r.nextZ;le&&le.z>=oe&&pe&&pe.z<=ve;){if(le.x>=$&&le.x<=q&&le.y>=H&&le.y<=te&&le!==h&&le!==y&&Il(b,P,S,L,I,V,le.x,le.y)&&tr(le.prev,le,le.next)>=0||(le=le.prevZ,pe.x>=$&&pe.x<=q&&pe.y>=H&&pe.y<=te&&pe!==h&&pe!==y&&Il(b,P,S,L,I,V,pe.x,pe.y)&&tr(pe.prev,pe,pe.next)>=0))return!1;pe=pe.nextZ}for(;le&&le.z>=oe;){if(le.x>=$&&le.x<=q&&le.y>=H&&le.y<=te&&le!==h&&le!==y&&Il(b,P,S,L,I,V,le.x,le.y)&&tr(le.prev,le,le.next)>=0)return!1;le=le.prevZ}for(;pe&&pe.z<=ve;){if(pe.x>=$&&pe.x<=q&&pe.y>=H&&pe.y<=te&&pe!==h&&pe!==y&&Il(b,P,S,L,I,V,pe.x,pe.y)&&tr(pe.prev,pe,pe.next)>=0)return!1;pe=pe.nextZ}return!0}function Pb(r,e,n){var o=r;do{var h=o.prev,_=o.next.next;!Dh(h,_)&&og(h,o,o.next,_)&&qc(h,_)&&qc(_,h)&&(e.push(h.i/n|0),e.push(o.i/n|0),e.push(_.i/n|0),Wc(o),Wc(o.next),o=r=_),o=o.next}while(o!==r);return xo(o)}function Mb(r,e,n,o,h,_){var y=r;do{for(var b=y.next.next;b!==y.prev;){if(y.i!==b.i&&zb(y,b)){var S=lg(y,b);return y=xo(y,y.next),S=xo(S,S.next),Gc(y,e,n,o,h,_,0),void Gc(S,e,n,o,h,_,0)}b=b.next}y=y.next}while(y!==r)}function kb(r,e){return r.x-e.x}function Lb(r,e){var n=function(h,_){var y,b=_,S=h.x,I=h.y,P=-1/0;do{if(I<=b.y&&I>=b.next.y&&b.next.y!==b.y){var L=b.x+(I-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(L<=S&&L>P&&(P=L,y=b.x<b.next.x?b:b.next,L===S))return y}b=b.next}while(b!==_);if(!y)return null;var V,$=y,H=y.x,q=y.y,te=1/0;b=y;do S>=b.x&&b.x>=H&&S!==b.x&&Il(I<q?S:P,I,H,q,I<q?P:S,I,b.x,b.y)&&(V=Math.abs(I-b.y)/(S-b.x),qc(b,h)&&(V<te||V===te&&(b.x>y.x||b.x===y.x&&Rb(y,b)))&&(y=b,te=V)),b=b.next;while(b!==$);return y}(r,e);if(!n)return e;var o=lg(n,r);return xo(o,o.next),xo(n,n.next)}function Rb(r,e){return tr(r.prev,r,e.prev)<0&&tr(e.next,r,r.next)<0}function If(r,e,n,o,h){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-n)*h|0)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-o)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Db(r){var e=r,n=r;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==r);return n}function Il(r,e,n,o,h,_,y,b){return(h-y)*(e-b)>=(r-y)*(_-b)&&(r-y)*(o-b)>=(n-y)*(e-b)&&(n-y)*(_-b)>=(h-y)*(o-b)}function zb(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(n,o){var h=n;do{if(h.i!==n.i&&h.next.i!==n.i&&h.i!==o.i&&h.next.i!==o.i&&og(h,h.next,n,o))return!0;h=h.next}while(h!==n);return!1}(r,e)&&(qc(r,e)&&qc(e,r)&&function(n,o){var h=n,_=!1,y=(n.x+o.x)/2,b=(n.y+o.y)/2;do h.y>b!=h.next.y>b&&h.next.y!==h.y&&y<(h.next.x-h.x)*(b-h.y)/(h.next.y-h.y)+h.x&&(_=!_),h=h.next;while(h!==n);return _}(r,e)&&(tr(r.prev,r,e.prev)||tr(r,e.prev,e))||Dh(r,e)&&tr(r.prev,r,r.next)>0&&tr(e.prev,e,e.next)>0)}function tr(r,e,n){return(e.y-r.y)*(n.x-e.x)-(e.x-r.x)*(n.y-e.y)}function Dh(r,e){return r.x===e.x&&r.y===e.y}function og(r,e,n,o){var h=Oh(tr(r,e,n)),_=Oh(tr(r,e,o)),y=Oh(tr(n,o,r)),b=Oh(tr(n,o,e));return h!==_&&y!==b||!(h!==0||!zh(r,n,e))||!(_!==0||!zh(r,o,e))||!(y!==0||!zh(n,r,o))||!(b!==0||!zh(n,e,o))}function zh(r,e,n){return e.x<=Math.max(r.x,n.x)&&e.x>=Math.min(r.x,n.x)&&e.y<=Math.max(r.y,n.y)&&e.y>=Math.min(r.y,n.y)}function Oh(r){return r>0?1:r<0?-1:0}function qc(r,e){return tr(r.prev,r,r.next)<0?tr(r,e,r.next)>=0&&tr(r,r.prev,e)>=0:tr(r,e,r.prev)<0||tr(r,r.next,e)<0}function lg(r,e){var n=new Af(r.i,r.x,r.y),o=new Af(e.i,e.x,e.y),h=r.next,_=e.prev;return r.next=e,e.prev=r,n.next=h,h.prev=n,o.next=n,n.prev=o,_.next=o,o.prev=_,o}function cg(r,e,n,o){var h=new Af(r,e,n);return o?(h.next=o.next,h.prev=o,o.next.prev=h,o.next=h):(h.prev=h,h.next=h),h}function Wc(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Af(r,e,n){this.i=r,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Cf(r,e,n,o){for(var h=0,_=e,y=n-o;_<n;_+=o)h+=(r[y]-r[_])*(r[_+1]+r[y+1]),y=_;return h}Ef.exports=Rh,Ef.exports.default=Rh,Rh.deviation=function(r,e,n,o){var h=e&&e.length,_=Math.abs(Cf(r,0,h?e[0]*n:r.length,n));if(h)for(var y=0,b=e.length;y<b;y++)_-=Math.abs(Cf(r,e[y]*n,y<b-1?e[y+1]*n:r.length,n));var S=0;for(y=0;y<o.length;y+=3){var I=o[y]*n,P=o[y+1]*n,L=o[y+2]*n;S+=Math.abs((r[I]-r[L])*(r[P+1]-r[I+1])-(r[I]-r[P])*(r[L+1]-r[I+1]))}return _===0&&S===0?0:Math.abs((S-_)/_)},Rh.flatten=function(r){for(var e=r[0][0].length,n={vertices:[],holes:[],dimensions:e},o=0,h=0;h<r.length;h++){for(var _=0;_<r[h].length;_++)for(var y=0;y<e;y++)n.vertices.push(r[h][_][y]);h>0&&n.holes.push(o+=r[h-1].length)}return n};var ug=A(Ef.exports);function Ob(r,e,n,o,h){hg(r,e,n||0,o||r.length-1,h||Fb)}function hg(r,e,n,o,h){for(;o>n;){if(o-n>600){var _=o-n+1,y=e-n+1,b=Math.log(_),S=.5*Math.exp(2*b/3),I=.5*Math.sqrt(b*S*(_-S)/_)*(y-_/2<0?-1:1);hg(r,e,Math.max(n,Math.floor(e-y*S/_+I)),Math.min(o,Math.floor(e+(_-y)*S/_+I)),h)}var P=r[e],L=n,V=o;for(Zc(r,n,e),h(r[o],P)>0&&Zc(r,n,o);L<V;){for(Zc(r,L,V),L++,V--;h(r[L],P)<0;)L++;for(;h(r[V],P)>0;)V--}h(r[n],P)===0?Zc(r,n,V):Zc(r,++V,o),V<=e&&(n=V+1),e<=V&&(o=V-1)}}function Zc(r,e,n){var o=r[e];r[e]=r[n],r[n]=o}function Fb(r,e){return r<e?-1:r>e?1:0}function Pf(r,e){const n=r.length;if(n<=1)return[r];const o=[];let h,_;for(let y=0;y<n;y++){const b=pi(r[y]);b!==0&&(r[y].area=Math.abs(b),_===void 0&&(_=b<0),_===b<0?(h&&o.push(h),h=[r[y]]):h.push(r[y]))}if(h&&o.push(h),e>1)for(let y=0;y<o.length;y++)o[y].length<=e||(Ob(o[y],e,1,o[y].length-1,Bb),o[y]=o[y].slice(0,e));return o}function Bb(r,e){return e.area-r.area}function Mf(r,e,n){const o=n.patternDependencies;let h=!1;for(const _ of e){const y=_.paint.get(`${r}-pattern`);y.isConstant()||(h=!0);const b=y.constantOr(null);b&&(h=!0,o[b.to]=!0,o[b.from]=!0)}return h}function kf(r,e,n,o,h){const _=h.patternDependencies;for(const y of e){const b=y.paint.get(`${r}-pattern`).value;if(b.kind!=="constant"){let S=b.evaluate({zoom:o-1},n,{},h.availableImages),I=b.evaluate({zoom:o},n,{},h.availableImages),P=b.evaluate({zoom:o+1},n,{},h.availableImages);S=S&&S.name?S.name:S,I=I&&I.name?I.name:I,P=P&&P.name?P.name:P,_[S]=!0,_[I]=!0,_[P]=!0,n.patterns[y.id]={min:S,mid:I,max:P}}}return n}class Lf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new X,this.indexArray=new je,this.indexArray2=new Ue,this.programConfigurations=new br(e.layers,e.zoom),this.segments=new Pt,this.segments2=new Pt,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,o){this.hasPattern=Mf("fill",this.layers,n);const h=this.layers[0].layout.get("fill-sort-key"),_=!h.isConstant(),y=[];for(const{feature:b,id:S,index:I,sourceLayerIndex:P}of e){const L=this.layers[0]._featureFilter.needGeometry,V=Hs(b,L);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom),V,o))continue;const $=_?h.evaluate(V,{},o,n.availableImages):void 0,H={id:S,properties:b.properties,type:b.type,sourceLayerIndex:P,index:I,geometry:L?V.geometry:js(b),patterns:{},sortKey:$};y.push(H)}_&&y.sort((b,S)=>b.sortKey-S.sortKey);for(const b of y){const{geometry:S,index:I,sourceLayerIndex:P}=b;if(this.hasPattern){const L=kf("fill",this.layers,b,this.zoom,n);this.patternFeatures.push(L)}else this.addFeature(b,S,I,o,{});n.featureIndex.insert(e[I].feature,S,I,P,this.index)}}update(e,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,o)}addFeatures(e,n,o){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,o)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ib),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,o,h,_){for(const y of Pf(n,500)){let b=0;for(const $ of y)b+=$.length;const S=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),I=S.vertexLength,P=[],L=[];for(const $ of y){if($.length===0)continue;$!==y[0]&&L.push(P.length/2);const H=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),q=H.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(q+$.length-1,q),P.push($[0].x),P.push($[0].y);for(let te=1;te<$.length;te++)this.layoutVertexArray.emplaceBack($[te].x,$[te].y),this.indexArray2.emplaceBack(q+te-1,q+te),P.push($[te].x),P.push($[te].y);H.vertexLength+=$.length,H.primitiveLength+=$.length}const V=ug(P,L);for(let $=0;$<V.length;$+=3)this.indexArray.emplaceBack(I+V[$],I+V[$+1],I+V[$+2]);S.vertexLength+=b,S.primitiveLength+=V.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,_,h)}}let dg,fg;ut("FillBucket",Lf,{omit:["layers","patternFeatures"]});var Nb={get paint(){return fg=fg||new jr({"fill-antialias":new xt(K.paint_fill["fill-antialias"]),"fill-opacity":new kt(K.paint_fill["fill-opacity"]),"fill-color":new kt(K.paint_fill["fill-color"]),"fill-outline-color":new kt(K.paint_fill["fill-outline-color"]),"fill-translate":new xt(K.paint_fill["fill-translate"]),"fill-translate-anchor":new xt(K.paint_fill["fill-translate-anchor"]),"fill-pattern":new ma(K.paint_fill["fill-pattern"])})},get layout(){return dg=dg||new jr({"fill-sort-key":new kt(K.layout_fill["fill-sort-key"])})}};class Vb extends Fn{constructor(e){super(e,Nb)}recalculate(e,n){super.recalculate(e,n);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Lf(e)}queryRadius(){return Mh(this.paint.get("fill-translate"))}queryIntersectsFeature(e,n,o,h,_,y,b){return Sl(kh(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,b),h)}isTileClipped(){return!0}}const Ub=Ji([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),$b=Ji([{name:"a_centroid",components:2,type:"Int16"}],4),{members:jb}=Ub;var va={},Hb=R,pg=Al;function Al(r,e,n,o,h){this.properties={},this.extent=n,this.type=0,this._pbf=r,this._geometry=-1,this._keys=o,this._values=h,r.readFields(Gb,this,e)}function Gb(r,e,n){r==1?e.id=n.readVarint():r==2?function(o,h){for(var _=o.readVarint()+o.pos;o.pos<_;){var y=h._keys[o.readVarint()],b=h._values[o.readVarint()];h.properties[y]=b}}(n,e):r==3?e.type=n.readVarint():r==4&&(e._geometry=n.pos)}function qb(r){for(var e,n,o=0,h=0,_=r.length,y=_-1;h<_;y=h++)o+=((n=r[y]).x-(e=r[h]).x)*(e.y+n.y);return o}Al.types=["Unknown","Point","LineString","Polygon"],Al.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,n=r.readVarint()+r.pos,o=1,h=0,_=0,y=0,b=[];r.pos<n;){if(h<=0){var S=r.readVarint();o=7&S,h=S>>3}if(h--,o===1||o===2)_+=r.readSVarint(),y+=r.readSVarint(),o===1&&(e&&b.push(e),e=[]),e.push(new Hb(_,y));else{if(o!==7)throw new Error("unknown command "+o);e&&e.push(e[0].clone())}}return e&&b.push(e),b},Al.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,n=1,o=0,h=0,_=0,y=1/0,b=-1/0,S=1/0,I=-1/0;r.pos<e;){if(o<=0){var P=r.readVarint();n=7&P,o=P>>3}if(o--,n===1||n===2)(h+=r.readSVarint())<y&&(y=h),h>b&&(b=h),(_+=r.readSVarint())<S&&(S=_),_>I&&(I=_);else if(n!==7)throw new Error("unknown command "+n)}return[y,S,b,I]},Al.prototype.toGeoJSON=function(r,e,n){var o,h,_=this.extent*Math.pow(2,n),y=this.extent*r,b=this.extent*e,S=this.loadGeometry(),I=Al.types[this.type];function P($){for(var H=0;H<$.length;H++){var q=$[H];$[H]=[360*(q.x+y)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(q.y+b)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var L=[];for(o=0;o<S.length;o++)L[o]=S[o][0];P(S=L);break;case 2:for(o=0;o<S.length;o++)P(S[o]);break;case 3:for(S=function($){var H=$.length;if(H<=1)return[$];for(var q,te,oe=[],ve=0;ve<H;ve++){var le=qb($[ve]);le!==0&&(te===void 0&&(te=le<0),te===le<0?(q&&oe.push(q),q=[$[ve]]):q.push($[ve]))}return q&&oe.push(q),oe}(S),o=0;o<S.length;o++)for(h=0;h<S[o].length;h++)P(S[o][h])}S.length===1?S=S[0]:I="Multi"+I;var V={type:"Feature",geometry:{type:I,coordinates:S},properties:this.properties};return"id"in this&&(V.id=this.id),V};var Wb=pg,mg=gg;function gg(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(Zb,this,e),this.length=this._features.length}function Zb(r,e,n){r===15?e.version=n.readVarint():r===1?e.name=n.readString():r===5?e.extent=n.readVarint():r===2?e._features.push(n.pos):r===3?e._keys.push(n.readString()):r===4&&e._values.push(function(o){for(var h=null,_=o.readVarint()+o.pos;o.pos<_;){var y=o.readVarint()>>3;h=y===1?o.readString():y===2?o.readFloat():y===3?o.readDouble():y===4?o.readVarint64():y===5?o.readVarint():y===6?o.readSVarint():y===7?o.readBoolean():null}return h}(n))}gg.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new Wb(this._pbf,e,this.extent,this._keys,this._values)};var Kb=mg;function Yb(r,e,n){if(r===3){var o=new Kb(n,n.readVarint()+n.pos);o.length&&(e[o.name]=o)}}va.VectorTile=function(r,e){this.layers=r.readFields(Yb,{},e)},va.VectorTileFeature=pg,va.VectorTileLayer=mg;const Xb=va.VectorTileFeature.types,Rf=Math.pow(2,13);function Kc(r,e,n,o,h,_,y,b){r.emplaceBack(e,n,2*Math.floor(o*Rf)+y,h*Rf*2,_*Rf*2,Math.round(b))}class Df{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ee,this.centroidVertexArray=new j,this.indexArray=new je,this.programConfigurations=new br(e.layers,e.zoom),this.segments=new Pt,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,o){this.features=[],this.hasPattern=Mf("fill-extrusion",this.layers,n);for(const{feature:h,id:_,index:y,sourceLayerIndex:b}of e){const S=this.layers[0]._featureFilter.needGeometry,I=Hs(h,S);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom),I,o))continue;const P={id:_,sourceLayerIndex:b,index:y,geometry:S?I.geometry:js(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(kf("fill-extrusion",this.layers,P,this.zoom,n)):this.addFeature(P,P.geometry,y,o,{}),n.featureIndex.insert(h,P.geometry,y,b,this.index,!0)}}addFeatures(e,n,o){for(const h of this.features){const{geometry:_}=h;this.addFeature(h,_,h.index,n,o)}}update(e,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,o)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,jb),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,$b.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,n,o,h,_){const y={x:0,y:0,vertexCount:0};for(const b of Pf(n,500)){let S=0;for(const H of b)S+=H.length;let I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const H of b){if(H.length===0||Qb(H))continue;let q=0;for(let te=0;te<H.length;te++){const oe=H[te];if(te>=1){const ve=H[te-1];if(!Jb(oe,ve)){I.vertexLength+4>Pt.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const le=oe.sub(ve)._perp()._unit(),pe=ve.dist(oe);q+pe>32768&&(q=0),Kc(this.layoutVertexArray,oe.x,oe.y,le.x,le.y,0,0,q),Kc(this.layoutVertexArray,oe.x,oe.y,le.x,le.y,0,1,q),y.x+=2*oe.x,y.y+=2*oe.y,y.vertexCount+=2,q+=pe,Kc(this.layoutVertexArray,ve.x,ve.y,le.x,le.y,0,0,q),Kc(this.layoutVertexArray,ve.x,ve.y,le.x,le.y,0,1,q),y.x+=2*ve.x,y.y+=2*ve.y,y.vertexCount+=2;const Le=I.vertexLength;this.indexArray.emplaceBack(Le,Le+2,Le+1),this.indexArray.emplaceBack(Le+1,Le+2,Le+3),I.vertexLength+=4,I.primitiveLength+=2}}}}if(I.vertexLength+S>Pt.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),Xb[e.type]!=="Polygon")continue;const P=[],L=[],V=I.vertexLength;for(const H of b)if(H.length!==0){H!==b[0]&&L.push(P.length/2);for(let q=0;q<H.length;q++){const te=H[q];Kc(this.layoutVertexArray,te.x,te.y,0,0,1,1,0),y.x+=te.x,y.y+=te.y,y.vertexCount+=1,P.push(te.x),P.push(te.y)}}const $=ug(P,L);for(let H=0;H<$.length;H+=3)this.indexArray.emplaceBack(V+$[H],V+$[H+2],V+$[H+1]);I.primitiveLength+=$.length/3,I.vertexLength+=S}for(let b=0;b<y.vertexCount;b++)this.centroidVertexArray.emplaceBack(Math.floor(y.x/y.vertexCount),Math.floor(y.y/y.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,_,h)}}function Jb(r,e){return r.x===e.x&&(r.x<0||r.x>Ki)||r.y===e.y&&(r.y<0||r.y>Ki)}function Qb(r){return r.every(e=>e.x<0)||r.every(e=>e.x>Ki)||r.every(e=>e.y<0)||r.every(e=>e.y>Ki)}let _g;ut("FillExtrusionBucket",Df,{omit:["layers","features"]});var e1={get paint(){return _g=_g||new jr({"fill-extrusion-opacity":new xt(K["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new kt(K["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new xt(K["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new xt(K["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ma(K["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new kt(K["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new kt(K["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new xt(K["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class t1 extends Fn{constructor(e){super(e,e1)}createBucket(e){return new Df(e)}queryRadius(){return Mh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,n,o,h,_,y,b,S){const I=kh(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,b),P=this.paint.get("fill-extrusion-height").evaluate(n,o),L=this.paint.get("fill-extrusion-base").evaluate(n,o),V=function(H,q,te,oe){const ve=[];for(const le of H){const pe=[le.x,le.y,0,1];Lh(pe,pe,q),ve.push(new B(pe[0]/pe[3],pe[1]/pe[3]))}return ve}(I,S),$=function(H,q,te,oe){const ve=[],le=[],pe=oe[8]*q,Le=oe[9]*q,Ne=oe[10]*q,lt=oe[11]*q,vt=oe[8]*te,at=oe[9]*te,rt=oe[10]*te,Xe=oe[11]*te;for(const pt of H){const Je=[],We=[];for(const Tt of pt){const wt=Tt.x,Zt=Tt.y,Di=oe[0]*wt+oe[4]*Zt+oe[12],Oi=oe[1]*wt+oe[5]*Zt+oe[13],fr=oe[2]*wt+oe[6]*Zt+oe[14],Mn=oe[3]*wt+oe[7]*Zt+oe[15],cn=fr+Ne,ar=Mn+lt,Ir=Di+vt,zr=Oi+at,un=fr+rt,hn=Mn+Xe,pr=new B((Di+pe)/ar,(Oi+Le)/ar);pr.z=cn/ar,Je.push(pr);const mr=new B(Ir/hn,zr/hn);mr.z=un/hn,We.push(mr)}ve.push(Je),le.push(We)}return[ve,le]}(h,L,P,S);return function(H,q,te){let oe=1/0;Sl(te,q)&&(oe=yg(te,q[0]));for(let ve=0;ve<q.length;ve++){const le=q[ve],pe=H[ve];for(let Le=0;Le<le.length-1;Le++){const Ne=le[Le],lt=[Ne,le[Le+1],pe[Le+1],pe[Le],Ne];Uc(te,lt)&&(oe=Math.min(oe,yg(te,lt)))}}return oe!==1/0&&oe}($[0],$[1],V)}}function Yc(r,e){return r.x*e.x+r.y*e.y}function yg(r,e){if(r.length===1){let n=0;const o=e[n++];let h;for(;!h||o.equals(h);)if(h=e[n++],!h)return 1/0;for(;n<e.length;n++){const _=e[n],y=r[0],b=h.sub(o),S=_.sub(o),I=y.sub(o),P=Yc(b,b),L=Yc(b,S),V=Yc(S,S),$=Yc(I,b),H=Yc(I,S),q=P*V-L*L,te=(V*$-L*H)/q,oe=(P*H-L*$)/q,ve=o.z*(1-te-oe)+h.z*te+_.z*oe;if(isFinite(ve))return ve}return 1/0}{let n=1/0;for(const o of e)n=Math.min(n,o.z);return n}}const i1=Ji([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:r1}=i1,n1=Ji([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:s1}=n1,a1=va.VectorTileFeature.types,o1=Math.cos(Math.PI/180*37.5),vg=Math.pow(2,14)/.5;class zf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new W,this.layoutVertexArray2=new he,this.indexArray=new je,this.programConfigurations=new br(e.layers,e.zoom),this.segments=new Pt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,o){this.hasPattern=Mf("line",this.layers,n);const h=this.layers[0].layout.get("line-sort-key"),_=!h.isConstant(),y=[];for(const{feature:b,id:S,index:I,sourceLayerIndex:P}of e){const L=this.layers[0]._featureFilter.needGeometry,V=Hs(b,L);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom),V,o))continue;const $=_?h.evaluate(V,{},o):void 0,H={id:S,properties:b.properties,type:b.type,sourceLayerIndex:P,index:I,geometry:L?V.geometry:js(b),patterns:{},sortKey:$};y.push(H)}_&&y.sort((b,S)=>b.sortKey-S.sortKey);for(const b of y){const{geometry:S,index:I,sourceLayerIndex:P}=b;if(this.hasPattern){const L=kf("line",this.layers,b,this.zoom,n);this.patternFeatures.push(L)}else this.addFeature(b,S,I,o,{});n.featureIndex.insert(e[I].feature,S,I,P,this.index)}}update(e,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,o)}addFeatures(e,n,o){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,o)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,s1)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,r1),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,o,h,_){const y=this.layers[0].layout,b=y.get("line-join").evaluate(e,{}),S=y.get("line-cap"),I=y.get("line-miter-limit"),P=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const L of n)this.addLine(L,e,b,S,I,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,_,h)}addLine(e,n,o,h,_,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let oe=0;oe<e.length-1;oe++)this.totalDistance+=e[oe].dist(e[oe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=a1[n.type]==="Polygon";let S=e.length;for(;S>=2&&e[S-1].equals(e[S-2]);)S--;let I=0;for(;I<S-1&&e[I].equals(e[I+1]);)I++;if(S<(b?3:2))return;o==="bevel"&&(_=1.05);const P=this.overscaling<=16?15*Ki/(512*this.overscaling):0,L=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let V,$,H,q,te;this.e1=this.e2=-1,b&&(V=e[S-2],te=e[I].sub(V)._unit()._perp());for(let oe=I;oe<S;oe++){if(H=oe===S-1?b?e[I+1]:void 0:e[oe+1],H&&e[oe].equals(H))continue;te&&(q=te),V&&($=V),V=e[oe],te=H?H.sub(V)._unit()._perp():q,q=q||te;let ve=q.add(te);ve.x===0&&ve.y===0||ve._unit();const le=q.x*te.x+q.y*te.y,pe=ve.x*te.x+ve.y*te.y,Le=pe!==0?1/pe:1/0,Ne=2*Math.sqrt(2-2*pe),lt=pe<o1&&$&&H,vt=q.x*te.y-q.y*te.x>0;if(lt&&oe>I){const Xe=V.dist($);if(Xe>2*P){const pt=V.sub(V.sub($)._mult(P/Xe)._round());this.updateDistance($,pt),this.addCurrentVertex(pt,q,0,0,L),$=pt}}const at=$&&H;let rt=at?o:b?"butt":h;if(at&&rt==="round"&&(Le<y?rt="miter":Le<=2&&(rt="fakeround")),rt==="miter"&&Le>_&&(rt="bevel"),rt==="bevel"&&(Le>2&&(rt="flipbevel"),Le<_&&(rt="miter")),$&&this.updateDistance($,V),rt==="miter")ve._mult(Le),this.addCurrentVertex(V,ve,0,0,L);else if(rt==="flipbevel"){if(Le>100)ve=te.mult(-1);else{const Xe=Le*q.add(te).mag()/q.sub(te).mag();ve._perp()._mult(Xe*(vt?-1:1))}this.addCurrentVertex(V,ve,0,0,L),this.addCurrentVertex(V,ve.mult(-1),0,0,L)}else if(rt==="bevel"||rt==="fakeround"){const Xe=-Math.sqrt(Le*Le-1),pt=vt?Xe:0,Je=vt?0:Xe;if($&&this.addCurrentVertex(V,q,pt,Je,L),rt==="fakeround"){const We=Math.round(180*Ne/Math.PI/20);for(let Tt=1;Tt<We;Tt++){let wt=Tt/We;if(wt!==.5){const Di=wt-.5;wt+=wt*Di*(wt-1)*((1.0904+le*(le*(3.55645-1.43519*le)-3.2452))*Di*Di+(.848013+le*(.215638*le-1.06021)))}const Zt=te.sub(q)._mult(wt)._add(q)._unit()._mult(vt?-1:1);this.addHalfVertex(V,Zt.x,Zt.y,!1,vt,0,L)}}H&&this.addCurrentVertex(V,te,-pt,-Je,L)}else if(rt==="butt")this.addCurrentVertex(V,ve,0,0,L);else if(rt==="square"){const Xe=$?1:-1;this.addCurrentVertex(V,ve,Xe,Xe,L)}else rt==="round"&&($&&(this.addCurrentVertex(V,q,0,0,L),this.addCurrentVertex(V,q,1,1,L,!0)),H&&(this.addCurrentVertex(V,te,-1,-1,L,!0),this.addCurrentVertex(V,te,0,0,L)));if(lt&&oe<S-1){const Xe=V.dist(H);if(Xe>2*P){const pt=V.add(H.sub(V)._mult(P/Xe)._round());this.updateDistance(V,pt),this.addCurrentVertex(pt,te,0,0,L),V=pt}}}}addCurrentVertex(e,n,o,h,_,y=!1){const b=n.y*h-n.x,S=-n.y-n.x*h;this.addHalfVertex(e,n.x+n.y*o,n.y-n.x*o,y,!1,o,_),this.addHalfVertex(e,b,S,y,!0,-h,_),this.distance>vg/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,n,o,h,_,y))}addHalfVertex({x:e,y:n},o,h,_,y,b,S){const I=.5*(this.lineClips?this.scaledDistance*(vg-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(_?1:0),(n<<1)+(y?1:0),Math.round(63*o)+128,Math.round(63*h)+128,1+(b===0?0:b<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const P=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,P),S.primitiveLength++),y?this.e2=P:this.e1=P}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}let xg,bg;ut("LineBucket",zf,{omit:["layers","patternFeatures"]});var wg={get paint(){return bg=bg||new jr({"line-opacity":new kt(K.paint_line["line-opacity"]),"line-color":new kt(K.paint_line["line-color"]),"line-translate":new xt(K.paint_line["line-translate"]),"line-translate-anchor":new xt(K.paint_line["line-translate-anchor"]),"line-width":new kt(K.paint_line["line-width"]),"line-gap-width":new kt(K.paint_line["line-gap-width"]),"line-offset":new kt(K.paint_line["line-offset"]),"line-blur":new kt(K.paint_line["line-blur"]),"line-dasharray":new Ac(K.paint_line["line-dasharray"]),"line-pattern":new ma(K.paint_line["line-pattern"]),"line-gradient":new Cc(K.paint_line["line-gradient"])})},get layout(){return xg=xg||new jr({"line-cap":new xt(K.layout_line["line-cap"]),"line-join":new kt(K.layout_line["line-join"]),"line-miter-limit":new xt(K.layout_line["line-miter-limit"]),"line-round-limit":new xt(K.layout_line["line-round-limit"]),"line-sort-key":new kt(K.layout_line["line-sort-key"])})}};class l1 extends kt{possiblyEvaluate(e,n){return n=new ki(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(e,n)}evaluate(e,n,o,h){return n=$e({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(e,n,o,h)}}let Fh;class c1 extends Fn{constructor(e){super(e,wg),this.gradientVersion=0,Fh||(Fh=new l1(wg.paint.properties["line-width"].specification),Fh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!function(o){return o._styleExpression!==void 0}(n)&&n._styleExpression.expression instanceof no,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,n){super.recalculate(e,n),this.paint._values["line-floorwidth"]=Fh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new zf(e)}queryRadius(e){const n=e,o=Sg($c("line-width",this,n),$c("line-gap-width",this,n)),h=$c("line-offset",this,n);return o/2+Math.abs(h)+Mh(this.paint.get("line-translate"))}queryIntersectsFeature(e,n,o,h,_,y,b){const S=kh(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,b),I=b/2*Sg(this.paint.get("line-width").evaluate(n,o),this.paint.get("line-gap-width").evaluate(n,o)),P=this.paint.get("line-offset").evaluate(n,o);return P&&(h=function(L,V){const $=[];for(let H=0;H<L.length;H++){const q=L[H],te=[];for(let oe=0;oe<q.length;oe++){const ve=q[oe-1],le=q[oe],pe=q[oe+1],Le=oe===0?new B(0,0):le.sub(ve)._unit()._perp(),Ne=oe===q.length-1?new B(0,0):pe.sub(le)._unit()._perp(),lt=Le._add(Ne)._unit(),vt=lt.x*Ne.x+lt.y*Ne.y;vt!==0&&lt._mult(1/vt),te.push(lt._mult(V)._add(le))}$.push(te)}return $}(h,P*b)),function(L,V,$){for(let H=0;H<V.length;H++){const q=V[H];if(L.length>=3){for(let te=0;te<q.length;te++)if(Tl(L,q[te]))return!0}if(Ph(L,q,$))return!0}return!1}(S,h,I)}isTileClipped(){return!0}}function Sg(r,e){return e>0?e+2*r:r}const u1=Ji([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),h1=Ji([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ji([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const d1=Ji([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Ji([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Tg=Ji([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),f1=Ji([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function p1(r,e,n){return r.sections.forEach(o=>{o.text=function(h,_,y){const b=_.layout.get("text-transform").evaluate(y,{});return b==="uppercase"?h=h.toLocaleUpperCase():b==="lowercase"&&(h=h.toLocaleLowerCase()),Ns.applyArabicShaping&&(h=Ns.applyArabicShaping(h)),h}(o.text,e,n)}),r}Ji([{name:"triangle",components:3,type:"Uint16"}]),Ji([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ji([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ji([{type:"Float32",name:"offsetX"}]),Ji([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ji([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Xc={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var dr=24,Eg=Si,Ig=function(r,e,n,o,h){var _,y,b=8*h-o-1,S=(1<<b)-1,I=S>>1,P=-7,L=n?h-1:0,V=n?-1:1,$=r[e+L];for(L+=V,_=$&(1<<-P)-1,$>>=-P,P+=b;P>0;_=256*_+r[e+L],L+=V,P-=8);for(y=_&(1<<-P)-1,_>>=-P,P+=o;P>0;y=256*y+r[e+L],L+=V,P-=8);if(_===0)_=1-I;else{if(_===S)return y?NaN:1/0*($?-1:1);y+=Math.pow(2,o),_-=I}return($?-1:1)*y*Math.pow(2,_-o)},Ag=function(r,e,n,o,h,_){var y,b,S,I=8*_-h-1,P=(1<<I)-1,L=P>>1,V=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=o?0:_-1,H=o?1:-1,q=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(b=isNaN(e)?1:0,y=P):(y=Math.floor(Math.log(e)/Math.LN2),e*(S=Math.pow(2,-y))<1&&(y--,S*=2),(e+=y+L>=1?V/S:V*Math.pow(2,1-L))*S>=2&&(y++,S/=2),y+L>=P?(b=0,y=P):y+L>=1?(b=(e*S-1)*Math.pow(2,h),y+=L):(b=e*Math.pow(2,L-1)*Math.pow(2,h),y=0));h>=8;r[n+$]=255&b,$+=H,b/=256,h-=8);for(y=y<<h|b,I+=h;I>0;r[n+$]=255&y,$+=H,y/=256,I-=8);r[n+$-H]|=128*q};function Si(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Si.Varint=0,Si.Fixed64=1,Si.Bytes=2,Si.Fixed32=5;var Of=4294967296,Cg=1/Of,Pg=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Gs(r){return r.type===Si.Bytes?r.readVarint()+r.pos:r.pos+1}function Cl(r,e,n){return n?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function Mg(r,e,n){var o=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(o);for(var h=n.pos-1;h>=r;h--)n.buf[h+o]=n.buf[h]}function m1(r,e){for(var n=0;n<r.length;n++)e.writeVarint(r[n])}function g1(r,e){for(var n=0;n<r.length;n++)e.writeSVarint(r[n])}function _1(r,e){for(var n=0;n<r.length;n++)e.writeFloat(r[n])}function y1(r,e){for(var n=0;n<r.length;n++)e.writeDouble(r[n])}function v1(r,e){for(var n=0;n<r.length;n++)e.writeBoolean(r[n])}function x1(r,e){for(var n=0;n<r.length;n++)e.writeFixed32(r[n])}function b1(r,e){for(var n=0;n<r.length;n++)e.writeSFixed32(r[n])}function w1(r,e){for(var n=0;n<r.length;n++)e.writeFixed64(r[n])}function S1(r,e){for(var n=0;n<r.length;n++)e.writeSFixed64(r[n])}function Bh(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function Pl(r,e,n){r[n]=e,r[n+1]=e>>>8,r[n+2]=e>>>16,r[n+3]=e>>>24}function kg(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}Si.prototype={destroy:function(){this.buf=null},readFields:function(r,e,n){for(n=n||this.length;this.pos<n;){var o=this.readVarint(),h=o>>3,_=this.pos;this.type=7&o,r(h,e,this),this.pos===_&&this.skip(o)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=Bh(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=kg(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=Bh(this.buf,this.pos)+Bh(this.buf,this.pos+4)*Of;return this.pos+=8,r},readSFixed64:function(){var r=Bh(this.buf,this.pos)+kg(this.buf,this.pos+4)*Of;return this.pos+=8,r},readFloat:function(){var r=Ig(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=Ig(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,n,o=this.buf;return e=127&(n=o[this.pos++]),n<128?e:(e|=(127&(n=o[this.pos++]))<<7,n<128?e:(e|=(127&(n=o[this.pos++]))<<14,n<128?e:(e|=(127&(n=o[this.pos++]))<<21,n<128?e:function(h,_,y){var b,S,I=y.buf;if(b=(112&(S=I[y.pos++]))>>4,S<128||(b|=(127&(S=I[y.pos++]))<<3,S<128)||(b|=(127&(S=I[y.pos++]))<<10,S<128)||(b|=(127&(S=I[y.pos++]))<<17,S<128)||(b|=(127&(S=I[y.pos++]))<<24,S<128)||(b|=(1&(S=I[y.pos++]))<<31,S<128))return Cl(h,b,_);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=o[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&Pg?function(n,o,h){return Pg.decode(n.subarray(o,h))}(this.buf,e,r):function(n,o,h){for(var _="",y=o;y<h;){var b,S,I,P=n[y],L=null,V=P>239?4:P>223?3:P>191?2:1;if(y+V>h)break;V===1?P<128&&(L=P):V===2?(192&(b=n[y+1]))==128&&(L=(31&P)<<6|63&b)<=127&&(L=null):V===3?(S=n[y+2],(192&(b=n[y+1]))==128&&(192&S)==128&&((L=(15&P)<<12|(63&b)<<6|63&S)<=2047||L>=55296&&L<=57343)&&(L=null)):V===4&&(S=n[y+2],I=n[y+3],(192&(b=n[y+1]))==128&&(192&S)==128&&(192&I)==128&&((L=(15&P)<<18|(63&b)<<12|(63&S)<<6|63&I)<=65535||L>=1114112)&&(L=null)),L===null?(L=65533,V=1):L>65535&&(L-=65536,_+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),_+=String.fromCharCode(L),y+=V}return _}(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==Si.Bytes)return r.push(this.readVarint(e));var n=Gs(this);for(r=r||[];this.pos<n;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==Si.Bytes)return r.push(this.readSVarint());var e=Gs(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Si.Bytes)return r.push(this.readBoolean());var e=Gs(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Si.Bytes)return r.push(this.readFloat());var e=Gs(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Si.Bytes)return r.push(this.readDouble());var e=Gs(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Si.Bytes)return r.push(this.readFixed32());var e=Gs(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Si.Bytes)return r.push(this.readSFixed32());var e=Gs(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Si.Bytes)return r.push(this.readFixed64());var e=Gs(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Si.Bytes)return r.push(this.readSFixed64());var e=Gs(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===Si.Varint)for(;this.buf[this.pos++]>127;);else if(e===Si.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Si.Fixed32)this.pos+=4;else{if(e!==Si.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Pl(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Pl(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Pl(this.buf,-1&r,this.pos),Pl(this.buf,Math.floor(r*Cg),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Pl(this.buf,-1&r,this.pos),Pl(this.buf,Math.floor(r*Cg),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(e,n){var o,h;if(e>=0?(o=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(o=~(-e%4294967296))?o=o+1|0:(o=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(_,y,b){b.buf[b.pos++]=127&_|128,_>>>=7,b.buf[b.pos++]=127&_|128,_>>>=7,b.buf[b.pos++]=127&_|128,_>>>=7,b.buf[b.pos++]=127&_|128,b.buf[b.pos]=127&(_>>>=7)}(o,0,n),function(_,y){var b=(7&_)<<4;y.buf[y.pos++]|=b|((_>>>=3)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_)))))}(h,n)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=function(o,h,_){for(var y,b,S=0;S<h.length;S++){if((y=h.charCodeAt(S))>55295&&y<57344){if(!b){y>56319||S+1===h.length?(o[_++]=239,o[_++]=191,o[_++]=189):b=y;continue}if(y<56320){o[_++]=239,o[_++]=191,o[_++]=189,b=y;continue}y=b-55296<<10|y-56320|65536,b=null}else b&&(o[_++]=239,o[_++]=191,o[_++]=189,b=null);y<128?o[_++]=y:(y<2048?o[_++]=y>>6|192:(y<65536?o[_++]=y>>12|224:(o[_++]=y>>18|240,o[_++]=y>>12&63|128),o[_++]=y>>6&63|128),o[_++]=63&y|128)}return _}(this.buf,r,this.pos);var n=this.pos-e;n>=128&&Mg(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(r){this.realloc(4),Ag(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),Ag(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=r[n]},writeRawMessage:function(r,e){this.pos++;var n=this.pos;r(e,this);var o=this.pos-n;o>=128&&Mg(n,o,this),this.pos=n-1,this.writeVarint(o),this.pos+=o},writeMessage:function(r,e,n){this.writeTag(r,Si.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,m1,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,g1,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,v1,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,_1,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,y1,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,x1,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,b1,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,w1,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,S1,e)},writeBytesField:function(r,e){this.writeTag(r,Si.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,Si.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,Si.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,Si.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,Si.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,Si.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,Si.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,Si.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,Si.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,Si.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,!!e)}};var Ff=A(Eg);const Bf=3;function T1(r,e,n){r===1&&n.readMessage(E1,e)}function E1(r,e,n){if(r===3){const{id:o,bitmap:h,width:_,height:y,left:b,top:S,advance:I}=n.readMessage(I1,{});e.push({id:o,bitmap:new Hc({width:_+2*Bf,height:y+2*Bf},h),metrics:{width:_,height:y,left:b,top:S,advance:I}})}}function I1(r,e,n){r===1?e.id=n.readVarint():r===2?e.bitmap=n.readBytes():r===3?e.width=n.readVarint():r===4?e.height=n.readVarint():r===5?e.left=n.readSVarint():r===6?e.top=n.readSVarint():r===7&&(e.advance=n.readVarint())}const Lg=Bf;function Rg(r){let e=0,n=0;for(const y of r)e+=y.w*y.h,n=Math.max(n,y.w);r.sort((y,b)=>b.h-y.h);const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let h=0,_=0;for(const y of r)for(let b=o.length-1;b>=0;b--){const S=o[b];if(!(y.w>S.w||y.h>S.h)){if(y.x=S.x,y.y=S.y,_=Math.max(_,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===S.w&&y.h===S.h){const I=o.pop();b<o.length&&(o[b]=I)}else y.h===S.h?(S.x+=y.w,S.w-=y.w):y.w===S.w?(S.y+=y.h,S.h-=y.h):(o.push({x:S.x+y.w,y:S.y,w:S.w-y.w,h:y.h}),S.y+=y.h,S.h-=y.h);break}}return{w:h,h:_,fill:e/(h*_)||0}}const vn=1;class Nf{constructor(e,{pixelRatio:n,version:o,stretchX:h,stretchY:_,content:y}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=h,this.stretchY=_,this.content=y,this.version=o}get tl(){return[this.paddedRect.x+vn,this.paddedRect.y+vn]}get br(){return[this.paddedRect.x+this.paddedRect.w-vn,this.paddedRect.y+this.paddedRect.h-vn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*vn)/this.pixelRatio,(this.paddedRect.h-2*vn)/this.pixelRatio]}}class Dg{constructor(e,n){const o={},h={};this.haveRenderCallbacks=[];const _=[];this.addImages(e,o,_),this.addImages(n,h,_);const{w:y,h:b}=Rg(_),S=new Bn({width:y||1,height:b||1});for(const I in e){const P=e[I],L=o[I].paddedRect;Bn.copy(P.data,S,{x:0,y:0},{x:L.x+vn,y:L.y+vn},P.data)}for(const I in n){const P=n[I],L=h[I].paddedRect,V=L.x+vn,$=L.y+vn,H=P.data.width,q=P.data.height;Bn.copy(P.data,S,{x:0,y:0},{x:V,y:$},P.data),Bn.copy(P.data,S,{x:0,y:q-1},{x:V,y:$-1},{width:H,height:1}),Bn.copy(P.data,S,{x:0,y:0},{x:V,y:$+q},{width:H,height:1}),Bn.copy(P.data,S,{x:H-1,y:0},{x:V-1,y:$},{width:1,height:q}),Bn.copy(P.data,S,{x:0,y:0},{x:V+H,y:$},{width:1,height:q})}this.image=S,this.iconPositions=o,this.patternPositions=h}addImages(e,n,o){for(const h in e){const _=e[h],y={x:0,y:0,w:_.data.width+2*vn,h:_.data.height+2*vn};o.push(y),n[h]=new Nf(y,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,n){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const o in e.updatedImages)this.patchUpdatedImage(this.iconPositions[o],e.getImage(o),n),this.patchUpdatedImage(this.patternPositions[o],e.getImage(o),n)}patchUpdatedImage(e,n,o){if(!e||!n||e.version===n.version)return;e.version=n.version;const[h,_]=e.tl;o.update(n.data,void 0,{x:h,y:_})}}var xa;ut("ImagePosition",Nf),ut("ImageAtlas",Dg),v.ah=void 0,(xa=v.ah||(v.ah={}))[xa.none=0]="none",xa[xa.horizontal=1]="horizontal",xa[xa.vertical=2]="vertical",xa[xa.horizontalOnly=3]="horizontalOnly";const Jc=-17;class Qc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const o=new Qc;return o.scale=e||1,o.fontStack=n,o}static forImage(e){const n=new Qc;return n.imageName=e,n}}class Ml{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const o=new Ml;for(let h=0;h<e.sections.length;h++){const _=e.sections[h];_.image?o.addImageSection(_):o.addTextSection(_,n)}return o}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let n="";for(let o=0;o<e.length;o++){const h=e.charCodeAt(o+1)||null,_=e.charCodeAt(o-1)||null;n+=h&&gl(h)&&!Xc[e[o+1]]||_&&gl(_)&&!Xc[e[o-1]]||!Xc[e[o]]?e[o]:Xc[e[o]]}return n}(this.text)}trim(){let e=0;for(let o=0;o<this.text.length&&Vh[this.text.charCodeAt(o)];o++)e++;let n=this.text.length;for(let o=this.text.length-1;o>=0&&o>=e&&Vh[this.text.charCodeAt(o)];o--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const o=new Ml;return o.text=this.text.substring(e,n),o.sectionIndex=this.sectionIndex.slice(e,n),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(Qc.forText(e.scale,e.fontStack||n));const o=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(o)}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void bt("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCharCode(o),this.sections.push(Qc.forImage(n)),this.sectionIndex.push(this.sections.length-1)):bt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Nh(r,e,n,o,h,_,y,b,S,I,P,L,V,$,H,q){const te=Ml.fromFeature(r,h);let oe;L===v.ah.vertical&&te.verticalizePunctuation();const{processBidirectionalText:ve,processStyledBidirectionalText:le}=Ns;if(ve&&te.sections.length===1){oe=[];const Ne=ve(te.toString(),Vf(te,I,_,e,o,$,H));for(const lt of Ne){const vt=new Ml;vt.text=lt,vt.sections=te.sections;for(let at=0;at<lt.length;at++)vt.sectionIndex.push(0);oe.push(vt)}}else if(le){oe=[];const Ne=le(te.text,te.sectionIndex,Vf(te,I,_,e,o,$,H));for(const lt of Ne){const vt=new Ml;vt.text=lt[0],vt.sectionIndex=lt[1],vt.sections=te.sections,oe.push(vt)}}else oe=function(Ne,lt){const vt=[],at=Ne.text;let rt=0;for(const Xe of lt)vt.push(Ne.substring(rt,Xe)),rt=Xe;return rt<at.length&&vt.push(Ne.substring(rt,at.length)),vt}(te,Vf(te,I,_,e,o,$,H));const pe=[],Le={positionedLines:pe,text:te.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:L,iconsInText:!1,verticalizable:!1};return function(Ne,lt,vt,at,rt,Xe,pt,Je,We,Tt,wt,Zt){let Di=0,Oi=Jc,fr=0,Mn=0;const cn=Je==="right"?1:Je==="left"?0:.5;let ar=0;for(const pr of rt){pr.trim();const mr=pr.getMaxScale(),qr=(mr-1)*dr,dn={positionedGlyphs:[],lineOffset:0};Ne.positionedLines[ar]=dn;const Wr=dn.positionedGlyphs;let xn=0;if(!pr.length()){Oi+=Xe,++ar;continue}for(let gr=0;gr<pr.length();gr++){const ti=pr.getSection(gr),Zr=pr.getSectionIndex(gr),Or=pr.getCharCode(gr);let _r=0,Yn=null,ns=null,ss=null,qs=dr;const Xn=!(We===v.ah.horizontal||!wt&&!ml(Or)||wt&&(Vh[Or]||(Ir=Or,st.Arabic(Ir)||st["Arabic Supplement"](Ir)||st["Arabic Extended-A"](Ir)||st["Arabic Presentation Forms-A"](Ir)||st["Arabic Presentation Forms-B"](Ir))));if(ti.imageName){const Vn=at[ti.imageName];if(!Vn)continue;ss=ti.imageName,Ne.iconsInText=Ne.iconsInText||!0,ns=Vn.paddedRect;const wn=Vn.displaySize;ti.scale=ti.scale*dr/Zt,Yn={width:wn[0],height:wn[1],left:vn,top:-Lg,advance:Xn?wn[1]:wn[0]},_r=qr+(dr-wn[1]*ti.scale),qs=Yn.advance;const Ws=Xn?wn[0]*ti.scale-dr*mr:wn[1]*ti.scale-dr*mr;Ws>0&&Ws>xn&&(xn=Ws)}else{const Vn=vt[ti.fontStack],wn=Vn&&Vn[Or];if(wn&&wn.rect)ns=wn.rect,Yn=wn.metrics;else{const Ws=lt[ti.fontStack],nu=Ws&&Ws[Or];if(!nu)continue;Yn=nu.metrics}_r=(mr-ti.scale)*dr}Xn?(Ne.verticalizable=!0,Wr.push({glyph:Or,imageName:ss,x:Di,y:Oi+_r,vertical:Xn,scale:ti.scale,fontStack:ti.fontStack,sectionIndex:Zr,metrics:Yn,rect:ns}),Di+=qs*ti.scale+Tt):(Wr.push({glyph:Or,imageName:ss,x:Di,y:Oi+_r,vertical:Xn,scale:ti.scale,fontStack:ti.fontStack,sectionIndex:Zr,metrics:Yn,rect:ns}),Di+=Yn.advance*ti.scale+Tt)}Wr.length!==0&&(fr=Math.max(Di-Tt,fr),P1(Wr,0,Wr.length-1,cn,xn)),Di=0;const bn=Xe*mr+xn;dn.lineOffset=Math.max(xn,qr),Oi+=bn,Mn=Math.max(bn,Mn),++ar}var Ir;const zr=Oi-Jc,{horizontalAlign:un,verticalAlign:hn}=Uf(pt);(function(pr,mr,qr,dn,Wr,xn,bn,gr,ti){const Zr=(mr-qr)*Wr;let Or=0;Or=xn!==bn?-gr*dn-Jc:(-dn*ti+.5)*bn;for(const _r of pr)for(const Yn of _r.positionedGlyphs)Yn.x+=Zr,Yn.y+=Or})(Ne.positionedLines,cn,un,hn,fr,Mn,Xe,zr,rt.length),Ne.top+=-hn*zr,Ne.bottom=Ne.top+zr,Ne.left+=-un*fr,Ne.right=Ne.left+fr}(Le,e,n,o,oe,y,b,S,L,I,V,q),!function(Ne){for(const lt of Ne)if(lt.positionedGlyphs.length!==0)return!1;return!0}(pe)&&Le}const Vh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},A1={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function zg(r,e,n,o,h,_){if(e.imageName){const y=o[e.imageName];return y?y.displaySize[0]*e.scale*dr/_+h:0}{const y=n[e.fontStack],b=y&&y[r];return b?b.metrics.advance*e.scale+h:0}}function Og(r,e,n,o){const h=Math.pow(r-e,2);return o?r<e?h/2:2*h:h+Math.abs(n)*n}function C1(r,e,n){let o=0;return r===10&&(o-=1e4),n&&(o+=150),r!==40&&r!==65288||(o+=50),e!==41&&e!==65289||(o+=50),o}function Fg(r,e,n,o,h,_){let y=null,b=Og(e,n,h,_);for(const S of o){const I=Og(e-S.x,n,h,_)+S.badness;I<=b&&(y=S,b=I)}return{index:r,x:e,priorBreak:y,badness:b}}function Bg(r){return r?Bg(r.priorBreak).concat(r.index):[]}function Vf(r,e,n,o,h,_,y){if(_!=="point")return[];if(!r)return[];const b=[],S=function(V,$,H,q,te,oe){let ve=0;for(let le=0;le<V.length();le++){const pe=V.getSection(le);ve+=zg(V.getCharCode(le),pe,q,te,$,oe)}return ve/Math.max(1,Math.ceil(ve/H))}(r,e,n,o,h,y),I=r.text.indexOf("")>=0;let P=0;for(let V=0;V<r.length();V++){const $=r.getSection(V),H=r.getCharCode(V);if(Vh[H]||(P+=zg(H,$,o,h,e,y)),V<r.length()-1){const q=!((L=H)<11904||!(st["Bopomofo Extended"](L)||st.Bopomofo(L)||st["CJK Compatibility Forms"](L)||st["CJK Compatibility Ideographs"](L)||st["CJK Compatibility"](L)||st["CJK Radicals Supplement"](L)||st["CJK Strokes"](L)||st["CJK Symbols and Punctuation"](L)||st["CJK Unified Ideographs Extension A"](L)||st["CJK Unified Ideographs"](L)||st["Enclosed CJK Letters and Months"](L)||st["Halfwidth and Fullwidth Forms"](L)||st.Hiragana(L)||st["Ideographic Description Characters"](L)||st["Kangxi Radicals"](L)||st["Katakana Phonetic Extensions"](L)||st.Katakana(L)||st["Vertical Forms"](L)||st["Yi Radicals"](L)||st["Yi Syllables"](L)));(A1[H]||q||$.imageName)&&b.push(Fg(V+1,P,S,b,C1(H,r.getCharCode(V+1),q&&I),!1))}}var L;return Bg(Fg(r.length(),P,S,b,0,!0))}function Uf(r){let e=.5,n=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function P1(r,e,n,o,h){if(!o&&!h)return;const _=r[n],y=(r[n].x+_.metrics.advance*_.scale)*o;for(let b=e;b<=n;b++)r[b].x-=y,r[b].y+=h}function M1(r,e,n){const{horizontalAlign:o,verticalAlign:h}=Uf(n),_=e[0]-r.displaySize[0]*o,y=e[1]-r.displaySize[1]*h;return{image:r,top:y,bottom:y+r.displaySize[1],left:_,right:_+r.displaySize[0]}}function Ng(r,e,n,o,h,_){const y=r.image;let b;if(y.content){const te=y.content,oe=y.pixelRatio||1;b=[te[0]/oe,te[1]/oe,y.displaySize[0]-te[2]/oe,y.displaySize[1]-te[3]/oe]}const S=e.left*_,I=e.right*_;let P,L,V,$;n==="width"||n==="both"?($=h[0]+S-o[3],L=h[0]+I+o[1]):($=h[0]+(S+I-y.displaySize[0])/2,L=$+y.displaySize[0]);const H=e.top*_,q=e.bottom*_;return n==="height"||n==="both"?(P=h[1]+H-o[0],V=h[1]+q+o[2]):(P=h[1]+(H+q-y.displaySize[1])/2,V=P+y.displaySize[1]),{image:y,top:P,right:L,bottom:V,left:$,collisionPadding:b}}const eu=255,xs=128,ba=eu*xs;function Vg(r,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new ki(r+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:h}=n;let _=0;for(;_<o.length&&o[_]<=r;)_++;_=Math.max(0,_-1);let y=_;for(;y<o.length&&o[y]<r+1;)y++;y=Math.min(o.length-1,y);const b=o[_],S=o[y];return n.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:S,interpolationType:h}:{kind:"camera",minZoom:b,maxZoom:S,minSize:n.evaluate(new ki(b)),maxSize:n.evaluate(new ki(S)),interpolationType:h}}}function $f(r,e,n){let o="never";const h=r.get(e);return h?o=h:r.get(n)&&(o="always"),o}const k1=va.VectorTileFeature.types,L1=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Uh(r,e,n,o,h,_,y,b,S,I,P,L,V){const $=b?Math.min(ba,Math.round(b[0])):0,H=b?Math.min(ba,Math.round(b[1])):0;r.emplaceBack(e,n,Math.round(32*o),Math.round(32*h),_,y,($<<1)+(S?1:0),H,16*I,16*P,256*L,256*V)}function jf(r,e,n){r.emplaceBack(e.x,e.y,n),r.emplaceBack(e.x,e.y,n),r.emplaceBack(e.x,e.y,n),r.emplaceBack(e.x,e.y,n)}function R1(r){for(const e of r.sections)if(bh(e.text))return!0;return!1}class Hf{constructor(e){this.layoutVertexArray=new ne,this.indexArray=new je,this.programConfigurations=e,this.segments=new Pt,this.dynamicLayoutVertexArray=new ge,this.opacityVertexArray=new Ie,this.hasVisibleVertices=!1,this.placedSymbolArray=new u}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,o,h){this.isEmpty()||(o&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,u1.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,h1.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,L1,!0),this.opacityVertexBuffer.itemSize=1),(o||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ut("SymbolBuffers",Hf);class Gf{constructor(e,n,o){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new o,this.segments=new Pt,this.collisionVertexArray=new Fe}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,d1.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ut("CollisionBuffers",Gf);class kl{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=wf([]),this.placementViewportMatrix=wf([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Vg(this.zoom,n["text-size"]),this.iconSizeData=Vg(this.zoom,n["icon-size"]);const o=this.layers[0].layout,h=o.get("symbol-sort-key"),_=o.get("symbol-z-order");this.canOverlap=$f(o,"text-overlap","text-allow-overlap")!=="never"||$f(o,"icon-overlap","icon-allow-overlap")!=="never"||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,o.get("symbol-placement")==="point"&&(this.writingModes=o.get("text-writing-mode").map(y=>v.ah[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID}createArrays(){this.text=new Hf(new br(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Hf(new br(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new w,this.lineVertexArray=new T,this.symbolInstances=new g,this.textAnchorOffsets=new C}calculateGlyphDependencies(e,n,o,h,_){for(let y=0;y<e.length;y++)if(n[e.charCodeAt(y)]=!0,(o||h)&&_){const b=Xc[e.charAt(y)];b&&(n[b.charCodeAt(0)]=!0)}}populate(e,n,o){const h=this.layers[0],_=h.layout,y=_.get("text-font"),b=_.get("text-field"),S=_.get("icon-image"),I=(b.value.kind!=="constant"||b.value.value instanceof gn&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),P=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,L=_.get("symbol-sort-key");if(this.features=[],!I&&!P)return;const V=n.iconDependencies,$=n.glyphDependencies,H=n.availableImages,q=new ki(this.zoom);for(const{feature:te,id:oe,index:ve,sourceLayerIndex:le}of e){const pe=h._featureFilter.needGeometry,Le=Hs(te,pe);if(!h._featureFilter.filter(q,Le,o))continue;let Ne,lt;if(pe||(Le.geometry=js(te)),I){const at=h.getValueAndResolveTokens("text-field",Le,o,H),rt=gn.factory(at);R1(rt)&&(this.hasRTLText=!0),(!this.hasRTLText||Ns.getRTLTextPluginStatus()==="unavailable"||this.hasRTLText&&Ns.isParsed())&&(Ne=p1(rt,h,Le))}if(P){const at=h.getValueAndResolveTokens("icon-image",Le,o,H);lt=at instanceof An?at:An.fromString(at)}if(!Ne&&!lt)continue;const vt=this.sortFeaturesByKey?L.evaluate(Le,{},o):void 0;if(this.features.push({id:oe,text:Ne,icon:lt,index:ve,sourceLayerIndex:le,geometry:Le.geometry,properties:te.properties,type:k1[te.type],sortKey:vt}),lt&&(V[lt.name]=!0),Ne){const at=y.evaluate(Le,{},o).join(","),rt=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(v.ah.vertical)>=0;for(const Xe of Ne.sections)if(Xe.image)V[Xe.image.name]=!0;else{const pt=pl(Ne.toString()),Je=Xe.fontStack||at,We=$[Je]=$[Je]||{};this.calculateGlyphDependencies(Xe.text,We,rt,this.allowVerticalPlacement,pt)}}}_.get("symbol-placement")==="line"&&(this.features=function(te){const oe={},ve={},le=[];let pe=0;function Le(at){le.push(te[at]),pe++}function Ne(at,rt,Xe){const pt=ve[at];return delete ve[at],ve[rt]=pt,le[pt].geometry[0].pop(),le[pt].geometry[0]=le[pt].geometry[0].concat(Xe[0]),pt}function lt(at,rt,Xe){const pt=oe[rt];return delete oe[rt],oe[at]=pt,le[pt].geometry[0].shift(),le[pt].geometry[0]=Xe[0].concat(le[pt].geometry[0]),pt}function vt(at,rt,Xe){const pt=Xe?rt[0][rt[0].length-1]:rt[0][0];return`${at}:${pt.x}:${pt.y}`}for(let at=0;at<te.length;at++){const rt=te[at],Xe=rt.geometry,pt=rt.text?rt.text.toString():null;if(!pt){Le(at);continue}const Je=vt(pt,Xe),We=vt(pt,Xe,!0);if(Je in ve&&We in oe&&ve[Je]!==oe[We]){const Tt=lt(Je,We,Xe),wt=Ne(Je,We,le[Tt].geometry);delete oe[Je],delete ve[We],ve[vt(pt,le[wt].geometry,!0)]=wt,le[Tt].geometry=null}else Je in ve?Ne(Je,We,Xe):We in oe?lt(Je,We,Xe):(Le(at),oe[Je]=pe-1,ve[We]=pe-1)}return le.filter(at=>at.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((te,oe)=>te.sortKey-oe.sortKey)}update(e,n,o){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,o),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,o))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const o=this.lineVertexArray.length;if(e.segment!==void 0){let h=e.dist(n[e.segment+1]),_=e.dist(n[e.segment]);const y={};for(let b=e.segment+1;b<n.length;b++)y[b]={x:n[b].x,y:n[b].y,tileUnitDistanceFromAnchor:h},b<n.length-1&&(h+=n[b+1].dist(n[b]));for(let b=e.segment||0;b>=0;b--)y[b]={x:n[b].x,y:n[b].y,tileUnitDistanceFromAnchor:_},b>0&&(_+=n[b-1].dist(n[b]));for(let b=0;b<n.length;b++){const S=y[b];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(e,n,o,h,_,y,b,S,I,P,L,V){const $=e.indexArray,H=e.layoutVertexArray,q=e.segments.prepareSegment(4*n.length,H,$,this.canOverlap?y.sortKey:void 0),te=this.glyphOffsetArray.length,oe=q.vertexLength,ve=this.allowVerticalPlacement&&b===v.ah.vertical?Math.PI/2:0,le=y.text&&y.text.sections;for(let pe=0;pe<n.length;pe++){const{tl:Le,tr:Ne,bl:lt,br:vt,tex:at,pixelOffsetTL:rt,pixelOffsetBR:Xe,minFontScaleX:pt,minFontScaleY:Je,glyphOffset:We,isSDF:Tt,sectionIndex:wt}=n[pe],Zt=q.vertexLength,Di=We[1];Uh(H,S.x,S.y,Le.x,Di+Le.y,at.x,at.y,o,Tt,rt.x,rt.y,pt,Je),Uh(H,S.x,S.y,Ne.x,Di+Ne.y,at.x+at.w,at.y,o,Tt,Xe.x,rt.y,pt,Je),Uh(H,S.x,S.y,lt.x,Di+lt.y,at.x,at.y+at.h,o,Tt,rt.x,Xe.y,pt,Je),Uh(H,S.x,S.y,vt.x,Di+vt.y,at.x+at.w,at.y+at.h,o,Tt,Xe.x,Xe.y,pt,Je),jf(e.dynamicLayoutVertexArray,S,ve),$.emplaceBack(Zt,Zt+1,Zt+2),$.emplaceBack(Zt+1,Zt+2,Zt+3),q.vertexLength+=4,q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(We[0]),pe!==n.length-1&&wt===n[pe+1].sectionIndex||e.programConfigurations.populatePaintArrays(H.length,y,y.index,{},V,le&&le[wt])}e.placedSymbolArray.emplaceBack(S.x,S.y,te,this.glyphOffsetArray.length-te,oe,I,P,S.segment,o?o[0]:0,o?o[1]:0,h[0],h[1],b,0,!1,0,L)}_addCollisionDebugVertex(e,n,o,h,_,y){return n.emplaceBack(0,0),e.emplaceBack(o.x,o.y,h,_,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(e,n,o,h,_,y,b){const S=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),I=S.vertexLength,P=_.layoutVertexArray,L=_.collisionVertexArray,V=b.anchorX,$=b.anchorY;this._addCollisionDebugVertex(P,L,y,V,$,new B(e,n)),this._addCollisionDebugVertex(P,L,y,V,$,new B(o,n)),this._addCollisionDebugVertex(P,L,y,V,$,new B(o,h)),this._addCollisionDebugVertex(P,L,y,V,$,new B(e,h)),S.vertexLength+=4;const H=_.indexArray;H.emplaceBack(I,I+1),H.emplaceBack(I+1,I+2),H.emplaceBack(I+2,I+3),H.emplaceBack(I+3,I),S.primitiveLength+=4}addDebugCollisionBoxes(e,n,o,h){for(let _=e;_<n;_++){const y=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,h?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,o)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Gf(Ee,Tg.members,Ue),this.iconCollisionBox=new Gf(Ee,Tg.members,Ue);for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(e,n,o,h,_,y,b,S,I){const P={};for(let L=n;L<o;L++){const V=e.get(L);P.textBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},P.textFeatureIndex=V.featureIndex;break}for(let L=h;L<_;L++){const V=e.get(L);P.verticalTextBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},P.verticalTextFeatureIndex=V.featureIndex;break}for(let L=y;L<b;L++){const V=e.get(L);P.iconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},P.iconFeatureIndex=V.featureIndex;break}for(let L=S;L<I;L++){const V=e.get(L);P.verticalIconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},P.verticalIconFeatureIndex=V.featureIndex;break}return P}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const o=e.placedSymbolArray.get(n),h=o.vertexStartIndex+4*o.numGlyphs;for(let _=o.vertexStartIndex;_<h;_+=4)e.indexArray.emplaceBack(_,_+1,_+2),e.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),o=Math.cos(e),h=[],_=[],y=[];for(let b=0;b<this.symbolInstances.length;++b){y.push(b);const S=this.symbolInstances.get(b);h.push(0|Math.round(n*S.anchorX+o*S.anchorY)),_.push(S.featureIndex)}return y.sort((b,S)=>h[b]-h[S]||_[S]-_[b]),y}addToSortKeyRanges(e,n){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===n?o.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const o=this.symbolInstances.get(n);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((h,_,y)=>{h>=0&&y.indexOf(h)===_&&this.addIndicesForPlacedSymbol(this.text,h)}),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Ug,$g;ut("SymbolBucket",kl,{omit:["layers","collisionBoxArray","features","compareText"]}),kl.MAX_GLYPHS=65535,kl.addDynamicAttributes=jf;var qf={get paint(){return $g=$g||new jr({"icon-opacity":new kt(K.paint_symbol["icon-opacity"]),"icon-color":new kt(K.paint_symbol["icon-color"]),"icon-halo-color":new kt(K.paint_symbol["icon-halo-color"]),"icon-halo-width":new kt(K.paint_symbol["icon-halo-width"]),"icon-halo-blur":new kt(K.paint_symbol["icon-halo-blur"]),"icon-translate":new xt(K.paint_symbol["icon-translate"]),"icon-translate-anchor":new xt(K.paint_symbol["icon-translate-anchor"]),"text-opacity":new kt(K.paint_symbol["text-opacity"]),"text-color":new kt(K.paint_symbol["text-color"],{runtimeType:gi,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new kt(K.paint_symbol["text-halo-color"]),"text-halo-width":new kt(K.paint_symbol["text-halo-width"]),"text-halo-blur":new kt(K.paint_symbol["text-halo-blur"]),"text-translate":new xt(K.paint_symbol["text-translate"]),"text-translate-anchor":new xt(K.paint_symbol["text-translate-anchor"])})},get layout(){return Ug=Ug||new jr({"symbol-placement":new xt(K.layout_symbol["symbol-placement"]),"symbol-spacing":new xt(K.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new xt(K.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new kt(K.layout_symbol["symbol-sort-key"]),"symbol-z-order":new xt(K.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new xt(K.layout_symbol["icon-allow-overlap"]),"icon-overlap":new xt(K.layout_symbol["icon-overlap"]),"icon-ignore-placement":new xt(K.layout_symbol["icon-ignore-placement"]),"icon-optional":new xt(K.layout_symbol["icon-optional"]),"icon-rotation-alignment":new xt(K.layout_symbol["icon-rotation-alignment"]),"icon-size":new kt(K.layout_symbol["icon-size"]),"icon-text-fit":new xt(K.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new xt(K.layout_symbol["icon-text-fit-padding"]),"icon-image":new kt(K.layout_symbol["icon-image"]),"icon-rotate":new kt(K.layout_symbol["icon-rotate"]),"icon-padding":new kt(K.layout_symbol["icon-padding"]),"icon-keep-upright":new xt(K.layout_symbol["icon-keep-upright"]),"icon-offset":new kt(K.layout_symbol["icon-offset"]),"icon-anchor":new kt(K.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new xt(K.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new xt(K.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new xt(K.layout_symbol["text-rotation-alignment"]),"text-field":new kt(K.layout_symbol["text-field"]),"text-font":new kt(K.layout_symbol["text-font"]),"text-size":new kt(K.layout_symbol["text-size"]),"text-max-width":new kt(K.layout_symbol["text-max-width"]),"text-line-height":new xt(K.layout_symbol["text-line-height"]),"text-letter-spacing":new kt(K.layout_symbol["text-letter-spacing"]),"text-justify":new kt(K.layout_symbol["text-justify"]),"text-radial-offset":new kt(K.layout_symbol["text-radial-offset"]),"text-variable-anchor":new xt(K.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new kt(K.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new kt(K.layout_symbol["text-anchor"]),"text-max-angle":new xt(K.layout_symbol["text-max-angle"]),"text-writing-mode":new xt(K.layout_symbol["text-writing-mode"]),"text-rotate":new kt(K.layout_symbol["text-rotate"]),"text-padding":new xt(K.layout_symbol["text-padding"]),"text-keep-upright":new xt(K.layout_symbol["text-keep-upright"]),"text-transform":new kt(K.layout_symbol["text-transform"]),"text-offset":new kt(K.layout_symbol["text-offset"]),"text-allow-overlap":new xt(K.layout_symbol["text-allow-overlap"]),"text-overlap":new xt(K.layout_symbol["text-overlap"]),"text-ignore-placement":new xt(K.layout_symbol["text-ignore-placement"]),"text-optional":new xt(K.layout_symbol["text-optional"])})}};class jg{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:rr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ut("FormatSectionOverride",jg,{omit:["defaultValue"]});class $h extends Fn{constructor(e){super(e,qf)}recalculate(e,n){if(super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const o=this.layout.get("text-writing-mode");if(o){const h=[];for(const _ of o)h.indexOf(_)<0&&h.push(_);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,n,o,h){const _=this.layout.get(e).evaluate(n,{},o,h),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||Ti(y.value)||!_?_:function(b,S){return S.replace(/{([^{}]+)}/g,(I,P)=>b&&P in b?String(b[P]):"")}(n.properties,_)}createBucket(e){return new kl(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of qf.paint.overridableProperties){if(!$h.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),o=new jg(n),h=new Mi(o,n.property.specification);let _=null;_=n.value.kind==="constant"||n.value.kind==="source"?new rl("source",h):new gc("composite",h,n.value.zoomStops),this.paint._values[e]=new On(n.property,_,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,o){return!(!this.layout||n.isDataDriven()||o.isDataDriven())&&$h.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const o=e.get("text-field"),h=qf.paint.properties[n];let _=!1;const y=b=>{for(const S of b)if(h.overrides&&h.overrides.hasOverride(S))return void(_=!0)};if(o.value.kind==="constant"&&o.value.value instanceof gn)y(o.value.value.sections);else if(o.value.kind==="source"){const b=I=>{_||(I instanceof fs&&sr(I.value)===or?y(I.value.sections):I instanceof tl?y(I.sections):I.eachChild(b))},S=o.value;S._styleExpression&&b(S._styleExpression.expression)}return _}}let Hg;var D1={get paint(){return Hg=Hg||new jr({"background-color":new xt(K.paint_background["background-color"]),"background-pattern":new Ac(K.paint_background["background-pattern"]),"background-opacity":new xt(K.paint_background["background-opacity"])})}};class z1 extends Fn{constructor(e){super(e,D1)}}let Gg;var O1={get paint(){return Gg=Gg||new jr({"raster-opacity":new xt(K.paint_raster["raster-opacity"]),"raster-hue-rotate":new xt(K.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new xt(K.paint_raster["raster-brightness-min"]),"raster-brightness-max":new xt(K.paint_raster["raster-brightness-max"]),"raster-saturation":new xt(K.paint_raster["raster-saturation"]),"raster-contrast":new xt(K.paint_raster["raster-contrast"]),"raster-resampling":new xt(K.paint_raster["raster-resampling"]),"raster-fade-duration":new xt(K.paint_raster["raster-fade-duration"])})}};class F1 extends Fn{constructor(e){super(e,O1)}}class B1 extends Fn{constructor(e){super(e,{}),this.onAdd=n=>{this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)},this.onRemove=n=>{this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class N1{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Wf=63710088e-1;class wa{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new wa(Ae(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,o=this.lat*n,h=e.lat*n,_=Math.sin(o)*Math.sin(h)+Math.cos(o)*Math.cos(h)*Math.cos((e.lng-this.lng)*n);return Wf*Math.acos(Math.min(_,1))}static convert(e){if(e instanceof wa)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new wa(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new wa(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const qg=2*Math.PI*Wf;function Wg(r){return qg*Math.cos(r*Math.PI/180)}function Zg(r){return(180+r)/360}function Kg(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Yg(r,e){return r/Wg(e)}function Zf(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class jh{constructor(e,n,o=0){this.x=+e,this.y=+n,this.z=+o}static fromLngLat(e,n=0){const o=wa.convert(e);return new jh(Zg(o.lng),Kg(o.lat),Yg(n,o.lat))}toLngLat(){return new wa(360*this.x-180,Zf(this.y))}toAltitude(){return this.z*Wg(Zf(this.y))}meterInMercatorCoordinateUnits(){return 1/qg*(e=Zf(this.y),1/Math.cos(e*Math.PI/180));var e}}function Xg(r,e,n){var o=2*Math.PI*6378137/256/Math.pow(2,n);return[r*o-2*Math.PI*6378137/2,e*o-2*Math.PI*6378137/2]}class Kf{constructor(e,n,o){if(e<0||e>25||o<0||o>=Math.pow(2,e)||n<0||n>=Math.pow(2,e))throw new Error(`x=${n}, y=${o}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=n,this.y=o,this.key=tu(0,e,e,n,o)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n,o){const h=(y=this.y,b=this.z,S=Xg(256*(_=this.x),256*(y=Math.pow(2,b)-y-1),b),I=Xg(256*(_+1),256*(y+1),b),S[0]+","+S[1]+","+I[0]+","+I[1]);var _,y,b,S,I;const P=function(L,V,$){let H,q="";for(let te=L;te>0;te--)H=1<<te-1,q+=(V&H?1:0)+($&H?2:0);return q}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,P).replace(/{bbox-epsg-3857}/g,h)}isChildOf(e){const n=this.z-e.z;return n>0&&e.x===this.x>>n&&e.y===this.y>>n}getTilePoint(e){const n=Math.pow(2,this.z);return new B((e.x*n-this.x)*Ki,(e.y*n-this.y)*Ki)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Jg{constructor(e,n){this.wrap=e,this.canonical=n,this.key=tu(e,n.z,n.z,n.x,n.y)}}class Nn{constructor(e,n,o,h,_){if(e<o)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${o}`);this.overscaledZ=e,this.wrap=n,this.canonical=new Kf(o,+h,+_),this.key=tu(n,e,o,h,_)}clone(){return new Nn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-e;return e>this.canonical.z?new Nn(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Nn(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-e;return e>this.canonical.z?tu(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y):tu(this.wrap*+n,e,e,this.canonical.x>>o,this.canonical.y>>o)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new Nn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,o=2*this.canonical.x,h=2*this.canonical.y;return[new Nn(n,this.wrap,n,o,h),new Nn(n,this.wrap,n,o+1,h),new Nn(n,this.wrap,n,o,h+1),new Nn(n,this.wrap,n,o+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Nn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Nn(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Jg(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new jh(e.x-this.wrap,e.y))}}function tu(r,e,n,o,h){(r*=2)<0&&(r=-1*r-1);const _=1<<n;return(_*_*r+_*h+o).toString(36)+n.toString(36)+e.toString(36)}ut("CanonicalTileID",Kf),ut("OverscaledTileID",Nn,{omit:["posMatrix"]});class Qg{constructor(e,n,o,h=1,_=1,y=1,b=0){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(o&&!["mapbox","terrarium","custom"].includes(o))return void bt(`"${o}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const S=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),o){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=_,this.blueFactor=y,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let I=0;I<S;I++)this.data[this._idx(-1,I)]=this.data[this._idx(0,I)],this.data[this._idx(S,I)]=this.data[this._idx(S-1,I)],this.data[this._idx(I,-1)]=this.data[this._idx(I,0)],this.data[this._idx(I,S)]=this.data[this._idx(I,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let I=0;I<S;I++)for(let P=0;P<S;P++){const L=this.get(I,P);L>this.max&&(this.max=L),L<this.min&&(this.min=L)}}get(e,n){const o=new Uint8Array(this.data.buffer),h=4*this._idx(e,n);return this.unpack(o[h],o[h+1],o[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}unpack(e,n,o){return e*this.redFactor+n*this.greenFactor+o*this.blueFactor-this.baseShift}getPixels(){return new Bn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,n,o){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=n*this.dim,_=n*this.dim+this.dim,y=o*this.dim,b=o*this.dim+this.dim;switch(n){case-1:h=_-1;break;case 1:_=h+1}switch(o){case-1:y=b-1;break;case 1:b=y+1}const S=-n*this.dim,I=-o*this.dim;for(let P=y;P<b;P++)for(let L=h;L<_;L++)this.data[this._idx(L,P)]=e.data[this._idx(L+S,P+I)]}}ut("DEMData",Qg);class e_{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const o=e[n];this._stringToNumber[o]=n,this._numberToString[n]=o}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class t_{constructor(e,n,o,h,_){this.type="Feature",this._vectorTileFeature=e,e._z=n,e._x=o,e._y=h,this.properties=e.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(e[n]=this[n]);return e}}class i_{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Bs(Ki,16,0),this.grid3D=new Bs(Ki,16,0),this.featureIndexArray=new F,this.promoteId=n}insert(e,n,o,h,_,y){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,h,_);const S=y?this.grid3D:this.grid;for(let I=0;I<n.length;I++){const P=n[I],L=[1/0,1/0,-1/0,-1/0];for(let V=0;V<P.length;V++){const $=P[V];L[0]=Math.min(L[0],$.x),L[1]=Math.min(L[1],$.y),L[2]=Math.max(L[2],$.x),L[3]=Math.max(L[3],$.y)}L[0]<Ki&&L[1]<Ki&&L[2]>=0&&L[3]>=0&&S.insert(b,L[0],L[1],L[2],L[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new va.VectorTile(new Ff(this.rawTileData)).layers,this.sourceLayerCoder=new e_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,n,o,h){this.loadVTLayers();const _=e.params||{},y=Ki/e.tileSize/e.scale,b=ol(_.filter),S=e.queryGeometry,I=e.queryPadding*y,P=n_(S),L=this.grid.query(P.minX-I,P.minY-I,P.maxX+I,P.maxY+I),V=n_(e.cameraQueryGeometry),$=this.grid3D.query(V.minX-I,V.minY-I,V.maxX+I,V.maxY+I,(te,oe,ve,le)=>function(pe,Le,Ne,lt,vt){for(const rt of pe)if(Le<=rt.x&&Ne<=rt.y&&lt>=rt.x&&vt>=rt.y)return!0;const at=[new B(Le,Ne),new B(Le,vt),new B(lt,vt),new B(lt,Ne)];if(pe.length>2){for(const rt of at)if(Tl(pe,rt))return!0}for(let rt=0;rt<pe.length-1;rt++)if(_b(pe[rt],pe[rt+1],at))return!0;return!1}(e.cameraQueryGeometry,te-I,oe-I,ve+I,le+I));for(const te of $)L.push(te);L.sort(V1);const H={};let q;for(let te=0;te<L.length;te++){const oe=L[te];if(oe===q)continue;q=oe;const ve=this.featureIndexArray.get(oe);let le=null;this.loadMatchingFeature(H,ve.bucketIndex,ve.sourceLayerIndex,ve.featureIndex,b,_.layers,_.availableImages,n,o,h,(pe,Le,Ne)=>(le||(le=js(pe)),Le.queryIntersectsFeature(S,pe,Ne,le,this.z,e.transform,y,e.pixelPosMatrix)))}return H}loadMatchingFeature(e,n,o,h,_,y,b,S,I,P,L){const V=this.bucketLayerIDs[n];if(y&&!function(te,oe){for(let ve=0;ve<te.length;ve++)if(oe.indexOf(te[ve])>=0)return!0;return!1}(y,V))return;const $=this.sourceLayerCoder.decode(o),H=this.vtLayers[$].feature(h);if(_.needGeometry){const te=Hs(H,!0);if(!_.filter(new ki(this.tileID.overscaledZ),te,this.tileID.canonical))return}else if(!_.filter(new ki(this.tileID.overscaledZ),H))return;const q=this.getId(H,$);for(let te=0;te<V.length;te++){const oe=V[te];if(y&&y.indexOf(oe)<0)continue;const ve=S[oe];if(!ve)continue;let le={};q&&P&&(le=P.getState(ve.sourceLayer||"_geojsonTileLayer",q));const pe=$e({},I[oe]);pe.paint=r_(pe.paint,ve.paint,H,le,b),pe.layout=r_(pe.layout,ve.layout,H,le,b);const Le=!L||L(H,ve,le);if(!Le)continue;const Ne=new t_(H,this.z,this.x,this.y,q);Ne.layer=pe;let lt=e[oe];lt===void 0&&(lt=e[oe]=[]),lt.push({featureIndex:h,feature:Ne,intersectionZ:Le})}}lookupSymbolFeatures(e,n,o,h,_,y,b,S){const I={};this.loadVTLayers();const P=ol(_);for(const L of e)this.loadMatchingFeature(I,o,h,L,P,y,b,S,n);return I}hasLayer(e){for(const n of this.bucketLayerIDs)for(const o of n)if(e===o)return!0;return!1}getId(e,n){let o=e.id;return this.promoteId&&(o=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof o=="boolean"&&(o=Number(o))),o}}function r_(r,e,n,o,h){return Ge(r,(_,y)=>{const b=e instanceof po?e.get(y):null;return b&&b.evaluate?b.evaluate(n,o,h):b})}function n_(r){let e=1/0,n=1/0,o=-1/0,h=-1/0;for(const _ of r)e=Math.min(e,_.x),n=Math.min(n,_.y),o=Math.max(o,_.x),h=Math.max(h,_.y);return{minX:e,minY:n,maxX:o,maxY:h}}function V1(r,e){return e-r}function s_(r,e,n,o,h){const _=[];for(let y=0;y<r.length;y++){const b=r[y];let S;for(let I=0;I<b.length-1;I++){let P=b[I],L=b[I+1];P.x<e&&L.x<e||(P.x<e?P=new B(e,P.y+(e-P.x)/(L.x-P.x)*(L.y-P.y))._round():L.x<e&&(L=new B(e,P.y+(e-P.x)/(L.x-P.x)*(L.y-P.y))._round()),P.y<n&&L.y<n||(P.y<n?P=new B(P.x+(n-P.y)/(L.y-P.y)*(L.x-P.x),n)._round():L.y<n&&(L=new B(P.x+(n-P.y)/(L.y-P.y)*(L.x-P.x),n)._round()),P.x>=o&&L.x>=o||(P.x>=o?P=new B(o,P.y+(o-P.x)/(L.x-P.x)*(L.y-P.y))._round():L.x>=o&&(L=new B(o,P.y+(o-P.x)/(L.x-P.x)*(L.y-P.y))._round()),P.y>=h&&L.y>=h||(P.y>=h?P=new B(P.x+(h-P.y)/(L.y-P.y)*(L.x-P.x),h)._round():L.y>=h&&(L=new B(P.x+(h-P.y)/(L.y-P.y)*(L.x-P.x),h)._round()),S&&P.equals(S[S.length-1])||(S=[P],_.push(S)),S.push(L)))))}}return _}ut("FeatureIndex",i_,{omit:["rawTileData","sourceLayerCoder"]});class Sa extends B{constructor(e,n,o,h){super(e,n),this.angle=o,h!==void 0&&(this.segment=h)}clone(){return new Sa(this.x,this.y,this.angle,this.segment)}}function a_(r,e,n,o,h){if(e.segment===void 0||n===0)return!0;let _=e,y=e.segment+1,b=0;for(;b>-n/2;){if(y--,y<0)return!1;b-=r[y].dist(_),_=r[y]}b+=r[y].dist(r[y+1]),y++;const S=[];let I=0;for(;b<n/2;){const P=r[y],L=r[y+1];if(!L)return!1;let V=r[y-1].angleTo(P)-P.angleTo(L);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:b,angleDelta:V}),I+=V;b-S[0].distance>o;)I-=S.shift().angleDelta;if(I>h)return!1;y++,b+=P.dist(L)}return!0}function o_(r){let e=0;for(let n=0;n<r.length-1;n++)e+=r[n].dist(r[n+1]);return e}function l_(r,e,n){return r?.6*e*n:0}function c_(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function U1(r,e,n,o,h,_){const y=l_(n,h,_),b=c_(n,o)*_;let S=0;const I=o_(r)/2;for(let P=0;P<r.length-1;P++){const L=r[P],V=r[P+1],$=L.dist(V);if(S+$>I){const H=(I-S)/$,q=Ur.number(L.x,V.x,H),te=Ur.number(L.y,V.y,H),oe=new Sa(q,te,V.angleTo(L),P);return oe._round(),!y||a_(r,oe,b,y,e)?oe:void 0}S+=$}}function $1(r,e,n,o,h,_,y,b,S){const I=l_(o,_,y),P=c_(o,h),L=P*y,V=r[0].x===0||r[0].x===S||r[0].y===0||r[0].y===S;return e-L<e/4&&(e=L+e/4),u_(r,V?e/2*b%e:(P/2+2*_)*y*b%e,e,I,n,L,V,!1,S)}function u_(r,e,n,o,h,_,y,b,S){const I=_/2,P=o_(r);let L=0,V=e-n,$=[];for(let H=0;H<r.length-1;H++){const q=r[H],te=r[H+1],oe=q.dist(te),ve=te.angleTo(q);for(;V+n<L+oe;){V+=n;const le=(V-L)/oe,pe=Ur.number(q.x,te.x,le),Le=Ur.number(q.y,te.y,le);if(pe>=0&&pe<S&&Le>=0&&Le<S&&V-I>=0&&V+I<=P){const Ne=new Sa(pe,Le,ve,H);Ne._round(),o&&!a_(r,Ne,_,o,h)||$.push(Ne)}}L+=oe}return b||$.length||y||($=u_(r,L/2,n,o,h,_,y,!0,S)),$}ut("Anchor",Sa);const Ll=vn;function h_(r,e,n,o){const h=[],_=r.image,y=_.pixelRatio,b=_.paddedRect.w-2*Ll,S=_.paddedRect.h-2*Ll,I=r.right-r.left,P=r.bottom-r.top,L=_.stretchX||[[0,b]],V=_.stretchY||[[0,S]],$=(Xe,pt)=>Xe+pt[1]-pt[0],H=L.reduce($,0),q=V.reduce($,0),te=b-H,oe=S-q;let ve=0,le=H,pe=0,Le=q,Ne=0,lt=te,vt=0,at=oe;if(_.content&&o){const Xe=_.content;ve=Hh(L,0,Xe[0]),pe=Hh(V,0,Xe[1]),le=Hh(L,Xe[0],Xe[2]),Le=Hh(V,Xe[1],Xe[3]),Ne=Xe[0]-ve,vt=Xe[1]-pe,lt=Xe[2]-Xe[0]-le,at=Xe[3]-Xe[1]-Le}const rt=(Xe,pt,Je,We)=>{const Tt=Gh(Xe.stretch-ve,le,I,r.left),wt=qh(Xe.fixed-Ne,lt,Xe.stretch,H),Zt=Gh(pt.stretch-pe,Le,P,r.top),Di=qh(pt.fixed-vt,at,pt.stretch,q),Oi=Gh(Je.stretch-ve,le,I,r.left),fr=qh(Je.fixed-Ne,lt,Je.stretch,H),Mn=Gh(We.stretch-pe,Le,P,r.top),cn=qh(We.fixed-vt,at,We.stretch,q),ar=new B(Tt,Zt),Ir=new B(Oi,Zt),zr=new B(Oi,Mn),un=new B(Tt,Mn),hn=new B(wt/y,Di/y),pr=new B(fr/y,cn/y),mr=e*Math.PI/180;if(mr){const Wr=Math.sin(mr),xn=Math.cos(mr),bn=[xn,-Wr,Wr,xn];ar._matMult(bn),Ir._matMult(bn),un._matMult(bn),zr._matMult(bn)}const qr=Xe.stretch+Xe.fixed,dn=pt.stretch+pt.fixed;return{tl:ar,tr:Ir,bl:un,br:zr,tex:{x:_.paddedRect.x+Ll+qr,y:_.paddedRect.y+Ll+dn,w:Je.stretch+Je.fixed-qr,h:We.stretch+We.fixed-dn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:hn,pixelOffsetBR:pr,minFontScaleX:lt/y/I,minFontScaleY:at/y/P,isSDF:n}};if(o&&(_.stretchX||_.stretchY)){const Xe=d_(L,te,H),pt=d_(V,oe,q);for(let Je=0;Je<Xe.length-1;Je++){const We=Xe[Je],Tt=Xe[Je+1];for(let wt=0;wt<pt.length-1;wt++)h.push(rt(We,pt[wt],Tt,pt[wt+1]))}}else h.push(rt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:S+1}));return h}function Hh(r,e,n){let o=0;for(const h of r)o+=Math.max(e,Math.min(n,h[1]))-Math.max(e,Math.min(n,h[0]));return o}function d_(r,e,n){const o=[{fixed:-Ll,stretch:0}];for(const[h,_]of r){const y=o[o.length-1];o.push({fixed:h-y.stretch,stretch:y.stretch}),o.push({fixed:h-y.stretch,stretch:y.stretch+(_-h)})}return o.push({fixed:e+Ll,stretch:n}),o}function Gh(r,e,n,o){return r/e*n+o}function qh(r,e,n,o){return r-e*n/o}class Wh{constructor(e,n,o,h,_,y,b,S,I,P){if(this.boxStartIndex=e.length,I){let L=y.top,V=y.bottom;const $=y.collisionPadding;$&&(L-=$[1],V+=$[3]);let H=V-L;H>0&&(H=Math.max(10,H),this.circleDiameter=H)}else{let L=y.top*b-S[0],V=y.bottom*b+S[2],$=y.left*b-S[3],H=y.right*b+S[1];const q=y.collisionPadding;if(q&&($-=q[0]*b,L-=q[1]*b,H+=q[2]*b,V+=q[3]*b),P){const te=new B($,L),oe=new B(H,L),ve=new B($,V),le=new B(H,V),pe=P*Math.PI/180;te._rotate(pe),oe._rotate(pe),ve._rotate(pe),le._rotate(pe),$=Math.min(te.x,oe.x,ve.x,le.x),H=Math.max(te.x,oe.x,ve.x,le.x),L=Math.min(te.y,oe.y,ve.y,le.y),V=Math.max(te.y,oe.y,ve.y,le.y)}e.emplaceBack(n.x,n.y,$,L,H,V,o,h,_)}this.boxEndIndex=e.length}}class j1{constructor(e=[],n=H1){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:o}=this,h=n[e];for(;e>0;){const _=e-1>>1,y=n[_];if(o(h,y)>=0)break;n[e]=y,e=_}n[e]=h}_down(e){const{data:n,compare:o}=this,h=this.length>>1,_=n[e];for(;e<h;){let y=1+(e<<1),b=n[y];const S=y+1;if(S<this.length&&o(n[S],b)<0&&(y=S,b=n[S]),o(b,_)>=0)break;n[e]=b,e=y}n[e]=_}}function H1(r,e){return r<e?-1:r>e?1:0}function G1(r,e=1,n=!1){let o=1/0,h=1/0,_=-1/0,y=-1/0;const b=r[0];for(let $=0;$<b.length;$++){const H=b[$];(!$||H.x<o)&&(o=H.x),(!$||H.y<h)&&(h=H.y),(!$||H.x>_)&&(_=H.x),(!$||H.y>y)&&(y=H.y)}const S=Math.min(_-o,y-h);let I=S/2;const P=new j1([],q1);if(S===0)return new B(o,h);for(let $=o;$<_;$+=S)for(let H=h;H<y;H+=S)P.push(new Rl($+I,H+I,I,r));let L=function($){let H=0,q=0,te=0;const oe=$[0];for(let ve=0,le=oe.length,pe=le-1;ve<le;pe=ve++){const Le=oe[ve],Ne=oe[pe],lt=Le.x*Ne.y-Ne.x*Le.y;q+=(Le.x+Ne.x)*lt,te+=(Le.y+Ne.y)*lt,H+=3*lt}return new Rl(q/H,te/H,0,$)}(r),V=P.length;for(;P.length;){const $=P.pop();($.d>L.d||!L.d)&&(L=$,n&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,V)),$.max-L.d<=e||(I=$.h/2,P.push(new Rl($.p.x-I,$.p.y-I,I,r)),P.push(new Rl($.p.x+I,$.p.y-I,I,r)),P.push(new Rl($.p.x-I,$.p.y+I,I,r)),P.push(new Rl($.p.x+I,$.p.y+I,I,r)),V+=4)}return n&&(console.log(`num probes: ${V}`),console.log(`best distance: ${L.d}`)),L.p}function q1(r,e){return e.max-r.max}function Rl(r,e,n,o){this.p=new B(r,e),this.h=n,this.d=function(h,_){let y=!1,b=1/0;for(let S=0;S<_.length;S++){const I=_[S];for(let P=0,L=I.length,V=L-1;P<L;V=P++){const $=I[P],H=I[V];$.y>h.y!=H.y>h.y&&h.x<(H.x-$.x)*(h.y-$.y)/(H.y-$.y)+$.x&&(y=!y),b=Math.min(b,Km(h,$,H))}}return(y?1:-1)*Math.sqrt(b)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}var Dr;v.ap=void 0,(Dr=v.ap||(v.ap={}))[Dr.center=1]="center",Dr[Dr.left=2]="left",Dr[Dr.right=3]="right",Dr[Dr.top=4]="top",Dr[Dr.bottom=5]="bottom",Dr[Dr["top-left"]=6]="top-left",Dr[Dr["top-right"]=7]="top-right",Dr[Dr["bottom-left"]=8]="bottom-left",Dr[Dr["bottom-right"]=9]="bottom-right";const Ta=7,Yf=Number.POSITIVE_INFINITY;function f_(r,e){return e[1]!==Yf?function(n,o,h){let _=0,y=0;switch(o=Math.abs(o),h=Math.abs(h),n){case"top-right":case"top-left":case"top":y=h-Ta;break;case"bottom-right":case"bottom-left":case"bottom":y=-h+Ta}switch(n){case"top-right":case"bottom-right":case"right":_=-o;break;case"top-left":case"bottom-left":case"left":_=o}return[_,y]}(r,e[0],e[1]):function(n,o){let h=0,_=0;o<0&&(o=0);const y=o/Math.SQRT2;switch(n){case"top-right":case"top-left":_=y-Ta;break;case"bottom-right":case"bottom-left":_=-y+Ta;break;case"bottom":_=-o+Ta;break;case"top":_=o-Ta}switch(n){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=o;break;case"right":h=-o}return[h,_]}(r,e[0])}function p_(r,e,n){var o;const h=r.layout,_=(o=h.get("text-variable-anchor-offset"))===null||o===void 0?void 0:o.evaluate(e,{},n);if(_){const b=_.values,S=[];for(let I=0;I<b.length;I+=2){const P=S[I]=b[I],L=b[I+1].map(V=>V*dr);P.startsWith("top")?L[1]-=Ta:P.startsWith("bottom")&&(L[1]+=Ta),S[I+1]=L}return new In(S)}const y=h.get("text-variable-anchor");if(y){let b;b=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(e,{},n)*dr,Yf]:h.get("text-offset").evaluate(e,{},n).map(I=>I*dr);const S=[];for(const I of y)S.push(I,f_(I,b));return new In(S)}return null}function Xf(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function W1(r,e,n,o,h,_,y,b,S,I,P){let L=_.textMaxSize.evaluate(e,{});L===void 0&&(L=y);const V=r.layers[0].layout,$=V.get("icon-offset").evaluate(e,{},P),H=g_(n.horizontal),q=y/24,te=r.tilePixelRatio*q,oe=r.tilePixelRatio*L/24,ve=r.tilePixelRatio*b,le=r.tilePixelRatio*V.get("symbol-spacing"),pe=V.get("text-padding")*r.tilePixelRatio,Le=function(We,Tt,wt,Zt=1){const Di=We.get("icon-padding").evaluate(Tt,{},wt),Oi=Di&&Di.values;return[Oi[0]*Zt,Oi[1]*Zt,Oi[2]*Zt,Oi[3]*Zt]}(V,e,P,r.tilePixelRatio),Ne=V.get("text-max-angle")/180*Math.PI,lt=V.get("text-rotation-alignment")!=="viewport"&&V.get("symbol-placement")!=="point",vt=V.get("icon-rotation-alignment")==="map"&&V.get("symbol-placement")!=="point",at=V.get("symbol-placement"),rt=le/2,Xe=V.get("icon-text-fit");let pt;o&&Xe!=="none"&&(r.allowVerticalPlacement&&n.vertical&&(pt=Ng(o,n.vertical,Xe,V.get("icon-text-fit-padding"),$,q)),H&&(o=Ng(o,H,Xe,V.get("icon-text-fit-padding"),$,q)));const Je=(We,Tt)=>{Tt.x<0||Tt.x>=Ki||Tt.y<0||Tt.y>=Ki||function(wt,Zt,Di,Oi,fr,Mn,cn,ar,Ir,zr,un,hn,pr,mr,qr,dn,Wr,xn,bn,gr,ti,Zr,Or,_r,Yn){const ns=wt.addToLineVertexArray(Zt,Di);let ss,qs,Xn,Vn,wn=0,Ws=0,nu=0,x_=0,sp=-1,ap=-1;const Zs={};let b_=wi("");if(wt.allowVerticalPlacement&&Oi.vertical){const Kr=ar.layout.get("text-rotate").evaluate(ti,{},_r)+90;Xn=new Wh(Ir,Zt,zr,un,hn,Oi.vertical,pr,mr,qr,Kr),cn&&(Vn=new Wh(Ir,Zt,zr,un,hn,cn,Wr,xn,qr,Kr))}if(fr){const Kr=ar.layout.get("icon-rotate").evaluate(ti,{}),Un=ar.layout.get("icon-text-fit")!=="none",bo=h_(fr,Kr,Or,Un),os=cn?h_(cn,Kr,Or,Un):void 0;qs=new Wh(Ir,Zt,zr,un,hn,fr,Wr,xn,!1,Kr),wn=4*bo.length;const wo=wt.iconSizeData;let bs=null;wo.kind==="source"?(bs=[xs*ar.layout.get("icon-size").evaluate(ti,{})],bs[0]>ba&&bt(`${wt.layerIds[0]}: Value for "icon-size" is >= ${eu}. Reduce your "icon-size".`)):wo.kind==="composite"&&(bs=[xs*Zr.compositeIconSizes[0].evaluate(ti,{},_r),xs*Zr.compositeIconSizes[1].evaluate(ti,{},_r)],(bs[0]>ba||bs[1]>ba)&&bt(`${wt.layerIds[0]}: Value for "icon-size" is >= ${eu}. Reduce your "icon-size".`)),wt.addSymbols(wt.icon,bo,bs,gr,bn,ti,v.ah.none,Zt,ns.lineStartIndex,ns.lineLength,-1,_r),sp=wt.icon.placedSymbolArray.length-1,os&&(Ws=4*os.length,wt.addSymbols(wt.icon,os,bs,gr,bn,ti,v.ah.vertical,Zt,ns.lineStartIndex,ns.lineLength,-1,_r),ap=wt.icon.placedSymbolArray.length-1)}const w_=Object.keys(Oi.horizontal);for(const Kr of w_){const Un=Oi.horizontal[Kr];if(!ss){b_=wi(Un.text);const os=ar.layout.get("text-rotate").evaluate(ti,{},_r);ss=new Wh(Ir,Zt,zr,un,hn,Un,pr,mr,qr,os)}const bo=Un.positionedLines.length===1;if(nu+=m_(wt,Zt,Un,Mn,ar,qr,ti,dn,ns,Oi.vertical?v.ah.horizontal:v.ah.horizontalOnly,bo?w_:[Kr],Zs,sp,Zr,_r),bo)break}Oi.vertical&&(x_+=m_(wt,Zt,Oi.vertical,Mn,ar,qr,ti,dn,ns,v.ah.vertical,["vertical"],Zs,ap,Zr,_r));const Y1=ss?ss.boxStartIndex:wt.collisionBoxArray.length,X1=ss?ss.boxEndIndex:wt.collisionBoxArray.length,J1=Xn?Xn.boxStartIndex:wt.collisionBoxArray.length,Q1=Xn?Xn.boxEndIndex:wt.collisionBoxArray.length,ew=qs?qs.boxStartIndex:wt.collisionBoxArray.length,tw=qs?qs.boxEndIndex:wt.collisionBoxArray.length,iw=Vn?Vn.boxStartIndex:wt.collisionBoxArray.length,rw=Vn?Vn.boxEndIndex:wt.collisionBoxArray.length;let as=-1;const Kh=(Kr,Un)=>Kr&&Kr.circleDiameter?Math.max(Kr.circleDiameter,Un):Un;as=Kh(ss,as),as=Kh(Xn,as),as=Kh(qs,as),as=Kh(Vn,as);const S_=as>-1?1:0;S_&&(as*=Yn/dr),wt.glyphOffsetArray.length>=kl.MAX_GLYPHS&&bt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ti.sortKey!==void 0&&wt.addToSortKeyRanges(wt.symbolInstances.length,ti.sortKey);const nw=p_(ar,ti,_r),[sw,aw]=function(Kr,Un){const bo=Kr.length,os=Un==null?void 0:Un.values;if((os==null?void 0:os.length)>0)for(let wo=0;wo<os.length;wo+=2){const bs=os[wo+1];Kr.emplaceBack(v.ap[os[wo]],bs[0],bs[1])}return[bo,Kr.length]}(wt.textAnchorOffsets,nw);wt.symbolInstances.emplaceBack(Zt.x,Zt.y,Zs.right>=0?Zs.right:-1,Zs.center>=0?Zs.center:-1,Zs.left>=0?Zs.left:-1,Zs.vertical||-1,sp,ap,b_,Y1,X1,J1,Q1,ew,tw,iw,rw,zr,nu,x_,wn,Ws,S_,0,pr,as,sw,aw)}(r,Tt,We,n,o,h,pt,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,te,[pe,pe,pe,pe],lt,S,ve,Le,vt,$,e,_,I,P,y)};if(at==="line")for(const We of s_(e.geometry,0,0,Ki,Ki)){const Tt=$1(We,le,Ne,n.vertical||H,o,24,oe,r.overscaling,Ki);for(const wt of Tt)H&&Z1(r,H.text,rt,wt)||Je(We,wt)}else if(at==="line-center"){for(const We of e.geometry)if(We.length>1){const Tt=U1(We,Ne,n.vertical||H,o,24,oe);Tt&&Je(We,Tt)}}else if(e.type==="Polygon")for(const We of Pf(e.geometry,0)){const Tt=G1(We,16);Je(We[0],new Sa(Tt.x,Tt.y,0))}else if(e.type==="LineString")for(const We of e.geometry)Je(We,new Sa(We[0].x,We[0].y,0));else if(e.type==="Point")for(const We of e.geometry)for(const Tt of We)Je([Tt],new Sa(Tt.x,Tt.y,0))}function m_(r,e,n,o,h,_,y,b,S,I,P,L,V,$,H){const q=function(ve,le,pe,Le,Ne,lt,vt,at){const rt=Le.layout.get("text-rotate").evaluate(lt,{})*Math.PI/180,Xe=[];for(const pt of le.positionedLines)for(const Je of pt.positionedGlyphs){if(!Je.rect)continue;const We=Je.rect||{};let Tt=Lg+1,wt=!0,Zt=1,Di=0;const Oi=(Ne||at)&&Je.vertical,fr=Je.metrics.advance*Je.scale/2;if(at&&le.verticalizable&&(Di=pt.lineOffset/2-(Je.imageName?-(dr-Je.metrics.width*Je.scale)/2:(Je.scale-1)*dr)),Je.imageName){const gr=vt[Je.imageName];wt=gr.sdf,Zt=gr.pixelRatio,Tt=vn/Zt}const Mn=Ne?[Je.x+fr,Je.y]:[0,0];let cn=Ne?[0,0]:[Je.x+fr+pe[0],Je.y+pe[1]-Di],ar=[0,0];Oi&&(ar=cn,cn=[0,0]);const Ir=Je.metrics.isDoubleResolution?2:1,zr=(Je.metrics.left-Tt)*Je.scale-fr+cn[0],un=(-Je.metrics.top-Tt)*Je.scale+cn[1],hn=zr+We.w/Ir*Je.scale/Zt,pr=un+We.h/Ir*Je.scale/Zt,mr=new B(zr,un),qr=new B(hn,un),dn=new B(zr,pr),Wr=new B(hn,pr);if(Oi){const gr=new B(-fr,fr-Jc),ti=-Math.PI/2,Zr=dr/2-fr,Or=new B(5-Jc-Zr,-(Je.imageName?Zr:0)),_r=new B(...ar);mr._rotateAround(ti,gr)._add(Or)._add(_r),qr._rotateAround(ti,gr)._add(Or)._add(_r),dn._rotateAround(ti,gr)._add(Or)._add(_r),Wr._rotateAround(ti,gr)._add(Or)._add(_r)}if(rt){const gr=Math.sin(rt),ti=Math.cos(rt),Zr=[ti,-gr,gr,ti];mr._matMult(Zr),qr._matMult(Zr),dn._matMult(Zr),Wr._matMult(Zr)}const xn=new B(0,0),bn=new B(0,0);Xe.push({tl:mr,tr:qr,bl:dn,br:Wr,tex:We,writingMode:le.writingMode,glyphOffset:Mn,sectionIndex:Je.sectionIndex,isSDF:wt,pixelOffsetTL:xn,pixelOffsetBR:bn,minFontScaleX:0,minFontScaleY:0})}return Xe}(0,n,b,h,_,y,o,r.allowVerticalPlacement),te=r.textSizeData;let oe=null;te.kind==="source"?(oe=[xs*h.layout.get("text-size").evaluate(y,{})],oe[0]>ba&&bt(`${r.layerIds[0]}: Value for "text-size" is >= ${eu}. Reduce your "text-size".`)):te.kind==="composite"&&(oe=[xs*$.compositeTextSizes[0].evaluate(y,{},H),xs*$.compositeTextSizes[1].evaluate(y,{},H)],(oe[0]>ba||oe[1]>ba)&&bt(`${r.layerIds[0]}: Value for "text-size" is >= ${eu}. Reduce your "text-size".`)),r.addSymbols(r.text,q,oe,b,_,y,I,e,S.lineStartIndex,S.lineLength,V,H);for(const ve of P)L[ve]=r.text.placedSymbolArray.length-1;return 4*q.length}function g_(r){for(const e in r)return r[e];return null}function Z1(r,e,n,o){const h=r.compareText;if(e in h){const _=h[e];for(let y=_.length-1;y>=0;y--)if(o.dist(_[y])<n)return!0}else h[e]=[];return h[e].push(o),!1}const __=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Jf{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,o]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=o>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const _=__[15&o];if(!_)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(e,2,1),[b]=new Uint32Array(e,4,1);return new Jf(b,y,_,e)}constructor(e,n=64,o=Float64Array,h){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=o,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const _=__.indexOf(this.ArrayType),y=2*e*this.ArrayType.BYTES_PER_ELEMENT,b=e*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-b%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${o}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+b+S,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+y+b+S),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+b+S,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=e,this.coords[this._pos++]=n,o}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Qf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,o,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:y,nodeSize:b}=this,S=[0,_.length-1,0],I=[];for(;S.length;){const P=S.pop()||0,L=S.pop()||0,V=S.pop()||0;if(L-V<=b){for(let te=V;te<=L;te++){const oe=y[2*te],ve=y[2*te+1];oe>=e&&oe<=o&&ve>=n&&ve<=h&&I.push(_[te])}continue}const $=V+L>>1,H=y[2*$],q=y[2*$+1];H>=e&&H<=o&&q>=n&&q<=h&&I.push(_[$]),(P===0?e<=H:n<=q)&&(S.push(V),S.push($-1),S.push(1-P)),(P===0?o>=H:h>=q)&&(S.push($+1),S.push(L),S.push(1-P))}return I}within(e,n,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:_,nodeSize:y}=this,b=[0,h.length-1,0],S=[],I=o*o;for(;b.length;){const P=b.pop()||0,L=b.pop()||0,V=b.pop()||0;if(L-V<=y){for(let te=V;te<=L;te++)v_(_[2*te],_[2*te+1],e,n)<=I&&S.push(h[te]);continue}const $=V+L>>1,H=_[2*$],q=_[2*$+1];v_(H,q,e,n)<=I&&S.push(h[$]),(P===0?e-o<=H:n-o<=q)&&(b.push(V),b.push($-1),b.push(1-P)),(P===0?e+o>=H:n+o>=q)&&(b.push($+1),b.push(L),b.push(1-P))}return S}}function Qf(r,e,n,o,h,_){if(h-o<=n)return;const y=o+h>>1;y_(r,e,y,o,h,_),Qf(r,e,n,o,y-1,1-_),Qf(r,e,n,y+1,h,1-_)}function y_(r,e,n,o,h,_){for(;h>o;){if(h-o>600){const I=h-o+1,P=n-o+1,L=Math.log(I),V=.5*Math.exp(2*L/3),$=.5*Math.sqrt(L*V*(I-V)/I)*(P-I/2<0?-1:1);y_(r,e,n,Math.max(o,Math.floor(n-P*V/I+$)),Math.min(h,Math.floor(n+(I-P)*V/I+$)),_)}const y=e[2*n+_];let b=o,S=h;for(iu(r,e,o,n),e[2*h+_]>y&&iu(r,e,o,h);b<S;){for(iu(r,e,b,S),b++,S--;e[2*b+_]<y;)b++;for(;e[2*S+_]>y;)S--}e[2*o+_]===y?iu(r,e,o,S):(S++,iu(r,e,S,h)),S<=n&&(o=S+1),n<=S&&(h=S-1)}}function iu(r,e,n,o){ep(r,n,o),ep(e,2*n,2*o),ep(e,2*n+1,2*o+1)}function ep(r,e,n){const o=r[e];r[e]=r[n],r[n]=o}function v_(r,e,n,o){const h=r-n,_=e-o;return h*h+_*_}var tp;v.bc=void 0,(tp=v.bc||(v.bc={})).create="create",tp.load="load",tp.fullLoad="fullLoad";let Zh=null,ru=[];const ip=1e3/60,rp="loadTime",np="fullLoadTime",K1={mark(r){performance.mark(r)},frame(r){const e=r;Zh!=null&&ru.push(e-Zh),Zh=e},clearMetrics(){Zh=null,ru=[],performance.clearMeasures(rp),performance.clearMeasures(np);for(const r in v.bc)performance.clearMarks(v.bc[r])},getPerformanceMetrics(){performance.measure(rp,v.bc.create,v.bc.load),performance.measure(np,v.bc.create,v.bc.fullLoad);const r=performance.getEntriesByName(rp)[0].duration,e=performance.getEntriesByName(np)[0].duration,n=ru.length,o=1/(ru.reduce((_,y)=>_+y,0)/n/1e3),h=ru.filter(_=>_>ip).reduce((_,y)=>_+(y-ip)/ip,0);return{loadTime:r,fullLoadTime:e,fps:o,percentDroppedFrames:h/(n+h)*100,totalFrames:n}}};v.$=Pt,v.A=El,v.B=function(r){if(jt==null){const e=r.navigator?r.navigator.userAgent:null;jt=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return jt},v.C=class{constructor(r,e){this.target=r,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new N1(()=>this.process()),this.subscription=function(n,o,h,_){return n.addEventListener(o,h,!1),{unsubscribe:()=>{n.removeEventListener(o,h,!1)}}}(this.target,"message",n=>this.receive(n)),this.globalScope=Lt(self)?r:window}registerMessageHandler(r,e){this.messageHandlers[r]=e}sendAsync(r,e){return new Promise((n,o)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[h]={resolve:n,reject:o},e&&e.signal.addEventListener("abort",()=>{delete this.resolveRejects[h];const b={id:h,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(b)},{once:!0});const _=[],y=Object.assign(Object.assign({},r),{id:h,sourceMapId:this.mapId,origin:location.origin,data:pa(r.data,_)});this.target.postMessage(y,{transfer:_})})}receive(r){const e=r.data,n=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[n];const o=this.abortControllers[n];return delete this.abortControllers[n],void(o&&o.abort())}if(Lt(self)||e.mustQueue)return this.tasks[n]=e,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,e)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),e=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(r,e)}processTask(r,e){return c(this,void 0,void 0,function*(){if(e.type==="<response>"){const h=this.resolveRejects[r];return delete this.resolveRejects[r],h?void(e.error?h.reject(ho(e.error)):h.resolve(ho(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=ho(e.data),o=new AbortController;this.abortControllers[r]=o;try{const h=yield this.messageHandlers[e.type](e.sourceMapId,n,o);this.completeTask(r,null,h)}catch(h){this.completeTask(r,h)}})}completeTask(r,e,n){const o=[];delete this.abortControllers[r];const h={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?pa(e):null,data:pa(n,o)};this.target.postMessage(h,{transfer:o})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},v.D=xt,v.E=ye,v.F=function(){var r=new El(16);return El!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},v.G=ke,v.H=function(r,e,n){var o,h,_,y,b,S,I,P,L,V,$,H,q=n[0],te=n[1],oe=n[2];return e===r?(r[12]=e[0]*q+e[4]*te+e[8]*oe+e[12],r[13]=e[1]*q+e[5]*te+e[9]*oe+e[13],r[14]=e[2]*q+e[6]*te+e[10]*oe+e[14],r[15]=e[3]*q+e[7]*te+e[11]*oe+e[15]):(h=e[1],_=e[2],y=e[3],b=e[4],S=e[5],I=e[6],P=e[7],L=e[8],V=e[9],$=e[10],H=e[11],r[0]=o=e[0],r[1]=h,r[2]=_,r[3]=y,r[4]=b,r[5]=S,r[6]=I,r[7]=P,r[8]=L,r[9]=V,r[10]=$,r[11]=H,r[12]=o*q+b*te+L*oe+e[12],r[13]=h*q+S*te+V*oe+e[13],r[14]=_*q+I*te+$*oe+e[14],r[15]=y*q+P*te+H*oe+e[15]),r},v.I=Nf,v.J=function(r,e,n){var o=n[0],h=n[1],_=n[2];return r[0]=e[0]*o,r[1]=e[1]*o,r[2]=e[2]*o,r[3]=e[3]*o,r[4]=e[4]*h,r[5]=e[5]*h,r[6]=e[6]*h,r[7]=e[7]*h,r[8]=e[8]*_,r[9]=e[9]*_,r[10]=e[10]*_,r[11]=e[11]*_,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},v.K=Qm,v.L=function(r,e){const n={};for(let o=0;o<e.length;o++){const h=e[o];h in r&&(n[h]=r[h])}return n},v.M=wa,v.N=Zg,v.O=Kg,v.P=B,v.Q=Nn,v.R=Bn,v.S=Z,v.T=wh,v.U=me,v.V=mi,v.W=Ki,v.X=Ji,v.Y=jh,v.Z=class extends Mc{},v._=c,v.a=Yi,v.a$=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]},v.a0=Kf,v.a1=Oe,v.a2=r=>{const e=window.document.createElement("video");return e.muted=!0,new Promise(n=>{e.onloadstart=()=>{n(e)};for(const o of r){const h=window.document.createElement("source");Ht(o)||(e.crossOrigin="Anonymous"),h.src=o,e.appendChild(h)}})},v.a3=function(){return Se++},v.a4=t,v.a5=kl,v.a6=ol,v.a7=Hs,v.a8=ki,v.a9=t_,v.aA=_t,v.aB=function(r,e){if(!r)return[{command:"setStyle",args:[e]}];let n=[];try{if(!Me(r.version,e.version))return[{command:"setStyle",args:[e]}];Me(r.center,e.center)||n.push({command:"setCenter",args:[e.center]}),Me(r.zoom,e.zoom)||n.push({command:"setZoom",args:[e.zoom]}),Me(r.bearing,e.bearing)||n.push({command:"setBearing",args:[e.bearing]}),Me(r.pitch,e.pitch)||n.push({command:"setPitch",args:[e.pitch]}),Me(r.sprite,e.sprite)||n.push({command:"setSprite",args:[e.sprite]}),Me(r.glyphs,e.glyphs)||n.push({command:"setGlyphs",args:[e.glyphs]}),Me(r.transition,e.transition)||n.push({command:"setTransition",args:[e.transition]}),Me(r.light,e.light)||n.push({command:"setLight",args:[e.light]}),Me(r.terrain,e.terrain)||n.push({command:"setTerrain",args:[e.terrain]}),Me(r.sky,e.sky)||n.push({command:"setSky",args:[e.sky]});const o={},h=[];(function(y,b,S,I){let P;for(P in b=b||{},y=y||{})Object.prototype.hasOwnProperty.call(y,P)&&(Object.prototype.hasOwnProperty.call(b,P)||ft(P,S,I));for(P in b)Object.prototype.hasOwnProperty.call(b,P)&&(Object.prototype.hasOwnProperty.call(y,P)?Me(y[P],b[P])||(y[P].type==="geojson"&&b[P].type==="geojson"&&xe(y,b,P)?Ke(S,{command:"setGeoJSONSourceData",args:[P,b[P].data]}):ct(P,b,S,I)):qe(P,b,S))})(r.sources,e.sources,h,o);const _=[];r.layers&&r.layers.forEach(y=>{"source"in y&&o[y.source]?n.push({command:"removeLayer",args:[y.id]}):_.push(y)}),n=n.concat(h),function(y,b,S){b=b||[];const I=(y=y||[]).map(yt),P=b.map(yt),L=y.reduce(Ct,{}),V=b.reduce(Ct,{}),$=I.slice(),H=Object.create(null);let q,te,oe,ve,le;for(let pe=0,Le=0;pe<I.length;pe++)q=I[pe],Object.prototype.hasOwnProperty.call(V,q)?Le++:(Ke(S,{command:"removeLayer",args:[q]}),$.splice($.indexOf(q,Le),1));for(let pe=0,Le=0;pe<P.length;pe++)q=P[P.length-1-pe],$[$.length-1-pe]!==q&&(Object.prototype.hasOwnProperty.call(L,q)?(Ke(S,{command:"removeLayer",args:[q]}),$.splice($.lastIndexOf(q,$.length-Le),1)):Le++,ve=$[$.length-pe],Ke(S,{command:"addLayer",args:[V[q],ve]}),$.splice($.length-pe,0,q),H[q]=!0);for(let pe=0;pe<P.length;pe++)if(q=P[pe],te=L[q],oe=V[q],!H[q]&&!Me(te,oe))if(Me(te.source,oe.source)&&Me(te["source-layer"],oe["source-layer"])&&Me(te.type,oe.type)){for(le in Pe(te.layout,oe.layout,S,q,null,"setLayoutProperty"),Pe(te.paint,oe.paint,S,q,null,"setPaintProperty"),Me(te.filter,oe.filter)||Ke(S,{command:"setFilter",args:[q,oe.filter]}),Me(te.minzoom,oe.minzoom)&&Me(te.maxzoom,oe.maxzoom)||Ke(S,{command:"setLayerZoomRange",args:[q,oe.minzoom,oe.maxzoom]}),te)Object.prototype.hasOwnProperty.call(te,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?Pe(te[le],oe[le],S,q,le.slice(6),"setPaintProperty"):Me(te[le],oe[le])||Ke(S,{command:"setLayerProperty",args:[q,le,oe[le]]}));for(le in oe)Object.prototype.hasOwnProperty.call(oe,le)&&!Object.prototype.hasOwnProperty.call(te,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?Pe(te[le],oe[le],S,q,le.slice(6),"setPaintProperty"):Me(te[le],oe[le])||Ke(S,{command:"setLayerProperty",args:[q,le,oe[le]]}))}else Ke(S,{command:"removeLayer",args:[q]}),ve=$[$.lastIndexOf(q)+1],Ke(S,{command:"addLayer",args:[oe,ve]})}(_,e.layers,n)}catch(o){console.warn("Unable to compute style diff:",o),n=[{command:"setStyle",args:[e]}]}return n},v.aC=function(r){const e=[],n=r.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),r.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},v.aD=function r(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(let o=0;o<e.length;o++)if(!r(e[o],n[o]))return!1;return!0}if(typeof e=="object"&&e!==null&&n!==null){if(typeof n!="object"||Object.keys(e).length!==Object.keys(n).length)return!1;for(const o in e)if(!r(e[o],n[o]))return!1;return!0}return e===n},v.aE=Ge,v.aF=ot,v.aG=class extends Rr{constructor(r,e){super(r,e),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},v.aH=Pn,v.aI=class extends Rr{constructor(r,e){super(r,e),this.current=ya}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let e=1;e<16;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},v.aJ=ys,v.aK=class extends Rr{constructor(r,e){super(r,e),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},v.aL=class extends Rr{constructor(r,e){super(r,e),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},v.aM=_a,v.aN=function(r,e,n,o,h,_,y){var b=1/(e-n),S=1/(o-h),I=1/(_-y);return r[0]=-2*b,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*S,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*I,r[11]=0,r[12]=(e+n)*b,r[13]=(h+o)*S,r[14]=(y+_)*I,r[15]=1,r},v.aO=vi,v.aP=vb,v.aQ=class extends _o{},v.aR=f1,v.aS=class extends Vs{},v.aT=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},v.aU=ng,v.aV=j,v.aW=class extends bl{},v.aX=je,v.aY=function(r,e){var n=r[0],o=r[1],h=r[2],_=r[3],y=r[4],b=r[5],S=r[6],I=r[7],P=r[8],L=r[9],V=r[10],$=r[11],H=r[12],q=r[13],te=r[14],oe=r[15],ve=e[0],le=e[1],pe=e[2],Le=e[3],Ne=e[4],lt=e[5],vt=e[6],at=e[7],rt=e[8],Xe=e[9],pt=e[10],Je=e[11],We=e[12],Tt=e[13],wt=e[14],Zt=e[15];return Math.abs(n-ve)<=ln*Math.max(1,Math.abs(n),Math.abs(ve))&&Math.abs(o-le)<=ln*Math.max(1,Math.abs(o),Math.abs(le))&&Math.abs(h-pe)<=ln*Math.max(1,Math.abs(h),Math.abs(pe))&&Math.abs(_-Le)<=ln*Math.max(1,Math.abs(_),Math.abs(Le))&&Math.abs(y-Ne)<=ln*Math.max(1,Math.abs(y),Math.abs(Ne))&&Math.abs(b-lt)<=ln*Math.max(1,Math.abs(b),Math.abs(lt))&&Math.abs(S-vt)<=ln*Math.max(1,Math.abs(S),Math.abs(vt))&&Math.abs(I-at)<=ln*Math.max(1,Math.abs(I),Math.abs(at))&&Math.abs(P-rt)<=ln*Math.max(1,Math.abs(P),Math.abs(rt))&&Math.abs(L-Xe)<=ln*Math.max(1,Math.abs(L),Math.abs(Xe))&&Math.abs(V-pt)<=ln*Math.max(1,Math.abs(V),Math.abs(pt))&&Math.abs($-Je)<=ln*Math.max(1,Math.abs($),Math.abs(Je))&&Math.abs(H-We)<=ln*Math.max(1,Math.abs(H),Math.abs(We))&&Math.abs(q-Tt)<=ln*Math.max(1,Math.abs(q),Math.abs(Tt))&&Math.abs(te-wt)<=ln*Math.max(1,Math.abs(te),Math.abs(wt))&&Math.abs(oe-Zt)<=ln*Math.max(1,Math.abs(oe),Math.abs(Zt))},v.aZ=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},v.a_=function(r,e,n){return r[0]=e[0]*n[0],r[1]=e[1]*n[1],r[2]=e[2]*n[2],r[3]=e[3]*n[3],r},v.aa=function(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,o,h,_)=>{const y=h||_;return e[o]=!y||y.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e},v.ab=function(r,e){const n=[];for(const o in r)o in e||n.push(o);return n},v.ac=Re,v.ad=function(r,e,n){var o=Math.sin(n),h=Math.cos(n),_=e[0],y=e[1],b=e[2],S=e[3],I=e[4],P=e[5],L=e[6],V=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=_*h+I*o,r[1]=y*h+P*o,r[2]=b*h+L*o,r[3]=S*h+V*o,r[4]=I*h-_*o,r[5]=P*h-y*o,r[6]=L*h-b*o,r[7]=V*h-S*o,r},v.ae=function(r){var e=new El(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},v.af=Lh,v.ag=function(r,e){let n=0,o=0;if(r.kind==="constant")o=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:h,minZoom:_,maxZoom:y}=r,b=h?Re(kr.interpolationFactor(h,e,_,y),0,1):0;r.kind==="camera"?o=Ur.number(r.minSize,r.maxSize,b):n=b}return{uSizeT:n,uSize:o}},v.ai=function(r,{uSize:e,uSizeT:n},{lowerSize:o,upperSize:h}){return r.kind==="source"?o/xs:r.kind==="composite"?Ur.number(o/xs,h/xs,n):e},v.aj=jf,v.ak=function(r,e,n,o){const h=e.y-r.y,_=e.x-r.x,y=o.y-n.y,b=o.x-n.x,S=y*_-b*h;if(S===0)return null;const I=(b*(r.y-n.y)-y*(r.x-n.x))/S;return new B(r.x+I*_,r.y+I*h)},v.al=s_,v.am=Uc,v.an=wf,v.ao=dr,v.aq=$f,v.ar=function(r,e){var n=e[0],o=e[1],h=e[2],_=e[3],y=e[4],b=e[5],S=e[6],I=e[7],P=e[8],L=e[9],V=e[10],$=e[11],H=e[12],q=e[13],te=e[14],oe=e[15],ve=n*b-o*y,le=n*S-h*y,pe=n*I-_*y,Le=o*S-h*b,Ne=o*I-_*b,lt=h*I-_*S,vt=P*q-L*H,at=P*te-V*H,rt=P*oe-$*H,Xe=L*te-V*q,pt=L*oe-$*q,Je=V*oe-$*te,We=ve*Je-le*pt+pe*Xe+Le*rt-Ne*at+lt*vt;return We?(r[0]=(b*Je-S*pt+I*Xe)*(We=1/We),r[1]=(h*pt-o*Je-_*Xe)*We,r[2]=(q*lt-te*Ne+oe*Le)*We,r[3]=(V*Ne-L*lt-$*Le)*We,r[4]=(S*rt-y*Je-I*at)*We,r[5]=(n*Je-h*rt+_*at)*We,r[6]=(te*pe-H*lt-oe*le)*We,r[7]=(P*lt-V*pe+$*le)*We,r[8]=(y*pt-b*rt+I*vt)*We,r[9]=(o*rt-n*pt-_*vt)*We,r[10]=(H*Ne-q*pe+oe*ve)*We,r[11]=(L*pe-P*Ne-$*ve)*We,r[12]=(b*at-y*Xe-S*vt)*We,r[13]=(n*Xe-o*at+h*vt)*We,r[14]=(q*le-H*Le-te*ve)*We,r[15]=(P*Le-L*le+V*ve)*We,r):null},v.as=Xf,v.at=Uf,v.au=Jf,v.av=function(){const r={},e=K.$version;for(const n in K.$root){const o=K.$root[n];if(o.required){let h=null;h=n==="version"?e:o.type==="array"?[]:{},h!=null&&(r[n]=h)}}return r},v.aw=fl,v.ax=it,v.ay=function(r){r=r.slice();const e=Object.create(null);for(let n=0;n<r.length;n++)e[r[n].id]=r[n];for(let n=0;n<r.length;n++)"ref"in r[n]&&(r[n]=Qe(r[n],e[r[n].ref]));return r},v.az=function(r){if(r.type==="custom")return new B1(r);switch(r.type){case"background":return new z1(r);case"circle":return new xb(r);case"fill":return new Vb(r);case"fill-extrusion":return new t1(r);case"heatmap":return new wb(r);case"hillshade":return new Tb(r);case"line":return new c1(r);case"raster":return new F1(r);case"symbol":return new $h(r)}},v.b=Dt,v.b0=Ae,v.b1=Jg,v.b2=Yg,v.b3=function(r,e,n,o,h){var _,y=1/Math.tan(e/2);return r[0]=y/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=y,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,h!=null&&h!==1/0?(r[10]=(h+o)*(_=1/(o-h)),r[14]=2*h*o*_):(r[10]=-1,r[14]=-2*o),r},v.b4=function(r,e,n){var o=Math.sin(n),h=Math.cos(n),_=e[4],y=e[5],b=e[6],S=e[7],I=e[8],P=e[9],L=e[10],V=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=_*h+I*o,r[5]=y*h+P*o,r[6]=b*h+L*o,r[7]=S*h+V*o,r[8]=I*h-_*o,r[9]=P*h-y*o,r[10]=L*h-b*o,r[11]=V*h-S*o,r},v.b5=Ce,v.b6=be,v.b7=function(r){return r*Math.PI/180},v.b8=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},v.b9=class extends yl{},v.ba=Wf,v.bb=K1,v.bd=nt,v.be=function(r,e){Yi.REGISTERED_PROTOCOLS[r]=e},v.bf=function(r){delete Yi.REGISTERED_PROTOCOLS[r]},v.bg=function(r,e){const n={};for(let h=0;h<r.length;h++){const _=e&&e[r[h].id]||_f(r[h]);e&&(e[r[h].id]=_);let y=n[_];y||(y=n[_]=[]),y.push(r[h])}const o=[];for(const h in n)o.push(n[h]);return o},v.bh=ut,v.bi=e_,v.bj=i_,v.bk=Dg,v.bl=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=Ki/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const e=r.bucket.layers[0],n=e.layout,o=e._unevaluatedLayout._values,h={layoutIconSize:o["icon-size"].possiblyEvaluate(new ki(r.bucket.zoom+1),r.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new ki(r.bucket.zoom+1),r.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new ki(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:P}=r.bucket.textSizeData;h.compositeTextSizes=[o["text-size"].possiblyEvaluate(new ki(I),r.canonical),o["text-size"].possiblyEvaluate(new ki(P),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:P}=r.bucket.iconSizeData;h.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new ki(I),r.canonical),o["icon-size"].possiblyEvaluate(new ki(P),r.canonical)]}const _=n.get("text-line-height")*dr,y=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",b=n.get("text-keep-upright"),S=n.get("text-size");for(const I of r.bucket.features){const P=n.get("text-font").evaluate(I,{},r.canonical).join(","),L=S.evaluate(I,{},r.canonical),V=h.layoutTextSize.evaluate(I,{},r.canonical),$=h.layoutIconSize.evaluate(I,{},r.canonical),H={horizontal:{},vertical:void 0},q=I.text;let te,oe=[0,0];if(q){const pe=q.toString(),Le=n.get("text-letter-spacing").evaluate(I,{},r.canonical)*dr,Ne=vh(pe)?Le:0,lt=n.get("text-anchor").evaluate(I,{},r.canonical),vt=p_(e,I,r.canonical);if(!vt){const Je=n.get("text-radial-offset").evaluate(I,{},r.canonical);oe=Je?f_(lt,[Je*dr,Yf]):n.get("text-offset").evaluate(I,{},r.canonical).map(We=>We*dr)}let at=y?"center":n.get("text-justify").evaluate(I,{},r.canonical);const rt=n.get("symbol-placement"),Xe=rt==="point"?n.get("text-max-width").evaluate(I,{},r.canonical)*dr:0,pt=()=>{r.bucket.allowVerticalPlacement&&pl(pe)&&(H.vertical=Nh(q,r.glyphMap,r.glyphPositions,r.imagePositions,P,Xe,_,lt,"left",Ne,oe,v.ah.vertical,!0,rt,V,L))};if(!y&&vt){const Je=new Set;if(at==="auto")for(let Tt=0;Tt<vt.values.length;Tt+=2)Je.add(Xf(vt.values[Tt]));else Je.add(at);let We=!1;for(const Tt of Je)if(!H.horizontal[Tt])if(We)H.horizontal[Tt]=H.horizontal[0];else{const wt=Nh(q,r.glyphMap,r.glyphPositions,r.imagePositions,P,Xe,_,"center",Tt,Ne,oe,v.ah.horizontal,!1,rt,V,L);wt&&(H.horizontal[Tt]=wt,We=wt.positionedLines.length===1)}pt()}else{at==="auto"&&(at=Xf(lt));const Je=Nh(q,r.glyphMap,r.glyphPositions,r.imagePositions,P,Xe,_,lt,at,Ne,oe,v.ah.horizontal,!1,rt,V,L);Je&&(H.horizontal[at]=Je),pt(),pl(pe)&&y&&b&&(H.vertical=Nh(q,r.glyphMap,r.glyphPositions,r.imagePositions,P,Xe,_,lt,at,Ne,oe,v.ah.vertical,!1,rt,V,L))}}let ve=!1;if(I.icon&&I.icon.name){const pe=r.imageMap[I.icon.name];pe&&(te=M1(r.imagePositions[I.icon.name],n.get("icon-offset").evaluate(I,{},r.canonical),n.get("icon-anchor").evaluate(I,{},r.canonical)),ve=!!pe.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=ve:r.bucket.sdfIcons!==ve&&bt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pe.pixelRatio!==r.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const le=g_(H.horizontal)||H.vertical;r.bucket.iconsInText=!!le&&le.iconsInText,(le||te)&&W1(r.bucket,I,H,te,r.imageMap,h,V,$,oe,ve,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},v.bm=zf,v.bn=Lf,v.bo=Df,v.bp=va,v.bq=Ff,v.br=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},v.bs=function(r,e,n,o,h){return c(this,void 0,void 0,function*(){if(me())try{return yield mi(r,e,n,o,h)}catch{}return function(_,y,b,S,I){const P=_.width,L=_.height;ai&&Xt||(ai=new OffscreenCanvas(P,L),Xt=ai.getContext("2d",{willReadFrequently:!0})),ai.width=P,ai.height=L,Xt.drawImage(_,0,0,P,L);const V=Xt.getImageData(y,b,S,I);return Xt.clearRect(0,0,P,L),V.data}(r,e,n,o,h)})},v.bt=Qg,v.bu=A,v.bv=R,v.bw=Eg,v.bx=zs,v.by=function(r){return r.message===Bi},v.bz=Ns,v.c=Pi,v.d=r=>c(void 0,void 0,void 0,function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(e)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),v.e=$e,v.f=r=>new Promise((e,n)=>{const o=new Image;o.onload=()=>{e(o),URL.revokeObjectURL(o.src),o.onload=null,window.requestAnimationFrame(()=>{o.src=Ci})},o.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(r)],{type:"image/png"});o.src=r.byteLength?URL.createObjectURL(h):Ci}),v.g=Wt,v.h=(r,e)=>ht($e(r,{type:"json"}),e),v.i=Lt,v.j=Y,v.k=D,v.l=(r,e)=>ht($e(r,{type:"arrayBuffer"}),e),v.m=ht,v.n=function(r){return new Ff(r).readFields(T1,[])},v.o=Hc,v.p=Rg,v.q=jr,v.r=Sc,v.s=Ht,v.t=yh,v.u=st,v.v=K,v.w=bt,v.x=co,v.y=function([r,e,n]){return e+=90,e*=Math.PI/180,n*=Math.PI/180,{x:r*Math.cos(e)*Math.sin(n),y:r*Math.sin(e)*Math.sin(n),z:r*Math.cos(n)}},v.z=Ur}),m("worker",["./shared"],function(v){class c{constructor(N){this.keyCache={},N&&this.replace(N)}replace(N){this._layerConfigs={},this._layers={},this.update(N,[])}update(N,U){for(const J of N){this._layerConfigs[J.id]=J;const de=this._layers[J.id]=v.az(J);de._featureFilter=v.a6(de.filter),this.keyCache[J.id]&&delete this.keyCache[J.id]}for(const J of U)delete this.keyCache[J],delete this._layerConfigs[J],delete this._layers[J];this.familiesBySource={};const G=v.bg(Object.values(this._layerConfigs),this.keyCache);for(const J of G){const de=J.map(De=>this._layers[De.id]),fe=de[0];if(fe.visibility==="none")continue;const _e=fe.source||"";let ce=this.familiesBySource[_e];ce||(ce=this.familiesBySource[_e]={});const we=fe.sourceLayer||"_geojsonTileLayer";let Ve=ce[we];Ve||(Ve=ce[we]=[]),Ve.push(de)}}}class A{constructor(N){const U={},G=[];for(const _e in N){const ce=N[_e],we=U[_e]={};for(const Ve in ce){const De=ce[+Ve];if(!De||De.bitmap.width===0||De.bitmap.height===0)continue;const ze={x:0,y:0,w:De.bitmap.width+2,h:De.bitmap.height+2};G.push(ze),we[Ve]={rect:ze,metrics:De.metrics}}}const{w:J,h:de}=v.p(G),fe=new v.o({width:J||1,height:de||1});for(const _e in N){const ce=N[_e];for(const we in ce){const Ve=ce[+we];if(!Ve||Ve.bitmap.width===0||Ve.bitmap.height===0)continue;const De=U[_e][we].rect;v.o.copy(Ve.bitmap,fe,{x:0,y:0},{x:De.x+1,y:De.y+1},Ve.bitmap)}}this.image=fe,this.positions=U}}v.bh("GlyphAtlas",A);class R{constructor(N){this.tileID=new v.Q(N.tileID.overscaledZ,N.tileID.wrap,N.tileID.canonical.z,N.tileID.canonical.x,N.tileID.canonical.y),this.uid=N.uid,this.zoom=N.zoom,this.pixelRatio=N.pixelRatio,this.tileSize=N.tileSize,this.source=N.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=N.showCollisionBoxes,this.collectResourceTiming=!!N.collectResourceTiming,this.returnDependencies=!!N.returnDependencies,this.promoteId=N.promoteId,this.inFlightDependencies=[]}parse(N,U,G,J){return v._(this,void 0,void 0,function*(){this.status="parsing",this.data=N,this.collisionBoxArray=new v.a4;const de=new v.bi(Object.keys(N.layers).sort()),fe=new v.bj(this.tileID,this.promoteId);fe.bucketLayerIDs=[];const _e={},ce={featureIndex:fe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:G},we=U.familiesBySource[this.source];for(const Ut in we){const $i=N.layers[Ut];if(!$i)continue;$i.version===1&&v.w(`Vector tile source "${this.source}" layer "${Ut}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const lr=de.encode(Ut),Vr=[];for(let nn=0;nn<$i.length;nn++){const vr=$i.feature(nn),Wn=fe.getId(vr,Ut);Vr.push({feature:vr,id:Wn,index:nn,sourceLayerIndex:lr})}for(const nn of we[Ut]){const vr=nn[0];vr.source!==this.source&&v.w(`layer.source = ${vr.source} does not equal this.source = ${this.source}`),vr.minzoom&&this.zoom<Math.floor(vr.minzoom)||vr.maxzoom&&this.zoom>=vr.maxzoom||vr.visibility!=="none"&&(z(nn,this.zoom,G),(_e[vr.id]=vr.createBucket({index:fe.bucketLayerIDs.length,layers:nn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:lr,sourceID:this.source})).populate(Vr,ce,this.tileID.canonical),fe.bucketLayerIDs.push(nn.map(Wn=>Wn.id)))}}const Ve=v.aE(ce.glyphDependencies,Ut=>Object.keys(Ut).map(Number));this.inFlightDependencies.forEach(Ut=>Ut==null?void 0:Ut.abort()),this.inFlightDependencies=[];let De=Promise.resolve({});if(Object.keys(Ve).length){const Ut=new AbortController;this.inFlightDependencies.push(Ut),De=J.sendAsync({type:"getGlyphs",data:{stacks:Ve,source:this.source,tileID:this.tileID,type:"glyphs"}},Ut)}const ze=Object.keys(ce.iconDependencies);let St=Promise.resolve({});if(ze.length){const Ut=new AbortController;this.inFlightDependencies.push(Ut),St=J.sendAsync({type:"getImages",data:{icons:ze,source:this.source,tileID:this.tileID,type:"icons"}},Ut)}const It=Object.keys(ce.patternDependencies);let Bt=Promise.resolve({});if(It.length){const Ut=new AbortController;this.inFlightDependencies.push(Ut),Bt=J.sendAsync({type:"getImages",data:{icons:It,source:this.source,tileID:this.tileID,type:"patterns"}},Ut)}const[zt,ii,bi]=yield Promise.all([De,St,Bt]),zi=new A(zt),nr=new v.bk(ii,bi);for(const Ut in _e){const $i=_e[Ut];$i instanceof v.a5?(z($i.layers,this.zoom,G),v.bl({bucket:$i,glyphMap:zt,glyphPositions:zi.positions,imageMap:ii,imagePositions:nr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):$i.hasPattern&&($i instanceof v.bm||$i instanceof v.bn||$i instanceof v.bo)&&(z($i.layers,this.zoom,G),$i.addFeatures(ce,this.tileID.canonical,nr.patternPositions))}return this.status="done",{buckets:Object.values(_e).filter(Ut=>!Ut.isEmpty()),featureIndex:fe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:zi.image,imageAtlas:nr,glyphMap:this.returnDependencies?zt:null,iconMap:this.returnDependencies?ii:null,glyphPositions:this.returnDependencies?zi.positions:null}})}}function z(ie,N,U){const G=new v.a8(N);for(const J of ie)J.recalculate(G,U)}class B{constructor(N,U,G){this.actor=N,this.layerIndex=U,this.availableImages=G,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(N,U){return v._(this,void 0,void 0,function*(){const G=yield v.l(N.request,U);try{return{vectorTile:new v.bp.VectorTile(new v.bq(G.data)),rawData:G.data,cacheControl:G.cacheControl,expires:G.expires}}catch(J){const de=new Uint8Array(G.data);let fe=`Unable to parse the tile at ${N.request.url}, `;throw fe+=de[0]===31&&de[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${J.messge}`,new Error(fe)}})}loadTile(N){return v._(this,void 0,void 0,function*(){const U=N.uid,G=!!(N&&N.request&&N.request.collectResourceTiming)&&new v.br(N.request),J=new R(N);this.loading[U]=J;const de=new AbortController;J.abort=de;try{const fe=yield this.loadVectorTile(N,de);if(delete this.loading[U],!fe)return null;const _e=fe.rawData,ce={};fe.expires&&(ce.expires=fe.expires),fe.cacheControl&&(ce.cacheControl=fe.cacheControl);const we={};if(G){const De=G.finish();De&&(we.resourceTiming=JSON.parse(JSON.stringify(De)))}J.vectorTile=fe.vectorTile;const Ve=J.parse(fe.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[U]=J,this.fetching[U]={rawTileData:_e,cacheControl:ce,resourceTiming:we};try{const De=yield Ve;return v.e({rawTileData:_e.slice(0)},De,ce,we)}finally{delete this.fetching[U]}}catch(fe){throw delete this.loading[U],J.status="done",this.loaded[U]=J,fe}})}reloadTile(N){return v._(this,void 0,void 0,function*(){const U=N.uid;if(!this.loaded||!this.loaded[U])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const G=this.loaded[U];if(G.showCollisionBoxes=N.showCollisionBoxes,G.status==="parsing"){const J=yield G.parse(G.vectorTile,this.layerIndex,this.availableImages,this.actor);let de;if(this.fetching[U]){const{rawTileData:fe,cacheControl:_e,resourceTiming:ce}=this.fetching[U];delete this.fetching[U],de=v.e({rawTileData:fe.slice(0)},J,_e,ce)}else de=J;return de}if(G.status==="done"&&G.vectorTile)return G.parse(G.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(N){return v._(this,void 0,void 0,function*(){const U=this.loading,G=N.uid;U&&U[G]&&U[G].abort&&(U[G].abort.abort(),delete U[G])})}removeTile(N){return v._(this,void 0,void 0,function*(){this.loaded&&this.loaded[N.uid]&&delete this.loaded[N.uid]})}}class M{constructor(){this.loaded={}}loadTile(N){return v._(this,void 0,void 0,function*(){const{uid:U,encoding:G,rawImageData:J,redFactor:de,greenFactor:fe,blueFactor:_e,baseShift:ce}=N,we=J.width+2,Ve=J.height+2,De=v.b(J)?new v.R({width:we,height:Ve},yield v.bs(J,-1,-1,we,Ve)):J,ze=new v.bt(U,De,G,de,fe,_e,ce);return this.loaded=this.loaded||{},this.loaded[U]=ze,ze})}removeTile(N){const U=this.loaded,G=N.uid;U&&U[G]&&delete U[G]}}function re(ie,N){if(ie.length!==0){se(ie[0],N);for(var U=1;U<ie.length;U++)se(ie[U],!N)}}function se(ie,N){for(var U=0,G=0,J=0,de=ie.length,fe=de-1;J<de;fe=J++){var _e=(ie[J][0]-ie[fe][0])*(ie[fe][1]+ie[J][1]),ce=U+_e;G+=Math.abs(U)>=Math.abs(_e)?U-ce+_e:_e-ce+U,U=ce}U+G>=0!=!!N&&ie.reverse()}var ue=v.bu(function ie(N,U){var G,J=N&&N.type;if(J==="FeatureCollection")for(G=0;G<N.features.length;G++)ie(N.features[G],U);else if(J==="GeometryCollection")for(G=0;G<N.geometries.length;G++)ie(N.geometries[G],U);else if(J==="Feature")ie(N.geometry,U);else if(J==="Polygon")re(N.coordinates,U);else if(J==="MultiPolygon")for(G=0;G<N.coordinates.length;G++)re(N.coordinates[G],U);return N});const ae=v.bp.VectorTileFeature.prototype.toGeoJSON;var Z={exports:{}},me=v.bv,Ce=v.bp.VectorTileFeature,be=Re;function Re(ie,N){this.options=N||{},this.features=ie,this.length=ie.length}function Ae(ie,N){this.id=typeof ie.id=="number"?ie.id:void 0,this.type=ie.type,this.rawGeometry=ie.type===1?[ie.geometry]:ie.geometry,this.properties=ie.tags,this.extent=N||4096}Re.prototype.feature=function(ie){return new Ae(this.features[ie],this.options.extent)},Ae.prototype.loadGeometry=function(){var ie=this.rawGeometry;this.geometry=[];for(var N=0;N<ie.length;N++){for(var U=ie[N],G=[],J=0;J<U.length;J++)G.push(new me(U[J][0],U[J][1]));this.geometry.push(G)}return this.geometry},Ae.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ie=this.geometry,N=1/0,U=-1/0,G=1/0,J=-1/0,de=0;de<ie.length;de++)for(var fe=ie[de],_e=0;_e<fe.length;_e++){var ce=fe[_e];N=Math.min(N,ce.x),U=Math.max(U,ce.x),G=Math.min(G,ce.y),J=Math.max(J,ce.y)}return[N,G,U,J]},Ae.prototype.toGeoJSON=Ce.prototype.toGeoJSON;var $e=v.bw,Se=be;function Ge(ie){var N=new $e;return function(U,G){for(var J in U.layers)G.writeMessage(3,ot,U.layers[J])}(ie,N),N.finish()}function ot(ie,N){var U;N.writeVarintField(15,ie.version||1),N.writeStringField(1,ie.name||""),N.writeVarintField(5,ie.extent||4096);var G={keys:[],values:[],keycache:{},valuecache:{}};for(U=0;U<ie.length;U++)G.feature=ie.feature(U),N.writeMessage(2,_t,G);var J=G.keys;for(U=0;U<J.length;U++)N.writeStringField(3,J[U]);var de=G.values;for(U=0;U<de.length;U++)N.writeMessage(4,Lt,de[U])}function _t(ie,N){var U=ie.feature;U.id!==void 0&&N.writeVarintField(1,U.id),N.writeMessage(2,He,ie),N.writeVarintField(3,U.type),N.writeMessage(4,pi,U)}function He(ie,N){var U=ie.feature,G=ie.keys,J=ie.values,de=ie.keycache,fe=ie.valuecache;for(var _e in U.properties){var ce=U.properties[_e],we=de[_e];if(ce!==null){we===void 0&&(G.push(_e),de[_e]=we=G.length-1),N.writeVarint(we);var Ve=typeof ce;Ve!=="string"&&Ve!=="boolean"&&Ve!=="number"&&(ce=JSON.stringify(ce));var De=Ve+":"+ce,ze=fe[De];ze===void 0&&(J.push(ce),fe[De]=ze=J.length-1),N.writeVarint(ze)}}}function bt(ie,N){return(N<<3)+(7&ie)}function qt(ie){return ie<<1^ie>>31}function pi(ie,N){for(var U=ie.loadGeometry(),G=ie.type,J=0,de=0,fe=U.length,_e=0;_e<fe;_e++){var ce=U[_e],we=1;G===1&&(we=ce.length),N.writeVarint(bt(1,we));for(var Ve=G===3?ce.length-1:ce.length,De=0;De<Ve;De++){De===1&&G!==1&&N.writeVarint(bt(2,Ve-1));var ze=ce[De].x-J,St=ce[De].y-de;N.writeVarint(qt(ze)),N.writeVarint(qt(St)),J+=ze,de+=St}G===3&&N.writeVarint(bt(7,1))}}function Lt(ie,N){var U=typeof ie;U==="string"?N.writeStringField(1,ie):U==="boolean"?N.writeBooleanField(7,ie):U==="number"&&(ie%1!=0?N.writeDoubleField(3,ie):ie<0?N.writeSVarintField(6,ie):N.writeVarintField(5,ie))}Z.exports=Ge,Z.exports.fromVectorTileJs=Ge,Z.exports.fromGeojsonVt=function(ie,N){N=N||{};var U={};for(var G in ie)U[G]=new Se(ie[G].features,N),U[G].name=G,U[G].version=N.version,U[G].extent=N.extent;return Ge({layers:U})},Z.exports.GeoJSONWrapper=Se;var jt=v.bu(Z.exports);const Dt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ie=>ie},Ci=Math.fround||(mi=new Float32Array(1),ie=>(mi[0]=+ie,mi[0]));var mi;const ai=3,Xt=5,Bi=6;class Pi{constructor(N){this.options=Object.assign(Object.create(Dt),N),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(N){const{log:U,minZoom:G,maxZoom:J}=this.options;U&&console.time("total time");const de=`prepare ${N.length} points`;U&&console.time(de),this.points=N;const fe=[];for(let ce=0;ce<N.length;ce++){const we=N[ce];if(!we.geometry)continue;const[Ve,De]=we.geometry.coordinates,ze=Ci(ke(Ve)),St=Ci(nt(De));fe.push(ze,St,1/0,ce,-1,1),this.options.reduce&&fe.push(0)}let _e=this.trees[J+1]=this._createTree(fe);U&&console.timeEnd(de);for(let ce=J;ce>=G;ce--){const we=+Date.now();_e=this.trees[ce]=this._createTree(this._cluster(_e,ce)),U&&console.log("z%d: %d clusters in %dms",ce,_e.numItems,+Date.now()-we)}return U&&console.timeEnd("total time"),this}getClusters(N,U){let G=((N[0]+180)%360+360)%360-180;const J=Math.max(-90,Math.min(90,N[1]));let de=N[2]===180?180:((N[2]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,N[3]));if(N[2]-N[0]>=360)G=-180,de=180;else if(G>de){const De=this.getClusters([G,J,180,fe],U),ze=this.getClusters([-180,J,de,fe],U);return De.concat(ze)}const _e=this.trees[this._limitZoom(U)],ce=_e.range(ke(G),nt(fe),ke(de),nt(J)),we=_e.data,Ve=[];for(const De of ce){const ze=this.stride*De;Ve.push(we[ze+Xt]>1?Yi(we,ze,this.clusterProps):this.points[we[ze+ai]])}return Ve}getChildren(N){const U=this._getOriginId(N),G=this._getOriginZoom(N),J="No cluster with the specified id.",de=this.trees[G];if(!de)throw new Error(J);const fe=de.data;if(U*this.stride>=fe.length)throw new Error(J);const _e=this.options.radius/(this.options.extent*Math.pow(2,G-1)),ce=de.within(fe[U*this.stride],fe[U*this.stride+1],_e),we=[];for(const Ve of ce){const De=Ve*this.stride;fe[De+4]===N&&we.push(fe[De+Xt]>1?Yi(fe,De,this.clusterProps):this.points[fe[De+ai]])}if(we.length===0)throw new Error(J);return we}getLeaves(N,U,G){const J=[];return this._appendLeaves(J,N,U=U||10,G=G||0,0),J}getTile(N,U,G){const J=this.trees[this._limitZoom(N)],de=Math.pow(2,N),{extent:fe,radius:_e}=this.options,ce=_e/fe,we=(G-ce)/de,Ve=(G+1+ce)/de,De={features:[]};return this._addTileFeatures(J.range((U-ce)/de,we,(U+1+ce)/de,Ve),J.data,U,G,de,De),U===0&&this._addTileFeatures(J.range(1-ce/de,we,1,Ve),J.data,de,G,de,De),U===de-1&&this._addTileFeatures(J.range(0,we,ce/de,Ve),J.data,-1,G,de,De),De.features.length?De:null}getClusterExpansionZoom(N){let U=this._getOriginZoom(N)-1;for(;U<=this.options.maxZoom;){const G=this.getChildren(N);if(U++,G.length!==1)break;N=G[0].properties.cluster_id}return U}_appendLeaves(N,U,G,J,de){const fe=this.getChildren(U);for(const _e of fe){const ce=_e.properties;if(ce&&ce.cluster?de+ce.point_count<=J?de+=ce.point_count:de=this._appendLeaves(N,ce.cluster_id,G,J,de):de<J?de++:N.push(_e),N.length===G)break}return de}_createTree(N){const U=new v.au(N.length/this.stride|0,this.options.nodeSize,Float32Array);for(let G=0;G<N.length;G+=this.stride)U.add(N[G],N[G+1]);return U.finish(),U.data=N,U}_addTileFeatures(N,U,G,J,de,fe){for(const _e of N){const ce=_e*this.stride,we=U[ce+Xt]>1;let Ve,De,ze;if(we)Ve=Wt(U,ce,this.clusterProps),De=U[ce],ze=U[ce+1];else{const Bt=this.points[U[ce+ai]];Ve=Bt.properties;const[zt,ii]=Bt.geometry.coordinates;De=ke(zt),ze=nt(ii)}const St={type:1,geometry:[[Math.round(this.options.extent*(De*de-G)),Math.round(this.options.extent*(ze*de-J))]],tags:Ve};let It;It=we||this.options.generateId?U[ce+ai]:this.points[U[ce+ai]].id,It!==void 0&&(St.id=It),fe.features.push(St)}}_limitZoom(N){return Math.max(this.options.minZoom,Math.min(Math.floor(+N),this.options.maxZoom+1))}_cluster(N,U){const{radius:G,extent:J,reduce:de,minPoints:fe}=this.options,_e=G/(J*Math.pow(2,U)),ce=N.data,we=[],Ve=this.stride;for(let De=0;De<ce.length;De+=Ve){if(ce[De+2]<=U)continue;ce[De+2]=U;const ze=ce[De],St=ce[De+1],It=N.within(ce[De],ce[De+1],_e),Bt=ce[De+Xt];let zt=Bt;for(const ii of It){const bi=ii*Ve;ce[bi+2]>U&&(zt+=ce[bi+Xt])}if(zt>Bt&&zt>=fe){let ii,bi=ze*Bt,zi=St*Bt,nr=-1;const Ut=((De/Ve|0)<<5)+(U+1)+this.points.length;for(const $i of It){const lr=$i*Ve;if(ce[lr+2]<=U)continue;ce[lr+2]=U;const Vr=ce[lr+Xt];bi+=ce[lr]*Vr,zi+=ce[lr+1]*Vr,ce[lr+4]=Ut,de&&(ii||(ii=this._map(ce,De,!0),nr=this.clusterProps.length,this.clusterProps.push(ii)),de(ii,this._map(ce,lr)))}ce[De+4]=Ut,we.push(bi/zt,zi/zt,1/0,Ut,-1,zt),de&&we.push(nr)}else{for(let ii=0;ii<Ve;ii++)we.push(ce[De+ii]);if(zt>1)for(const ii of It){const bi=ii*Ve;if(!(ce[bi+2]<=U)){ce[bi+2]=U;for(let zi=0;zi<Ve;zi++)we.push(ce[bi+zi])}}}}return we}_getOriginId(N){return N-this.points.length>>5}_getOriginZoom(N){return(N-this.points.length)%32}_map(N,U,G){if(N[U+Xt]>1){const fe=this.clusterProps[N[U+Bi]];return G?Object.assign({},fe):fe}const J=this.points[N[U+ai]].properties,de=this.options.map(J);return G&&de===J?Object.assign({},de):de}}function Yi(ie,N,U){return{type:"Feature",id:ie[N+ai],properties:Wt(ie,N,U),geometry:{type:"Point",coordinates:[(G=ie[N],360*(G-.5)),it(ie[N+1])]}};var G}function Wt(ie,N,U){const G=ie[N+Xt],J=G>=1e4?`${Math.round(G/1e3)}k`:G>=1e3?Math.round(G/100)/10+"k":G,de=ie[N+Bi],fe=de===-1?{}:Object.assign({},U[de]);return Object.assign(fe,{cluster:!0,cluster_id:ie[N+ai],point_count:G,point_count_abbreviated:J})}function ke(ie){return ie/360+.5}function nt(ie){const N=Math.sin(ie*Math.PI/180),U=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return U<0?0:U>1?1:U}function it(ie){const N=(180-360*ie)*Math.PI/180;return 360*Math.atan(Math.exp(N))/Math.PI-90}function ht(ie,N,U,G){for(var J,de=G,fe=U-N>>1,_e=U-N,ce=ie[N],we=ie[N+1],Ve=ie[U],De=ie[U+1],ze=N+3;ze<U;ze+=3){var St=Ht(ie[ze],ie[ze+1],ce,we,Ve,De);if(St>de)J=ze,de=St;else if(St===de){var It=Math.abs(ze-fe);It<_e&&(J=ze,_e=It)}}de>G&&(J-N>3&&ht(ie,N,J,G),ie[J+2]=de,U-J>3&&ht(ie,J,U,G))}function Ht(ie,N,U,G,J,de){var fe=J-U,_e=de-G;if(fe!==0||_e!==0){var ce=((ie-U)*fe+(N-G)*_e)/(fe*fe+_e*_e);ce>1?(U=J,G=de):ce>0&&(U+=fe*ce,G+=_e*ce)}return(fe=ie-U)*fe+(_e=N-G)*_e}function ei(ie,N,U,G){var J={id:ie===void 0?null:ie,type:N,geometry:U,tags:G,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(de){var fe=de.geometry,_e=de.type;if(_e==="Point"||_e==="MultiPoint"||_e==="LineString")O(de,fe);else if(_e==="Polygon"||_e==="MultiLineString")for(var ce=0;ce<fe.length;ce++)O(de,fe[ce]);else if(_e==="MultiPolygon")for(ce=0;ce<fe.length;ce++)for(var we=0;we<fe[ce].length;we++)O(de,fe[ce][we])}(J),J}function O(ie,N){for(var U=0;U<N.length;U+=3)ie.minX=Math.min(ie.minX,N[U]),ie.minY=Math.min(ie.minY,N[U+1]),ie.maxX=Math.max(ie.maxX,N[U]),ie.maxY=Math.max(ie.maxY,N[U+1])}function D(ie,N,U,G){if(N.geometry){var J=N.geometry.coordinates,de=N.geometry.type,fe=Math.pow(U.tolerance/((1<<U.maxZoom)*U.extent),2),_e=[],ce=N.id;if(U.promoteId?ce=N.properties[U.promoteId]:U.generateId&&(ce=G||0),de==="Point")Y(J,_e);else if(de==="MultiPoint")for(var we=0;we<J.length;we++)Y(J[we],_e);else if(de==="LineString")ye(J,_e,fe,!1);else if(de==="MultiLineString"){if(U.lineMetrics){for(we=0;we<J.length;we++)ye(J[we],_e=[],fe,!1),ie.push(ei(ce,"LineString",_e,N.properties));return}K(J,_e,fe,!1)}else if(de==="Polygon")K(J,_e,fe,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(we=0;we<N.geometry.geometries.length;we++)D(ie,{id:ce,geometry:N.geometry.geometries[we],properties:N.properties},U,G);return}throw new Error("Input data is not a valid GeoJSON object.")}for(we=0;we<J.length;we++){var Ve=[];K(J[we],Ve,fe,!0),_e.push(Ve)}}ie.push(ei(ce,de,_e,N.properties))}}function Y(ie,N){N.push(Be(ie[0])),N.push(Qe(ie[1])),N.push(0)}function ye(ie,N,U,G){for(var J,de,fe=0,_e=0;_e<ie.length;_e++){var ce=Be(ie[_e][0]),we=Qe(ie[_e][1]);N.push(ce),N.push(we),N.push(0),_e>0&&(fe+=G?(J*we-ce*de)/2:Math.sqrt(Math.pow(ce-J,2)+Math.pow(we-de,2))),J=ce,de=we}var Ve=N.length-3;N[2]=1,ht(N,0,Ve,U),N[Ve+2]=1,N.size=Math.abs(fe),N.start=0,N.end=N.size}function K(ie,N,U,G){for(var J=0;J<ie.length;J++){var de=[];ye(ie[J],de,U,G),N.push(de)}}function Be(ie){return ie/360+.5}function Qe(ie){var N=Math.sin(ie*Math.PI/180),U=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return U<0?0:U>1?1:U}function Me(ie,N,U,G,J,de,fe,_e){if(G/=N,de>=(U/=N)&&fe<G)return ie;if(fe<U||de>=G)return null;for(var ce=[],we=0;we<ie.length;we++){var Ve=ie[we],De=Ve.geometry,ze=Ve.type,St=J===0?Ve.minX:Ve.minY,It=J===0?Ve.maxX:Ve.maxY;if(St>=U&&It<G)ce.push(Ve);else if(!(It<U||St>=G)){var Bt=[];if(ze==="Point"||ze==="MultiPoint")Ke(De,Bt,U,G,J);else if(ze==="LineString")qe(De,Bt,U,G,J,!1,_e.lineMetrics);else if(ze==="MultiLineString")ct(De,Bt,U,G,J,!1);else if(ze==="Polygon")ct(De,Bt,U,G,J,!0);else if(ze==="MultiPolygon")for(var zt=0;zt<De.length;zt++){var ii=[];ct(De[zt],ii,U,G,J,!0),ii.length&&Bt.push(ii)}if(Bt.length){if(_e.lineMetrics&&ze==="LineString"){for(zt=0;zt<Bt.length;zt++)ce.push(ei(Ve.id,ze,Bt[zt],Ve.tags));continue}ze!=="LineString"&&ze!=="MultiLineString"||(Bt.length===1?(ze="LineString",Bt=Bt[0]):ze="MultiLineString"),ze!=="Point"&&ze!=="MultiPoint"||(ze=Bt.length===3?"Point":"MultiPoint"),ce.push(ei(Ve.id,ze,Bt,Ve.tags))}}}return ce.length?ce:null}function Ke(ie,N,U,G,J){for(var de=0;de<ie.length;de+=3){var fe=ie[de+J];fe>=U&&fe<=G&&(N.push(ie[de]),N.push(ie[de+1]),N.push(ie[de+2]))}}function qe(ie,N,U,G,J,de,fe){for(var _e,ce,we=ft(ie),Ve=J===0?Pe:yt,De=ie.start,ze=0;ze<ie.length-3;ze+=3){var St=ie[ze],It=ie[ze+1],Bt=ie[ze+2],zt=ie[ze+3],ii=ie[ze+4],bi=J===0?St:It,zi=J===0?zt:ii,nr=!1;fe&&(_e=Math.sqrt(Math.pow(St-zt,2)+Math.pow(It-ii,2))),bi<U?zi>U&&(ce=Ve(we,St,It,zt,ii,U),fe&&(we.start=De+_e*ce)):bi>G?zi<G&&(ce=Ve(we,St,It,zt,ii,G),fe&&(we.start=De+_e*ce)):xe(we,St,It,Bt),zi<U&&bi>=U&&(ce=Ve(we,St,It,zt,ii,U),nr=!0),zi>G&&bi<=G&&(ce=Ve(we,St,It,zt,ii,G),nr=!0),!de&&nr&&(fe&&(we.end=De+_e*ce),N.push(we),we=ft(ie)),fe&&(De+=_e)}var Ut=ie.length-3;St=ie[Ut],It=ie[Ut+1],Bt=ie[Ut+2],(bi=J===0?St:It)>=U&&bi<=G&&xe(we,St,It,Bt),Ut=we.length-3,de&&Ut>=3&&(we[Ut]!==we[0]||we[Ut+1]!==we[1])&&xe(we,we[0],we[1],we[2]),we.length&&N.push(we)}function ft(ie){var N=[];return N.size=ie.size,N.start=ie.start,N.end=ie.end,N}function ct(ie,N,U,G,J,de){for(var fe=0;fe<ie.length;fe++)qe(ie[fe],N,U,G,J,de,!1)}function xe(ie,N,U,G){ie.push(N),ie.push(U),ie.push(G)}function Pe(ie,N,U,G,J,de){var fe=(de-N)/(G-N);return ie.push(de),ie.push(U+(J-U)*fe),ie.push(1),fe}function yt(ie,N,U,G,J,de){var fe=(de-U)/(J-U);return ie.push(N+(G-N)*fe),ie.push(de),ie.push(1),fe}function Ct(ie,N){for(var U=[],G=0;G<ie.length;G++){var J,de=ie[G],fe=de.type;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")J=Oe(de.geometry,N);else if(fe==="MultiLineString"||fe==="Polygon"){J=[];for(var _e=0;_e<de.geometry.length;_e++)J.push(Oe(de.geometry[_e],N))}else if(fe==="MultiPolygon")for(J=[],_e=0;_e<de.geometry.length;_e++){for(var ce=[],we=0;we<de.geometry[_e].length;we++)ce.push(Oe(de.geometry[_e][we],N));J.push(ce)}U.push(ei(de.id,fe,J,de.tags))}return U}function Oe(ie,N){var U=[];U.size=ie.size,ie.start!==void 0&&(U.start=ie.start,U.end=ie.end);for(var G=0;G<ie.length;G+=3)U.push(ie[G]+N,ie[G+1],ie[G+2]);return U}function oi(ie,N){if(ie.transformed)return ie;var U,G,J,de=1<<ie.z,fe=ie.x,_e=ie.y;for(U=0;U<ie.features.length;U++){var ce=ie.features[U],we=ce.geometry,Ve=ce.type;if(ce.geometry=[],Ve===1)for(G=0;G<we.length;G+=2)ce.geometry.push(fi(we[G],we[G+1],N,de,fe,_e));else for(G=0;G<we.length;G++){var De=[];for(J=0;J<we[G].length;J+=2)De.push(fi(we[G][J],we[G][J+1],N,de,fe,_e));ce.geometry.push(De)}}return ie.transformed=!0,ie}function fi(ie,N,U,G,J,de){return[Math.round(U*(ie*G-J)),Math.round(U*(N*G-de))]}function rn(ie,N,U,G,J){for(var de=N===J.maxZoom?0:J.tolerance/((1<<N)*J.extent),fe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:U,y:G,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},_e=0;_e<ie.length;_e++){fe.numFeatures++,rr(fe,ie[_e],de,J);var ce=ie[_e].minX,we=ie[_e].minY,Ve=ie[_e].maxX,De=ie[_e].maxY;ce<fe.minX&&(fe.minX=ce),we<fe.minY&&(fe.minY=we),Ve>fe.maxX&&(fe.maxX=Ve),De>fe.maxY&&(fe.maxY=De)}return fe}function rr(ie,N,U,G){var J=N.geometry,de=N.type,fe=[];if(de==="Point"||de==="MultiPoint")for(var _e=0;_e<J.length;_e+=3)fe.push(J[_e]),fe.push(J[_e+1]),ie.numPoints++,ie.numSimplified++;else if(de==="LineString")Ye(fe,J,ie,U,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(_e=0;_e<J.length;_e++)Ye(fe,J[_e],ie,U,de==="Polygon",_e===0);else if(de==="MultiPolygon")for(var ce=0;ce<J.length;ce++){var we=J[ce];for(_e=0;_e<we.length;_e++)Ye(fe,we[_e],ie,U,!0,_e===0)}if(fe.length){var Ve=N.tags||null;if(de==="LineString"&&G.lineMetrics){for(var De in Ve={},N.tags)Ve[De]=N.tags[De];Ve.mapbox_clip_start=J.start/J.size,Ve.mapbox_clip_end=J.end/J.size}var ze={geometry:fe,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:Ve};N.id!==null&&(ze.id=N.id),ie.features.push(ze)}}function Ye(ie,N,U,G,J,de){var fe=G*G;if(G>0&&N.size<(J?fe:G))U.numPoints+=N.length/3;else{for(var _e=[],ce=0;ce<N.length;ce+=3)(G===0||N[ce+2]>fe)&&(U.numSimplified++,_e.push(N[ce]),_e.push(N[ce+1])),U.numPoints++;J&&function(we,Ve){for(var De=0,ze=0,St=we.length,It=St-2;ze<St;It=ze,ze+=2)De+=(we[ze]-we[It])*(we[ze+1]+we[It+1]);if(De>0===Ve)for(ze=0,St=we.length;ze<St/2;ze+=2){var Bt=we[ze],zt=we[ze+1];we[ze]=we[St-2-ze],we[ze+1]=we[St-1-ze],we[St-2-ze]=Bt,we[St-1-ze]=zt}}(_e,de),ie.push(_e)}}function Ot(ie,N){var U=(N=this.options=function(J,de){for(var fe in de)J[fe]=de[fe];return J}(Object.create(this.options),N)).debug;if(U&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var G=function(J,de){var fe=[];if(J.type==="FeatureCollection")for(var _e=0;_e<J.features.length;_e++)D(fe,J.features[_e],de,_e);else D(fe,J.type==="Feature"?J:{geometry:J},de);return fe}(ie,N);this.tiles={},this.tileCoords=[],U&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),G=function(J,de){var fe=de.buffer/de.extent,_e=J,ce=Me(J,1,-1-fe,fe,0,-1,2,de),we=Me(J,1,1-fe,2+fe,0,-1,2,de);return(ce||we)&&(_e=Me(J,1,-fe,1+fe,0,-1,2,de)||[],ce&&(_e=Ct(ce,1).concat(_e)),we&&(_e=_e.concat(Ct(we,-1)))),_e}(G,N),G.length&&this.splitTile(G,0,0,0),U&&(G.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Et(ie,N,U){return 32*((1<<ie)*U+N)+ie}function gi(ie,N){return N?ie.properties[N]:ie.id}function mn(ie,N){if(ie==null)return!0;if(ie.type==="Feature")return gi(ie,N)!=null;if(ie.type==="FeatureCollection"){const U=new Set;for(const G of ie.features){const J=gi(G,N);if(J==null||U.has(J))return!1;U.add(J)}return!0}return!1}function Ft(ie,N){const U=new Map;if(ie!=null)if(ie.type==="Feature")U.set(gi(ie,N),ie);else for(const G of ie.features)U.set(gi(G,N),G);return U}Ot.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ot.prototype.splitTile=function(ie,N,U,G,J,de,fe){for(var _e=[ie,N,U,G],ce=this.options,we=ce.debug;_e.length;){G=_e.pop(),U=_e.pop(),N=_e.pop(),ie=_e.pop();var Ve=1<<N,De=Et(N,U,G),ze=this.tiles[De];if(!ze&&(we>1&&console.time("creation"),ze=this.tiles[De]=rn(ie,N,U,G,ce),this.tileCoords.push({z:N,x:U,y:G}),we)){we>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,U,G,ze.numFeatures,ze.numPoints,ze.numSimplified),console.timeEnd("creation"));var St="z"+N;this.stats[St]=(this.stats[St]||0)+1,this.total++}if(ze.source=ie,J){if(N===ce.maxZoom||N===J)continue;var It=1<<J-N;if(U!==Math.floor(de/It)||G!==Math.floor(fe/It))continue}else if(N===ce.indexMaxZoom||ze.numPoints<=ce.indexMaxPoints)continue;if(ze.source=null,ie.length!==0){we>1&&console.time("clipping");var Bt,zt,ii,bi,zi,nr,Ut=.5*ce.buffer/ce.extent,$i=.5-Ut,lr=.5+Ut,Vr=1+Ut;Bt=zt=ii=bi=null,zi=Me(ie,Ve,U-Ut,U+lr,0,ze.minX,ze.maxX,ce),nr=Me(ie,Ve,U+$i,U+Vr,0,ze.minX,ze.maxX,ce),ie=null,zi&&(Bt=Me(zi,Ve,G-Ut,G+lr,1,ze.minY,ze.maxY,ce),zt=Me(zi,Ve,G+$i,G+Vr,1,ze.minY,ze.maxY,ce),zi=null),nr&&(ii=Me(nr,Ve,G-Ut,G+lr,1,ze.minY,ze.maxY,ce),bi=Me(nr,Ve,G+$i,G+Vr,1,ze.minY,ze.maxY,ce),nr=null),we>1&&console.timeEnd("clipping"),_e.push(Bt||[],N+1,2*U,2*G),_e.push(zt||[],N+1,2*U,2*G+1),_e.push(ii||[],N+1,2*U+1,2*G),_e.push(bi||[],N+1,2*U+1,2*G+1)}}},Ot.prototype.getTile=function(ie,N,U){var G=this.options,J=G.extent,de=G.debug;if(ie<0||ie>24)return null;var fe=1<<ie,_e=Et(ie,N=(N%fe+fe)%fe,U);if(this.tiles[_e])return oi(this.tiles[_e],J);de>1&&console.log("drilling down to z%d-%d-%d",ie,N,U);for(var ce,we=ie,Ve=N,De=U;!ce&&we>0;)we--,Ve=Math.floor(Ve/2),De=Math.floor(De/2),ce=this.tiles[Et(we,Ve,De)];return ce&&ce.source?(de>1&&console.log("found parent tile z%d-%d-%d",we,Ve,De),de>1&&console.time("drilling down"),this.splitTile(ce.source,we,Ve,De,ie,N,U),de>1&&console.timeEnd("drilling down"),this.tiles[_e]?oi(this.tiles[_e],J):null):null};class ks extends B{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(N,U){return v._(this,void 0,void 0,function*(){const G=N.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const J=this._geoJSONIndex.getTile(G.z,G.x,G.y);if(!J)return null;const de=new class{constructor(_e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=v.W,this.length=_e.length,this._features=_e}feature(_e){return new class{constructor(ce){this._feature=ce,this.extent=v.W,this.type=ce.type,this.properties=ce.tags,"id"in ce&&!isNaN(ce.id)&&(this.id=parseInt(ce.id,10))}loadGeometry(){if(this._feature.type===1){const ce=[];for(const we of this._feature.geometry)ce.push([new v.P(we[0],we[1])]);return ce}{const ce=[];for(const we of this._feature.geometry){const Ve=[];for(const De of we)Ve.push(new v.P(De[0],De[1]));ce.push(Ve)}return ce}}toGeoJSON(ce,we,Ve){return ae.call(this,ce,we,Ve)}}(this._features[_e])}}(J.features);let fe=jt(de);return fe.byteOffset===0&&fe.byteLength===fe.buffer.byteLength||(fe=new Uint8Array(fe)),{vectorTile:de,rawData:fe.buffer}})}loadData(N){var U;return v._(this,void 0,void 0,function*(){(U=this._pendingRequest)===null||U===void 0||U.abort();const G=!!(N&&N.request&&N.request.collectResourceTiming)&&new v.br(N.request);this._pendingRequest=new AbortController;try{let J=yield this.loadGeoJSON(N,this._pendingRequest);if(delete this._pendingRequest,typeof J!="object")throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`);if(ue(J,!0),N.filter){const fe=v.bx(N.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(fe.result==="error")throw new Error(fe.value.map(ce=>`${ce.key}: ${ce.message}`).join(", "));J={type:"FeatureCollection",features:J.features.filter(ce=>fe.value.evaluate({zoom:0},ce))}}this._geoJSONIndex=N.cluster?new Pi(function({superclusterOptions:fe,clusterProperties:_e}){if(!_e||!fe)return fe;const ce={},we={},Ve={accumulated:null,zoom:0},De={properties:null},ze=Object.keys(_e);for(const St of ze){const[It,Bt]=_e[St],zt=v.bx(Bt),ii=v.bx(typeof It=="string"?[It,["accumulated"],["get",St]]:It);ce[St]=zt.value,we[St]=ii.value}return fe.map=St=>{De.properties=St;const It={};for(const Bt of ze)It[Bt]=ce[Bt].evaluate(Ve,De);return It},fe.reduce=(St,It)=>{De.properties=It;for(const Bt of ze)Ve.accumulated=St[Bt],St[Bt]=we[Bt].evaluate(Ve,De)},fe}(N)).load(J.features):function(fe,_e){return new Ot(fe,_e)}(J,N.geojsonVtOptions),this.loaded={};const de={};if(G){const fe=G.finish();fe&&(de.resourceTiming={},de.resourceTiming[N.source]=JSON.parse(JSON.stringify(fe)))}return de}catch(J){if(delete this._pendingRequest,v.by(J))return{abandoned:!0};throw J}})}reloadTile(N){const U=this.loaded;return U&&U[N.uid]?super.reloadTile(N):this.loadTile(N)}loadGeoJSON(N,U){return v._(this,void 0,void 0,function*(){const{promoteId:G}=N;if(N.request){const J=yield v.h(N.request,U);return this._dataUpdateable=mn(J.data,G)?Ft(J.data,G):void 0,J.data}if(typeof N.data=="string")try{const J=JSON.parse(N.data);return this._dataUpdateable=mn(J,G)?Ft(J,G):void 0,J}catch{throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`)}if(!N.dataDiff)throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${N.source}`);return function(J,de,fe){var _e,ce,we,Ve;if(de.removeAll&&J.clear(),de.remove)for(const De of de.remove)J.delete(De);if(de.add)for(const De of de.add){const ze=gi(De,fe);ze!=null&&J.set(ze,De)}if(de.update)for(const De of de.update){let ze=J.get(De.id);if(ze==null)continue;const St=!De.removeAllProperties&&(((_e=De.removeProperties)===null||_e===void 0?void 0:_e.length)>0||((ce=De.addOrUpdateProperties)===null||ce===void 0?void 0:ce.length)>0);if((De.newGeometry||De.removeAllProperties||St)&&(ze=Object.assign({},ze),J.set(De.id,ze),St&&(ze.properties=Object.assign({},ze.properties))),De.newGeometry&&(ze.geometry=De.newGeometry),De.removeAllProperties)ze.properties={};else if(((we=De.removeProperties)===null||we===void 0?void 0:we.length)>0)for(const It of De.removeProperties)Object.prototype.hasOwnProperty.call(ze.properties,It)&&delete ze.properties[It];if(((Ve=De.addOrUpdateProperties)===null||Ve===void 0?void 0:Ve.length)>0)for(const{key:It,value:Bt}of De.addOrUpdateProperties)ze.properties[It]=Bt}}(this._dataUpdateable,N.dataDiff,G),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(N){return v._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(N){return this._geoJSONIndex.getClusterExpansionZoom(N.clusterId)}getClusterChildren(N){return this._geoJSONIndex.getChildren(N.clusterId)}getClusterLeaves(N){return this._geoJSONIndex.getLeaves(N.clusterId,N.limit,N.offset)}}class or{constructor(N){this.self=N,this.actor=new v.C(N),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(U,G)=>{if(this.externalWorkerSourceTypes[U])throw new Error(`Worker source with name "${U}" already registered.`);this.externalWorkerSourceTypes[U]=G},this.self.addProtocol=v.be,this.self.removeProtocol=v.bf,this.self.registerRTLTextPlugin=U=>{if(v.bz.isParsed())throw new Error("RTL text plugin already registered.");v.bz.setMethods(U)},this.actor.registerMessageHandler("loadDEMTile",(U,G)=>this._getDEMWorkerSource(U,G.source).loadTile(G)),this.actor.registerMessageHandler("removeDEMTile",(U,G)=>v._(this,void 0,void 0,function*(){this._getDEMWorkerSource(U,G.source).removeTile(G)})),this.actor.registerMessageHandler("getClusterExpansionZoom",(U,G)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(U,G.type,G.source).getClusterExpansionZoom(G)})),this.actor.registerMessageHandler("getClusterChildren",(U,G)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(U,G.type,G.source).getClusterChildren(G)})),this.actor.registerMessageHandler("getClusterLeaves",(U,G)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(U,G.type,G.source).getClusterLeaves(G)})),this.actor.registerMessageHandler("loadData",(U,G)=>this._getWorkerSource(U,G.type,G.source).loadData(G)),this.actor.registerMessageHandler("loadTile",(U,G)=>this._getWorkerSource(U,G.type,G.source).loadTile(G)),this.actor.registerMessageHandler("reloadTile",(U,G)=>this._getWorkerSource(U,G.type,G.source).reloadTile(G)),this.actor.registerMessageHandler("abortTile",(U,G)=>this._getWorkerSource(U,G.type,G.source).abortTile(G)),this.actor.registerMessageHandler("removeTile",(U,G)=>this._getWorkerSource(U,G.type,G.source).removeTile(G)),this.actor.registerMessageHandler("removeSource",(U,G)=>v._(this,void 0,void 0,function*(){if(!this.workerSources[U]||!this.workerSources[U][G.type]||!this.workerSources[U][G.type][G.source])return;const J=this.workerSources[U][G.type][G.source];delete this.workerSources[U][G.type][G.source],J.removeSource!==void 0&&J.removeSource(G)})),this.actor.registerMessageHandler("removeMap",U=>v._(this,void 0,void 0,function*(){delete this.layerIndexes[U],delete this.availableImages[U],delete this.workerSources[U],delete this.demWorkerSources[U]})),this.actor.registerMessageHandler("setReferrer",(U,G)=>v._(this,void 0,void 0,function*(){this.referrer=G})),this.actor.registerMessageHandler("syncRTLPluginState",(U,G)=>this._syncRTLPluginState(U,G)),this.actor.registerMessageHandler("importScript",(U,G)=>v._(this,void 0,void 0,function*(){this.self.importScripts(G)})),this.actor.registerMessageHandler("setImages",(U,G)=>this._setImages(U,G)),this.actor.registerMessageHandler("updateLayers",(U,G)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(U).update(G.layers,G.removedIds)})),this.actor.registerMessageHandler("setLayers",(U,G)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(U).replace(G)}))}_setImages(N,U){return v._(this,void 0,void 0,function*(){this.availableImages[N]=U;for(const G in this.workerSources[N]){const J=this.workerSources[N][G];for(const de in J)J[de].availableImages=U}})}_syncRTLPluginState(N,U){return v._(this,void 0,void 0,function*(){v.bz.setState(U);const G=v.bz.getPluginURL();if(U.pluginStatus==="loaded"&&!v.bz.isParsed()&&G!=null){this.self.importScripts(G);const J=v.bz.isParsed();if(J)return J;throw new Error(`RTL Text Plugin failed to import scripts from ${G}`)}return!1})}_getAvailableImages(N){let U=this.availableImages[N];return U||(U=[]),U}_getLayerIndex(N){let U=this.layerIndexes[N];return U||(U=this.layerIndexes[N]=new c),U}_getWorkerSource(N,U,G){if(this.workerSources[N]||(this.workerSources[N]={}),this.workerSources[N][U]||(this.workerSources[N][U]={}),!this.workerSources[N][U][G]){const J={sendAsync:(de,fe)=>(de.targetMapId=N,this.actor.sendAsync(de,fe))};switch(U){case"vector":this.workerSources[N][U][G]=new B(J,this._getLayerIndex(N),this._getAvailableImages(N));break;case"geojson":this.workerSources[N][U][G]=new ks(J,this._getLayerIndex(N),this._getAvailableImages(N));break;default:this.workerSources[N][U][G]=new this.externalWorkerSourceTypes[U](J,this._getLayerIndex(N),this._getAvailableImages(N))}}return this.workerSources[N][U][G]}_getDEMWorkerSource(N,U){return this.demWorkerSources[N]||(this.demWorkerSources[N]={}),this.demWorkerSources[N][U]||(this.demWorkerSources[N][U]=new M),this.demWorkerSources[N][U]}}return v.i(self)&&(self.worker=new or(self)),or}),m("index",["exports","./shared"],function(v,c){var A="4.1.0";let R,z;const B={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:p=>new Promise((t,a)=>{const u=requestAnimationFrame(t);p.signal.addEventListener("abort",()=>{cancelAnimationFrame(u),a(c.c())})}),getImageData(p,t=0){return this.getImageCanvasContext(p).getImageData(-t,-t,p.width+2*t,p.height+2*t)},getImageCanvasContext(p){const t=window.document.createElement("canvas"),a=t.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return t.width=p.width,t.height=p.height,a.drawImage(p,0,0,p.width,p.height),a},resolveURL:p=>(R||(R=document.createElement("a")),R.href=p,R.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(z==null&&(z=matchMedia("(prefers-reduced-motion: reduce)")),z.matches)}};class M{static testProp(t){if(!M.docStyle)return t[0];for(let a=0;a<t.length;a++)if(t[a]in M.docStyle)return t[a];return t[0]}static create(t,a,u){const d=window.document.createElement(t);return a!==void 0&&(d.className=a),u&&u.appendChild(d),d}static createNS(t,a){return window.document.createElementNS(t,a)}static disableDrag(){M.docStyle&&M.selectProp&&(M.userSelect=M.docStyle[M.selectProp],M.docStyle[M.selectProp]="none")}static enableDrag(){M.docStyle&&M.selectProp&&(M.docStyle[M.selectProp]=M.userSelect)}static setTransform(t,a){t.style[M.transformProp]=a}static addEventListener(t,a,u,d={}){t.addEventListener(a,u,"passive"in d?d:d.capture)}static removeEventListener(t,a,u,d={}){t.removeEventListener(a,u,"passive"in d?d:d.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",M.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",M.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",M.suppressClickInternal,!0)},0)}static getScale(t){const a=t.getBoundingClientRect();return{x:a.width/t.offsetWidth||1,y:a.height/t.offsetHeight||1,boundingClientRect:a}}static getPoint(t,a,u){const d=a.boundingClientRect;return new c.P((u.clientX-d.left)/a.x-t.clientLeft,(u.clientY-d.top)/a.y-t.clientTop)}static mousePos(t,a){const u=M.getScale(t);return M.getPoint(t,u,a)}static touchPos(t,a){const u=[],d=M.getScale(t);for(let g=0;g<a.length;g++)u.push(M.getPoint(t,d,a[g]));return u}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}M.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,M.selectProp=M.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),M.transformProp=M.testProp(["transform","WebkitTransform"]);const re={supported:!1,testSupport:function(p){!ae&&ue&&(Z?me(p):se=p)}};let se,ue,ae=!1,Z=!1;function me(p){const t=p.createTexture();p.bindTexture(p.TEXTURE_2D,t);try{if(p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,ue),p.isContextLost())return;re.supported=!0}catch{}p.deleteTexture(t),ae=!0}var Ce,be;typeof document<"u"&&(ue=document.createElement("img"),ue.onload=function(){se&&me(se),se=null,Z=!0},ue.onerror=function(){ae=!0,se=null},ue.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(p){let t,a,u,d;p.resetRequestQueue=()=>{t=[],a=0,u=0,d={}},p.addThrottleControl=E=>{const C=u++;return d[C]=E,C},p.removeThrottleControl=E=>{delete d[E],w()},p.getImage=(E,C,k=!0)=>new Promise((F,j)=>{re.supported&&(E.headers||(E.headers={}),E.headers.accept="image/webp,*/*"),c.e(E,{type:"image"}),t.push({abortController:C,requestParameters:E,supportImageRefresh:k,state:"queued",onError:Q=>{j(Q)},onSuccess:Q=>{F(Q)}}),w()});const g=E=>c._(this,void 0,void 0,function*(){E.state="running";const{requestParameters:C,supportImageRefresh:k,onError:F,onSuccess:j,abortController:Q}=E,X=k===!1&&!c.i(self)&&!c.g(C.url)&&(!C.headers||Object.keys(C.headers).reduce((he,Te)=>he&&Te==="accept",!0));a++;const ee=X?T(C,Q):c.m(C,Q);try{const he=yield ee;delete E.abortController,E.state="completed",he.data instanceof HTMLImageElement||c.b(he.data)?j(he):he.data&&j({data:yield(W=he.data,typeof createImageBitmap=="function"?c.d(W):c.f(W)),cacheControl:he.cacheControl,expires:he.expires})}catch(he){delete E.abortController,F(he)}finally{a--,w()}var W}),w=()=>{const E=(()=>{for(const C of Object.keys(d))if(d[C]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let C=a;C<E&&t.length>0;C++){const k=t.shift();k.abortController.signal.aborted?C--:g(k)}},T=(E,C)=>new Promise((k,F)=>{const j=new Image,Q=E.url,X=E.credentials;X&&X==="include"?j.crossOrigin="use-credentials":(X&&X==="same-origin"||!c.s(Q))&&(j.crossOrigin="anonymous"),C.signal.addEventListener("abort",()=>{j.src="",F(c.c())}),j.fetchPriority="high",j.onload=()=>{j.onerror=j.onload=null,k({data:j})},j.onerror=()=>{j.onerror=j.onload=null,C.signal.aborted||F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},j.src=Q})}(Ce||(Ce={})),Ce.resetRequestQueue(),function(p){p.Glyphs="Glyphs",p.Image="Image",p.Source="Source",p.SpriteImage="SpriteImage",p.SpriteJSON="SpriteJSON",p.Style="Style",p.Tile="Tile",p.Unknown="Unknown"}(be||(be={}));class Re{constructor(t){this._transformRequestFn=t}transformRequest(t,a){return this._transformRequestFn&&this._transformRequestFn(t,a)||{url:t}}normalizeSpriteURL(t,a,u){const d=function(g){const w=g.match(Ae);if(!w)throw new Error(`Unable to parse URL "${g}"`);return{protocol:w[1],authority:w[2],path:w[3]||"/",params:w[4]?w[4].split("&"):[]}}(t);return d.path+=`${a}${u}`,function(g){const w=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${w}`}(d)}setTransformRequest(t){this._transformRequestFn=t}}const Ae=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function $e(p){var t=new c.A(3);return t[0]=p[0],t[1]=p[1],t[2]=p[2],t}var Se,Ge=function(p,t,a){return p[0]=t[0]-a[0],p[1]=t[1]-a[1],p[2]=t[2]-a[2],p};Se=new c.A(3),c.A!=Float32Array&&(Se[0]=0,Se[1]=0,Se[2]=0);var ot=function(p){var t=p[0],a=p[1];return t*t+a*a};function _t(p){const t=[];if(typeof p=="string")t.push({id:"default",url:p});else if(p&&p.length>0){const a=[];for(const{id:u,url:d}of p){const g=`${u}${d}`;a.indexOf(g)===-1&&(a.push(g),t.push({id:u,url:d}))}}return t}(function(){var p=new c.A(2);c.A!=Float32Array&&(p[0]=0,p[1]=0)})();class He{constructor(t,a,u,d){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(a,d)}update(t,a,u){const{width:d,height:g}=t,w=!(this.size&&this.size[0]===d&&this.size[1]===g||u),{context:T}=this,{gl:E}=T;if(this.useMipmap=!!(a&&a.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!a||a.premultiply!==!1)),w)this.size=[d,g],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||c.b(t)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,t):E.texImage2D(E.TEXTURE_2D,0,this.format,d,g,0,this.format,E.UNSIGNED_BYTE,t.data);else{const{x:C,y:k}=u||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||c.b(t)?E.texSubImage2D(E.TEXTURE_2D,0,C,k,E.RGBA,E.UNSIGNED_BYTE,t):E.texSubImage2D(E.TEXTURE_2D,0,C,k,d,g,E.RGBA,E.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)}bind(t,a,u){const{context:d}=this,{gl:g}=d;g.bindTexture(g.TEXTURE_2D,this.texture),u!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=g.LINEAR),t!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,t),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,u||t),this.filter=t),a!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,a),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function bt(p){const{userImage:t}=p;return!!(t&&t.render&&t.render())&&(p.data.replace(new Uint8Array(t.data.buffer)),!0)}class qt extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:a,promiseResolve:u}of this.requestors)u(this._getImagesForIds(a));this.requestors=[]}}getImage(t){const a=this.images[t];if(a&&!a.data&&a.spriteData){const u=a.spriteData;a.data=new c.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),a.spriteData=null}return a}addImage(t,a){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,a)&&(this.images[t]=a)}_validate(t,a){let u=!0;const d=a.data||a.spriteData;return this._validateStretch(a.stretchX,d&&d.width)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "stretchX" value`))),u=!1),this._validateStretch(a.stretchY,d&&d.height)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "stretchY" value`))),u=!1),this._validateContent(a.content,a)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "content" value`))),u=!1),u}_validateStretch(t,a){if(!t)return!0;let u=0;for(const d of t){if(d[0]<u||d[1]<d[0]||a<d[1])return!1;u=d[1]}return!0}_validateContent(t,a){if(!t)return!0;if(t.length!==4)return!1;const u=a.spriteData,d=u&&u.width||a.data.width,g=u&&u.height||a.data.height;return!(t[0]<0||d<t[0]||t[1]<0||g<t[1]||t[2]<0||d<t[2]||t[3]<0||g<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,a,u=!0){const d=this.getImage(t);if(u&&(d.data.width!==a.data.width||d.data.height!==a.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=d.version+1,this.images[t]=a,this.updatedImages[t]=!0}removeImage(t){const a=this.images[t];delete this.images[t],delete this.patterns[t],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((a,u)=>{let d=!0;if(!this.isLoaded())for(const g of t)this.images[g]||(d=!1);this.isLoaded()||d?a(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:a})})}_getImagesForIds(t){const a={};for(const u of t){let d=this.getImage(u);d||(this.fire(new c.k("styleimagemissing",{id:u})),d=this.getImage(u)),d?a[u]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:c.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:t,height:a}=this.atlasImage;return{width:t,height:a}}getPattern(t){const a=this.patterns[t],u=this.getImage(t);if(!u)return null;if(a&&a.position.version===u.version)return a.position;if(a)a.position.version=u.version;else{const d={w:u.data.width+2,h:u.data.height+2,x:0,y:0},g=new c.I(d,u);this.patterns[t]={bin:d,position:g}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const a=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new He(t,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const g in this.patterns)t.push(this.patterns[g].bin);const{w:a,h:u}=c.p(t),d=this.atlasImage;d.resize({width:a||1,height:u||1});for(const g in this.patterns){const{bin:w}=this.patterns[g],T=w.x+1,E=w.y+1,C=this.getImage(g).data,k=C.width,F=C.height;c.R.copy(C,d,{x:0,y:0},{x:T,y:E},{width:k,height:F}),c.R.copy(C,d,{x:0,y:F-1},{x:T,y:E-1},{width:k,height:1}),c.R.copy(C,d,{x:0,y:0},{x:T,y:E+F},{width:k,height:1}),c.R.copy(C,d,{x:k-1,y:0},{x:T-1,y:E},{width:1,height:F}),c.R.copy(C,d,{x:0,y:0},{x:T+k,y:E},{width:1,height:F})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const a of t){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const u=this.getImage(a);u||c.w(`Image with ID: "${a}" was not found`),bt(u)&&this.updateImage(a,u)}}}const pi=1e20;function Lt(p,t,a,u,d,g,w,T,E){for(let C=t;C<t+u;C++)jt(p,a*g+C,g,d,w,T,E);for(let C=a;C<a+d;C++)jt(p,C*g+t,1,u,w,T,E)}function jt(p,t,a,u,d,g,w){g[0]=0,w[0]=-pi,w[1]=pi,d[0]=p[t];for(let T=1,E=0,C=0;T<u;T++){d[T]=p[t+T*a];const k=T*T;do{const F=g[E];C=(d[T]-d[F]+k-F*F)/(T-F)/2}while(C<=w[E]&&--E>-1);E++,g[E]=T,w[E]=C,w[E+1]=pi}for(let T=0,E=0;T<u;T++){for(;w[E+1]<T;)E++;const C=g[E],k=T-C;p[t+T*a]=d[C]+k*k}}class Dt{constructor(t,a){this.requestManager=t,this.localIdeographFontFamily=a,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return c._(this,void 0,void 0,function*(){const a=[];for(const g in t)for(const w of t[g])a.push(this._getAndCacheGlyphsPromise(g,w));const u=yield Promise.all(a),d={};for(const{stack:g,id:w,glyph:T}of u)d[g]||(d[g]={}),d[g][w]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics};return d})}_getAndCacheGlyphsPromise(t,a){return c._(this,void 0,void 0,function*(){let u=this.entries[t];u||(u=this.entries[t]={glyphs:{},requests:{},ranges:{}});let d=u.glyphs[a];if(d!==void 0)return{stack:t,id:a,glyph:d};if(d=this._tinySDF(u,t,a),d)return u.glyphs[a]=d,{stack:t,id:a,glyph:d};const g=Math.floor(a/256);if(256*g>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[g])return{stack:t,id:a,glyph:d};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[g]){const T=Dt.loadGlyphRange(t,g,this.url,this.requestManager);u.requests[g]=T}const w=yield u.requests[g];for(const T in w)this._doesCharSupportLocalGlyph(+T)||(u.glyphs[+T]=w[+T]);return u.ranges[g]=!0,{stack:t,id:a,glyph:w[a]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(c.u["CJK Unified Ideographs"](t)||c.u["Hangul Syllables"](t)||c.u.Hiragana(t)||c.u.Katakana(t))}_tinySDF(t,a,u){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(u))return;let g=t.tinySDF;if(!g){let T="400";/bold/i.test(a)?T="900":/medium/i.test(a)?T="500":/light/i.test(a)&&(T="200"),g=t.tinySDF=new Dt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:T})}const w=g.draw(String.fromCharCode(u));return{id:u,bitmap:new c.o({width:w.width||60,height:w.height||60},w.data),metrics:{width:w.glyphWidth/2||24,height:w.glyphHeight/2||24,left:w.glyphLeft/2+.5||0,top:w.glyphTop/2-27.5||-8,advance:w.glyphAdvance/2||24,isDoubleResolution:!0}}}}Dt.loadGlyphRange=function(p,t,a,u){return c._(this,void 0,void 0,function*(){const d=256*t,g=d+255,w=u.transformRequest(a.replace("{fontstack}",p).replace("{range}",`${d}-${g}`),be.Glyphs),T=yield c.l(w,new AbortController);if(!T||!T.data)throw new Error(`Could not load glyph range. range: ${t}, ${d}-${g}`);const E={};for(const C of c.n(T.data))E[C.id]=C;return E})},Dt.TinySDF=class{constructor({fontSize:p=24,buffer:t=3,radius:a=8,cutoff:u=.25,fontFamily:d="sans-serif",fontWeight:g="normal",fontStyle:w="normal"}={}){this.buffer=t,this.cutoff=u,this.radius=a;const T=this.size=p+4*t,E=this._createCanvas(T),C=this.ctx=E.getContext("2d",{willReadFrequently:!0});C.font=`${w} ${g} ${p}px ${d}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(p){const t=document.createElement("canvas");return t.width=t.height=p,t}draw(p){const{width:t,actualBoundingBoxAscent:a,actualBoundingBoxDescent:u,actualBoundingBoxLeft:d,actualBoundingBoxRight:g}=this.ctx.measureText(p),w=Math.ceil(a),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-d))),E=Math.min(this.size-this.buffer,w+Math.ceil(u)),C=T+2*this.buffer,k=E+2*this.buffer,F=Math.max(C*k,0),j=new Uint8ClampedArray(F),Q={data:j,width:C,height:k,glyphWidth:T,glyphHeight:E,glyphTop:w,glyphLeft:0,glyphAdvance:t};if(T===0||E===0)return Q;const{ctx:X,buffer:ee,gridInner:W,gridOuter:he}=this;X.clearRect(ee,ee,T,E),X.fillText(p,ee,ee+w);const Te=X.getImageData(ee,ee,T,E);he.fill(pi,0,F),W.fill(0,0,F);for(let ne=0;ne<E;ne++)for(let ge=0;ge<T;ge++){const Ie=Te.data[4*(ne*T+ge)+3]/255;if(Ie===0)continue;const Ee=(ne+ee)*C+ge+ee;if(Ie===1)he[Ee]=0,W[Ee]=pi;else{const Fe=.5-Ie;he[Ee]=Fe>0?Fe*Fe:0,W[Ee]=Fe<0?Fe*Fe:0}}Lt(he,0,0,C,k,C,this.f,this.v,this.z),Lt(W,ee,ee,T,E,C,this.f,this.v,this.z);for(let ne=0;ne<F;ne++){const ge=Math.sqrt(he[ne])-Math.sqrt(W[ne]);j[ne]=Math.round(255-255*(ge/this.radius+this.cutoff))}return Q}};class Ci{constructor(){this.specification=c.v.light.position}possiblyEvaluate(t,a){return c.y(t.expression.evaluate(a))}interpolate(t,a,u){return{x:c.z.number(t.x,a.x,u),y:c.z.number(t.y,a.y,u),z:c.z.number(t.z,a.z,u)}}}let mi;class ai extends c.E{constructor(t){super(),mi=mi||new c.q({anchor:new c.D(c.v.light.anchor),position:new Ci,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(mi),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,a={}){if(!this._validate(c.r,t,a))for(const u in t){const d=t[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),d):this._transitionable.setValue(u,d)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,u){return(!u||u.validate!==!1)&&c.t(this,t.call(c.x,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}class Xt{constructor(t,a){this.width=t,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,a){const u=t.join(",")+String(a);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(t,a)),this.dashEntry[u]}getDashRanges(t,a,u){const d=[];let g=t.length%2==1?-t[t.length-1]*u:0,w=t[0]*u,T=!0;d.push({left:g,right:w,isDash:T,zeroLength:t[0]===0});let E=t[0];for(let C=1;C<t.length;C++){T=!T;const k=t[C];g=E*u,E+=k,w=E*u,d.push({left:g,right:w,isDash:T,zeroLength:k===0})}return d}addRoundDash(t,a,u){const d=a/2;for(let g=-u;g<=u;g++){const w=this.width*(this.nextRow+u+g);let T=0,E=t[T];for(let C=0;C<this.width;C++){C/E.right>1&&(E=t[++T]);const k=Math.abs(C-E.left),F=Math.abs(C-E.right),j=Math.min(k,F);let Q;const X=g/u*(d+1);if(E.isDash){const ee=d-Math.abs(X);Q=Math.sqrt(j*j+ee*ee)}else Q=d-Math.sqrt(j*j+X*X);this.data[w+C]=Math.max(0,Math.min(255,Q+128))}}}addRegularDash(t){for(let T=t.length-1;T>=0;--T){const E=t[T],C=t[T+1];E.zeroLength?t.splice(T,1):C&&C.isDash===E.isDash&&(C.left=E.left,t.splice(T,1))}const a=t[0],u=t[t.length-1];a.isDash===u.isDash&&(a.left=u.left-this.width,u.right=a.right+this.width);const d=this.width*this.nextRow;let g=0,w=t[g];for(let T=0;T<this.width;T++){T/w.right>1&&(w=t[++g]);const E=Math.abs(T-w.left),C=Math.abs(T-w.right),k=Math.min(E,C);this.data[d+T]=Math.max(0,Math.min(255,(w.isDash?k:-k)+128))}}addDash(t,a){const u=a?7:0,d=2*u+1;if(this.nextRow+d>this.height)return c.w("LineAtlas out of space"),null;let g=0;for(let T=0;T<t.length;T++)g+=t[T];if(g!==0){const T=this.width/g,E=this.getDashRanges(t,this.width,T);a?this.addRoundDash(E,T,u):this.addRegularDash(E)}const w={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:g};return this.nextRow+=d,this.dirty=!0,w}bind(t){const a=t.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const Bi="maplibre_preloaded_worker_pool";class Pi{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Pi.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Bi]}numActive(){return Object.keys(this.active).length}}const Yi=Math.floor(B.hardwareConcurrency/2);let Wt,ke;function nt(){return Wt||(Wt=new Pi),Wt}Pi.workerCount=c.B(globalThis)?Math.max(Math.min(Yi,3),1):1;class it{constructor(t,a){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=a;const u=this.workerPool.acquire(a);for(let d=0;d<u.length;d++){const g=new c.C(u[d],a);g.name=`Worker ${d}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,a){const u=[];for(const d of this.actors)u.push(d.sendAsync({type:t,data:a}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,a){for(const u of this.actors)u.registerMessageHandler(t,a)}}function ht(){return ke||(ke=new it(nt(),c.G),ke.registerMessageHandler("getResource",(p,t,a)=>c.m(t,a))),ke}function Ht(p,t){const a=c.F();return c.H(a,a,[1,1,0]),c.J(a,a,[.5*p.width,.5*p.height,1]),c.K(a,a,p.calculatePosMatrix(t.toUnwrapped()))}function ei(p,t,a,u,d,g){const w=function(F,j,Q){if(F)for(const X of F){const ee=j[X];if(ee&&ee.source===Q&&ee.type==="fill-extrusion")return!0}else for(const X in j){const ee=j[X];if(ee.source===Q&&ee.type==="fill-extrusion")return!0}return!1}(d&&d.layers,t,p.id),T=g.maxPitchScaleFactor(),E=p.tilesIn(u,T,w);E.sort(O);const C=[];for(const F of E)C.push({wrappedTileID:F.tileID.wrapped().key,queryResults:F.tile.queryRenderedFeatures(t,a,p._state,F.queryGeometry,F.cameraQueryGeometry,F.scale,d,g,T,Ht(p.transform,F.tileID))});const k=function(F){const j={},Q={};for(const X of F){const ee=X.queryResults,W=X.wrappedTileID,he=Q[W]=Q[W]||{};for(const Te in ee){const ne=ee[Te],ge=he[Te]=he[Te]||{},Ie=j[Te]=j[Te]||[];for(const Ee of ne)ge[Ee.featureIndex]||(ge[Ee.featureIndex]=!0,Ie.push(Ee))}}return j}(C);for(const F in k)k[F].forEach(j=>{const Q=j.feature,X=p.getFeatureState(Q.layer["source-layer"],Q.id);Q.source=Q.layer.source,Q.layer["source-layer"]&&(Q.sourceLayer=Q.layer["source-layer"]),Q.state=X});return k}function O(p,t){const a=p.tileID,u=t.tileID;return a.overscaledZ-u.overscaledZ||a.canonical.y-u.canonical.y||a.wrap-u.wrap||a.canonical.x-u.canonical.x}function D(p,t,a){return c._(this,void 0,void 0,function*(){let u=p;if(p.url?u=(yield c.h(t.transformRequest(p.url,be.Source),a)).data:yield B.frameAsync(a),!u)return null;const d=c.L(c.e(u,p),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(d.vectorLayerIds=u.vector_layers.map(g=>g.id)),d})}class Y{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof c.M?new c.M(t.lng,t.lat):c.M.convert(t),this}setSouthWest(t){return this._sw=t instanceof c.M?new c.M(t.lng,t.lat):c.M.convert(t),this}extend(t){const a=this._sw,u=this._ne;let d,g;if(t instanceof c.M)d=t,g=t;else{if(!(t instanceof Y))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Y.convert(t)):this.extend(c.M.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(c.M.convert(t)):this;if(d=t._sw,g=t._ne,!d||!g)return this}return a||u?(a.lng=Math.min(d.lng,a.lng),a.lat=Math.min(d.lat,a.lat),u.lng=Math.max(g.lng,u.lng),u.lat=Math.max(g.lat,u.lat)):(this._sw=new c.M(d.lng,d.lat),this._ne=new c.M(g.lng,g.lat)),this}getCenter(){return new c.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.M(this.getWest(),this.getNorth())}getSouthEast(){return new c.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:u}=c.M.convert(t);let d=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&d}static convert(t){return t instanceof Y?t:t&&new Y(t)}static fromLngLat(t,a=0){const u=360*a/40075017,d=u/Math.cos(Math.PI/180*t.lat);return new Y(new c.M(t.lng-d,t.lat-u),new c.M(t.lng+d,t.lat+u))}}class ye{constructor(t,a,u){this.bounds=Y.convert(this.validateBounds(t)),this.minzoom=a||0,this.maxzoom=u||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const a=Math.pow(2,t.z),u=Math.floor(c.N(this.bounds.getWest())*a),d=Math.floor(c.O(this.bounds.getNorth())*a),g=Math.ceil(c.N(this.bounds.getEast())*a),w=Math.ceil(c.O(this.bounds.getSouth())*a);return t.x>=u&&t.x<g&&t.y>=d&&t.y<w}}class K extends c.E{constructor(t,a,u,d){if(super(),this.id=t,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.L(a,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield D(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(c.e(this,t),t.bounds&&(this.tileBounds=new ye(t.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new c.j(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(a,be.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};u.request.collectResourceTiming=this._collectResourceTiming;let d="reloadTile";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((g,w)=>{t.reloadPromise={resolve:g,reject:w}})}else t.actor=this.dispatcher.getActor(),d="loadTile";t.abortController=new AbortController;try{const g=yield t.actor.sendAsync({type:d,data:u},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,g)}catch(g){if(delete t.abortController,t.aborted)return;if(g&&g.status!==404)throw g;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,a){if(a&&a.resourceTiming&&(t.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&t.setExpiryData(a),t.loadVectorData(a,this.map.painter),t.reloadPromise){const u=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(u.resolve).catch(u.reject)}}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"abortTile",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"removeTile",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Be extends c.E{constructor(t,a,u,d){super(),this.id=t,this.dispatcher=u,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.L(a,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield D(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,t&&(c.e(this,t),t.bounds&&(this.tileBounds=new ye(t.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new c.j(t))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return c.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const u=yield Ce.getImage(this.map._requestManager.transformRequest(a,be.Tile),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&t.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const d=this.map.painter.context,g=d.gl,w=u.data;t.texture=this.map.painter.getTileTexture(w.width),t.texture?t.texture.update(w,{useMipmap:!0}):(t.texture=new He(d,w,g.RGBA,{useMipmap:!0}),t.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST),d.extTextureFilterAnisotropic&&g.texParameterf(g.TEXTURE_2D,d.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,d.extTextureFilterAnisotropicMax)),t.state="loaded"}}catch(u){if(delete t.abortController,t.aborted)t.state="unloaded";else if(u)throw t.state="errored",u}})}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class Qe extends Be{constructor(t,a,u,d){super(t,a,u,d),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(a,be.Tile);t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const d=yield Ce.getImage(u,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(d&&d.data){const g=d.data;this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&t.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const w=c.b(g)&&c.S()?g:yield this.readImageNow(g),T={type:this.type,uid:t.uid,source:this.id,rawImageData:w,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const E=yield t.actor.sendAsync({type:"loadDEMTile",data:T});t.dem=E,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(d){if(delete t.abortController,t.aborted)t.state="unloaded";else if(d)throw t.state="errored",d}})}readImageNow(t){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.U()){const a=t.width+2,u=t.height+2;try{return new c.R({width:a,height:u},yield c.V(t,-1,-1,a,u))}catch{}}return B.getImageData(t,1)})}_getNeighboringTiles(t){const a=t.canonical,u=Math.pow(2,a.z),d=(a.x-1+u)%u,g=a.x===0?t.wrap-1:t.wrap,w=(a.x+1+u)%u,T=a.x+1===u?t.wrap+1:t.wrap,E={};return E[new c.Q(t.overscaledZ,g,a.z,d,a.y).key]={backfilled:!1},E[new c.Q(t.overscaledZ,T,a.z,w,a.y).key]={backfilled:!1},a.y>0&&(E[new c.Q(t.overscaledZ,g,a.z,d,a.y-1).key]={backfilled:!1},E[new c.Q(t.overscaledZ,t.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},E[new c.Q(t.overscaledZ,T,a.z,w,a.y-1).key]={backfilled:!1}),a.y+1<u&&(E[new c.Q(t.overscaledZ,g,a.z,d,a.y+1).key]={backfilled:!1},E[new c.Q(t.overscaledZ,t.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},E[new c.Q(t.overscaledZ,T,a.z,w,a.y+1).key]={backfilled:!1}),E}unloadTile(t){return c._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"removeDEMTile",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class Me extends c.E{constructor(t,a,u,d){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(d),this._data=a.data,this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const g=c.W/this.tileSize;this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*g,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*g,extent:c.W,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.W,radius:(a.clusterRadius||50)*g,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"getClusterExpansionZoom",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"getClusterChildren",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,a,u){return this.actor.sendAsync({type:"getClusterLeaves",data:{type:this.type,source:this.id,clusterId:t,limit:a,offset:u}})}_updateWorkerData(t){return c._(this,void 0,void 0,function*(){const a=c.e({type:this.type},this.workerOptions);t?a.dataDiff=t:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(B.resolveURL(this._data),be.Source),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const u=yield this.actor.sendAsync({type:"loadData",data:a});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let d=null;u.resourceTiming&&u.resourceTiming[this.id]&&(d=u.resourceTiming[this.id].slice(0));const g={dataType:"source"};this._collectResourceTiming&&d&&d.length>0&&c.e(g,{resourceTiming:d}),this.fire(new c.k("data",Object.assign(Object.assign({},g),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},g),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(u))}})}loaded(){return this._pendingLoads===0}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const u={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.abortController=new AbortController;const d=yield this.actor.sendAsync({type:a,data:u},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(d,this.map.painter,a==="reloadTile")})}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"removeTile",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"removeSource",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ke=c.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class qe extends c.E{constructor(t,a,u,d){super(),this.id=t,this.dispatcher=u,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=a}load(t){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield Ce.getImage(this.map._requestManager.transformRequest(this.url,be.Image),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,t&&(this.coordinates=t),this._finishLoading())}catch(a){this._request=null,this.fire(new c.j(a))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const a=t.map(c.Y.fromLngLat);this.tileID=function(d){let g=1/0,w=1/0,T=-1/0,E=-1/0;for(const j of d)g=Math.min(g,j.x),w=Math.min(w,j.y),T=Math.max(T,j.x),E=Math.max(E,j.y);const C=Math.max(T-g,E-w),k=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),F=Math.pow(2,k);return new c.a0(k,Math.floor((g+T)/2*F),Math.floor((w+E)/2*F))}(a),this.minzoom=this.maxzoom=this.tileID.z;const u=a.map(d=>this.tileID.getTilePoint(d)._round());return this._boundsArray=new c.Z,this._boundsArray.emplaceBack(u[0].x,u[0].y,0,0),this._boundsArray.emplaceBack(u[1].x,u[1].y,c.W,0),this._boundsArray.emplaceBack(u[3].x,u[3].y,0,c.W),this._boundsArray.emplaceBack(u[2].x,u[2].y,c.W,c.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,a=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Ke.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new He(t,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let u=!1;for(const d in this.tiles){const g=this.tiles[d];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,u=!0)}u&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ft extends qe{constructor(t,a,u,d){super(t,a,u,d),this.roundZoom=!0,this.type="video",this.options=a}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const a of t.urls)this.urls.push(this.map._requestManager.transformRequest(a,be.Source).url);try{const a=yield c.a2(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new c.j(a))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const a=this.video.seekable;t<a.start(0)||t>a.end(0)?this.fire(new c.j(new c.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,a=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Ke.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new He(t,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let u=!1;for(const d in this.tiles){const g=this.tiles[d];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,u=!0)}u&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ct extends qe{constructor(t,a,u,d){super(t,a,u,d),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(w=>typeof w!="number"))||this.fire(new c.j(new c.a1(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a1(`sources.${t}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.j(new c.a1(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a1(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a1(`sources.${t}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,u=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,Ke.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new He(a,this.canvas,u.RGBA,{premultiply:!0});let d=!1;for(const g in this.tiles){const w=this.tiles[g];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,d=!0)}d&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const xe={},Pe=p=>{switch(p){case"geojson":return Me;case"image":return qe;case"raster":return Be;case"raster-dem":return Qe;case"vector":return K;case"video":return ft;case"canvas":return ct}return xe[p]};class yt extends c.E{constructor(){super(...arguments),this.pluginStatus="unavailable",this.pluginURL=null,this.dispatcher=ht(),this.queue=[]}_sendPluginStateToWorker(){return c._(this,void 0,void 0,function*(){yield this.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}),this.fire(new c.k("pluginStateChange",{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}))})}getRTLTextPluginStatus(){return this.pluginStatus}clearRTLTextPlugin(){this.pluginStatus="unavailable",this.pluginURL=null}setRTLTextPlugin(t,a=!1){return c._(this,void 0,void 0,function*(){if(this.pluginStatus==="deferred"||this.pluginStatus==="loading"||this.pluginStatus==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");this.pluginURL=B.resolveURL(t),this.pluginStatus="deferred",yield this._sendPluginStateToWorker(),a||(yield this._downloadRTLTextPlugin())})}_downloadRTLTextPlugin(){return c._(this,void 0,void 0,function*(){if(this.pluginStatus!=="deferred"||!this.pluginURL)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");try{this.pluginStatus="loading",yield this._sendPluginStateToWorker(),yield c.l({url:this.pluginURL},new AbortController),this.pluginStatus="loaded"}catch{this.pluginStatus="error"}yield this._sendPluginStateToWorker()})}lazyLoadRTLTextPlugin(){return c._(this,void 0,void 0,function*(){this.pluginStatus==="deferred"&&(yield this._downloadRTLTextPlugin())})}}let Ct=null;function Oe(){return Ct||(Ct=new yt),Ct}class oi{constructor(t,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=c.a3(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const a=t+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,a,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(d,g){const w={};if(!g)return w;for(const T of d){const E=T.layerIds.map(C=>g.getLayer(C)).filter(Boolean);if(E.length!==0){T.layers=E,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(C=>E.filter(k=>k.id===C)[0]));for(const C of E)w[C.id]=T}}return w}(t.buckets,a.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const g=this.buckets[d];if(g instanceof c.a5){if(this.hasSymbolBuckets=!0,!u)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const g=this.buckets[d];if(g instanceof c.a5&&g.hasRTLText){this.hasRTLText=!0,Oe().lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const d in this.buckets){const g=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(d).queryRadius(g))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new c.a4}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const u in this.buckets){const d=this.buckets[u];d.uploadPending()&&d.upload(t)}const a=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new He(t,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new He(t,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,a,u,d,g,w,T,E,C,k){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:g,scale:w,tileSize:this.tileSize,pixelPosMatrix:k,transform:E,params:T,queryPadding:this.queryPadding*C},t,a,u):{}}querySourceFeatures(t,a){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const d=u.loadVTLayers(),g=a&&a.sourceLayer?a.sourceLayer:"",w=d._geojsonTileLayer||d[g];if(!w)return;const T=c.a6(a&&a.filter),{z:E,x:C,y:k}=this.tileID.canonical,F={z:E,x:C,y:k};for(let j=0;j<w.length;j++){const Q=w.feature(j);if(T.needGeometry){const W=c.a7(Q,!0);if(!T.filter(new c.a8(this.tileID.overscaledZ),W,this.tileID.canonical))continue}else if(!T.filter(new c.a8(this.tileID.overscaledZ),Q))continue;const X=u.getId(Q,g),ee=new c.a9(Q,E,C,k,X);ee.tile=F,t.push(ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const a=this.expirationTime;if(t.cacheControl){const u=c.aa(t.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const u=Date.now();let d=!1;if(this.expirationTime>u)d=!1;else if(a)if(this.expirationTime<a)d=!0;else{const g=this.expirationTime-a;g?this.expirationTime=u+Math.max(g,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!a.style.hasLayer(d))continue;const g=this.buckets[d],w=g.layers[0].sourceLayer||"_geojsonTileLayer",T=u[w],E=t[w];if(!T||!E||Object.keys(E).length===0)continue;g.update(E,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const C=a&&a.style&&a.style.getLayer(d);C&&(this.queryPadding=Math.max(this.queryPadding,C.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<B.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=B.now()+t}setDependencies(t,a){const u={};for(const d of a)u[d]=!0;this.dependencies[t]=u}hasDependency(t,a){for(const u of t){const d=this.dependencies[u];if(d){for(const g of a)if(d[g])return!0}}return!1}}class fi{constructor(t,a){this.max=t,this.onRemove=a,this.reset()}reset(){for(const t in this.data)for(const a of this.data[t])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(t,a,u){const d=t.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const g={value:a,timeout:void 0};if(u!==void 0&&(g.timeout=setTimeout(()=>{this.remove(t,g)},u)),this.data[d].push(g),this.order.push(d),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const a=this.data[t].shift();return a.timeout&&clearTimeout(a.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),a.value}getByKey(t){const a=this.data[t];return a?a[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,a){if(!this.has(t))return this;const u=t.wrapped().key,d=a===void 0?0:this.data[u].indexOf(a),g=this.data[u][d];return this.data[u].splice(d,1),g.timeout&&clearTimeout(g.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(g.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(t){const a=[];for(const u in this.data)for(const d of this.data[u])t(d.value)||a.push(d);for(const u of a)this.remove(u.value.tileID,u)}}class rn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,a,u){const d=String(a);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][d]=this.stateChanges[t][d]||{},c.e(this.stateChanges[t][d],u),this.deletedStates[t]===null){this.deletedStates[t]={};for(const g in this.state[t])g!==d&&(this.deletedStates[t][g]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][d]===null){this.deletedStates[t][d]={};for(const g in this.state[t][d])u[g]||(this.deletedStates[t][d][g]=null)}else for(const g in u)this.deletedStates[t]&&this.deletedStates[t][d]&&this.deletedStates[t][d][g]===null&&delete this.deletedStates[t][d][g]}removeFeatureState(t,a,u){if(this.deletedStates[t]===null)return;const d=String(a);if(this.deletedStates[t]=this.deletedStates[t]||{},u&&a!==void 0)this.deletedStates[t][d]!==null&&(this.deletedStates[t][d]=this.deletedStates[t][d]||{},this.deletedStates[t][d][u]=null);else if(a!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][d])for(u in this.deletedStates[t][d]={},this.stateChanges[t][d])this.deletedStates[t][d][u]=null;else this.deletedStates[t][d]=null;else this.deletedStates[t]=null}getState(t,a){const u=String(a),d=c.e({},(this.state[t]||{})[u],(this.stateChanges[t]||{})[u]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const g=this.deletedStates[t][a];if(g===null)return{};for(const w in g)delete d[w]}return d}initializeTileState(t,a){t.setFeatureState(this.state,a)}coalesceChanges(t,a){const u={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const g={};for(const w in this.stateChanges[d])this.state[d][w]||(this.state[d][w]={}),c.e(this.state[d][w],this.stateChanges[d][w]),g[w]=this.state[d][w];u[d]=g}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const g={};if(this.deletedStates[d]===null)for(const w in this.state[d])g[w]={},this.state[d][w]={};else for(const w in this.deletedStates[d]){if(this.deletedStates[d][w]===null)this.state[d][w]={};else for(const T of Object.keys(this.deletedStates[d][w]))delete this.state[d][w][T];g[w]=this.state[d][w]}u[d]=u[d]||{},c.e(u[d],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const d in t)t[d].setFeatureState(u,a)}}class rr extends c.E{constructor(t,a,u){super(),this.id=t,this.dispatcher=u,this.on("data",d=>{d.dataType==="source"&&d.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&d.dataType==="source"&&d.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((d,g,w,T)=>{const E=new(Pe(g.type))(d,g,w,T);if(E.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${E.id}`);return E})(t,a,u,this),this._tiles={},this._cache=new fi(0,d=>this._unloadTile(d)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new rn,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const a=this._tiles[t];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,a,u){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,a,u)}catch(d){t.state="errored",d.status!==404?this._source.fire(new c.j(d,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new c.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const u=this._tiles[a];u.upload(t),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(Ye).map(t=>t.key)}getRenderableIds(t){const a=[];for(const u in this._tiles)this._isIdRenderable(u,t)&&a.push(this._tiles[u]);return t?a.sort((u,d)=>{const g=u.tileID,w=d.tileID,T=new c.P(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),E=new c.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-w.overscaledZ||E.y-T.y||E.x-T.x}).map(u=>u.tileID.key):a.map(u=>u.tileID).sort(Ye).map(u=>u.key)}hasRenderableParent(t){const a=this.findLoadedParent(t,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(t,a){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(a||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,a){return c._(this,void 0,void 0,function*(){const u=this._tiles[t];u&&(u.state!=="loading"&&(u.state=a),yield this._loadTile(u,t,a))})}_tileLoaded(t,a,u){t.timeAdded=B.now(),u==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(a,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const a=this.getRenderableIds();for(let d=0;d<a.length;d++){const g=a[d];if(t.neighboringTiles&&t.neighboringTiles[g]){const w=this.getTileByID(g);u(t,w),u(w,t)}}function u(d,g){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let w=g.tileID.canonical.x-d.tileID.canonical.x;const T=g.tileID.canonical.y-d.tileID.canonical.y,E=Math.pow(2,d.tileID.canonical.z),C=g.tileID.key;w===0&&T===0||Math.abs(T)>1||(Math.abs(w)>1&&(Math.abs(w+E)===1?w+=E:Math.abs(w-E)===1&&(w-=E)),g.dem&&d.dem&&(d.dem.backfillBorder(g.dem,w,T),d.neighboringTiles&&d.neighboringTiles[C]&&(d.neighboringTiles[C].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,a,u,d){for(const g in this._tiles){let w=this._tiles[g];if(d[g]||!w.hasData()||w.tileID.overscaledZ<=a||w.tileID.overscaledZ>u)continue;let T=w.tileID;for(;w&&w.tileID.overscaledZ>a+1;){const C=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[C.key],w&&w.hasData()&&(T=C)}let E=T;for(;E.overscaledZ>a;)if(E=E.scaledTo(E.overscaledZ-1),t[E.key]){d[T.key]=T;break}}}findLoadedParent(t,a){if(t.key in this._loadedParentTiles){const u=this._loadedParentTiles[t.key];return u&&u.tileID.overscaledZ>=a?u:null}for(let u=t.overscaledZ-1;u>=a;u--){const d=t.scaledTo(u),g=this._getLoadedTile(d);if(g)return g}}_getLoadedTile(t){const a=this._tiles[t.key];return a&&a.hasData()?a:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const a=Math.ceil(t.width/this._source.tileSize)+1,u=Math.ceil(t.height/this._source.tileSize)+1,d=Math.floor(a*u*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(g)}handleWrapJump(t){const a=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,a){const u={};for(const d in this._tiles){const g=this._tiles[d];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),u[g.tileID.key]=g}this._tiles=u;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}update(t,a){if(this.transform=t,this.terrain=a,!this._sourceLoaded||this._paused)return;let u;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new c.Q(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(u=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(u=u.filter(k=>this._source.hasTile(k)))):u=[];const d=t.coveringZoomLevel(this._source),g=Math.max(d-rr.maxOverzooming,this._source.minzoom),w=Math.max(d+rr.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const k={};for(const F of u)if(F.canonical.z>this._source.minzoom){const j=F.scaledTo(F.canonical.z-1);k[j.key]=j;const Q=F.scaledTo(Math.max(this._source.minzoom,Math.min(F.canonical.z,5)));k[Q.key]=Q}u=u.concat(Object.values(k))}const T=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,T&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const E=this._updateRetainedTiles(u,d);if(Ot(this._source.type)){const k={},F={},j=Object.keys(E),Q=B.now();for(const X of j){const ee=E[X],W=this._tiles[X];if(!W||W.fadeEndTime!==0&&W.fadeEndTime<=Q)continue;const he=this.findLoadedParent(ee,g);he&&(this._addTile(he.tileID),k[he.tileID.key]=he.tileID),F[X]=ee}this._retainLoadedChildren(F,d,w,E);for(const X in k)E[X]||(this._coveredTiles[X]=!0,E[X]=k[X]);if(a){const X={},ee={};for(const W of u)this._tiles[W.key].hasData()?X[W.key]=W:ee[W.key]=W;for(const W in ee){const he=ee[W].children(this._source.maxzoom);this._tiles[he[0].key]&&this._tiles[he[1].key]&&this._tiles[he[2].key]&&this._tiles[he[3].key]&&(X[he[0].key]=E[he[0].key]=he[0],X[he[1].key]=E[he[1].key]=he[1],X[he[2].key]=E[he[2].key]=he[2],X[he[3].key]=E[he[3].key]=he[3],delete ee[W])}for(const W in ee){const he=this.findLoadedParent(ee[W],this._source.minzoom);if(he){X[he.tileID.key]=E[he.tileID.key]=he.tileID;for(const Te in X)X[Te].isChildOf(he.tileID)&&delete X[Te]}}for(const W in this._tiles)X[W]||(this._coveredTiles[W]=!0)}}for(const k in E)this._tiles[k].clearFadeHold();const C=c.ab(this._tiles,E);for(const k of C){const F=this._tiles[k];F.hasSymbolBuckets&&!F.holdingForFade()?F.setHoldDuration(this.map._fadeDuration):F.hasSymbolBuckets&&!F.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,a){const u={},d={},g=Math.max(a-rr.maxOverzooming,this._source.minzoom),w=Math.max(a+rr.maxUnderzooming,this._source.minzoom),T={};for(const E of t){const C=this._addTile(E);u[E.key]=E,C.hasData()||a<this._source.maxzoom&&(T[E.key]=E)}this._retainLoadedChildren(T,a,w,u);for(const E of t){let C=this._tiles[E.key];if(C.hasData())continue;if(a+1>this._source.maxzoom){const F=E.children(this._source.maxzoom)[0],j=this.getTile(F);if(j&&j.hasData()){u[F.key]=F;continue}}else{const F=E.children(this._source.maxzoom);if(u[F[0].key]&&u[F[1].key]&&u[F[2].key]&&u[F[3].key])continue}let k=C.wasRequested();for(let F=E.overscaledZ-1;F>=g;--F){const j=E.scaledTo(F);if(d[j.key])break;if(d[j.key]=!0,C=this.getTile(j),!C&&k&&(C=this._addTile(j)),C){const Q=C.hasData();if((k||Q)&&(u[j.key]=j),k=C.wasRequested(),Q)break}}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const a=[];let u,d=this._tiles[t].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){u=this._loadedParentTiles[d.key];break}a.push(d.key);const g=d.scaledTo(d.overscaledZ-1);if(u=this._getLoadedTile(g),u)break;d=g}for(const g of a)this._loadedParentTiles[g]=u}}_addTile(t){let a=this._tiles[t.key];if(a)return a;a=this._cache.getAndRemove(t),a&&(this._setTileReloadTimer(t.key,a),a.tileID=t,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,a)));const u=a;return a||(a=new oi(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(a,t.key,a.state)),a.uses++,this._tiles[t.key]=a,u||this._source.fire(new c.k("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(t,a){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const u=a.getExpiryTimeout();u&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},u))}_removeTile(t){const a=this._tiles[t];a&&(a.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,a,u){const d=[],g=this.transform;if(!g)return d;const w=u?g.getCameraQueryGeometry(t):t,T=t.map(X=>g.pointCoordinate(X,this.terrain)),E=w.map(X=>g.pointCoordinate(X,this.terrain)),C=this.getIds();let k=1/0,F=1/0,j=-1/0,Q=-1/0;for(const X of E)k=Math.min(k,X.x),F=Math.min(F,X.y),j=Math.max(j,X.x),Q=Math.max(Q,X.y);for(let X=0;X<C.length;X++){const ee=this._tiles[C[X]];if(ee.holdingForFade())continue;const W=ee.tileID,he=Math.pow(2,g.zoom-ee.tileID.overscaledZ),Te=a*ee.queryPadding*c.W/ee.tileSize/he,ne=[W.getTilePoint(new c.Y(k,F)),W.getTilePoint(new c.Y(j,Q))];if(ne[0].x-Te<c.W&&ne[0].y-Te<c.W&&ne[1].x+Te>=0&&ne[1].y+Te>=0){const ge=T.map(Ee=>W.getTilePoint(Ee)),Ie=E.map(Ee=>W.getTilePoint(Ee));d.push({tile:ee,tileID:W,queryGeometry:ge,cameraQueryGeometry:Ie,scale:he})}}return d}getVisibleCoordinates(t){const a=this.getRenderableIds(t).map(u=>this._tiles[u].tileID);for(const u of a)u.posMatrix=this.transform.calculatePosMatrix(u.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(Ot(this._source.type)){const t=B.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=t)return!0}return!1}setFeatureState(t,a,u){this._state.updateState(t=t||"_geojsonTileLayer",a,u)}removeFeatureState(t,a,u){this._state.removeFeatureState(t=t||"_geojsonTileLayer",a,u)}getFeatureState(t,a){return this._state.getState(t=t||"_geojsonTileLayer",a)}setDependencies(t,a,u){const d=this._tiles[t];d&&d.setDependencies(a,u)}reloadTilesForDependencies(t,a){for(const u in this._tiles)this._tiles[u].hasDependency(t,a)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(t,a))}}function Ye(p,t){const a=Math.abs(2*p.wrap)-+(p.wrap<0),u=Math.abs(2*t.wrap)-+(t.wrap<0);return p.overscaledZ-t.overscaledZ||u-a||t.canonical.y-p.canonical.y||t.canonical.x-p.canonical.x}function Ot(p){return p==="raster"||p==="image"||p==="video"}rr.maxOverzooming=10,rr.maxUnderzooming=3;class Et{constructor(t,a){this.reset(t,a)}reset(t,a){this.points=t||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=c.ac(t,0,1);let a=1,u=this._distances[a];const d=t*this.paddedLength+this.padding;for(;u<d&&a<this._distances.length;)u=this._distances[++a];const g=a-1,w=this._distances[g],T=u-w,E=T>0?(d-w)/T:0;return this.points[g].mult(1-E).add(this.points[a].mult(E))}}function gi(p,t){let a=!0;return p==="always"||p!=="never"&&t!=="never"||(a=!1),a}class mn{constructor(t,a,u){const d=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(t/u),this.yCellCount=Math.ceil(a/u);for(let w=0;w<this.xCellCount*this.yCellCount;w++)d.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=a,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,a,u,d,g){this._forEachCell(a,u,d,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(d),this.bboxes.push(g)}insertCircle(t,a,u,d){this._forEachCell(a-d,u-d,a+d,u+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(a),this.circles.push(u),this.circles.push(d)}_insertBoxCell(t,a,u,d,g,w){this.boxCells[g].push(w)}_insertCircleCell(t,a,u,d,g,w){this.circleCells[g].push(w)}_query(t,a,u,d,g,w,T){if(u<0||t>this.width||d<0||a>this.height)return[];const E=[];if(t<=0&&a<=0&&this.width<=u&&this.height<=d){if(g)return[{key:null,x1:t,y1:a,x2:u,y2:d}];for(let C=0;C<this.boxKeys.length;C++)E.push({key:this.boxKeys[C],x1:this.bboxes[4*C],y1:this.bboxes[4*C+1],x2:this.bboxes[4*C+2],y2:this.bboxes[4*C+3]});for(let C=0;C<this.circleKeys.length;C++){const k=this.circles[3*C],F=this.circles[3*C+1],j=this.circles[3*C+2];E.push({key:this.circleKeys[C],x1:k-j,y1:F-j,x2:k+j,y2:F+j})}}else this._forEachCell(t,a,u,d,this._queryCell,E,{hitTest:g,overlapMode:w,seenUids:{box:{},circle:{}}},T);return E}query(t,a,u,d){return this._query(t,a,u,d,!1,null)}hitTest(t,a,u,d,g,w){return this._query(t,a,u,d,!0,g,w).length>0}hitTestCircle(t,a,u,d,g){const w=t-u,T=t+u,E=a-u,C=a+u;if(T<0||w>this.width||C<0||E>this.height)return!1;const k=[];return this._forEachCell(w,E,T,C,this._queryCellCircle,k,{hitTest:!0,overlapMode:d,circle:{x:t,y:a,radius:u},seenUids:{box:{},circle:{}}},g),k.length>0}_queryCell(t,a,u,d,g,w,T,E){const{seenUids:C,hitTest:k,overlapMode:F}=T,j=this.boxCells[g];if(j!==null){const X=this.bboxes;for(const ee of j)if(!C.box[ee]){C.box[ee]=!0;const W=4*ee,he=this.boxKeys[ee];if(t<=X[W+2]&&a<=X[W+3]&&u>=X[W+0]&&d>=X[W+1]&&(!E||E(he))&&(!k||!gi(F,he.overlapMode))&&(w.push({key:he,x1:X[W],y1:X[W+1],x2:X[W+2],y2:X[W+3]}),k))return!0}}const Q=this.circleCells[g];if(Q!==null){const X=this.circles;for(const ee of Q)if(!C.circle[ee]){C.circle[ee]=!0;const W=3*ee,he=this.circleKeys[ee];if(this._circleAndRectCollide(X[W],X[W+1],X[W+2],t,a,u,d)&&(!E||E(he))&&(!k||!gi(F,he.overlapMode))){const Te=X[W],ne=X[W+1],ge=X[W+2];if(w.push({key:he,x1:Te-ge,y1:ne-ge,x2:Te+ge,y2:ne+ge}),k)return!0}}}return!1}_queryCellCircle(t,a,u,d,g,w,T,E){const{circle:C,seenUids:k,overlapMode:F}=T,j=this.boxCells[g];if(j!==null){const X=this.bboxes;for(const ee of j)if(!k.box[ee]){k.box[ee]=!0;const W=4*ee,he=this.boxKeys[ee];if(this._circleAndRectCollide(C.x,C.y,C.radius,X[W+0],X[W+1],X[W+2],X[W+3])&&(!E||E(he))&&!gi(F,he.overlapMode))return w.push(!0),!0}}const Q=this.circleCells[g];if(Q!==null){const X=this.circles;for(const ee of Q)if(!k.circle[ee]){k.circle[ee]=!0;const W=3*ee,he=this.circleKeys[ee];if(this._circlesCollide(X[W],X[W+1],X[W+2],C.x,C.y,C.radius)&&(!E||E(he))&&!gi(F,he.overlapMode))return w.push(!0),!0}}}_forEachCell(t,a,u,d,g,w,T,E){const C=this._convertToXCellCoord(t),k=this._convertToYCellCoord(a),F=this._convertToXCellCoord(u),j=this._convertToYCellCoord(d);for(let Q=C;Q<=F;Q++)for(let X=k;X<=j;X++)if(g.call(this,t,a,u,d,this.xCellCount*X+Q,w,T,E))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,a,u,d,g,w){const T=d-t,E=g-a,C=u+w;return C*C>T*T+E*E}_circleAndRectCollide(t,a,u,d,g,w,T){const E=(w-d)/2,C=Math.abs(t-(d+E));if(C>E+u)return!1;const k=(T-g)/2,F=Math.abs(a-(g+k));if(F>k+u)return!1;if(C<=E||F<=k)return!0;const j=C-E,Q=F-k;return j*j+Q*Q<=u*u}}function Ft(p,t,a,u,d){const g=c.F();return t?(c.J(g,g,[1/d,1/d,1]),a||c.ad(g,g,u.angle)):c.K(g,u.labelPlaneMatrix,p),g}function ks(p,t,a,u,d){if(t){const g=c.ae(p);return c.J(g,g,[d,d,1]),a||c.ad(g,g,-u.angle),g}return u.glCoordMatrix}function or(p,t,a){let u;a?(u=[p.x,p.y,a(p.x,p.y),1],c.af(u,u,t)):(u=[p.x,p.y,0,1],St(u,u,t));const d=u[3];return{point:new c.P(u[0]/d,u[1]/d),signedDistanceFromCamera:d}}function ie(p,t){return .5+p/t*.5}function N(p,t){const a=p[0]/p[3],u=p[1]/p[3];return a>=-t[0]&&a<=t[0]&&u>=-t[1]&&u<=t[1]}function U(p,t,a,u,d,g,w,T,E,C){const k=u?p.textSizeData:p.iconSizeData,F=c.ag(k,a.transform.zoom),j=[256/a.width*2+1,256/a.height*2+1],Q=u?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;Q.clear();const X=p.lineVertexArray,ee=u?p.text.placedSymbolArray:p.icon.placedSymbolArray,W=a.transform.width/a.transform.height;let he=!1;for(let Te=0;Te<ee.length;Te++){const ne=ee.get(Te);if(ne.hidden||ne.writingMode===c.ah.vertical&&!he){ze(ne.numGlyphs,Q);continue}let ge;if(he=!1,C?(ge=[ne.anchorX,ne.anchorY,C(ne.anchorX,ne.anchorY),1],c.af(ge,ge,t)):(ge=[ne.anchorX,ne.anchorY,0,1],St(ge,ge,t)),!N(ge,j)){ze(ne.numGlyphs,Q);continue}const Ie=ie(a.transform.cameraToCenterDistance,ge[3]),Ee=c.ai(k,F,ne),Fe=w?Ee/Ie:Ee*Ie,je=new c.P(ne.anchorX,ne.anchorY),Ue=or(je,d,C).point,Ze={projections:{},offsets:{}},dt=de(ne,Fe,!1,T,t,d,g,p.glyphOffsetArray,X,Q,Ue,je,Ze,W,E,C);he=dt.useVertical,(dt.notEnoughRoom||he||dt.needsFlipping&&de(ne,Fe,!0,T,t,d,g,p.glyphOffsetArray,X,Q,Ue,je,Ze,W,E,C).notEnoughRoom)&&ze(ne.numGlyphs,Q)}u?p.text.dynamicLayoutVertexBuffer.updateData(Q):p.icon.dynamicLayoutVertexBuffer.updateData(Q)}function G(p,t,a,u,d,g,w,T,E,C,k,F,j){const Q=T.glyphStartIndex+T.numGlyphs,X=T.lineStartIndex,ee=T.lineStartIndex+T.lineLength,W=t.getoffsetX(T.glyphStartIndex),he=t.getoffsetX(Q-1),Te=Ve(p*W,a,u,d,g,w,T.segment,X,ee,E,C,k,F,j);if(!Te)return null;const ne=Ve(p*he,a,u,d,g,w,T.segment,X,ee,E,C,k,F,j);return ne?{first:Te,last:ne}:null}function J(p,t,a,u){return p===c.ah.horizontal&&Math.abs(a.y-t.y)>Math.abs(a.x-t.x)*u?{useVertical:!0}:(p===c.ah.vertical?t.y<a.y:t.x>a.x)?{needsFlipping:!0}:null}function de(p,t,a,u,d,g,w,T,E,C,k,F,j,Q,X,ee){const W=t/24,he=p.lineOffsetX*W,Te=p.lineOffsetY*W;let ne;if(p.numGlyphs>1){const ge=p.glyphStartIndex+p.numGlyphs,Ie=p.lineStartIndex,Ee=p.lineStartIndex+p.lineLength,Fe=G(W,T,he,Te,a,k,F,p,E,g,j,X,ee);if(!Fe)return{notEnoughRoom:!0};const je=or(Fe.first.point,w,ee).point,Ue=or(Fe.last.point,w,ee).point;if(u&&!a){const Ze=J(p.writingMode,je,Ue,Q);if(Ze)return Ze}ne=[Fe.first];for(let Ze=p.glyphStartIndex+1;Ze<ge-1;Ze++)ne.push(Ve(W*T.getoffsetX(Ze),he,Te,a,k,F,p.segment,Ie,Ee,E,g,j,X,ee));ne.push(Fe.last)}else{if(u&&!a){const Ie=or(F,d,ee).point,Ee=p.lineStartIndex+p.segment+1,Fe=new c.P(E.getx(Ee),E.gety(Ee)),je=or(Fe,d,ee),Ue=je.signedDistanceFromCamera>0?je.point:fe(F,Fe,Ie,1,d,ee),Ze=J(p.writingMode,Ie,Ue,Q);if(Ze)return Ze}const ge=Ve(W*T.getoffsetX(p.glyphStartIndex),he,Te,a,k,F,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,E,g,j,X,ee);if(!ge)return{notEnoughRoom:!0};ne=[ge]}for(const ge of ne)c.aj(C,ge.point,ge.angle);return{}}function fe(p,t,a,u,d,g){const w=or(p.add(p.sub(t)._unit()),d,g).point,T=a.sub(w);return a.add(T._mult(u/T.mag()))}function _e(p,t){const{projectionCache:a,lineVertexArray:u,labelPlaneMatrix:d,tileAnchorPoint:g,distanceFromAnchor:w,getElevation:T,previousVertex:E,direction:C,absOffsetX:k}=t;if(a.projections[p])return a.projections[p];const F=new c.P(u.getx(p),u.gety(p)),j=or(F,d,T);if(j.signedDistanceFromCamera>0)return a.projections[p]=j.point,j.point;const Q=p-C;return fe(w===0?g:new c.P(u.getx(Q),u.gety(Q)),F,E,k-w+1,d,T)}function ce(p,t,a){return p._unit()._perp()._mult(t*a)}function we(p,t,a,u,d,g,w,T){const{projectionCache:E,direction:C}=T;if(E.offsets[p])return E.offsets[p];const k=a.add(t);if(p+C<u||p+C>=d)return E.offsets[p]=k,k;const F=_e(p+C,T),j=ce(F.sub(a),w,C),Q=a.add(j),X=F.add(j);return E.offsets[p]=c.ak(g,k,Q,X)||k,E.offsets[p]}function Ve(p,t,a,u,d,g,w,T,E,C,k,F,j,Q){const X=u?p-t:p+t;let ee=X>0?1:-1,W=0;u&&(ee*=-1,W=Math.PI),ee<0&&(W+=Math.PI);let he,Te,ne=ee>0?T+w:T+w+1,ge=d,Ie=d,Ee=0,Fe=0;const je=Math.abs(X),Ue=[];let Ze;for(;Ee+Fe<=je;){if(ne+=ee,ne<T||ne>=E)return null;Ee+=Fe,Ie=ge,Te=he;const tt={projectionCache:F,lineVertexArray:C,labelPlaneMatrix:k,tileAnchorPoint:g,distanceFromAnchor:Ee,getElevation:Q,previousVertex:Ie,direction:ee,absOffsetX:je};if(ge=_e(ne,tt),a===0)Ue.push(Ie),Ze=ge.sub(Ie);else{let At;const mt=ge.sub(Ie);At=mt.mag()===0?ce(_e(ne+ee,tt).sub(ge),a,ee):ce(mt,a,ee),Te||(Te=Ie.add(At)),he=we(ne,At,ge,T,E,Te,a,tt),Ue.push(Te),Ze=he.sub(Te)}Fe=Ze.mag()}const dt=Ze._mult((je-Ee)/Fe)._add(Te||Ie),Pt=W+Math.atan2(ge.y-Ie.y,ge.x-Ie.x);return Ue.push(dt),{point:dt,angle:j?Pt:0,path:Ue}}const De=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ze(p,t){for(let a=0;a<p;a++){const u=t.length;t.resize(u+4),t.float32.set(De,3*u)}}function St(p,t,a){const u=t[0],d=t[1];return p[0]=a[0]*u+a[4]*d+a[12],p[1]=a[1]*u+a[5]*d+a[13],p[3]=a[3]*u+a[7]*d+a[15],p}const It=100;class Bt{constructor(t,a=new mn(t.width+200,t.height+200,25),u=new mn(t.width+200,t.height+200,25)){this.transform=t,this.grid=a,this.ignoredGrid=u,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+It,this.screenBottomBoundary=t.height+It,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,a,u,d,g,w){const T=this.projectAndGetPerspectiveRatio(d,t.anchorPointX,t.anchorPointY,w),E=u*T.perspectiveRatio,C=t.x1*E+T.point.x,k=t.y1*E+T.point.y,F=t.x2*E+T.point.x,j=t.y2*E+T.point.y;return!this.isInsideGrid(C,k,F,j)||a!=="always"&&this.grid.hitTest(C,k,F,j,a,g)||T.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[C,k,F,j],offscreen:this.isOffscreen(C,k,F,j)}}placeCollisionCircles(t,a,u,d,g,w,T,E,C,k,F,j,Q,X){const ee=[],W=new c.P(a.anchorX,a.anchorY),he=or(W,w,X),Te=ie(this.transform.cameraToCenterDistance,he.signedDistanceFromCamera),ne=(k?g/Te:g*Te)/c.ao,ge=or(W,T,X).point,Ie=G(ne,d,a.lineOffsetX*ne,a.lineOffsetY*ne,!1,ge,W,a,u,T,{projections:{},offsets:{}},!1,X);let Ee=!1,Fe=!1,je=!0;if(Ie){const Ue=.5*j*Te+Q,Ze=new c.P(-100,-100),dt=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Pt=new Et,tt=Ie.first,At=Ie.last;let mt=[];for(let $t=tt.path.length-1;$t>=1;$t--)mt.push(tt.path[$t]);for(let $t=1;$t<At.path.length;$t++)mt.push(At.path[$t]);const Li=2.5*Ue;if(E){const $t=mt.map(Qt=>or(Qt,E,X));mt=$t.some(Qt=>Qt.signedDistanceFromCamera<=0)?[]:$t.map(Qt=>Qt.point)}let Jt=[];if(mt.length>0){const $t=mt[0].clone(),Qt=mt[0].clone();for(let Qi=1;Qi<mt.length;Qi++)$t.x=Math.min($t.x,mt[Qi].x),$t.y=Math.min($t.y,mt[Qi].y),Qt.x=Math.max(Qt.x,mt[Qi].x),Qt.y=Math.max(Qt.y,mt[Qi].y);Jt=$t.x>=Ze.x&&Qt.x<=dt.x&&$t.y>=Ze.y&&Qt.y<=dt.y?[mt]:Qt.x<Ze.x||$t.x>dt.x||Qt.y<Ze.y||$t.y>dt.y?[]:c.al([mt],Ze.x,Ze.y,dt.x,dt.y)}for(const $t of Jt){Pt.reset($t,.25*Ue);let Qt=0;Qt=Pt.length<=.5*Ue?1:Math.ceil(Pt.paddedLength/Li)+1;for(let Qi=0;Qi<Qt;Qi++){const wi=Qi/Math.max(Qt-1,1),Hr=Pt.lerp(wi),xr=Hr.x+It,Gi=Hr.y+It;ee.push(xr,Gi,Ue,0);const Lr=xr-Ue,Rr=Gi-Ue,Pn=xr+Ue,ys=Gi+Ue;if(je=je&&this.isOffscreen(Lr,Rr,Pn,ys),Fe=Fe||this.isInsideGrid(Lr,Rr,Pn,ys),t!=="always"&&this.grid.hitTestCircle(xr,Gi,Ue,t,F)&&(Ee=!0,!C))return{circles:[],offscreen:!1,collisionDetected:Ee}}}}return{circles:!C&&Ee||!Fe||Te<this.perspectiveRatioCutoff?[]:ee,offscreen:je,collisionDetected:Ee}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let u=1/0,d=1/0,g=-1/0,w=-1/0;for(const k of t){const F=new c.P(k.x+It,k.y+It);u=Math.min(u,F.x),d=Math.min(d,F.y),g=Math.max(g,F.x),w=Math.max(w,F.y),a.push(F)}const T=this.grid.query(u,d,g,w).concat(this.ignoredGrid.query(u,d,g,w)),E={},C={};for(const k of T){const F=k.key;if(E[F.bucketInstanceId]===void 0&&(E[F.bucketInstanceId]={}),E[F.bucketInstanceId][F.featureIndex])continue;const j=[new c.P(k.x1,k.y1),new c.P(k.x2,k.y1),new c.P(k.x2,k.y2),new c.P(k.x1,k.y2)];c.am(a,j)&&(E[F.bucketInstanceId][F.featureIndex]=!0,C[F.bucketInstanceId]===void 0&&(C[F.bucketInstanceId]=[]),C[F.bucketInstanceId].push(F.featureIndex))}return C}insertCollisionBox(t,a,u,d,g,w){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:g,collisionGroupID:w,overlapMode:a},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,a,u,d,g,w){const T=u?this.ignoredGrid:this.grid,E={bucketInstanceId:d,featureIndex:g,collisionGroupID:w,overlapMode:a};for(let C=0;C<t.length;C+=4)T.insertCircle(E,t[C],t[C+1],t[C+2])}projectAndGetPerspectiveRatio(t,a,u,d){let g;return d?(g=[a,u,d(a,u),1],c.af(g,g,t)):(g=[a,u,0,1],St(g,g,t)),{point:new c.P((g[0]/g[3]+1)/2*this.transform.width+It,(-g[1]/g[3]+1)/2*this.transform.height+It),perspectiveRatio:.5+this.transform.cameraToCenterDistance/g[3]*.5}}isOffscreen(t,a,u,d){return u<It||t>=this.screenRightBoundary||d<It||a>this.screenBottomBoundary}isInsideGrid(t,a,u,d){return u>=0&&t<this.gridRightBoundary&&d>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const t=c.an([]);return c.H(t,t,[-100,-100,0]),t}}function zt(p,t,a){return t*(c.W/(p.tileSize*Math.pow(2,a-p.tileID.overscaledZ)))}class ii{constructor(t,a,u,d){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?a:-a))):d&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class bi{constructor(t,a,u,d,g){this.text=new ii(t?t.text:null,a,u,g),this.icon=new ii(t?t.icon:null,a,d,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class zi{constructor(t,a,u){this.text=t,this.icon=a,this.skipFade=u}}class nr{constructor(){this.invProjMatrix=c.F(),this.viewportMatrix=c.F(),this.circles=[]}}class Ut{constructor(t,a,u,d,g){this.bucketInstanceId=t,this.featureIndex=a,this.sourceLayerIndex=u,this.bucketIndex=d,this.tileID=g}}class $i{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const a=++this.maxGroupID;this.collisionGroups[t]={ID:a,predicate:u=>u.collisionGroupID===a}}return this.collisionGroups[t]}}function lr(p,t,a,u,d){const{horizontalAlign:g,verticalAlign:w}=c.at(p);return new c.P(-(g-.5)*t+u[0]*d,-(w-.5)*a+u[1]*d)}function Vr(p,t,a,u,d,g){const{x1:w,x2:T,y1:E,y2:C,anchorPointX:k,anchorPointY:F}=p,j=new c.P(t,a);return u&&j._rotate(d?g:-g),{x1:w+j.x,y1:E+j.y,x2:T+j.x,y2:C+j.y,anchorPointX:k,anchorPointY:F}}class nn{constructor(t,a,u,d,g){this.transform=t.clone(),this.terrain=a,this.collisionIndex=new Bt(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new $i(d),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,a,u,d){const g=u.getBucket(a),w=u.latestFeatureIndex;if(!g||!w||a.id!==g.layerIds[0])return;const T=u.collisionBoxArray,E=g.layers[0].layout,C=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),k=u.tileSize/c.W,F=this.transform.calculatePosMatrix(u.tileID.toUnwrapped()),j=E.get("text-pitch-alignment")==="map",Q=E.get("text-rotation-alignment")==="map",X=zt(u,1,this.transform.zoom),ee=Ft(F,j,Q,this.transform,X);let W=null;if(j){const Te=ks(F,j,Q,this.transform,X);W=c.K([],this.transform.labelPlaneMatrix,Te)}this.retainedQueryData[g.bucketInstanceId]=new Ut(g.bucketInstanceId,w,g.sourceLayerIndex,g.index,u.tileID);const he={bucket:g,layout:E,posMatrix:F,textLabelPlaneMatrix:ee,labelToScreenMatrix:W,scale:C,textPixelRatio:k,holdingForFade:u.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:c.ag(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(d)for(const Te of g.sortKeyRanges){const{sortKey:ne,symbolInstanceStart:ge,symbolInstanceEnd:Ie}=Te;t.push({sortKey:ne,symbolInstanceStart:ge,symbolInstanceEnd:Ie,parameters:he})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:he})}attemptAnchorPlacement(t,a,u,d,g,w,T,E,C,k,F,j,Q,X,ee,W){const he=c.ap[t.textAnchor],Te=[t.textOffset0,t.textOffset1],ne=lr(he,u,d,Te,g),ge=this.collisionIndex.placeCollisionBox(Vr(a,ne.x,ne.y,w,T,this.transform.angle),F,E,C,k.predicate,W);if((!ee||this.collisionIndex.placeCollisionBox(Vr(ee,ne.x,ne.y,w,T,this.transform.angle),F,E,C,k.predicate,W).box.length!==0)&&ge.box.length>0){let Ie;if(this.prevPlacement&&this.prevPlacement.variableOffsets[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID].text&&(Ie=this.prevPlacement.variableOffsets[j.crossTileID].anchor),j.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[j.crossTileID]={textOffset:Te,width:u,height:d,anchor:he,textBoxScale:g,prevAnchor:Ie},this.markUsedJustification(Q,he,j,X),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,X,j),this.placedOrientations[j.crossTileID]=X),{shift:ne,placedGlyphBoxes:ge}}}placeLayerBucketPart(t,a,u){const{bucket:d,layout:g,posMatrix:w,textLabelPlaneMatrix:T,labelToScreenMatrix:E,textPixelRatio:C,holdingForFade:k,collisionBoxArray:F,partiallyEvaluatedTextSize:j,collisionGroup:Q}=t.parameters,X=g.get("text-optional"),ee=g.get("icon-optional"),W=c.aq(g,"text-overlap","text-allow-overlap"),he=W==="always",Te=c.aq(g,"icon-overlap","icon-allow-overlap"),ne=Te==="always",ge=g.get("text-rotation-alignment")==="map",Ie=g.get("text-pitch-alignment")==="map",Ee=g.get("icon-text-fit")!=="none",Fe=g.get("symbol-z-order")==="viewport-y",je=he&&(ne||!d.hasIconData()||ee),Ue=ne&&(he||!d.hasTextData()||X);!d.collisionArrays&&F&&d.deserializeCollisionBoxes(F);const Ze=this.retainedQueryData[d.bucketInstanceId].tileID,dt=this.terrain?(tt,At)=>this.terrain.getElevation(Ze,tt,At):null,Pt=(tt,At)=>{var mt,Li;if(a[tt.crossTileID])return;if(k)return void(this.placements[tt.crossTileID]=new zi(!1,!1,!1));let Jt=!1,$t=!1,Qt=!0,Qi=null,wi={box:null,offscreen:null},Hr={box:null,offscreen:null},xr=null,Gi=null,Lr=null,Rr=0,Pn=0,ys=0;At.textFeatureIndex?Rr=At.textFeatureIndex:tt.useRuntimeCollisionCircles&&(Rr=tt.featureIndex),At.verticalTextFeatureIndex&&(Pn=At.verticalTextFeatureIndex);const _a=At.textBox;if(_a){const cr=Ri=>{let ur=c.ah.horizontal;if(d.allowVerticalPlacement&&!Ri&&this.prevPlacement){const br=this.prevPlacement.placedOrientations[tt.crossTileID];br&&(this.placedOrientations[tt.crossTileID]=br,ur=br,this.markUsedOrientation(d,ur,tt))}return ur},er=(Ri,ur)=>{if(d.allowVerticalPlacement&&tt.numVerticalGlyphVertices>0&&At.verticalTextBox){for(const br of d.writingModes)if(br===c.ah.vertical?(wi=ur(),Hr=wi):wi=Ri(),wi&&wi.box&&wi.box.length)break}else wi=Ri()},qi=tt.textAnchorOffsetStartIndex,Gr=tt.textAnchorOffsetEndIndex;if(Gr===qi){const Ri=(ur,br)=>{const hr=this.collisionIndex.placeCollisionBox(ur,W,C,w,Q.predicate,dt);return hr&&hr.box&&hr.box.length&&(this.markUsedOrientation(d,br,tt),this.placedOrientations[tt.crossTileID]=br),hr};er(()=>Ri(_a,c.ah.horizontal),()=>{const ur=At.verticalTextBox;return d.allowVerticalPlacement&&tt.numVerticalGlyphVertices>0&&ur?Ri(ur,c.ah.vertical):{box:null,offscreen:null}}),cr(wi&&wi.box&&wi.box.length)}else{let Ri=c.ap[(Li=(mt=this.prevPlacement)===null||mt===void 0?void 0:mt.variableOffsets[tt.crossTileID])===null||Li===void 0?void 0:Li.anchor];const ur=(hr,Ih,Ki)=>{const Vc=hr.x2-hr.x1,Ah=hr.y2-hr.y1,js=tt.textBoxScale,Hs=Ee&&Te==="never"?Ih:null;let rs={box:[],offscreen:!1},wl=W==="never"?1:2,Uc="never";Ri&&wl++;for(let Ch=0;Ch<wl;Ch++){for(let Sl=qi;Sl<Gr;Sl++){const Ph=d.textAnchorOffsets.get(Sl);if(Ri&&Ph.textAnchor!==Ri)continue;const vo=this.attemptAnchorPlacement(Ph,hr,Vc,Ah,js,ge,Ie,C,w,Q,Uc,tt,d,Ki,Hs,dt);if(vo&&(rs=vo.placedGlyphBoxes,rs&&rs.box&&rs.box.length))return Jt=!0,Qi=vo.shift,rs}Ri?Ri=null:Uc=W}return rs};er(()=>ur(_a,At.iconBox,c.ah.horizontal),()=>{const hr=At.verticalTextBox;return d.allowVerticalPlacement&&!(wi&&wi.box&&wi.box.length)&&tt.numVerticalGlyphVertices>0&&hr?ur(hr,At.verticalIconBox,c.ah.vertical):{box:null,offscreen:null}}),wi&&(Jt=wi.box,Qt=wi.offscreen);const br=cr(wi&&wi.box);if(!Jt&&this.prevPlacement){const hr=this.prevPlacement.variableOffsets[tt.crossTileID];hr&&(this.variableOffsets[tt.crossTileID]=hr,this.markUsedJustification(d,hr.anchor,tt,br))}}}if(xr=wi,Jt=xr&&xr.box&&xr.box.length>0,Qt=xr&&xr.offscreen,tt.useRuntimeCollisionCircles){const cr=d.text.placedSymbolArray.get(tt.centerJustifiedTextSymbolIndex),er=c.ai(d.textSizeData,j,cr),qi=g.get("text-padding");Gi=this.collisionIndex.placeCollisionCircles(W,cr,d.lineVertexArray,d.glyphOffsetArray,er,w,T,E,u,Ie,Q.predicate,tt.collisionCircleDiameter,qi,dt),Gi.circles.length&&Gi.collisionDetected&&!u&&c.w("Collisions detected, but collision boxes are not shown"),Jt=he||Gi.circles.length>0&&!Gi.collisionDetected,Qt=Qt&&Gi.offscreen}if(At.iconFeatureIndex&&(ys=At.iconFeatureIndex),At.iconBox){const cr=er=>{const qi=Ee&&Qi?Vr(er,Qi.x,Qi.y,ge,Ie,this.transform.angle):er;return this.collisionIndex.placeCollisionBox(qi,Te,C,w,Q.predicate,dt)};Hr&&Hr.box&&Hr.box.length&&At.verticalIconBox?(Lr=cr(At.verticalIconBox),$t=Lr.box.length>0):(Lr=cr(At.iconBox),$t=Lr.box.length>0),Qt=Qt&&Lr.offscreen}const ya=X||tt.numHorizontalGlyphVertices===0&&tt.numVerticalGlyphVertices===0,vs=ee||tt.numIconVertices===0;if(ya||vs?vs?ya||($t=$t&&Jt):Jt=$t&&Jt:$t=Jt=$t&&Jt,Jt&&xr&&xr.box&&this.collisionIndex.insertCollisionBox(xr.box,W,g.get("text-ignore-placement"),d.bucketInstanceId,Hr&&Hr.box&&Pn?Pn:Rr,Q.ID),$t&&Lr&&this.collisionIndex.insertCollisionBox(Lr.box,Te,g.get("icon-ignore-placement"),d.bucketInstanceId,ys,Q.ID),Gi&&(Jt&&this.collisionIndex.insertCollisionCircles(Gi.circles,W,g.get("text-ignore-placement"),d.bucketInstanceId,Rr,Q.ID),u)){const cr=d.bucketInstanceId;let er=this.collisionCircleArrays[cr];er===void 0&&(er=this.collisionCircleArrays[cr]=new nr);for(let qi=0;qi<Gi.circles.length;qi+=4)er.circles.push(Gi.circles[qi+0]),er.circles.push(Gi.circles[qi+1]),er.circles.push(Gi.circles[qi+2]),er.circles.push(Gi.collisionDetected?1:0)}if(tt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[tt.crossTileID]=new zi(Jt||je,$t||Ue,Qt||d.justReloaded),a[tt.crossTileID]=!0};if(Fe){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const tt=d.getSortedSymbolIndexes(this.transform.angle);for(let At=tt.length-1;At>=0;--At){const mt=tt[At];Pt(d.symbolInstances.get(mt),d.collisionArrays[mt])}}else for(let tt=t.symbolInstanceStart;tt<t.symbolInstanceEnd;tt++)Pt(d.symbolInstances.get(tt),d.collisionArrays[tt]);if(u&&d.bucketInstanceId in this.collisionCircleArrays){const tt=this.collisionCircleArrays[d.bucketInstanceId];c.ar(tt.invProjMatrix,w),tt.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}markUsedJustification(t,a,u,d){let g;g=d===c.ah.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[c.as(a)];const w=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const T of w)T>=0&&(t.text.placedSymbolArray.get(T).crossTileID=g>=0&&T!==g?0:u.crossTileID)}markUsedOrientation(t,a,u){const d=a===c.ah.horizontal||a===c.ah.horizontalOnly?a:0,g=a===c.ah.vertical?a:0,w=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const T of w)t.text.placedSymbolArray.get(T).placedOrientation=d;u.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let u=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const d=a?a.symbolFadeChange(t):1,g=a?a.opacities:{},w=a?a.variableOffsets:{},T=a?a.placedOrientations:{};for(const E in this.placements){const C=this.placements[E],k=g[E];k?(this.opacities[E]=new bi(k,d,C.text,C.icon),u=u||C.text!==k.text.placed||C.icon!==k.icon.placed):(this.opacities[E]=new bi(null,d,C.text,C.icon,C.skipFade),u=u||C.text||C.icon)}for(const E in g){const C=g[E];if(!this.opacities[E]){const k=new bi(C,d,!1,!1);k.isHidden()||(this.opacities[E]=k,u=u||C.text.placed||C.icon.placed)}}for(const E in w)this.variableOffsets[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.variableOffsets[E]=w[E]);for(const E in T)this.placedOrientations[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.placedOrientations[E]=T[E]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:t)}updateLayerOpacities(t,a){const u={};for(const d of a){const g=d.getBucket(t);g&&d.latestFeatureIndex&&t.id===g.layerIds[0]&&this.updateBucketOpacities(g,u,d.collisionBoxArray)}}updateBucketOpacities(t,a,u){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const d=t.layers[0],g=d.layout,w=new bi(null,0,!1,!1,!0),T=g.get("text-allow-overlap"),E=g.get("icon-allow-overlap"),C=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),k=g.get("text-rotation-alignment")==="map",F=g.get("text-pitch-alignment")==="map",j=g.get("icon-text-fit")!=="none",Q=new bi(null,0,T&&(E||!t.hasIconData()||g.get("icon-optional")),E&&(T||!t.hasTextData()||g.get("text-optional")),!0);!t.collisionArrays&&u&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(u);const X=(ee,W,he)=>{for(let Te=0;Te<W/4;Te++)ee.opacityVertexArray.emplaceBack(he);ee.hasVisibleVertices=ee.hasVisibleVertices||he!==Ya};for(let ee=0;ee<t.symbolInstances.length;ee++){const W=t.symbolInstances.get(ee),{numHorizontalGlyphVertices:he,numVerticalGlyphVertices:Te,crossTileID:ne}=W;let ge=this.opacities[ne];a[ne]?ge=w:ge||(ge=Q,this.opacities[ne]=ge),a[ne]=!0;const Ie=W.numIconVertices>0,Ee=this.placedOrientations[W.crossTileID],Fe=Ee===c.ah.vertical,je=Ee===c.ah.horizontal||Ee===c.ah.horizontalOnly;if(he>0||Te>0){const Ue=sn(ge.text);X(t.text,he,Fe?Ya:Ue),X(t.text,Te,je?Ya:Ue);const Ze=ge.text.isHidden();[W.rightJustifiedTextSymbolIndex,W.centerJustifiedTextSymbolIndex,W.leftJustifiedTextSymbolIndex].forEach(tt=>{tt>=0&&(t.text.placedSymbolArray.get(tt).hidden=Ze||Fe?1:0)}),W.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(W.verticalPlacedTextSymbolIndex).hidden=Ze||je?1:0);const dt=this.variableOffsets[W.crossTileID];dt&&this.markUsedJustification(t,dt.anchor,W,Ee);const Pt=this.placedOrientations[W.crossTileID];Pt&&(this.markUsedJustification(t,"left",W,Pt),this.markUsedOrientation(t,Pt,W))}if(Ie){const Ue=sn(ge.icon),Ze=!(j&&W.verticalPlacedIconSymbolIndex&&Fe);W.placedIconSymbolIndex>=0&&(X(t.icon,W.numIconVertices,Ze?Ue:Ya),t.icon.placedSymbolArray.get(W.placedIconSymbolIndex).hidden=ge.icon.isHidden()),W.verticalPlacedIconSymbolIndex>=0&&(X(t.icon,W.numVerticalIconVertices,Ze?Ya:Ue),t.icon.placedSymbolArray.get(W.verticalPlacedIconSymbolIndex).hidden=ge.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Ue=t.collisionArrays[ee];if(Ue){let Ze=new c.P(0,0);if(Ue.textBox||Ue.verticalTextBox){let Pt=!0;if(C){const tt=this.variableOffsets[ne];tt?(Ze=lr(tt.anchor,tt.width,tt.height,tt.textOffset,tt.textBoxScale),k&&Ze._rotate(F?this.transform.angle:-this.transform.angle)):Pt=!1}Ue.textBox&&vr(t.textCollisionBox.collisionVertexArray,ge.text.placed,!Pt||Fe,Ze.x,Ze.y),Ue.verticalTextBox&&vr(t.textCollisionBox.collisionVertexArray,ge.text.placed,!Pt||je,Ze.x,Ze.y)}const dt=!!(!je&&Ue.verticalIconBox);Ue.iconBox&&vr(t.iconCollisionBox.collisionVertexArray,ge.icon.placed,dt,j?Ze.x:0,j?Ze.y:0),Ue.verticalIconBox&&vr(t.iconCollisionBox.collisionVertexArray,ge.icon.placed,!dt,j?Ze.x:0,j?Ze.y:0)}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const ee=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=ee.invProjMatrix,t.placementViewportMatrix=ee.viewportMatrix,t.collisionCircleArray=ee.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,a){const u=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*u>t}setStale(){this.stale=!0}}function vr(p,t,a,u,d){p.emplaceBack(t?1:0,a?1:0,u||0,d||0),p.emplaceBack(t?1:0,a?1:0,u||0,d||0),p.emplaceBack(t?1:0,a?1:0,u||0,d||0),p.emplaceBack(t?1:0,a?1:0,u||0,d||0)}const Wn=Math.pow(2,25),Hu=Math.pow(2,24),tf=Math.pow(2,17),vi=Math.pow(2,16),nc=Math.pow(2,9),sc=Math.pow(2,8),gn=Math.pow(2,1);function sn(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const t=p.placed?1:0,a=Math.floor(127*p.opacity);return a*Wn+t*Hu+a*tf+t*vi+a*nc+t*sc+a*gn+t}const Ya=0;class In{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,a,u,d,g){const w=this._bucketParts;for(;this._currentTileIndex<t.length;)if(a.getBucketParts(w,d,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((T,E)=>T.sortKey-E.sortKey));this._currentPartIndex<w.length;)if(a.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,g())return!0;return!1}}class An{constructor(t,a,u,d,g,w,T,E){this.placement=new nn(t,a,w,T,E),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(t,a,u){const d=B.now(),g=()=>!this._forceFullPlacement&&B.now()-d>2;for(;this._currentPlacementIndex>=0;){const w=a[t[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=T)&&(!w.maxzoom||w.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new In(w)),this._inProgressLayer.continuePlacement(u[w.source],this.placement,this._showCollisionBoxes,w,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const aa=512/c.W/2;class Vo{constructor(t,a,u){this.tileID=t,this.bucketInstanceId=u,this._symbolsByKey={};const d=new Map;for(let g=0;g<a.length;g++){const w=a.get(g),T=w.key,E=d.get(T);E?E.push(w):d.set(T,[w])}for(const[g,w]of d){const T={positions:w.map(E=>({x:Math.floor(E.anchorX*aa),y:Math.floor(E.anchorY*aa)})),crossTileIDs:w.map(E=>E.crossTileID)};if(T.positions.length>128){const E=new c.au(T.positions.length,16,Uint16Array);for(const{x:C,y:k}of T.positions)E.add(C,k);E.finish(),delete T.positions,T.index=E}this._symbolsByKey[g]=T}}getScaledCoordinates(t,a){const{x:u,y:d,z:g}=this.tileID.canonical,{x:w,y:T,z:E}=a.canonical,C=aa/Math.pow(2,E-g),k=(T*c.W+t.anchorY)*C,F=d*c.W*aa;return{x:Math.floor((w*c.W+t.anchorX)*C-u*c.W*aa),y:Math.floor(k-F)}}findMatches(t,a,u){const d=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let g=0;g<t.length;g++){const w=t.get(g);if(w.crossTileID)continue;const T=this._symbolsByKey[w.key];if(!T)continue;const E=this.getScaledCoordinates(w,a);if(T.index){const C=T.index.range(E.x-d,E.y-d,E.x+d,E.y+d).sort();for(const k of C){const F=T.crossTileIDs[k];if(!u[F]){u[F]=!0,w.crossTileID=F;break}}}else if(T.positions)for(let C=0;C<T.positions.length;C++){const k=T.positions[C],F=T.crossTileIDs[C];if(Math.abs(k.x-E.x)<=d&&Math.abs(k.y-E.y)<=d&&!u[F]){u[F]=!0,w.crossTileID=F;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class sr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Xa{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const a=Math.round((t-this.lng)/360);if(a!==0)for(const u in this.indexes){const d=this.indexes[u],g={};for(const w in d){const T=d[w];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+a),g[T.tileID.key]=T}this.indexes[u]=g}this.lng=t}addBucket(t,a,u){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let g=0;g<a.symbolInstances.length;g++)a.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const d=this.usedCrossTileIDs[t.overscaledZ];for(const g in this.indexes){const w=this.indexes[g];if(Number(g)>t.overscaledZ)for(const T in w){const E=w[T];E.tileID.isChildOf(t)&&E.findMatches(a.symbolInstances,t,d)}else{const T=w[t.scaledTo(Number(g)).key];T&&T.findMatches(a.symbolInstances,t,d)}}for(let g=0;g<a.symbolInstances.length;g++){const w=a.symbolInstances.get(g);w.crossTileID||(w.crossTileID=u.generate(),d[w.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Vo(t,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(t,a){for(const u of a.getCrossTileIDsLists())for(const d of u)delete this.usedCrossTileIDs[t][d]}removeStaleBuckets(t){let a=!1;for(const u in this.indexes){const d=this.indexes[u];for(const g in d)t[d[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,d[g]),delete d[g],a=!0)}return a}}class fs{constructor(){this.layerIndexes={},this.crossTileIDs=new sr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,a,u){let d=this.layerIndexes[t.id];d===void 0&&(d=this.layerIndexes[t.id]=new Xa);let g=!1;const w={};d.handleWrapJump(u);for(const T of a){const E=T.getBucket(t);E&&t.id===E.layerIds[0]&&(E.bucketInstanceId||(E.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(T.tileID,E,this.crossTileIDs)&&(g=!0),w[E.bucketInstanceId]=!0)}return d.removeStaleBuckets(w)&&(g=!0),g}pruneUnusedLayers(t){const a={};t.forEach(u=>{a[u]=!0});for(const u in this.layerIndexes)a[u]||delete this.layerIndexes[u]}}const Ni=(p,t)=>c.t(p,t&&t.filter(a=>a.identifier!=="source.canvas")),Uo=c.av();class _n extends c.E{constructor(t,a={}){super(),this._rtlTextPluginStateChange=()=>{for(const u in this.sourceCaches){const d=this.sourceCaches[u].getSource().type;d!=="vector"&&d!=="geojson"||this.sourceCaches[u].reload()}},this.map=t,this.dispatcher=new it(nt(),t._getMapId()),this.dispatcher.registerMessageHandler("getGlyphs",(u,d)=>this.getGlyphs(u,d)),this.dispatcher.registerMessageHandler("getImages",(u,d)=>this.getImages(u,d)),this.imageManager=new qt,this.imageManager.setEventedParent(this),this.glyphManager=new Dt(t._requestManager,a.localIdeographFontFamily),this.lineAtlas=new Xt(256,512),this.crossTileSymbolIndex=new fs,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.aw,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",c.ax()),Oe().on("pluginStateChange",this._rtlTextPluginStateChange),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const d=this.sourceCaches[u.sourceId];if(!d)return;const g=d.getSource();if(g&&g.vectorLayerIds)for(const w in this._layers){const T=this._layers[w];T.source===g.id&&this._validateLayer(T)}})}loadURL(t,a={},u){this.fire(new c.k("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const d=this.map._requestManager.transformRequest(t,be.Style);this._loadStyleRequest=new AbortController,c.h(d,this._loadStyleRequest).then(g=>{this._loadStyleRequest=null,this._load(g.data,a,u)}).catch(g=>{this._loadStyleRequest=null,g&&this.fire(new c.j(g))})}loadJSON(t,a={},u){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,B.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(t,a,u)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(Uo,{validate:!1})}_load(t,a,u){var d;const g=a.transformStyle?a.transformStyle(u,t):t;if(!a.validate||!Ni(this,c.x(g))){this._loaded=!0,this.stylesheet=g;for(const w in g.sources)this.addSource(w,g.sources[w],{validate:!1});g.sprite?this._loadSprite(g.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(g.glyphs),this._createLayers(),this.light=new ai(this.stylesheet.light),this.map.setTerrain((d=this.stylesheet.terrain)!==null&&d!==void 0?d:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const t=c.ay(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",t),this._order=t.map(a=>a.id),this._layers={},this._serializedLayers=null;for(const a of t){const u=c.az(a);u.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=u}}_loadSprite(t,a=!1,u=void 0){let d;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(g,w,T,E){return c._(this,void 0,void 0,function*(){const C=_t(g),k=T>1?"@2x":"",F={},j={};for(const{id:Q,url:X}of C){const ee=w.transformRequest(w.normalizeSpriteURL(X,k,".json"),be.SpriteJSON);F[Q]=c.h(ee,E);const W=w.transformRequest(w.normalizeSpriteURL(X,k,".png"),be.SpriteImage);j[Q]=Ce.getImage(W,E)}return yield Promise.all([...Object.values(F),...Object.values(j)]),function(Q,X){return c._(this,void 0,void 0,function*(){const ee={};for(const W in Q){ee[W]={};const he=B.getImageCanvasContext((yield X[W]).data),Te=(yield Q[W]).data;for(const ne in Te){const{width:ge,height:Ie,x:Ee,y:Fe,sdf:je,pixelRatio:Ue,stretchX:Ze,stretchY:dt,content:Pt}=Te[ne];ee[W][ne]={data:null,pixelRatio:Ue,sdf:je,stretchX:Ze,stretchY:dt,content:Pt,spriteData:{width:ge,height:Ie,x:Ee,y:Fe,context:he}}}}return ee})}(F,j)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(g=>{if(this._spriteRequest=null,g)for(const w in g){this._spritesImagesIds[w]=[];const T=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter(E=>!(E in g)):[];for(const E of T)this.imageManager.removeImage(E),this._changedImages[E]=!0;for(const E in g[w]){const C=w==="default"?E:`${w}:${E}`;this._spritesImagesIds[w].push(C),C in this.imageManager.images?this.imageManager.updateImage(C,g[w][E],!1):this.imageManager.addImage(C,g[w][E]),a&&(this._changedImages[C]=!0)}}}).catch(g=>{this._spriteRequest=null,d=g,this.fire(new c.j(d))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),u&&u(d)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(t){const a=this.sourceCaches[t.source];if(!a)return;const u=t.sourceLayer;if(!u)return;const d=a.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(u)===-1)&&this.fire(new c.j(new Error(`Source layer "${u}" does not exist on source "${d.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t){const a=this._serializedAllLayers();if(!t||t.length===0)return Object.values(a);const u=[];for(const d of t)a[d]&&u.push(a[d]);return u}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const a=Object.keys(this._layers);for(const u of a){const d=this._layers[u];d.type!=="custom"&&(t[u]=d.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const a=this._changed;if(this._changed){const d=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(d.length||g.length)&&this._updateWorkerLayers(d,g);for(const w in this._updatedSources){const T=this._updatedSources[w];if(T==="reload")this._reloadSource(w);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const u={};for(const d in this.sourceCaches){const g=this.sourceCaches[d];u[d]=g.used,g.used=!1}for(const d of this._order){const g=this._layers[d];g.recalculate(t,this._availableImages),!g.isHidden(t.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(const d in u){const g=this.sourceCaches[d];u[d]!==g.used&&g.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(t),this.z=t.zoom,a&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,a){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(t),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,a={}){var u;this._checkLoaded();const d=this.serialize();if(t=a.transformStyle?a.transformStyle(d,t):t,((u=a.validate)===null||u===void 0||u)&&Ni(this,c.x(t)))return!1;(t=c.aA(t)).layers=c.ay(t.layers);const g=c.aB(d,t),w=this._getOperationsToPerform(g);if(w.unimplemented.length>0)throw new Error(`Unimplemented: ${w.unimplemented.join(", ")}.`);if(w.operations.length===0)return!1;for(const T of w.operations)T();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const a=[],u=[];for(const d of t)switch(d.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":a.push(()=>this.addLayer.apply(this,d.args));break;case"removeLayer":a.push(()=>this.removeLayer.apply(this,d.args));break;case"setPaintProperty":a.push(()=>this.setPaintProperty.apply(this,d.args));break;case"setLayoutProperty":a.push(()=>this.setLayoutProperty.apply(this,d.args));break;case"setFilter":a.push(()=>this.setFilter.apply(this,d.args));break;case"addSource":a.push(()=>this.addSource.apply(this,d.args));break;case"removeSource":a.push(()=>this.removeSource.apply(this,d.args));break;case"setLayerZoomRange":a.push(()=>this.setLayerZoomRange.apply(this,d.args));break;case"setLight":a.push(()=>this.setLight.apply(this,d.args));break;case"setGeoJSONSourceData":a.push(()=>this.setGeoJSONSourceData.apply(this,d.args));break;case"setGlyphs":a.push(()=>this.setGlyphs.apply(this,d.args));break;case"setSprite":a.push(()=>this.setSprite.apply(this,d.args));break;case"setTerrain":a.push(()=>this.map.setTerrain.apply(this,d.args));break;case"setTransition":a.push(()=>{});break;default:u.push(d.command)}return{operations:a,unimplemented:u}}addImage(t,a){if(this.getImage(t))return this.fire(new c.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,a),this._afterImageUpdated(t)}updateImage(t,a){this.imageManager.updateImage(t,a)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new c.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,a,u={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.x.source,`sources.${t}`,a,null,u))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const d=this.sourceCaches[t]=new rr(t,a,this.dispatcher);d.style=this,d.setEventedParent(this,()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:t})),d.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===t)return this.fire(new c.j(new Error(`Source "${t}" cannot be removed while layer "${u}" is using it.`)));const a=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],a.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,a){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const u=this.sourceCaches[t].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(a),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,a,u={}){this._checkLoaded();const d=t.id;if(this.getLayer(d))return void this.fire(new c.j(new Error(`Layer "${d}" already exists on this map.`)));let g;if(t.type==="custom"){if(Ni(this,c.aC(t)))return;g=c.az(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(d,t.source),t=c.aA(t),t=c.e(t,{source:d})),this._validate(c.x.layer,`layers.${d}`,t,{arrayIndex:-1},u))return;g=c.az(t),this._validateLayer(g),g.setEventedParent(this,{layer:{id:d}})}const w=a?this._order.indexOf(a):this._order.length;if(a&&w===-1)this.fire(new c.j(new Error(`Cannot add layer "${d}" before non-existing layer "${a}".`)));else{if(this._order.splice(w,0,d),this._layerOrderChanged=!0,this._layers[d]=g,this._removedLayers[d]&&g.source&&g.type!=="custom"){const T=this._removedLayers[d];delete this._removedLayers[d],T.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(t,a){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new c.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===a)return;const u=this._order.indexOf(t);this._order.splice(u,1);const d=a?this._order.indexOf(a):this._order.length;a&&d===-1?this.fire(new c.j(new Error(`Cannot move layer "${t}" before non-existing layer "${a}".`))):(this._order.splice(d,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const a=this._layers[t];if(!a)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${t}".`)));a.setEventedParent(null);const u=this._order.indexOf(t);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=a,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],a.onRemove&&a.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,a,u){this._checkLoaded();const d=this.getLayer(t);d?d.minzoom===a&&d.maxzoom===u||(a!=null&&(d.minzoom=a),u!=null&&(d.maxzoom=u),this._updateLayer(d)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,a,u={}){this._checkLoaded();const d=this.getLayer(t);if(d){if(!c.aD(d.filter,a))return a==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(c.x.filter,`layers.${d.id}.filter`,a,null,u)||(d.filter=c.aA(a),this._updateLayer(d)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return c.aA(this.getLayer(t).filter)}setLayoutProperty(t,a,u,d={}){this._checkLoaded();const g=this.getLayer(t);g?c.aD(g.getLayoutProperty(a),u)||(g.setLayoutProperty(a,u,d),this._updateLayer(g)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,a){const u=this.getLayer(t);if(u)return u.getLayoutProperty(a);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,a,u,d={}){this._checkLoaded();const g=this.getLayer(t);g?c.aD(g.getPaintProperty(a),u)||(g.setPaintProperty(a,u,d)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new c.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,a){return this.getLayer(t).getPaintProperty(a)}setFeatureState(t,a){this._checkLoaded();const u=t.source,d=t.sourceLayer,g=this.sourceCaches[u];if(g===void 0)return void this.fire(new c.j(new Error(`The source '${u}' does not exist in the map's style.`)));const w=g.getSource().type;w==="geojson"&&d?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||d?(t.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),g.setFeatureState(d,t.id,a)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,a){this._checkLoaded();const u=t.source,d=this.sourceCaches[u];if(d===void 0)return void this.fire(new c.j(new Error(`The source '${u}' does not exist in the map's style.`)));const g=d.getSource().type,w=g==="vector"?t.sourceLayer:void 0;g!=="vector"||w?a&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(w,t.id,a):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const a=t.source,u=t.sourceLayer,d=this.sourceCaches[a];if(d!==void 0)return d.getSource().type!=="vector"||u?(t.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),d.getFeatureState(u,t.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=c.aE(this.sourceCaches,g=>g.serialize()),a=this._serializeByIds(this._order),u=this.map.getTerrain()||void 0,d=this.stylesheet;return c.aF({version:d.version,name:d.name,metadata:d.metadata,light:d.light,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,sources:t,layers:a,terrain:u},g=>g!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const a=w=>this._layers[w].type==="fill-extrusion",u={},d=[];for(let w=this._order.length-1;w>=0;w--){const T=this._order[w];if(a(T)){u[T]=w;for(const E of t){const C=E[T];if(C)for(const k of C)d.push(k)}}}d.sort((w,T)=>T.intersectionZ-w.intersectionZ);const g=[];for(let w=this._order.length-1;w>=0;w--){const T=this._order[w];if(a(T))for(let E=d.length-1;E>=0;E--){const C=d[E].feature;if(u[C.layer.id]<w)break;g.push(C),d.pop()}else for(const E of t){const C=E[T];if(C)for(const k of C)g.push(k.feature)}}return g}queryRenderedFeatures(t,a,u){a&&a.filter&&this._validate(c.x.filter,"queryRenderedFeatures.filter",a.filter,null,a);const d={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const T of a.layers){const E=this._layers[T];if(!E)return this.fire(new c.j(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];d[E.source]=!0}}const g=[];a.availableImages=this._availableImages;const w=this._serializedAllLayers();for(const T in this.sourceCaches)a.layers&&!d[T]||g.push(ei(this.sourceCaches[T],this._layers,w,t,a,u));return this.placement&&g.push(function(T,E,C,k,F,j,Q){const X={},ee=j.queryRenderedSymbols(k),W=[];for(const he of Object.keys(ee).map(Number))W.push(Q[he]);W.sort(O);for(const he of W){const Te=he.featureIndex.lookupSymbolFeatures(ee[he.bucketInstanceId],E,he.bucketIndex,he.sourceLayerIndex,F.filter,F.layers,F.availableImages,T);for(const ne in Te){const ge=X[ne]=X[ne]||[],Ie=Te[ne];Ie.sort((Ee,Fe)=>{const je=he.featureSortOrder;if(je){const Ue=je.indexOf(Ee.featureIndex);return je.indexOf(Fe.featureIndex)-Ue}return Fe.featureIndex-Ee.featureIndex});for(const Ee of Ie)ge.push(Ee)}}for(const he in X)X[he].forEach(Te=>{const ne=Te.feature,ge=C[T[he].source].getFeatureState(ne.layer["source-layer"],ne.id);ne.source=ne.layer.source,ne.layer["source-layer"]&&(ne.sourceLayer=ne.layer["source-layer"]),ne.state=ge});return X}(this._layers,w,this.sourceCaches,t,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(t,a){a&&a.filter&&this._validate(c.x.filter,"querySourceFeatures.filter",a.filter,null,a);const u=this.sourceCaches[t];return u?function(d,g){const w=d.getRenderableIds().map(C=>d.getTileByID(C)),T=[],E={};for(let C=0;C<w.length;C++){const k=w[C],F=k.tileID.canonical.key;E[F]||(E[F]=!0,k.querySourceFeatures(T,g))}return T}(u,a):[]}getLight(){return this.light.getLight()}setLight(t,a={}){this._checkLoaded();const u=this.light.getLight();let d=!1;for(const w in t)if(!c.aD(t[w],u[w])){d=!0;break}if(!d)return;const g={now:B.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,a),this.light.updateTransitions(g)}_validate(t,a,u,d,g={}){return(!g||g.validate!==!1)&&Ni(this,t.call(c.x,c.e({key:a,style:this.serialize(),value:u,styleSpec:c.v},d)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Oe().off("pluginStateChange",this._rtlTextPluginStateChange);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const u=this.sourceCaches[a];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("removeMap",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const a in this.sourceCaches)this.sourceCaches[a].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,a,u,d,g=!1){let w=!1,T=!1;const E={};for(const C of this._order){const k=this._layers[C];if(k.type!=="symbol")continue;if(!E[k.source]){const j=this.sourceCaches[k.source];E[k.source]=j.getRenderableIds(!0).map(Q=>j.getTileByID(Q)).sort((Q,X)=>X.tileID.overscaledZ-Q.tileID.overscaledZ||(Q.tileID.isLessThan(X.tileID)?-1:1))}const F=this.crossTileSymbolIndex.addLayer(k,E[k.source],t.center.lng);w=w||F}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(B.now(),t.zoom))&&(this.pauseablePlacement=new An(t,this.map.terrain,this._order,g,a,u,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(B.now()),T=!0),w&&this.pauseablePlacement.placement.setStale()),T||w)for(const C of this._order){const k=this._layers[C];k.type==="symbol"&&this.placement.updateLayerOpacities(k,E[k.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(B.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,a){return c._(this,void 0,void 0,function*(){const u=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const d=this.sourceCaches[a.source];return d&&d.setDependencies(a.tileID.key,a.type,a.icons),u})}getGlyphs(t,a){return c._(this,void 0,void 0,function*(){const u=yield this.glyphManager.getGlyphs(a.stacks),d=this.sourceCaches[a.source];return d&&d.setDependencies(a.tileID.key,a.type,[""]),u})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,a={}){this._checkLoaded(),t&&this._validate(c.x.glyphs,"glyphs",t,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,a,u={},d){this._checkLoaded();const g=[{id:t,url:a}],w=[..._t(this.stylesheet.sprite),...g];this._validate(c.x.sprite,"sprite",w,null,u)||(this.stylesheet.sprite=w,this._loadSprite(g,!0,d))}removeSprite(t){this._checkLoaded();const a=_t(this.stylesheet.sprite);if(a.find(u=>u.id===t)){if(this._spritesImagesIds[t])for(const u of this._spritesImagesIds[t])this.imageManager.removeImage(u),this._changedImages[u]=!0;a.splice(a.findIndex(u=>u.id===t),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return _t(this.stylesheet.sprite)}setSprite(t,a={},u){this._checkLoaded(),t&&this._validate(c.x.sprite,"sprite",t,null,a)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,u):(this._unloadSprite(),u&&u(null)))}}var $o=c.X([{name:"a_pos",type:"Int16",components:2}]),Zn="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Ja={prelude:xi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:xi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:xi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:xi(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:xi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:xi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:xi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:xi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:xi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:xi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:xi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:xi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:xi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:xi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:xi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:xi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:xi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:xi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:xi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:xi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:xi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:xi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:xi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:xi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:xi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:xi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:xi("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Zn),terrainDepth:xi("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Zn),terrainCoords:xi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Zn)};function xi(p,t){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=t.match(/attribute ([\w]+) ([\w]+)/g),d=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=g?g.concat(d):d,T={};return{fragmentSource:p=p.replace(a,(E,C,k,F,j)=>(T[j]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_${j}
varying ${k} ${F} ${j};
#else
uniform ${k} ${F} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${k} ${F} ${j} = u_${j};
#endif
`)),vertexSource:t=t.replace(a,(E,C,k,F,j)=>{const Q=F==="float"?"vec2":"vec4",X=j.match(/color/)?"color":Q;return T[j]?C==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
attribute ${k} ${Q} a_${j};
varying ${k} ${F} ${j};
#else
uniform ${k} ${F} u_${j};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${k} ${F} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${X}(a_${j}, u_${j}_t);
#else
    ${k} ${F} ${j} = u_${j};
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
attribute ${k} ${Q} a_${j};
#else
uniform ${k} ${F} u_${j};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${k} ${F} ${j} = a_${j};
#else
    ${k} ${F} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${k} ${F} ${j} = unpack_mix_${X}(a_${j}, u_${j}_t);
#else
    ${k} ${F} ${j} = u_${j};
#endif
`}),staticAttributes:u,staticUniforms:w}}class jo{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,a,u,d,g,w,T,E,C){this.context=t;let k=this.boundPaintVertexBuffers.length!==d.length;for(let F=0;!k&&F<d.length;F++)this.boundPaintVertexBuffers[F]!==d[F]&&(k=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==u||k||this.boundIndexBuffer!==g||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==E||this.boundDynamicVertexBuffer3!==C?this.freshBind(a,u,d,g,w,T,E,C):(t.bindVertexArray.set(this.vao),T&&T.bind(),g&&g.dynamicDraw&&g.bind(),E&&E.bind(),C&&C.bind())}freshBind(t,a,u,d,g,w,T,E){const C=t.numAttributes,k=this.context,F=k.gl;this.vao&&this.destroy(),this.vao=k.createVertexArray(),k.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=d,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=E,a.enableAttributes(F,t);for(const j of u)j.enableAttributes(F,t);w&&w.enableAttributes(F,t),T&&T.enableAttributes(F,t),E&&E.enableAttributes(F,t),a.bind(),a.setVertexAttribPointers(F,t,g);for(const j of u)j.bind(),j.setVertexAttribPointers(F,t,g);w&&(w.bind(),w.setVertexAttribPointers(F,t,g)),d&&d.bind(),T&&(T.bind(),T.setVertexAttribPointers(F,t,g)),E&&(E.bind(),E.setVertexAttribPointers(F,t,g)),k.currentNumAttributes=C}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function oa(p){const t=[];for(let a=0;a<p.length;a++){if(p[a]===null)continue;const u=p[a].split(" ");t.push(u.pop())}return t}class ps{constructor(t,a,u,d,g,w){const T=t.gl;this.program=T.createProgram();const E=oa(a.staticAttributes),C=u?u.getBinderAttributes():[],k=E.concat(C),F=Ja.prelude.staticUniforms?oa(Ja.prelude.staticUniforms):[],j=a.staticUniforms?oa(a.staticUniforms):[],Q=u?u.getBinderUniforms():[],X=F.concat(j).concat(Q),ee=[];for(const Ee of X)ee.indexOf(Ee)<0&&ee.push(Ee);const W=u?u.defines():[];g&&W.push("#define OVERDRAW_INSPECTOR;"),w&&W.push("#define TERRAIN3D;");const he=W.concat(Ja.prelude.fragmentSource,a.fragmentSource).join(`
`),Te=W.concat(Ja.prelude.vertexSource,a.vertexSource).join(`
`),ne=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(ne,he),T.compileShader(ne),!T.getShaderParameter(ne,T.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${T.getShaderInfoLog(ne)}`);T.attachShader(this.program,ne);const ge=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(ge,Te),T.compileShader(ge),!T.getShaderParameter(ge,T.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${T.getShaderInfoLog(ge)}`);T.attachShader(this.program,ge),this.attributes={};const Ie={};this.numAttributes=k.length;for(let Ee=0;Ee<this.numAttributes;Ee++)k[Ee]&&(T.bindAttribLocation(this.program,Ee,k[Ee]),this.attributes[k[Ee]]=Ee);if(T.linkProgram(this.program),!T.getProgramParameter(this.program,T.LINK_STATUS))throw new Error(`Program failed to link: ${T.getProgramInfoLog(this.program)}`);T.deleteShader(ge),T.deleteShader(ne);for(let Ee=0;Ee<ee.length;Ee++){const Fe=ee[Ee];if(Fe&&!Ie[Fe]){const je=T.getUniformLocation(this.program,Fe);je&&(Ie[Fe]=je)}}this.fixedUniforms=d(t,Ie),this.terrainUniforms=((Ee,Fe)=>({u_depth:new c.aG(Ee,Fe.u_depth),u_terrain:new c.aG(Ee,Fe.u_terrain),u_terrain_dim:new c.aH(Ee,Fe.u_terrain_dim),u_terrain_matrix:new c.aI(Ee,Fe.u_terrain_matrix),u_terrain_unpack:new c.aJ(Ee,Fe.u_terrain_unpack),u_terrain_exaggeration:new c.aH(Ee,Fe.u_terrain_exaggeration)}))(t,Ie),this.binderUniforms=u?u.getUniforms(t,Ie):[]}draw(t,a,u,d,g,w,T,E,C,k,F,j,Q,X,ee,W,he,Te){const ne=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(u),t.setStencilMode(d),t.setColorMode(g),t.setCullFace(w),E){t.activeTexture.set(ne.TEXTURE2),ne.bindTexture(ne.TEXTURE_2D,E.depthTexture),t.activeTexture.set(ne.TEXTURE3),ne.bindTexture(ne.TEXTURE_2D,E.texture);for(const Ie in this.terrainUniforms)this.terrainUniforms[Ie].set(E[Ie])}for(const Ie in this.fixedUniforms)this.fixedUniforms[Ie].set(T[Ie]);ee&&ee.setUniforms(t,this.binderUniforms,Q,{zoom:X});let ge=0;switch(a){case ne.LINES:ge=2;break;case ne.TRIANGLES:ge=3;break;case ne.LINE_STRIP:ge=1}for(const Ie of j.get()){const Ee=Ie.vaos||(Ie.vaos={});(Ee[C]||(Ee[C]=new jo)).bind(t,this,k,ee?ee.getPaintVertexBuffers():[],F,Ie.vertexOffset,W,he,Te),ne.drawElements(a,Ie.primitiveLength*ge,ne.UNSIGNED_SHORT,Ie.primitiveOffset*ge*2)}}}function Ho(p,t,a){const u=1/zt(a,1,t.transform.tileZoom),d=Math.pow(2,a.tileID.overscaledZ),g=a.tileSize*Math.pow(2,t.transform.tileZoom)/d,w=g*(a.tileID.canonical.x+a.tileID.wrap*d),T=g*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[u,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[w>>16,T>>16],u_pixel_coord_lower:[65535&w,65535&T]}}const Qa=(p,t,a,u)=>{const d=t.style.light,g=d.properties.get("position"),w=[g.x,g.y,g.z],T=function(){var C=new c.A(9);return c.A!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[5]=0,C[6]=0,C[7]=0),C[0]=1,C[4]=1,C[8]=1,C}();d.properties.get("anchor")==="viewport"&&function(C,k){var F=Math.sin(k),j=Math.cos(k);C[0]=j,C[1]=F,C[2]=0,C[3]=-F,C[4]=j,C[5]=0,C[6]=0,C[7]=0,C[8]=1}(T,-t.transform.angle),function(C,k,F){var j=k[0],Q=k[1],X=k[2];C[0]=j*F[0]+Q*F[3]+X*F[6],C[1]=j*F[1]+Q*F[4]+X*F[7],C[2]=j*F[2]+Q*F[5]+X*F[8]}(w,w,T);const E=d.properties.get("color");return{u_matrix:p,u_lightpos:w,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+a,u_opacity:u}},rf=(p,t,a,u,d,g,w)=>c.e(Qa(p,t,a,u),Ho(g,t,w),{u_height_factor:-Math.pow(2,d.overscaledZ)/w.tileSize/8}),Gu=p=>({u_matrix:p}),Go=(p,t,a,u)=>c.e(Gu(p),Ho(a,t,u)),nf=(p,t)=>({u_matrix:p,u_world:t}),qu=(p,t,a,u,d)=>c.e(Go(p,t,a,u),{u_world:d}),sf=(p,t,a,u)=>{const d=p.transform;let g,w;if(u.paint.get("circle-pitch-alignment")==="map"){const T=zt(a,1,d.zoom);g=!0,w=[T,T]}else g=!1,w=d.pixelsToGLUnits;return{u_camera_to_center_distance:d.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:p.translatePosMatrix(t.posMatrix,a,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+g,u_device_pixel_ratio:p.pixelRatio,u_extrude_scale:w}},Wu=(p,t,a)=>{const u=zt(a,1,t.zoom),d=Math.pow(2,t.zoom-a.tileID.overscaledZ),g=a.tileID.overscaleFactor();return{u_matrix:p,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[t.pixelsToGLUnits[0]/(u*d),t.pixelsToGLUnits[1]/(u*d)],u_overscale_factor:g}},Zu=(p,t,a=1)=>({u_matrix:p,u_color:t,u_overlay:0,u_overlay_scale:a}),qo=p=>({u_matrix:p}),Ku=(p,t,a,u)=>({u_matrix:p,u_extrude_scale:zt(t,1,a),u_intensity:u});function Yu(p,t){const a=Math.pow(2,t.canonical.z),u=t.canonical.y;return[new c.Y(0,u/a).toLngLat().lat,new c.Y(0,(u+1)/a).toLngLat().lat]}const Wo=(p,t,a,u)=>{const d=p.transform;return{u_matrix:eo(p,t,a,u),u_ratio:1/zt(t,1,d.zoom),u_device_pixel_ratio:p.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Xu=(p,t,a,u,d)=>c.e(Wo(p,t,a,d),{u_image:0,u_image_height:u}),Ls=(p,t,a,u,d)=>{const g=p.transform,w=yn(t,g);return{u_matrix:eo(p,t,a,d),u_texsize:t.imageAtlasTexture.size,u_ratio:1/zt(t,1,g.zoom),u_device_pixel_ratio:p.pixelRatio,u_image:0,u_scale:[w,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Zo=(p,t,a,u,d,g)=>{const w=p.lineAtlas,T=yn(t,p.transform),E=a.layout.get("line-cap")==="round",C=w.getDash(u.from,E),k=w.getDash(u.to,E),F=C.width*d.fromScale,j=k.width*d.toScale;return c.e(Wo(p,t,a,g),{u_patternscale_a:[T/F,-C.height/2],u_patternscale_b:[T/j,-k.height/2],u_sdfgamma:w.width/(256*Math.min(F,j)*p.pixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:k.y,u_mix:d.t})};function yn(p,t){return 1/zt(p,1,t.tileZoom)}function eo(p,t,a,u){return p.translatePosMatrix(u?u.posMatrix:t.tileID.posMatrix,t,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Ko=(p,t,a,u,d)=>{return{u_matrix:p,u_tl_parent:t,u_scale_parent:a,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(w=d.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(g=d.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:to(d.paint.get("raster-hue-rotate"))};var g,w};function to(p){p*=Math.PI/180;const t=Math.sin(p),a=Math.cos(p);return[(2*a+1)/3,(-Math.sqrt(3)*t-a+1)/3,(Math.sqrt(3)*t-a+1)/3]}const io=(p,t,a,u,d,g,w,T,E,C)=>{const k=d.transform;return{u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:k.cameraToCenterDistance,u_pitch:k.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:k.width/k.height,u_fade_change:d.options.fadeDuration?d.symbolFadeChange:1,u_matrix:g,u_label_plane_matrix:w,u_coord_matrix:T,u_is_text:+E,u_pitch_with_map:+u,u_texsize:C,u_texture:0}},ro=(p,t,a,u,d,g,w,T,E,C,k)=>{const F=d.transform;return c.e(io(p,t,a,u,d,g,w,T,E,C),{u_gamma_scale:u?Math.cos(F._pitch)*F.cameraToCenterDistance:1,u_device_pixel_ratio:d.pixelRatio,u_is_halo:+k})},no=(p,t,a,u,d,g,w,T,E,C)=>c.e(ro(p,t,a,u,d,g,w,T,!0,E,!0),{u_texsize_icon:C,u_texture_icon:1}),af=(p,t,a)=>({u_matrix:p,u_opacity:t,u_color:a}),of=(p,t,a,u,d,g)=>c.e(function(w,T,E,C){const k=E.imageManager.getPattern(w.from.toString()),F=E.imageManager.getPattern(w.to.toString()),{width:j,height:Q}=E.imageManager.getPixelSize(),X=Math.pow(2,C.tileID.overscaledZ),ee=C.tileSize*Math.pow(2,E.transform.tileZoom)/X,W=ee*(C.tileID.canonical.x+C.tileID.wrap*X),he=ee*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:k.tl,u_pattern_br_a:k.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[j,Q],u_mix:T.t,u_pattern_size_a:k.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/zt(C,1,E.transform.tileZoom),u_pixel_coord_upper:[W>>16,he>>16],u_pixel_coord_lower:[65535&W,65535&he]}}(u,g,a,d),{u_matrix:p,u_opacity:t}),Ju={fillExtrusion:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_lightpos:new c.aK(p,t.u_lightpos),u_lightintensity:new c.aH(p,t.u_lightintensity),u_lightcolor:new c.aK(p,t.u_lightcolor),u_vertical_gradient:new c.aH(p,t.u_vertical_gradient),u_opacity:new c.aH(p,t.u_opacity)}),fillExtrusionPattern:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_lightpos:new c.aK(p,t.u_lightpos),u_lightintensity:new c.aH(p,t.u_lightintensity),u_lightcolor:new c.aK(p,t.u_lightcolor),u_vertical_gradient:new c.aH(p,t.u_vertical_gradient),u_height_factor:new c.aH(p,t.u_height_factor),u_image:new c.aG(p,t.u_image),u_texsize:new c.aL(p,t.u_texsize),u_pixel_coord_upper:new c.aL(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aL(p,t.u_pixel_coord_lower),u_scale:new c.aK(p,t.u_scale),u_fade:new c.aH(p,t.u_fade),u_opacity:new c.aH(p,t.u_opacity)}),fill:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix)}),fillPattern:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_image:new c.aG(p,t.u_image),u_texsize:new c.aL(p,t.u_texsize),u_pixel_coord_upper:new c.aL(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aL(p,t.u_pixel_coord_lower),u_scale:new c.aK(p,t.u_scale),u_fade:new c.aH(p,t.u_fade)}),fillOutline:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_world:new c.aL(p,t.u_world)}),fillOutlinePattern:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_world:new c.aL(p,t.u_world),u_image:new c.aG(p,t.u_image),u_texsize:new c.aL(p,t.u_texsize),u_pixel_coord_upper:new c.aL(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aL(p,t.u_pixel_coord_lower),u_scale:new c.aK(p,t.u_scale),u_fade:new c.aH(p,t.u_fade)}),circle:(p,t)=>({u_camera_to_center_distance:new c.aH(p,t.u_camera_to_center_distance),u_scale_with_map:new c.aG(p,t.u_scale_with_map),u_pitch_with_map:new c.aG(p,t.u_pitch_with_map),u_extrude_scale:new c.aL(p,t.u_extrude_scale),u_device_pixel_ratio:new c.aH(p,t.u_device_pixel_ratio),u_matrix:new c.aI(p,t.u_matrix)}),collisionBox:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_camera_to_center_distance:new c.aH(p,t.u_camera_to_center_distance),u_pixels_to_tile_units:new c.aH(p,t.u_pixels_to_tile_units),u_extrude_scale:new c.aL(p,t.u_extrude_scale),u_overscale_factor:new c.aH(p,t.u_overscale_factor)}),collisionCircle:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_inv_matrix:new c.aI(p,t.u_inv_matrix),u_camera_to_center_distance:new c.aH(p,t.u_camera_to_center_distance),u_viewport_size:new c.aL(p,t.u_viewport_size)}),debug:(p,t)=>({u_color:new c.aM(p,t.u_color),u_matrix:new c.aI(p,t.u_matrix),u_overlay:new c.aG(p,t.u_overlay),u_overlay_scale:new c.aH(p,t.u_overlay_scale)}),clippingMask:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix)}),heatmap:(p,t)=>({u_extrude_scale:new c.aH(p,t.u_extrude_scale),u_intensity:new c.aH(p,t.u_intensity),u_matrix:new c.aI(p,t.u_matrix)}),heatmapTexture:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_world:new c.aL(p,t.u_world),u_image:new c.aG(p,t.u_image),u_color_ramp:new c.aG(p,t.u_color_ramp),u_opacity:new c.aH(p,t.u_opacity)}),hillshade:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_image:new c.aG(p,t.u_image),u_latrange:new c.aL(p,t.u_latrange),u_light:new c.aL(p,t.u_light),u_shadow:new c.aM(p,t.u_shadow),u_highlight:new c.aM(p,t.u_highlight),u_accent:new c.aM(p,t.u_accent)}),hillshadePrepare:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_image:new c.aG(p,t.u_image),u_dimension:new c.aL(p,t.u_dimension),u_zoom:new c.aH(p,t.u_zoom),u_unpack:new c.aJ(p,t.u_unpack)}),line:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_ratio:new c.aH(p,t.u_ratio),u_device_pixel_ratio:new c.aH(p,t.u_device_pixel_ratio),u_units_to_pixels:new c.aL(p,t.u_units_to_pixels)}),lineGradient:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_ratio:new c.aH(p,t.u_ratio),u_device_pixel_ratio:new c.aH(p,t.u_device_pixel_ratio),u_units_to_pixels:new c.aL(p,t.u_units_to_pixels),u_image:new c.aG(p,t.u_image),u_image_height:new c.aH(p,t.u_image_height)}),linePattern:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_texsize:new c.aL(p,t.u_texsize),u_ratio:new c.aH(p,t.u_ratio),u_device_pixel_ratio:new c.aH(p,t.u_device_pixel_ratio),u_image:new c.aG(p,t.u_image),u_units_to_pixels:new c.aL(p,t.u_units_to_pixels),u_scale:new c.aK(p,t.u_scale),u_fade:new c.aH(p,t.u_fade)}),lineSDF:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_ratio:new c.aH(p,t.u_ratio),u_device_pixel_ratio:new c.aH(p,t.u_device_pixel_ratio),u_units_to_pixels:new c.aL(p,t.u_units_to_pixels),u_patternscale_a:new c.aL(p,t.u_patternscale_a),u_patternscale_b:new c.aL(p,t.u_patternscale_b),u_sdfgamma:new c.aH(p,t.u_sdfgamma),u_image:new c.aG(p,t.u_image),u_tex_y_a:new c.aH(p,t.u_tex_y_a),u_tex_y_b:new c.aH(p,t.u_tex_y_b),u_mix:new c.aH(p,t.u_mix)}),raster:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_tl_parent:new c.aL(p,t.u_tl_parent),u_scale_parent:new c.aH(p,t.u_scale_parent),u_buffer_scale:new c.aH(p,t.u_buffer_scale),u_fade_t:new c.aH(p,t.u_fade_t),u_opacity:new c.aH(p,t.u_opacity),u_image0:new c.aG(p,t.u_image0),u_image1:new c.aG(p,t.u_image1),u_brightness_low:new c.aH(p,t.u_brightness_low),u_brightness_high:new c.aH(p,t.u_brightness_high),u_saturation_factor:new c.aH(p,t.u_saturation_factor),u_contrast_factor:new c.aH(p,t.u_contrast_factor),u_spin_weights:new c.aK(p,t.u_spin_weights)}),symbolIcon:(p,t)=>({u_is_size_zoom_constant:new c.aG(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aG(p,t.u_is_size_feature_constant),u_size_t:new c.aH(p,t.u_size_t),u_size:new c.aH(p,t.u_size),u_camera_to_center_distance:new c.aH(p,t.u_camera_to_center_distance),u_pitch:new c.aH(p,t.u_pitch),u_rotate_symbol:new c.aG(p,t.u_rotate_symbol),u_aspect_ratio:new c.aH(p,t.u_aspect_ratio),u_fade_change:new c.aH(p,t.u_fade_change),u_matrix:new c.aI(p,t.u_matrix),u_label_plane_matrix:new c.aI(p,t.u_label_plane_matrix),u_coord_matrix:new c.aI(p,t.u_coord_matrix),u_is_text:new c.aG(p,t.u_is_text),u_pitch_with_map:new c.aG(p,t.u_pitch_with_map),u_texsize:new c.aL(p,t.u_texsize),u_texture:new c.aG(p,t.u_texture)}),symbolSDF:(p,t)=>({u_is_size_zoom_constant:new c.aG(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aG(p,t.u_is_size_feature_constant),u_size_t:new c.aH(p,t.u_size_t),u_size:new c.aH(p,t.u_size),u_camera_to_center_distance:new c.aH(p,t.u_camera_to_center_distance),u_pitch:new c.aH(p,t.u_pitch),u_rotate_symbol:new c.aG(p,t.u_rotate_symbol),u_aspect_ratio:new c.aH(p,t.u_aspect_ratio),u_fade_change:new c.aH(p,t.u_fade_change),u_matrix:new c.aI(p,t.u_matrix),u_label_plane_matrix:new c.aI(p,t.u_label_plane_matrix),u_coord_matrix:new c.aI(p,t.u_coord_matrix),u_is_text:new c.aG(p,t.u_is_text),u_pitch_with_map:new c.aG(p,t.u_pitch_with_map),u_texsize:new c.aL(p,t.u_texsize),u_texture:new c.aG(p,t.u_texture),u_gamma_scale:new c.aH(p,t.u_gamma_scale),u_device_pixel_ratio:new c.aH(p,t.u_device_pixel_ratio),u_is_halo:new c.aG(p,t.u_is_halo)}),symbolTextAndIcon:(p,t)=>({u_is_size_zoom_constant:new c.aG(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aG(p,t.u_is_size_feature_constant),u_size_t:new c.aH(p,t.u_size_t),u_size:new c.aH(p,t.u_size),u_camera_to_center_distance:new c.aH(p,t.u_camera_to_center_distance),u_pitch:new c.aH(p,t.u_pitch),u_rotate_symbol:new c.aG(p,t.u_rotate_symbol),u_aspect_ratio:new c.aH(p,t.u_aspect_ratio),u_fade_change:new c.aH(p,t.u_fade_change),u_matrix:new c.aI(p,t.u_matrix),u_label_plane_matrix:new c.aI(p,t.u_label_plane_matrix),u_coord_matrix:new c.aI(p,t.u_coord_matrix),u_is_text:new c.aG(p,t.u_is_text),u_pitch_with_map:new c.aG(p,t.u_pitch_with_map),u_texsize:new c.aL(p,t.u_texsize),u_texsize_icon:new c.aL(p,t.u_texsize_icon),u_texture:new c.aG(p,t.u_texture),u_texture_icon:new c.aG(p,t.u_texture_icon),u_gamma_scale:new c.aH(p,t.u_gamma_scale),u_device_pixel_ratio:new c.aH(p,t.u_device_pixel_ratio),u_is_halo:new c.aG(p,t.u_is_halo)}),background:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_opacity:new c.aH(p,t.u_opacity),u_color:new c.aM(p,t.u_color)}),backgroundPattern:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_opacity:new c.aH(p,t.u_opacity),u_image:new c.aG(p,t.u_image),u_pattern_tl_a:new c.aL(p,t.u_pattern_tl_a),u_pattern_br_a:new c.aL(p,t.u_pattern_br_a),u_pattern_tl_b:new c.aL(p,t.u_pattern_tl_b),u_pattern_br_b:new c.aL(p,t.u_pattern_br_b),u_texsize:new c.aL(p,t.u_texsize),u_mix:new c.aH(p,t.u_mix),u_pattern_size_a:new c.aL(p,t.u_pattern_size_a),u_pattern_size_b:new c.aL(p,t.u_pattern_size_b),u_scale_a:new c.aH(p,t.u_scale_a),u_scale_b:new c.aH(p,t.u_scale_b),u_pixel_coord_upper:new c.aL(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aL(p,t.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aH(p,t.u_tile_units_to_pixels)}),terrain:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_texture:new c.aG(p,t.u_texture),u_ele_delta:new c.aH(p,t.u_ele_delta)}),terrainDepth:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_ele_delta:new c.aH(p,t.u_ele_delta)}),terrainCoords:(p,t)=>({u_matrix:new c.aI(p,t.u_matrix),u_texture:new c.aG(p,t.u_texture),u_terrain_coords_id:new c.aH(p,t.u_terrain_coords_id),u_ele_delta:new c.aH(p,t.u_ele_delta)})};class lf{constructor(t,a,u){this.context=t;const d=t.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Rs={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Yo{constructor(t,a,u,d){this.length=a.length,this.attributes=u,this.itemSize=a.bytesPerElement,this.dynamicDraw=d,this.context=t;const g=t.gl;this.buffer=g.createBuffer(),t.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,a){for(let u=0;u<this.attributes.length;u++){const d=a.attributes[this.attributes[u].name];d!==void 0&&t.enableVertexAttribArray(d)}}setVertexAttribPointers(t,a,u){for(let d=0;d<this.attributes.length;d++){const g=this.attributes[d],w=a.attributes[g.name];w!==void 0&&t.vertexAttribPointer(w,g.components,t[Rs[g.type]],!1,this.itemSize,g.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ur=new WeakMap;function kr(p){var t;if(Ur.has(p))return Ur.get(p);{const a=(t=p.getParameter(p.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return Ur.set(p,a),a}}class li{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Xo extends li{getDefault(){return c.aO.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Jo extends li{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class ac extends li{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class oc extends li{getDefault(){return[!0,!0,!0,!0]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Qo extends li{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class lc extends li{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class cc extends li{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const a=this.current;(t.func!==a.func||t.ref!==a.ref||t.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class el extends li{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Qu extends li{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=t,this.dirty=!1}}class eh extends li{getDefault(){return[0,1]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class la extends li{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=t,this.dirty=!1}}class cf extends li{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class uf extends li{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.BLEND):a.disable(a.BLEND),this.current=t,this.dirty=!1}}class hf extends li{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class df extends li{getDefault(){return c.aO.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class ff extends li{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class pf extends li{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=t,this.dirty=!1}}class uc extends li{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class tl extends li{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class hc extends li{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class dc extends li{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class ca extends li{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class th extends li{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class ih extends li{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class fc extends li{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Ds extends li{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class rh extends li{getDefault(){return null}set(t){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ua extends li{getDefault(){return null}set(t){var a;if(t===this.current&&!this.dirty)return;const u=this.gl;kr(u)?u.bindVertexArray(t):(a=u.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class ha extends li{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class nh extends li{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class pc extends li{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class ni extends li{constructor(t,a){super(t),this.context=t,this.parent=a}getDefault(){return null}}class il extends ni{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class mf extends ni{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class sh extends ni{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class so{constructor(t,a,u,d,g){this.context=t,this.width=a,this.height=u;const w=t.gl,T=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new il(t,T),d)this.depthAttachment=g?new sh(t,T):new mf(t,T);else if(g)throw new Error("Stencil cannot be set without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,a=this.colorAttachment.get();if(a&&t.deleteTexture(a),this.depthAttachment){const u=this.depthAttachment.get();u&&t.deleteRenderbuffer(u)}t.deleteFramebuffer(this.framebuffer)}}class Xi{constructor(t,a,u){this.blendFunction=t,this.blendColor=a,this.mask=u}}Xi.Replace=[1,0],Xi.disabled=new Xi(Xi.Replace,c.aO.transparent,[!1,!1,!1,!1]),Xi.unblended=new Xi(Xi.Replace,c.aO.transparent,[!0,!0,!0,!0]),Xi.alphaBlended=new Xi([1,771],c.aO.transparent,[!0,!0,!0,!0]);class gf{constructor(t){var a,u;if(this.gl=t,this.clearColor=new Xo(this),this.clearDepth=new Jo(this),this.clearStencil=new ac(this),this.colorMask=new oc(this),this.depthMask=new Qo(this),this.stencilMask=new lc(this),this.stencilFunc=new cc(this),this.stencilOp=new el(this),this.stencilTest=new Qu(this),this.depthRange=new eh(this),this.depthTest=new la(this),this.depthFunc=new cf(this),this.blend=new uf(this),this.blendFunc=new hf(this),this.blendColor=new df(this),this.blendEquation=new ff(this),this.cullFace=new pf(this),this.cullFaceSide=new uc(this),this.frontFace=new tl(this),this.program=new hc(this),this.activeTexture=new dc(this),this.viewport=new ca(this),this.bindFramebuffer=new th(this),this.bindRenderbuffer=new ih(this),this.bindTexture=new fc(this),this.bindVertexBuffer=new Ds(this),this.bindElementBuffer=new rh(this),this.bindVertexArray=new ua(this),this.pixelStoreUnpack=new ha(this),this.pixelStoreUnpackPremultiplyAlpha=new nh(this),this.pixelStoreUnpackFlipY=new pc(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),kr(t)){this.HALF_FLOAT=t.HALF_FLOAT;const d=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=t.RGBA16F)!==null&&a!==void 0?a:d==null?void 0:d.RGBA16F_EXT,this.RGB16F=(u=t.RGB16F)!==null&&u!==void 0?u:d==null?void 0:d.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const d=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=d==null?void 0:d.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,a){return new lf(this,t,a)}createVertexBuffer(t,a,u){return new Yo(this,t,a,u)}createRenderbuffer(t,a,u){const d=this.gl,g=d.createRenderbuffer();return this.bindRenderbuffer.set(g),d.renderbufferStorage(d.RENDERBUFFER,t,a,u),this.bindRenderbuffer.set(null),g}createFramebuffer(t,a,u,d){return new so(this,t,a,u,d)}clear({color:t,depth:a,stencil:u}){const d=this.gl;let g=0;t&&(g|=d.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(g|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),u!==void 0&&(g|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),d.clear(g)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){c.aD(t.blendFunction,Xi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return kr(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var a;return kr(this.gl)?this.gl.deleteVertexArray(t):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class ri{constructor(t,a,u){this.func=t,this.mask=a,this.range=u}}ri.ReadOnly=!1,ri.ReadWrite=!0,ri.disabled=new ri(519,ri.ReadOnly,[0,1]);const mc=7680;class Mi{constructor(t,a,u,d,g,w){this.test=t,this.ref=a,this.mask=u,this.fail=d,this.depthFail=g,this.pass=w}}Mi.disabled=new Mi({func:519,mask:0},0,0,mc,mc,mc);class Ti{constructor(t,a,u){this.enable=t,this.mode=a,this.frontFace=u}}let zs;function rl(p,t,a,u,d,g,w){const T=p.context,E=T.gl,C=p.useProgram("collisionBox"),k=[];let F=0,j=0;for(let ne=0;ne<u.length;ne++){const ge=u[ne],Ie=t.getTile(ge),Ee=Ie.getBucket(a);if(!Ee)continue;let Fe=ge.posMatrix;d[0]===0&&d[1]===0||(Fe=p.translatePosMatrix(ge.posMatrix,Ie,d,g));const je=w?Ee.textCollisionBox:Ee.iconCollisionBox,Ue=Ee.collisionCircleArray;if(Ue.length>0){const Ze=c.F(),dt=Fe;c.aP(Ze,Ee.placementInvProjMatrix,p.transform.glCoordMatrix),c.aP(Ze,Ze,Ee.placementViewportMatrix),k.push({circleArray:Ue,circleOffset:j,transform:dt,invTransform:Ze,coord:ge}),F+=Ue.length/4,j=F}je&&C.draw(T,E.LINES,ri.disabled,Mi.disabled,p.colorModeForRenderPass(),Ti.disabled,Wu(Fe,p.transform,Ie),p.style.map.terrain&&p.style.map.terrain.getTerrainData(ge),a.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,null,p.transform.zoom,null,null,je.collisionVertexBuffer)}if(!w||!k.length)return;const Q=p.useProgram("collisionCircle"),X=new c.aQ;X.resize(4*F),X._trim();let ee=0;for(const ne of k)for(let ge=0;ge<ne.circleArray.length/4;ge++){const Ie=4*ge,Ee=ne.circleArray[Ie+0],Fe=ne.circleArray[Ie+1],je=ne.circleArray[Ie+2],Ue=ne.circleArray[Ie+3];X.emplace(ee++,Ee,Fe,je,Ue,0),X.emplace(ee++,Ee,Fe,je,Ue,1),X.emplace(ee++,Ee,Fe,je,Ue,2),X.emplace(ee++,Ee,Fe,je,Ue,3)}(!zs||zs.length<2*F)&&(zs=function(ne){const ge=2*ne,Ie=new c.aS;Ie.resize(ge),Ie._trim();for(let Ee=0;Ee<ge;Ee++){const Fe=6*Ee;Ie.uint16[Fe+0]=4*Ee+0,Ie.uint16[Fe+1]=4*Ee+1,Ie.uint16[Fe+2]=4*Ee+2,Ie.uint16[Fe+3]=4*Ee+2,Ie.uint16[Fe+4]=4*Ee+3,Ie.uint16[Fe+5]=4*Ee+0}return Ie}(F));const W=T.createIndexBuffer(zs,!0),he=T.createVertexBuffer(X,c.aR.members,!0);for(const ne of k){const ge={u_matrix:ne.transform,u_inv_matrix:ne.invTransform,u_camera_to_center_distance:(Te=p.transform).cameraToCenterDistance,u_viewport_size:[Te.width,Te.height]};Q.draw(T,E.TRIANGLES,ri.disabled,Mi.disabled,p.colorModeForRenderPass(),Ti.disabled,ge,p.style.map.terrain&&p.style.map.terrain.getTerrainData(ne.coord),a.id,he,W,c.$.simpleSegment(0,2*ne.circleOffset,ne.circleArray.length,ne.circleArray.length/2),null,p.transform.zoom,null,null,null)}var Te;he.destroy(),W.destroy()}Ti.disabled=new Ti(!1,1029,2305),Ti.backCCW=new Ti(!0,1029,2305);const gc=c.an(new Float32Array(16));function ah(p,t,a,u,d,g){const{horizontalAlign:w,verticalAlign:T}=c.at(p);return new c.P((-(w-.5)*t/d+u[0])*g,(-(T-.5)*a/d+u[1])*g)}function nl(p,t,a,u,d,g,w,T,E,C,k){const F=p.text.placedSymbolArray,j=p.text.dynamicLayoutVertexArray,Q=p.icon.dynamicLayoutVertexArray,X={};j.clear();for(let ee=0;ee<F.length;ee++){const W=F.get(ee),he=W.hidden||!W.crossTileID||p.allowVerticalPlacement&&!W.placedOrientation?null:u[W.crossTileID];if(he){const Te=new c.P(W.anchorX,W.anchorY),ne=or(Te,a?w:g,k),ge=ie(d.cameraToCenterDistance,ne.signedDistanceFromCamera);let Ie=c.ai(p.textSizeData,E,W)*ge/c.ao;a&&(Ie*=p.tilePixelRatio/T);const{width:Ee,height:Fe,anchor:je,textOffset:Ue,textBoxScale:Ze}=he,dt=ah(je,Ee,Fe,Ue,Ze,Ie),Pt=a?or(Te.add(dt),g,k).point:ne.point.add(t?dt.rotate(-d.angle):dt),tt=p.allowVerticalPlacement&&W.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let At=0;At<W.numGlyphs;At++)c.aj(j,Pt,tt);C&&W.associatedIconIndex>=0&&(X[W.associatedIconIndex]={shiftedAnchor:Pt,angle:tt})}else ze(W.numGlyphs,j)}if(C){Q.clear();const ee=p.icon.placedSymbolArray;for(let W=0;W<ee.length;W++){const he=ee.get(W);if(he.hidden)ze(he.numGlyphs,Q);else{const Te=X[W];if(Te)for(let ne=0;ne<he.numGlyphs;ne++)c.aj(Q,Te.shiftedAnchor,Te.angle);else ze(he.numGlyphs,Q)}}p.icon.dynamicLayoutVertexBuffer.updateData(Q)}p.text.dynamicLayoutVertexBuffer.updateData(j)}function sl(p,t,a){return a.iconsInText&&t?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function al(p,t,a,u,d,g,w,T,E,C,k,F){const j=p.context,Q=j.gl,X=p.transform,ee=T==="map",W=E==="map",he=T!=="viewport"&&a.layout.get("symbol-placement")!=="point",Te=ee&&!W&&!he,ne=!a.layout.get("symbol-sort-key").isConstant();let ge=!1;const Ie=p.depthModeForSublayer(0,ri.ReadOnly),Ee=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Fe=[];for(const je of u){const Ue=t.getTile(je),Ze=Ue.getBucket(a);if(!Ze)continue;const dt=d?Ze.text:Ze.icon;if(!dt||!dt.segments.get().length||!dt.hasVisibleVertices)continue;const Pt=dt.programConfigurations.get(a.id),tt=d||Ze.sdfIcons,At=d?Ze.textSizeData:Ze.iconSizeData,mt=W||X.pitch!==0,Li=p.useProgram(sl(tt,d,Ze),Pt),Jt=c.ag(At,X.zoom),$t=p.style.map.terrain&&p.style.map.terrain.getTerrainData(je);let Qt,Qi,wi,Hr,xr=[0,0],Gi=null;if(d)Qi=Ue.glyphAtlasTexture,wi=Q.LINEAR,Qt=Ue.glyphAtlasTexture.size,Ze.iconsInText&&(xr=Ue.imageAtlasTexture.size,Gi=Ue.imageAtlasTexture,Hr=mt||p.options.rotating||p.options.zooming||At.kind==="composite"||At.kind==="camera"?Q.LINEAR:Q.NEAREST);else{const Ri=a.layout.get("icon-size").constantOr(0)!==1||Ze.iconsNeedLinear;Qi=Ue.imageAtlasTexture,wi=tt||p.options.rotating||p.options.zooming||Ri||mt?Q.LINEAR:Q.NEAREST,Qt=Ue.imageAtlasTexture.size}const Lr=zt(Ue,1,p.transform.zoom),Rr=Ft(je.posMatrix,W,ee,p.transform,Lr),Pn=ks(je.posMatrix,W,ee,p.transform,Lr),ys=Ee&&Ze.hasTextData(),_a=a.layout.get("icon-text-fit")!=="none"&&ys&&Ze.hasIconData();if(he){const Ri=p.style.map.terrain?(br,hr)=>p.style.map.terrain.getElevation(je,br,hr):null,ur=a.layout.get("text-rotation-alignment")==="map";U(Ze,je.posMatrix,p,d,Rr,Pn,W,C,ur,Ri)}const ya=p.translatePosMatrix(je.posMatrix,Ue,g,w),vs=he||d&&Ee||_a?gc:Rr,cr=p.translatePosMatrix(Pn,Ue,g,w,!0),er=tt&&a.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let qi;qi=tt?Ze.iconsInText?no(At.kind,Jt,Te,W,p,ya,vs,cr,Qt,xr):ro(At.kind,Jt,Te,W,p,ya,vs,cr,d,Qt,!0):io(At.kind,Jt,Te,W,p,ya,vs,cr,d,Qt);const Gr={program:Li,buffers:dt,uniformValues:qi,atlasTexture:Qi,atlasTextureIcon:Gi,atlasInterpolation:wi,atlasInterpolationIcon:Hr,isSDF:tt,hasHalo:er};if(ne&&Ze.canOverlap){ge=!0;const Ri=dt.segments.get();for(const ur of Ri)Fe.push({segments:new c.$([ur]),sortKey:ur.sortKey,state:Gr,terrainData:$t})}else Fe.push({segments:dt.segments,sortKey:0,state:Gr,terrainData:$t})}ge&&Fe.sort((je,Ue)=>je.sortKey-Ue.sortKey);for(const je of Fe){const Ue=je.state;if(j.activeTexture.set(Q.TEXTURE0),Ue.atlasTexture.bind(Ue.atlasInterpolation,Q.CLAMP_TO_EDGE),Ue.atlasTextureIcon&&(j.activeTexture.set(Q.TEXTURE1),Ue.atlasTextureIcon&&Ue.atlasTextureIcon.bind(Ue.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),Ue.isSDF){const Ze=Ue.uniformValues;Ue.hasHalo&&(Ze.u_is_halo=1,oh(Ue.buffers,je.segments,a,p,Ue.program,Ie,k,F,Ze,je.terrainData)),Ze.u_is_halo=0}oh(Ue.buffers,je.segments,a,p,Ue.program,Ie,k,F,Ue.uniformValues,je.terrainData)}}function oh(p,t,a,u,d,g,w,T,E,C){const k=u.context;d.draw(k,k.gl.TRIANGLES,g,w,T,Ti.disabled,E,C,a.id,p.layoutVertexBuffer,p.indexBuffer,t,a.paint,u.transform.zoom,p.programConfigurations.get(a.id),p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer)}function ol(p,t,a,u,d){if(!a||!u||!u.imageAtlas)return;const g=u.imageAtlas.patternPositions;let w=g[a.to.toString()],T=g[a.from.toString()];if(!w&&T&&(w=T),!T&&w&&(T=w),!w||!T){const E=d.getPaintProperty(t);w=g[E],T=g[E]}w&&T&&p.setConstantPatternPositions(w,T)}function lh(p,t,a,u,d,g,w){const T=p.context.gl,E="fill-pattern",C=a.paint.get(E),k=C&&C.constantOr(1),F=a.getCrossfadeParameters();let j,Q,X,ee,W;w?(Q=k&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=T.LINES):(Q=k?"fillPattern":"fill",j=T.TRIANGLES);const he=C.constantOr(null);for(const Te of u){const ne=t.getTile(Te);if(k&&!ne.patternsLoaded())continue;const ge=ne.getBucket(a);if(!ge)continue;const Ie=ge.programConfigurations.get(a.id),Ee=p.useProgram(Q,Ie),Fe=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Te);k&&(p.context.activeTexture.set(T.TEXTURE0),ne.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),Ie.updatePaintBuffers(F)),ol(Ie,E,he,ne,a);const je=Fe?Te:null,Ue=p.translatePosMatrix(je?je.posMatrix:Te.posMatrix,ne,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(w){ee=ge.indexBuffer2,W=ge.segments2;const Ze=[T.drawingBufferWidth,T.drawingBufferHeight];X=Q==="fillOutlinePattern"&&k?qu(Ue,p,F,ne,Ze):nf(Ue,Ze)}else ee=ge.indexBuffer,W=ge.segments,X=k?Go(Ue,p,F,ne):Gu(Ue);Ee.draw(p.context,j,d,p.stencilModeForClipping(Te),g,Ti.disabled,X,Fe,a.id,ge.layoutVertexBuffer,ee,W,a.paint,p.transform.zoom,Ie)}}function ll(p,t,a,u,d,g,w){const T=p.context,E=T.gl,C="fill-extrusion-pattern",k=a.paint.get(C),F=k.constantOr(1),j=a.getCrossfadeParameters(),Q=a.paint.get("fill-extrusion-opacity"),X=k.constantOr(null);for(const ee of u){const W=t.getTile(ee),he=W.getBucket(a);if(!he)continue;const Te=p.style.map.terrain&&p.style.map.terrain.getTerrainData(ee),ne=he.programConfigurations.get(a.id),ge=p.useProgram(F?"fillExtrusionPattern":"fillExtrusion",ne);F&&(p.context.activeTexture.set(E.TEXTURE0),W.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),ne.updatePaintBuffers(j)),ol(ne,C,X,W,a);const Ie=p.translatePosMatrix(ee.posMatrix,W,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Ee=a.paint.get("fill-extrusion-vertical-gradient"),Fe=F?rf(Ie,p,Ee,Q,ee,j,W):Qa(Ie,p,Ee,Q);ge.draw(T,T.gl.TRIANGLES,d,g,w,Ti.backCCW,Fe,Te,a.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,a.paint,p.transform.zoom,ne,p.style.map.terrain&&he.centroidVertexBuffer)}}function cl(p,t,a,u,d,g,w){const T=p.context,E=T.gl,C=a.fbo;if(!C)return;const k=p.useProgram("hillshade"),F=p.style.map.terrain&&p.style.map.terrain.getTerrainData(t);T.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,C.colorAttachment.get()),k.draw(T,E.TRIANGLES,d,g,w,Ti.disabled,((j,Q,X,ee)=>{const W=X.paint.get("hillshade-shadow-color"),he=X.paint.get("hillshade-highlight-color"),Te=X.paint.get("hillshade-accent-color");let ne=X.paint.get("hillshade-illumination-direction")*(Math.PI/180);X.paint.get("hillshade-illumination-anchor")==="viewport"&&(ne-=j.transform.angle);const ge=!j.options.moving;return{u_matrix:ee?ee.posMatrix:j.transform.calculatePosMatrix(Q.tileID.toUnwrapped(),ge),u_image:0,u_latrange:Yu(0,Q.tileID),u_light:[X.paint.get("hillshade-exaggeration"),ne],u_shadow:W,u_highlight:he,u_accent:Te}})(p,a,u,F?t:null),F,u.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments)}function _c(p,t,a,u,d,g){const w=p.context,T=w.gl,E=t.dem;if(E&&E.data){const C=E.dim,k=E.stride,F=E.getPixels();if(w.activeTexture.set(T.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||p.getTileTexture(k),t.demTexture){const Q=t.demTexture;Q.update(F,{premultiply:!1}),Q.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else t.demTexture=new He(w,F,T.RGBA,{premultiply:!1}),t.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);w.activeTexture.set(T.TEXTURE0);let j=t.fbo;if(!j){const Q=new He(w,{width:C,height:C,data:null},T.RGBA);Q.bind(T.LINEAR,T.CLAMP_TO_EDGE),j=t.fbo=w.createFramebuffer(C,C,!0,!1),j.colorAttachment.set(Q.texture)}w.bindFramebuffer.set(j.framebuffer),w.viewport.set([0,0,C,C]),p.useProgram("hillshadePrepare").draw(w,T.TRIANGLES,u,d,g,Ti.disabled,((Q,X)=>{const ee=X.stride,W=c.F();return c.aN(W,0,c.W,-c.W,0,0,1),c.H(W,W,[0,-c.W,0]),{u_matrix:W,u_image:1,u_dimension:[ee,ee],u_zoom:Q.overscaledZ,u_unpack:X.getUnpackVector()}})(t.tileID,E),null,a.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function ch(p,t,a,u,d,g){const w=u.paint.get("raster-fade-duration");if(!g&&w>0){const T=B.now(),E=(T-p.timeAdded)/w,C=t?(T-t.timeAdded)/w:-1,k=a.getSource(),F=d.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),j=!t||Math.abs(t.tileID.overscaledZ-F)>Math.abs(p.tileID.overscaledZ-F),Q=j&&p.refreshedUponExpiration?1:c.ac(j?E:1-C,0,1);return p.refreshedUponExpiration&&E>=1&&(p.refreshedUponExpiration=!1),t?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}const uh=new c.aO(1,0,0,1),ul=new c.aO(0,1,0,1),yc=new c.aO(0,0,1,1),_f=new c.aO(1,0,1,1),hh=new c.aO(0,1,1,1);function ji(p,t,a,u){$r(p,0,t+a/2,p.transform.width,a,u)}function ms(p,t,a,u){$r(p,t-a/2,0,a,p.transform.height,u)}function $r(p,t,a,u,d,g){const w=p.context,T=w.gl;T.enable(T.SCISSOR_TEST),T.scissor(t*p.pixelRatio,a*p.pixelRatio,u*p.pixelRatio,d*p.pixelRatio),w.clear({color:g}),T.disable(T.SCISSOR_TEST)}function vc(p,t,a){const u=p.context,d=u.gl,g=a.posMatrix,w=p.useProgram("debug"),T=ri.disabled,E=Mi.disabled,C=p.colorModeForRenderPass(),k="$debug",F=p.style.map.terrain&&p.style.map.terrain.getTerrainData(a);u.activeTexture.set(d.TEXTURE0);const j=t.getTileByID(a.key).latestRawTileData,Q=Math.floor((j&&j.byteLength||0)/1024),X=t.getTile(a).tileSize,ee=512/Math.min(X,512)*(a.overscaledZ/p.transform.zoom)*.5;let W=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(W+=` => ${a.overscaledZ}`),function(he,Te){he.initDebugOverlayCanvas();const ne=he.debugOverlayCanvas,ge=he.context.gl,Ie=he.debugOverlayCanvas.getContext("2d");Ie.clearRect(0,0,ne.width,ne.height),Ie.shadowColor="white",Ie.shadowBlur=2,Ie.lineWidth=1.5,Ie.strokeStyle="white",Ie.textBaseline="top",Ie.font="bold 36px Open Sans, sans-serif",Ie.fillText(Te,5,5),Ie.strokeText(Te,5,5),he.debugOverlayTexture.update(ne),he.debugOverlayTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE)}(p,`${W} ${Q}kB`),w.draw(u,d.TRIANGLES,T,E,Xi.alphaBlended,Ti.disabled,Zu(g,c.aO.transparent,ee),null,k,p.debugBuffer,p.quadTriangleIndexBuffer,p.debugSegments),w.draw(u,d.LINE_STRIP,T,E,C,Ti.disabled,Zu(g,c.aO.red),F,k,p.debugBuffer,p.tileBorderIndexBuffer,p.debugSegments)}function hl(p,t,a){const u=p.context,d=u.gl,g=p.colorModeForRenderPass(),w=new ri(d.LEQUAL,ri.ReadWrite,p.depthRangeFor3D),T=p.useProgram("terrain"),E=t.getTerrainMesh();u.bindFramebuffer.set(null),u.viewport.set([0,0,p.width,p.height]);for(const C of a){const k=p.renderToTexture.getTexture(C),F=t.getTerrainData(C.tileID);u.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,k.texture);const j={u_matrix:p.transform.calculatePosMatrix(C.tileID.toUnwrapped()),u_texture:0,u_ele_delta:t.getMeshFrameDelta(p.transform.zoom)};T.draw(u,d.TRIANGLES,w,Mi.disabled,g,Ti.backCCW,j,F,"terrain",E.vertexBuffer,E.indexBuffer,E.segments)}}class dh{constructor(t,a){this.context=new gf(t),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.F(),renderTime:0},this.setup(),this.numSublayers=rr.maxUnderzooming+rr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new fs}resize(t,a,u){if(this.width=Math.floor(t*u),this.height=Math.floor(a*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const t=this.context,a=new c.aV;a.emplaceBack(0,0),a.emplaceBack(c.W,0),a.emplaceBack(0,c.W),a.emplaceBack(c.W,c.W),this.tileExtentBuffer=t.createVertexBuffer(a,$o.members),this.tileExtentSegments=c.$.simpleSegment(0,0,4,2);const u=new c.aV;u.emplaceBack(0,0),u.emplaceBack(c.W,0),u.emplaceBack(0,c.W),u.emplaceBack(c.W,c.W),this.debugBuffer=t.createVertexBuffer(u,$o.members),this.debugSegments=c.$.simpleSegment(0,0,4,5);const d=new c.Z;d.emplaceBack(0,0,0,0),d.emplaceBack(c.W,0,c.W,0),d.emplaceBack(0,c.W,0,c.W),d.emplaceBack(c.W,c.W,c.W,c.W),this.rasterBoundsBuffer=t.createVertexBuffer(d,Ke.members),this.rasterBoundsSegments=c.$.simpleSegment(0,0,4,2);const g=new c.aV;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(g,$o.members),this.viewportSegments=c.$.simpleSegment(0,0,4,2);const w=new c.aW;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(w);const T=new c.aX;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(T);const E=this.context.gl;this.stencilClearMode=new Mi({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)}clearStencil(){const t=this.context,a=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=c.F();c.aN(u,0,this.width,this.height,0,0,1),c.J(u,u,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,a.TRIANGLES,ri.disabled,this.stencilClearMode,Xi.disabled,Ti.disabled,qo(u),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,a){if(this.currentStencilSource===t.source||!t.isTileClipped()||!a||!a.length)return;this.currentStencilSource=t.source;const u=this.context,d=u.gl;this.nextStencilID+a.length>256&&this.clearStencil(),u.setColorMode(Xi.disabled),u.setDepthMode(ri.disabled);const g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of a){const T=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,E=this.style.map.terrain&&this.style.map.terrain.getTerrainData(w);g.draw(u,d.TRIANGLES,ri.disabled,new Mi({func:d.ALWAYS,mask:0},T,255,d.KEEP,d.KEEP,d.REPLACE),Xi.disabled,Ti.disabled,qo(w.posMatrix),E,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,a=this.context.gl;return new Mi({func:a.NOTEQUAL,mask:255},t,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(t){const a=this.context.gl;return new Mi({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(t){const a=this.context.gl,u=t.sort((w,T)=>T.overscaledZ-w.overscaledZ),d=u[u.length-1].overscaledZ,g=u[0].overscaledZ-d+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const w={};for(let T=0;T<g;T++)w[T+d]=new Mi({func:a.GEQUAL,mask:255},T+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=g,[w,u]}return[{[d]:Mi.disabled},u]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Xi([t.CONSTANT_COLOR,t.ONE],new c.aO(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Xi.unblended:Xi.alphaBlended}depthModeForSublayer(t,a,u){if(!this.opaquePassEnabledForLayer())return ri.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new ri(u||this.context.gl.LEQUAL,a,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,a){this.style=t,this.options=a,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(B.now()),this.imageManager.beginFrame();const u=this.style._order,d=this.style.sourceCaches,g={},w={},T={};for(const E in d){const C=d[E];C.used&&C.prepare(this.context),g[E]=C.getVisibleCoordinates(),w[E]=g[E].slice().reverse(),T[E]=C.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let E=0;E<u.length;E++)if(this.style._layers[u[E]].is3D()){this.opaquePassCutoff=E;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const E=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!c.aY(this.terrainFacilitator.matrix,this.transform.projMatrix)||E.length)&&(c.aZ(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(C,k){const F=C.context,j=F.gl,Q=Xi.unblended,X=new ri(j.LEQUAL,ri.ReadWrite,[0,1]),ee=k.getTerrainMesh(),W=k.sourceCache.getRenderableTiles(),he=C.useProgram("terrainDepth");F.bindFramebuffer.set(k.getFramebuffer("depth").framebuffer),F.viewport.set([0,0,C.width/devicePixelRatio,C.height/devicePixelRatio]),F.clear({color:c.aO.transparent,depth:1});for(const Te of W){const ne=k.getTerrainData(Te.tileID),ge={u_matrix:C.transform.calculatePosMatrix(Te.tileID.toUnwrapped()),u_ele_delta:k.getMeshFrameDelta(C.transform.zoom)};he.draw(F,j.TRIANGLES,X,Mi.disabled,Q,Ti.backCCW,ge,ne,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments)}F.bindFramebuffer.set(null),F.viewport.set([0,0,C.width,C.height])}(this,this.style.map.terrain),function(C,k){const F=C.context,j=F.gl,Q=Xi.unblended,X=new ri(j.LEQUAL,ri.ReadWrite,[0,1]),ee=k.getTerrainMesh(),W=k.getCoordsTexture(),he=k.sourceCache.getRenderableTiles(),Te=C.useProgram("terrainCoords");F.bindFramebuffer.set(k.getFramebuffer("coords").framebuffer),F.viewport.set([0,0,C.width/devicePixelRatio,C.height/devicePixelRatio]),F.clear({color:c.aO.transparent,depth:1}),k.coordsIndex=[];for(const ne of he){const ge=k.getTerrainData(ne.tileID);F.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,W.texture);const Ie={u_matrix:C.transform.calculatePosMatrix(ne.tileID.toUnwrapped()),u_terrain_coords_id:(255-k.coordsIndex.length)/255,u_texture:0,u_ele_delta:k.getMeshFrameDelta(C.transform.zoom)};Te.draw(F,j.TRIANGLES,X,Mi.disabled,Q,Ti.backCCW,Ie,ge,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments),k.coordsIndex.push(ne.tileID.key)}F.bindFramebuffer.set(null),F.viewport.set([0,0,C.width,C.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const E of u){const C=this.style._layers[E];if(!C.hasOffscreenPass()||C.isHidden(this.transform.zoom))continue;const k=w[C.source];(C.type==="custom"||k.length)&&this.renderLayer(this,d[C.source],C,k)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.aO.black:c.aO.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const E=this.style._layers[u[this.currentLayer]],C=d[E.source],k=g[E.source];this._renderTileClippingMasks(E,k),this.renderLayer(this,C,E,k)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const E=this.style._layers[u[this.currentLayer]],C=d[E.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(E))continue;const k=(E.type==="symbol"?T:w)[E.source];this._renderTileClippingMasks(E,g[E.source]),this.renderLayer(this,C,E,k)}if(this.options.showTileBoundaries){const E=function(C,k){let F=null;const j=Object.values(C._layers).flatMap(W=>W.source&&!W.isHidden(k)?[C.sourceCaches[W.source]]:[]),Q=j.filter(W=>W.getSource().type==="vector"),X=j.filter(W=>W.getSource().type!=="vector"),ee=W=>{(!F||F.getSource().maxzoom<W.getSource().maxzoom)&&(F=W)};return Q.forEach(W=>ee(W)),F||X.forEach(W=>ee(W)),F}(this.style,this.transform.zoom);E&&function(C,k,F){for(let j=0;j<F.length;j++)vc(C,k,F[j])}(this,E,E.getVisibleCoordinates())}this.options.showPadding&&function(E){const C=E.transform.padding;ji(E,E.transform.height-(C.top||0),3,uh),ji(E,C.bottom||0,3,ul),ms(E,C.left||0,3,yc),ms(E,E.transform.width-(C.right||0),3,_f);const k=E.transform.centerPoint;(function(F,j,Q,X){$r(F,j-1,Q-10,2,20,X),$r(F,j-10,Q-1,20,2,X)})(E,k.x,E.transform.height-k.y,hh)}(this),this.context.setDefault()}renderLayer(t,a,u,d){if(!u.isHidden(this.transform.zoom)&&(u.type==="background"||u.type==="custom"||(d||[]).length))switch(this.id=u.id,u.type){case"symbol":(function(g,w,T,E,C){if(g.renderPass!=="translucent")return;const k=Mi.disabled,F=g.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(j,Q,X,ee,W,he,Te){const ne=Q.transform,ge=W==="map",Ie=he==="map";for(const Ee of j){const Fe=ee.getTile(Ee),je=Fe.getBucket(X);if(!je||!je.text||!je.text.segments.get().length)continue;const Ue=c.ag(je.textSizeData,ne.zoom),Ze=zt(Fe,1,Q.transform.zoom),dt=Ft(Ee.posMatrix,Ie,ge,Q.transform,Ze),Pt=X.layout.get("icon-text-fit")!=="none"&&je.hasIconData();if(Ue){const tt=Math.pow(2,ne.zoom-Fe.tileID.overscaledZ);nl(je,ge,Ie,Te,ne,dt,Ee.posMatrix,tt,Ue,Pt,Q.style.map.terrain?(At,mt)=>Q.style.map.terrain.getElevation(Ee,At,mt):null)}}}(E,g,T,w,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),C),T.paint.get("icon-opacity").constantOr(1)!==0&&al(g,w,T,E,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),k,F),T.paint.get("text-opacity").constantOr(1)!==0&&al(g,w,T,E,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),k,F),w.map.showCollisionBoxes&&(rl(g,w,T,E,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),!0),rl(g,w,T,E,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),!1))})(t,a,u,d,this.style.placement.variableOffsets);break;case"circle":(function(g,w,T,E){if(g.renderPass!=="translucent")return;const C=T.paint.get("circle-opacity"),k=T.paint.get("circle-stroke-width"),F=T.paint.get("circle-stroke-opacity"),j=!T.layout.get("circle-sort-key").isConstant();if(C.constantOr(1)===0&&(k.constantOr(1)===0||F.constantOr(1)===0))return;const Q=g.context,X=Q.gl,ee=g.depthModeForSublayer(0,ri.ReadOnly),W=Mi.disabled,he=g.colorModeForRenderPass(),Te=[];for(let ne=0;ne<E.length;ne++){const ge=E[ne],Ie=w.getTile(ge),Ee=Ie.getBucket(T);if(!Ee)continue;const Fe=Ee.programConfigurations.get(T.id),je=g.useProgram("circle",Fe),Ue=Ee.layoutVertexBuffer,Ze=Ee.indexBuffer,dt=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ge),Pt={programConfiguration:Fe,program:je,layoutVertexBuffer:Ue,indexBuffer:Ze,uniformValues:sf(g,ge,Ie,T),terrainData:dt};if(j){const tt=Ee.segments.get();for(const At of tt)Te.push({segments:new c.$([At]),sortKey:At.sortKey,state:Pt})}else Te.push({segments:Ee.segments,sortKey:0,state:Pt})}j&&Te.sort((ne,ge)=>ne.sortKey-ge.sortKey);for(const ne of Te){const{programConfiguration:ge,program:Ie,layoutVertexBuffer:Ee,indexBuffer:Fe,uniformValues:je,terrainData:Ue}=ne.state;Ie.draw(Q,X.TRIANGLES,ee,W,he,Ti.disabled,je,Ue,T.id,Ee,Fe,ne.segments,T.paint,g.transform.zoom,ge)}})(t,a,u,d);break;case"heatmap":(function(g,w,T,E){if(T.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const C=g.context,k=C.gl,F=Mi.disabled,j=new Xi([k.ONE,k.ONE],c.aO.transparent,[!0,!0,!0,!0]);(function(Q,X,ee){const W=Q.gl;Q.activeTexture.set(W.TEXTURE1),Q.viewport.set([0,0,X.width/4,X.height/4]);let he=ee.heatmapFbo;if(he)W.bindTexture(W.TEXTURE_2D,he.colorAttachment.get()),Q.bindFramebuffer.set(he.framebuffer);else{const Te=W.createTexture();W.bindTexture(W.TEXTURE_2D,Te),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MIN_FILTER,W.LINEAR),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MAG_FILTER,W.LINEAR),he=ee.heatmapFbo=Q.createFramebuffer(X.width/4,X.height/4,!1,!1),function(ne,ge,Ie,Ee){var Fe,je;const Ue=ne.gl,Ze=(Fe=ne.HALF_FLOAT)!==null&&Fe!==void 0?Fe:Ue.UNSIGNED_BYTE,dt=(je=ne.RGBA16F)!==null&&je!==void 0?je:Ue.RGBA;Ue.texImage2D(Ue.TEXTURE_2D,0,dt,ge.width/4,ge.height/4,0,Ue.RGBA,Ze,null),Ee.colorAttachment.set(Ie)}(Q,X,Te,he)}})(C,g,T),C.clear({color:c.aO.transparent});for(let Q=0;Q<E.length;Q++){const X=E[Q];if(w.hasRenderableParent(X))continue;const ee=w.getTile(X),W=ee.getBucket(T);if(!W)continue;const he=W.programConfigurations.get(T.id),Te=g.useProgram("heatmap",he),{zoom:ne}=g.transform;Te.draw(C,k.TRIANGLES,ri.disabled,F,j,Ti.disabled,Ku(X.posMatrix,ee,ne,T.paint.get("heatmap-intensity")),null,T.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,T.paint,g.transform.zoom,he)}C.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(C,k){const F=C.context,j=F.gl,Q=k.heatmapFbo;if(!Q)return;F.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,Q.colorAttachment.get()),F.activeTexture.set(j.TEXTURE1);let X=k.colorRampTexture;X||(X=k.colorRampTexture=new He(F,k.colorRamp,j.RGBA)),X.bind(j.LINEAR,j.CLAMP_TO_EDGE),C.useProgram("heatmapTexture").draw(F,j.TRIANGLES,ri.disabled,Mi.disabled,C.colorModeForRenderPass(),Ti.disabled,((ee,W,he,Te)=>{const ne=c.F();c.aN(ne,0,ee.width,ee.height,0,0,1);const ge=ee.context.gl;return{u_matrix:ne,u_world:[ge.drawingBufferWidth,ge.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:W.paint.get("heatmap-opacity")}})(C,k),null,k.id,C.viewportBuffer,C.quadTriangleIndexBuffer,C.viewportSegments,k.paint,C.transform.zoom)}(g,T))})(t,a,u,d);break;case"line":(function(g,w,T,E){if(g.renderPass!=="translucent")return;const C=T.paint.get("line-opacity"),k=T.paint.get("line-width");if(C.constantOr(1)===0||k.constantOr(1)===0)return;const F=g.depthModeForSublayer(0,ri.ReadOnly),j=g.colorModeForRenderPass(),Q=T.paint.get("line-dasharray"),X=T.paint.get("line-pattern"),ee=X.constantOr(1),W=T.paint.get("line-gradient"),he=T.getCrossfadeParameters(),Te=ee?"linePattern":Q?"lineSDF":W?"lineGradient":"line",ne=g.context,ge=ne.gl;let Ie=!0;for(const Ee of E){const Fe=w.getTile(Ee);if(ee&&!Fe.patternsLoaded())continue;const je=Fe.getBucket(T);if(!je)continue;const Ue=je.programConfigurations.get(T.id),Ze=g.context.program.get(),dt=g.useProgram(Te,Ue),Pt=Ie||dt.program!==Ze,tt=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Ee),At=X.constantOr(null);if(At&&Fe.imageAtlas){const Jt=Fe.imageAtlas,$t=Jt.patternPositions[At.to.toString()],Qt=Jt.patternPositions[At.from.toString()];$t&&Qt&&Ue.setConstantPatternPositions($t,Qt)}const mt=tt?Ee:null,Li=ee?Ls(g,Fe,T,he,mt):Q?Zo(g,Fe,T,Q,he,mt):W?Xu(g,Fe,T,je.lineClipsArray.length,mt):Wo(g,Fe,T,mt);if(ee)ne.activeTexture.set(ge.TEXTURE0),Fe.imageAtlasTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE),Ue.updatePaintBuffers(he);else if(Q&&(Pt||g.lineAtlas.dirty))ne.activeTexture.set(ge.TEXTURE0),g.lineAtlas.bind(ne);else if(W){const Jt=je.gradients[T.id];let $t=Jt.texture;if(T.gradientVersion!==Jt.version){let Qt=256;if(T.stepInterpolant){const Qi=w.getSource().maxzoom,wi=Ee.canonical.z===Qi?Math.ceil(1<<g.transform.maxZoom-Ee.canonical.z):1;Qt=c.ac(c.aT(je.maxLineLength/c.W*1024*wi),256,ne.maxTextureSize)}Jt.gradient=c.aU({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:Qt,image:Jt.gradient||void 0,clips:je.lineClipsArray}),Jt.texture?Jt.texture.update(Jt.gradient):Jt.texture=new He(ne,Jt.gradient,ge.RGBA),Jt.version=T.gradientVersion,$t=Jt.texture}ne.activeTexture.set(ge.TEXTURE0),$t.bind(T.stepInterpolant?ge.NEAREST:ge.LINEAR,ge.CLAMP_TO_EDGE)}dt.draw(ne,ge.TRIANGLES,F,g.stencilModeForClipping(Ee),j,Ti.disabled,Li,tt,T.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,T.paint,g.transform.zoom,Ue,je.layoutVertexBuffer2),Ie=!1}})(t,a,u,d);break;case"fill":(function(g,w,T,E){const C=T.paint.get("fill-color"),k=T.paint.get("fill-opacity");if(k.constantOr(1)===0)return;const F=g.colorModeForRenderPass(),j=T.paint.get("fill-pattern"),Q=g.opaquePassEnabledForLayer()&&!j.constantOr(1)&&C.constantOr(c.aO.transparent).a===1&&k.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===Q){const X=g.depthModeForSublayer(1,g.renderPass==="opaque"?ri.ReadWrite:ri.ReadOnly);lh(g,w,T,E,X,F,!1)}if(g.renderPass==="translucent"&&T.paint.get("fill-antialias")){const X=g.depthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,ri.ReadOnly);lh(g,w,T,E,X,F,!0)}})(t,a,u,d);break;case"fill-extrusion":(function(g,w,T,E){const C=T.paint.get("fill-extrusion-opacity");if(C!==0&&g.renderPass==="translucent"){const k=new ri(g.context.gl.LEQUAL,ri.ReadWrite,g.depthRangeFor3D);if(C!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))ll(g,w,T,E,k,Mi.disabled,Xi.disabled),ll(g,w,T,E,k,g.stencilModeFor3D(),g.colorModeForRenderPass());else{const F=g.colorModeForRenderPass();ll(g,w,T,E,k,Mi.disabled,F)}}})(t,a,u,d);break;case"hillshade":(function(g,w,T,E){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent")return;const C=g.context,k=g.depthModeForSublayer(0,ri.ReadOnly),F=g.colorModeForRenderPass(),[j,Q]=g.renderPass==="translucent"?g.stencilConfigForOverlap(E):[{},E];for(const X of Q){const ee=w.getTile(X);ee.needsHillshadePrepare!==void 0&&ee.needsHillshadePrepare&&g.renderPass==="offscreen"?_c(g,ee,T,k,Mi.disabled,F):g.renderPass==="translucent"&&cl(g,X,ee,T,k,j[X.overscaledZ],F)}C.viewport.set([0,0,g.width,g.height])})(t,a,u,d);break;case"raster":(function(g,w,T,E){if(g.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!E.length)return;const C=g.context,k=C.gl,F=w.getSource(),j=g.useProgram("raster"),Q=g.colorModeForRenderPass(),[X,ee]=F instanceof qe?[{},E]:g.stencilConfigForOverlap(E),W=ee[ee.length-1].overscaledZ,he=!g.options.moving;for(const Te of ee){const ne=g.depthModeForSublayer(Te.overscaledZ-W,T.paint.get("raster-opacity")===1?ri.ReadWrite:ri.ReadOnly,k.LESS),ge=w.getTile(Te);ge.registerFadeDuration(T.paint.get("raster-fade-duration"));const Ie=w.findLoadedParent(Te,0),Ee=ch(ge,Ie,w,T,g.transform,g.style.map.terrain);let Fe,je;const Ue=T.paint.get("raster-resampling")==="nearest"?k.NEAREST:k.LINEAR;C.activeTexture.set(k.TEXTURE0),ge.texture.bind(Ue,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),C.activeTexture.set(k.TEXTURE1),Ie?(Ie.texture.bind(Ue,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),Fe=Math.pow(2,Ie.tileID.overscaledZ-ge.tileID.overscaledZ),je=[ge.tileID.canonical.x*Fe%1,ge.tileID.canonical.y*Fe%1]):ge.texture.bind(Ue,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST);const Ze=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Te),dt=Ze?Te:null,Pt=dt?dt.posMatrix:g.transform.calculatePosMatrix(Te.toUnwrapped(),he),tt=Ko(Pt,je||[0,0],Fe||1,Ee,T);F instanceof qe?j.draw(C,k.TRIANGLES,ne,Mi.disabled,Q,Ti.disabled,tt,Ze,T.id,F.boundsBuffer,g.quadTriangleIndexBuffer,F.boundsSegments):j.draw(C,k.TRIANGLES,ne,X[Te.overscaledZ],Q,Ti.disabled,tt,Ze,T.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}})(t,a,u,d);break;case"background":(function(g,w,T,E){const C=T.paint.get("background-color"),k=T.paint.get("background-opacity");if(k===0)return;const F=g.context,j=F.gl,Q=g.transform,X=Q.tileSize,ee=T.paint.get("background-pattern");if(g.isPatternMissing(ee))return;const W=!ee&&C.a===1&&k===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==W)return;const he=Mi.disabled,Te=g.depthModeForSublayer(0,W==="opaque"?ri.ReadWrite:ri.ReadOnly),ne=g.colorModeForRenderPass(),ge=g.useProgram(ee?"backgroundPattern":"background"),Ie=E||Q.coveringTiles({tileSize:X,terrain:g.style.map.terrain});ee&&(F.activeTexture.set(j.TEXTURE0),g.imageManager.bind(g.context));const Ee=T.getCrossfadeParameters();for(const Fe of Ie){const je=E?Fe.posMatrix:g.transform.calculatePosMatrix(Fe.toUnwrapped()),Ue=ee?of(je,k,g,ee,{tileID:Fe,tileSize:X},Ee):af(je,k,C),Ze=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Fe);ge.draw(F,j.TRIANGLES,Te,he,ne,Ti.disabled,Ue,Ze,T.id,g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}})(t,0,u,d);break;case"custom":(function(g,w,T){const E=g.context,C=T.implementation;if(g.renderPass==="offscreen"){const k=C.prerender;k&&(g.setCustomLayerDefaults(),E.setColorMode(g.colorModeForRenderPass()),k.call(C,E.gl,g.transform.customLayerMatrix()),E.setDirty(),g.setBaseState())}else if(g.renderPass==="translucent"){g.setCustomLayerDefaults(),E.setColorMode(g.colorModeForRenderPass()),E.setStencilMode(Mi.disabled);const k=C.renderingMode==="3d"?new ri(g.context.gl.LEQUAL,ri.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,ri.ReadOnly);E.setDepthMode(k),C.render(E.gl,g.transform.customLayerMatrix()),E.setDirty(),g.setBaseState(),E.bindFramebuffer.set(null)}})(t,0,u)}}translatePosMatrix(t,a,u,d,g){if(!u[0]&&!u[1])return t;const w=g?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(w){const C=Math.sin(w),k=Math.cos(w);u=[u[0]*k-u[1]*C,u[0]*C+u[1]*k]}const T=[g?u[0]:zt(a,u[0],this.transform.zoom),g?u[1]:zt(a,u[1],this.transform.zoom),0],E=new Float32Array(16);return c.H(E,t,T),E}saveTileTexture(t){const a=this._tileTextures[t.size[0]];a?a.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const a=this._tileTextures[t];return a&&a.length>0?a.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const a=this.imageManager.getPattern(t.from.toString()),u=this.imageManager.getPattern(t.to.toString());return!a||!u}useProgram(t,a){this.cache=this.cache||{};const u=t+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[u]||(this.cache[u]=new ps(this.context,Ja[t],a,Ju[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[u]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new He(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:a}=this.context.gl;return this.width!==t||this.height!==a}}class gs{constructor(t,a){this.points=t,this.planes=a}static fromInvProjectionMatrix(t,a,u){const d=Math.pow(2,u),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const E=1/(T=c.af([],T,t))[3]/a*d;return c.a_(T,T,[E,E,1/T[3],E])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const E=function(j,Q){var X=Q[0],ee=Q[1],W=Q[2],he=X*X+ee*ee+W*W;return he>0&&(he=1/Math.sqrt(he)),j[0]=Q[0]*he,j[1]=Q[1]*he,j[2]=Q[2]*he,j}([],function(j,Q,X){var ee=Q[0],W=Q[1],he=Q[2],Te=X[0],ne=X[1],ge=X[2];return j[0]=W*ge-he*ne,j[1]=he*Te-ee*ge,j[2]=ee*ne-W*Te,j}([],Ge([],g[T[0]],g[T[1]]),Ge([],g[T[2]],g[T[1]]))),C=-((k=E)[0]*(F=g[T[1]])[0]+k[1]*F[1]+k[2]*F[2]);var k,F;return E.concat(C)});return new gs(g,w)}}class _s{constructor(t,a){this.min=t,this.max=a,this.center=function(u,d,g){return u[0]=.5*d[0],u[1]=.5*d[1],u[2]=.5*d[2],u}([],function(u,d,g){return u[0]=d[0]+g[0],u[1]=d[1]+g[1],u[2]=d[2]+g[2],u}([],this.min,this.max))}quadrant(t){const a=[t%2==0,t<2],u=$e(this.min),d=$e(this.max);for(let g=0;g<a.length;g++)u[g]=a[g]?this.min[g]:this.center[g],d[g]=a[g]?this.center[g]:this.max[g];return d[2]=this.max[2],new _s(u,d)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let u=!0;for(let d=0;d<t.planes.length;d++){const g=t.planes[d];let w=0;for(let T=0;T<a.length;T++)c.a$(g,a[T])>=0&&w++;if(w===0)return 0;w!==a.length&&(u=!1)}if(u)return 2;for(let d=0;d<3;d++){let g=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let T=0;T<t.points.length;T++){const E=t.points[T][d]-this.min[d];g=Math.min(g,E),w=Math.max(w,E)}if(w<0||g>this.max[d]-this.min[d])return 0}return 1}}class da{constructor(t=0,a=0,u=0,d=0){if(isNaN(t)||t<0||isNaN(a)||a<0||isNaN(u)||u<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=a,this.left=u,this.right=d}interpolate(t,a,u){return a.top!=null&&t.top!=null&&(this.top=c.z.number(t.top,a.top,u)),a.bottom!=null&&t.bottom!=null&&(this.bottom=c.z.number(t.bottom,a.bottom,u)),a.left!=null&&t.left!=null&&(this.left=c.z.number(t.left,a.left,u)),a.right!=null&&t.right!=null&&(this.right=c.z.number(t.right,a.right,u)),this}getCenter(t,a){const u=c.ac((this.left+t-this.right)/2,0,t),d=c.ac((this.top+a-this.bottom)/2,0,a);return new c.P(u,d)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new da(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class dl{constructor(t,a,u,d,g){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=g===void 0||!!g,this._minZoom=t||0,this._maxZoom=a||22,this._minPitch=u??0,this._maxPitch=d??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new da,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const t=new dl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this.minElevationForCurrentTile=t.minElevationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const a=-c.b0(t,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=function(){var u=new c.A(4);return c.A!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u}(),function(u,d,g){var w=d[0],T=d[1],E=d[2],C=d[3],k=Math.sin(g),F=Math.cos(g);u[0]=w*F+E*k,u[1]=T*F+C*k,u[2]=w*-k+E*F,u[3]=T*-k+C*F}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const a=c.ac(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const a=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.tileZoom=Math.max(0,Math.floor(a)),this.scale=this.zoomScale(a),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,a,u){this._unmodified=!1,this._edgeInsets.interpolate(t,a,u),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const a=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(t){const a=[new c.b1(0,t)];if(this._renderWorldCopies){const u=this.pointCoordinate(new c.P(0,0)),d=this.pointCoordinate(new c.P(this.width,0)),g=this.pointCoordinate(new c.P(this.width,this.height)),w=this.pointCoordinate(new c.P(0,this.height)),T=Math.floor(Math.min(u.x,d.x,g.x,w.x)),E=Math.floor(Math.max(u.x,d.x,g.x,w.x)),C=1;for(let k=T-C;k<=E+C;k++)k!==0&&a.push(new c.b1(k,t))}return a}coveringTiles(t){var a,u;let d=this.coveringZoomLevel(t);const g=d;if(t.minzoom!==void 0&&d<t.minzoom)return[];t.maxzoom!==void 0&&d>t.maxzoom&&(d=t.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),T=c.Y.fromLngLat(this.center),E=Math.pow(2,d),C=[E*w.x,E*w.y,0],k=[E*T.x,E*T.y,0],F=gs.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d);let j=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(j=d);const Q=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,X=ne=>({aabb:new _s([ne*E,0,0],[(ne+1)*E,E,0]),zoom:0,x:0,y:0,wrap:ne,fullyVisible:!1}),ee=[],W=[],he=d,Te=t.reparseOverscaled?g:d;if(this._renderWorldCopies)for(let ne=1;ne<=3;ne++)ee.push(X(-ne)),ee.push(X(ne));for(ee.push(X(0));ee.length>0;){const ne=ee.pop(),ge=ne.x,Ie=ne.y;let Ee=ne.fullyVisible;if(!Ee){const dt=ne.aabb.intersects(F);if(dt===0)continue;Ee=dt===2}const Fe=t.terrain?C:k,je=ne.aabb.distanceX(Fe),Ue=ne.aabb.distanceY(Fe),Ze=Math.max(Math.abs(je),Math.abs(Ue));if(ne.zoom===he||Ze>Q+(1<<he-ne.zoom)-2&&ne.zoom>=j){const dt=he-ne.zoom,Pt=C[0]-.5-(ge<<dt),tt=C[1]-.5-(Ie<<dt);W.push({tileID:new c.Q(ne.zoom===he?Te:ne.zoom,ne.wrap,ne.zoom,ge,Ie),distanceSq:ot([k[0]-.5-ge,k[1]-.5-Ie]),tileDistanceToCamera:Math.sqrt(Pt*Pt+tt*tt)})}else for(let dt=0;dt<4;dt++){const Pt=(ge<<1)+dt%2,tt=(Ie<<1)+(dt>>1),At=ne.zoom+1;let mt=ne.aabb.quadrant(dt);if(t.terrain){const Li=new c.Q(At,ne.wrap,At,Pt,tt),Jt=t.terrain.getMinMaxElevation(Li),$t=(a=Jt.minElevation)!==null&&a!==void 0?a:this.elevation,Qt=(u=Jt.maxElevation)!==null&&u!==void 0?u:this.elevation;mt=new _s([mt.min[0],mt.min[1],$t],[mt.max[0],mt.max[1],Qt])}ee.push({aabb:mt,zoom:At,x:Pt,y:tt,wrap:ne.wrap,fullyVisible:Ee})}}return W.sort((ne,ge)=>ne.distanceSq-ge.distanceSq).map(ne=>ne.tileID)}resize(t,a){this.width=t,this.height=a,this.pixelsToGLUnits=[2/t,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const a=c.ac(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new c.P(c.N(t.lng)*this.worldSize,c.O(a)*this.worldSize)}unproject(t){return new c.Y(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const a=this.pointLocation(this.centerPoint,t),u=t.getElevationForLngLatZoom(a,this.tileZoom);if(!(this.elevation-u))return;const d=this.getCameraPosition(),g=c.Y.fromLngLat(d.lngLat,d.altitude),w=c.Y.fromLngLat(a,u),T=g.x-w.x,E=g.y-w.y,C=g.z-w.z,k=Math.sqrt(T*T+E*E+C*C),F=this.scaleZoom(this.cameraToCenterDistance/k/this.tileSize);this._elevation=u,this._center=a,this.zoom=F}setLocationAtPoint(t,a){const u=this.pointCoordinate(a),d=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(t),w=new c.Y(g.x-(u.x-d.x),g.y-(u.y-d.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,a){return a?this.coordinatePoint(this.locationCoordinate(t),a.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,a){return this.coordinateLocation(this.pointCoordinate(t,a))}locationCoordinate(t){return c.Y.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,a){if(a){const j=a.pointCoordinate(t);if(j!=null)return j}const u=[t.x,t.y,0,1],d=[t.x,t.y,1,1];c.af(u,u,this.pixelMatrixInverse),c.af(d,d,this.pixelMatrixInverse);const g=u[3],w=d[3],T=u[1]/g,E=d[1]/w,C=u[2]/g,k=d[2]/w,F=C===k?0:(0-C)/(k-C);return new c.Y(c.z.number(u[0]/g,d[0]/w,F)/this.worldSize,c.z.number(T,E,F)/this.worldSize)}coordinatePoint(t,a=0,u=this.pixelMatrix){const d=[t.x*this.worldSize,t.y*this.worldSize,a,1];return c.af(d,d,u),new c.P(d[0]/d[3],d[1]/d[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new Y().extend(this.pointLocation(new c.P(0,t))).extend(this.pointLocation(new c.P(this.width,t))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Y([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(t,a=!1){const u=t.key,d=a?this._alignedPosMatrixCache:this._posMatrixCache;if(d[u])return d[u];const g=t.canonical,w=this.worldSize/this.zoomScale(g.z),T=g.x+Math.pow(2,g.z)*t.wrap,E=c.an(new Float64Array(16));return c.H(E,E,[T*w,g.y*w,0]),c.J(E,E,[w/c.W,w/c.W,1]),c.K(E,a?this.alignedProjMatrix:this.projMatrix,E),d[u]=new Float32Array(E),d[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;let t=this.lngRange;if(!this._renderWorldCopies&&t===null){const X=179.9999999999;t=[-X,X]}this._constraining=!0;let a,u,d,g,w=-90,T=90,E=-180,C=180;const k=this.size,F=this._unmodified;if(this.latRange){const X=this.latRange;w=c.O(X[1])*this.worldSize,T=c.O(X[0])*this.worldSize,a=T-w<k.y?k.y/(T-w):0}t&&(E=c.b0(c.N(t[0])*this.worldSize,0,this.worldSize),C=c.b0(c.N(t[1])*this.worldSize,0,this.worldSize),C<E&&(C+=this.worldSize),u=C-E<k.x?k.x/(C-E):0);const j=this.point,Q=Math.max(u||0,a||0);if(Q)return this.center=this.unproject(new c.P(u?(C+E)/2:j.x,a?(T+w)/2:j.y)),this.zoom+=this.scaleZoom(Q),this._unmodified=F,void(this._constraining=!1);if(this.latRange){const X=j.y,ee=k.y/2;X-ee<w&&(g=w+ee),X+ee>T&&(g=T-ee)}if(t){const X=(E+C)/2;let ee=j.x;this._renderWorldCopies&&(ee=c.b0(j.x,X-this.worldSize/2,X+this.worldSize/2));const W=k.x/2;ee-W<E&&(d=E+W),ee+W>C&&(d=C-W)}d===void 0&&g===void 0||(this.center=this.unproject(new c.P(d!==void 0?d:j.x,g!==void 0?g:j.y)).wrap()),this._unmodified=F,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,a=this.point.x,u=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b2(1,this.center.lat)*this.worldSize;let d=c.an(new Float64Array(16));c.J(d,d,[this.width/2,-this.height/2,1]),c.H(d,d,[1,-1,0]),this.labelPlaneMatrix=d,d=c.an(new Float64Array(16)),c.J(d,d,[1,-1,1]),c.H(d,d,[-1,-1,0]),c.J(d,d,[2/this.width,2/this.height,1]),this.glCoordMatrix=d;const g=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),w=Math.min(this.elevation,this.minElevationForCurrentTile),T=g-w*this._pixelPerMeter/Math.cos(this._pitch),E=w<0?T:g,C=Math.PI/2+this._pitch,k=this._fov*(.5+t.y/this.height),F=Math.sin(k)*E/Math.sin(c.ac(Math.PI-C-k,.01,Math.PI-.01)),j=this.getHorizon(),Q=2*Math.atan(j/this.cameraToCenterDistance)*(.5+t.y/(2*j)),X=Math.sin(Q)*E/Math.sin(c.ac(Math.PI-C-Q,.01,Math.PI-.01)),ee=Math.min(F,X),W=1.01*(Math.cos(Math.PI/2-this._pitch)*ee+E),he=this.height/50;d=new Float64Array(16),c.b3(d,this._fov,this.width/this.height,he,W),d[8]=2*-t.x/this.width,d[9]=2*t.y/this.height,c.J(d,d,[1,-1,1]),c.H(d,d,[0,0,-this.cameraToCenterDistance]),c.b4(d,d,this._pitch),c.ad(d,d,this.angle),c.H(d,d,[-a,-u,0]),this.mercatorMatrix=c.J([],d,[this.worldSize,this.worldSize,this.worldSize]),c.J(d,d,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.K(new Float64Array(16),this.labelPlaneMatrix,d),c.H(d,d,[0,0,-this.elevation]),this.projMatrix=d,this.invProjMatrix=c.ar([],d),this.pixelMatrix3D=c.K(new Float64Array(16),this.labelPlaneMatrix,d);const Te=this.width%2/2,ne=this.height%2/2,ge=Math.cos(this.angle),Ie=Math.sin(this.angle),Ee=a-Math.round(a)+ge*Te+Ie*ne,Fe=u-Math.round(u)+ge*ne+Ie*Te,je=new Float64Array(d);if(c.H(je,je,[Ee>.5?Ee-1:Ee,Fe>.5?Fe-1:Fe,0]),this.alignedProjMatrix=je,d=c.ar(new Float64Array(16),this.pixelMatrix),!d)throw new Error("failed to invert matrix");this.pixelMatrixInverse=d,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new c.P(0,0)),a=[t.x*this.worldSize,t.y*this.worldSize,0,1];return c.af(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,t))}getCameraQueryGeometry(t){const a=this.getCameraPoint();if(t.length===1)return[t[0],a];{let u=a.x,d=a.y,g=a.x,w=a.y;for(const T of t)u=Math.min(u,T.x),d=Math.min(d,T.y),g=Math.max(g,T.x),w=Math.max(w,T.y);return[new c.P(u,d),new c.P(g,d),new c.P(g,w),new c.P(u,w),new c.P(u,d)]}}lngLatToCameraDepth(t,a){const u=this.locationCoordinate(t),d=[u.x*this.worldSize,u.y*this.worldSize,a,1];return c.af(d,d,this.projMatrix),d[2]/d[3]}}function xc(p,t){let a,u=!1,d=null,g=null;const w=()=>{d=null,u&&(p.apply(g,a),d=setTimeout(w,t),u=!1)};return(...T)=>(u=!0,g=this,a=T,d||w(),d)}class bc{constructor(t){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let u;return a.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(u=d)}),(u&&u[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(a.length>=3&&!a.some(u=>isNaN(u))){const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:u,pitch:+(a[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,a)}catch{}},this._updateHash=xc(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const a=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,d=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,d),w=Math.round(a.lng*g)/g,T=Math.round(a.lat*g)/g,E=this._map.getBearing(),C=this._map.getPitch();let k="";if(k+=t?`/${w}/${T}/${u}`:`${u}/${T}/${w}`,(E||C)&&(k+="/"+Math.round(10*E)/10),C&&(k+=`/${Math.round(C)}`),this._hashName){const F=this._hashName;let j=!1;const Q=window.location.hash.slice(1).split("&").map(X=>{const ee=X.split("=")[0];return ee===F?(j=!0,`${ee}=${k}`):X}).filter(X=>X);return j||Q.push(`${F}=${k}`),`#${Q.join("&")}`}return`#${k}`}}const ao={linearity:.3,easing:c.b5(0,0,.3,1)},fh=c.e({deceleration:2500,maxSpeed:1400},ao),Os=c.e({deceleration:20,maxSpeed:1400},ao),ph=c.e({deceleration:1e3,maxSpeed:360},ao),mh=c.e({deceleration:1e3,maxSpeed:90},ao);class gh{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:B.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,a=B.now();for(;t.length>0&&a-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)a.zoom+=g.zoomDelta||0,a.bearing+=g.bearingDelta||0,a.pitch+=g.pitchDelta||0,g.panDelta&&a.pan._add(g.panDelta),g.around&&(a.around=g.around),g.pinchAround&&(a.pinchAround=g.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(a.pan.mag()){const g=lo(a.pan.mag(),u,c.e({},fh,t||{}));d.offset=a.pan.mult(g.amount/a.pan.mag()),d.center=this._map.transform.center,oo(d,g)}if(a.zoom){const g=lo(a.zoom,u,Os);d.zoom=this._map.transform.zoom+g.amount,oo(d,g)}if(a.bearing){const g=lo(a.bearing,u,ph);d.bearing=this._map.transform.bearing+c.ac(g.amount,-179,179),oo(d,g)}if(a.pitch){const g=lo(a.pitch,u,mh);d.pitch=this._map.transform.pitch+g.amount,oo(d,g)}if(d.zoom||d.bearing){const g=a.pinchAround===void 0?a.around:a.pinchAround;d.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),c.e(d,{noMoveStart:!0})}}function oo(p,t){(!p.duration||p.duration<t.duration)&&(p.duration=t.duration,p.easing=t.easing)}function lo(p,t,a){const{maxSpeed:u,linearity:d,deceleration:g}=a,w=c.ac(p*d/(t/1e3),-u,u),T=Math.abs(w)/(g*d);return{easing:a.easing,duration:1e3*T,amount:w*(T/2)}}class an extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,u,d={}){const g=M.mousePos(a.getCanvas(),u),w=a.unproject(g);super(t,c.e({point:g,lngLat:w,originalEvent:u},d)),this._defaultPrevented=!1,this.target=a}}class fa extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,u){const d=t==="touchend"?u.changedTouches:u.touches,g=M.touchPos(a.getCanvasContainer(),d),w=g.map(E=>a.unproject(E)),T=g.reduce((E,C,k,F)=>E.add(C.div(F.length)),new c.P(0,0));super(t,{points:g,point:T,lngLats:w,lngLat:a.unproject(T),originalEvent:u}),this._defaultPrevented=!1}}class Fs extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,u){super(t,{originalEvent:u}),this._defaultPrevented=!1}}class _h{constructor(t,a){this._map=t,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Fs(t.type,this._map,t))}mousedown(t,a){return this._mousedownPos=a,this._firePreventable(new an(t.type,this._map,t))}mouseup(t){this._map.fire(new an(t.type,this._map,t))}click(t,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new an(t.type,this._map,t))}dblclick(t){return this._firePreventable(new an(t.type,this._map,t))}mouseover(t){this._map.fire(new an(t.type,this._map,t))}mouseout(t){this._map.fire(new an(t.type,this._map,t))}touchstart(t){return this._firePreventable(new fa(t.type,this._map,t))}touchmove(t){this._map.fire(new fa(t.type,this._map,t))}touchend(t){this._map.fire(new fa(t.type,this._map,t))}touchcancel(t){this._map.fire(new fa(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class zn{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new an(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new an("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new an(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class on{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(c.P.convert(t),this._map.terrain)}}class wc{constructor(t,a){this._map=t,this._tr=new on(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,a){this.isEnabled()&&t.shiftKey&&t.button===0&&(M.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(t,a){if(!this._active)return;const u=a;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=u,this._box||(this._box=M.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const g=Math.min(d.x,u.x),w=Math.max(d.x,u.x),T=Math.min(d.y,u.y),E=Math.max(d.y,u.y);M.setTransform(this._box,`translate(${g}px,${T}px)`),this._box.style.width=w-g+"px",this._box.style.height=E-T+"px"}mouseupWindow(t,a){if(!this._active||t.button!==0)return;const u=this._startPos,d=a;if(this.reset(),M.suppressClick(),u.x!==d.x||u.y!==d.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:t})),{cameraAnimation:g=>g.fitScreenCoordinates(u,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(M.remove(this._box),this._box=null),M.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,a){return this._map.fire(new c.k(t,{originalEvent:a}))}}function Cn(p,t){if(p.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${p.length}, points ${t.length}`);const a={};for(let u=0;u<p.length;u++)a[p[u].identifier]=t[u];return a}class co{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,a,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),u.length===this.numTouches&&(this.centroid=function(d){const g=new c.P(0,0);for(const w of d)g._add(w);return g.div(d.length)}(a),this.touches=Cn(u,a)))}touchmove(t,a,u){if(this.aborted||!this.centroid)return;const d=Cn(u,a);for(const g in this.touches){const w=d[g];(!w||w.dist(this.touches[g])>30)&&(this.aborted=!0)}}touchend(t,a,u){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class Sc{constructor(t){this.singleTap=new co(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,a,u){this.singleTap.touchstart(t,a,u)}touchmove(t,a,u){this.singleTap.touchmove(t,a,u)}touchend(t,a,u){const d=this.singleTap.touchend(t,a,u);if(d){const g=t.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(d)<30;if(g&&w||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class yf{constructor(t){this._tr=new on(t),this._zoomIn=new Sc({numTouches:1,numTaps:2}),this._zoomOut=new Sc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,a,u){this._zoomIn.touchstart(t,a,u),this._zoomOut.touchstart(t,a,u)}touchmove(t,a,u){this._zoomIn.touchmove(t,a,u),this._zoomOut.touchmove(t,a,u)}touchend(t,a,u){const d=this._zoomIn.touchend(t,a,u),g=this._zoomOut.touchend(t,a,u),w=this._tr;return d?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(d)},{originalEvent:t})}):g?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(g)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class uo{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const a=this._moveFunction(...t);if(a.bearingDelta||a.pitchDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(t,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=a.length?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,a){if(!this.isEnabled())return;const u=this._lastPoint;if(!u)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const d=a.length?a[0]:a;return!this._moved&&d.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(u,d))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&M.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const yh={0:1,2:2};class Bs{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const a=M.mouseButton(t);this._eventButton=a}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(a,u){const d=yh[u];return a.buttons===void 0||(a.buttons&d)!==d}(t,this._eventButton)}isValidEndEvent(t){return M.mouseButton(t)===this._eventButton}}class ts{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const ut=p=>{p.mousedown=p.dragStart,p.mousemoveWindow=p.dragMove,p.mouseup=p.dragEnd,p.contextmenu=function(t){t.preventDefault()}},Tc=({enable:p,clickTolerance:t,bearingDegreesPerPixelMoved:a=.8})=>{const u=new Bs({checkCorrectEvent:d=>M.mouseButton(d)===0&&d.ctrlKey||M.mouseButton(d)===2});return new uo({clickTolerance:t,move:(d,g)=>({bearingDelta:(g.x-d.x)*a}),moveStateManager:u,enable:p,assignEvents:ut})},pa=({enable:p,clickTolerance:t,pitchDegreesPerPixelMoved:a=-.5})=>{const u=new Bs({checkCorrectEvent:d=>M.mouseButton(d)===0&&d.ctrlKey||M.mouseButton(d)===2});return new uo({clickTolerance:t,move:(d,g)=>({pitchDelta:(g.y-d.y)*a}),moveStateManager:u,enable:p,assignEvents:ut})};class ho{constructor(t,a){this._clickTolerance=t.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(t,a,u){return this._calculateTransform(t,a,u)}touchmove(t,a,u){if(this._active&&!(u.length<this.minTouchs()))return t.preventDefault(),this._calculateTransform(t,a,u)}touchend(t,a,u){this._calculateTransform(t,a,u),this._active&&u.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,a,u){u.length>0&&(this._active=!0);const d=Cn(u,a),g=new c.P(0,0),w=new c.P(0,0);let T=0;for(const C in d){const k=d[C],F=this._touches[C];F&&(g._add(k),w._add(k.sub(F)),T++,d[C]=k)}if(this._touches=d,T<this.minTouchs()||!w.mag())return;const E=w.div(T);return this._sum._add(E),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(T),panDelta:E}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,a,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([a[0],a[1]]))}touchmove(t,a,u){if(!this._firstTwoTouches)return;t.preventDefault();const[d,g]=this._firstTwoTouches,w=st(u,a,d),T=st(u,a,g);if(!w||!T)return;const E=this._aroundCenter?null:w.add(T).div(2);return this._move([w,T],E,t)}touchend(t,a,u){if(!this._firstTwoTouches)return;const[d,g]=this._firstTwoTouches,w=st(u,a,d),T=st(u,a,g);w&&T||(this._active&&M.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function st(p,t,a){for(let u=0;u<p.length;u++)if(p[u].identifier===a)return t[u]}function pl(p,t){return Math.log(p/t)/Math.LN2}class vh extends fl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,a){const u=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(pl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:pl(this._distance,u),pinchAround:a}}}function xh(p,t){return 180*p.angleWith(t)/Math.PI}class ml extends fl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,a,u){const d=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:xh(this._vector,d),pinchAround:a}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const a=25/(Math.PI*this._minDiameter)*360,u=xh(t,this._startVector);return Math.abs(u)<a}}function gl(p){return Math.abs(p.y)>Math.abs(p.x)}class Ec extends fl{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,a,u){super.touchstart(t,a,u),this._currentTouchCount=u.length}_start(t){this._lastPoints=t,gl(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,a,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const d=t[0].sub(this._lastPoints[0]),g=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,g,u.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(d.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(t,a,u){if(this._valid!==void 0)return this._valid;const d=t.mag()>=2,g=a.mag()>=2;if(!d&&!g)return;if(!d||!g)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const w=t.y>0==a.y>0;return gl(t)&&gl(a)&&w}}const vf={panStep:100,bearingStep:15,pitchStep:10};class bh{constructor(t){this._tr=new on(t);const a=vf;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let a=0,u=0,d=0,g=0,w=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:t.shiftKey?u=-1:(t.preventDefault(),g=-1);break;case 39:t.shiftKey?u=1:(t.preventDefault(),g=1);break;case 38:t.shiftKey?d=1:(t.preventDefault(),w=-1);break;case 40:t.shiftKey?d=-1:(t.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(u=0,d=0),{cameraAnimation:T=>{const E=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:Ns,zoom:a?Math.round(E.zoom)+a*(t.shiftKey?2:1):E.zoom,bearing:E.bearing+u*this._bearingStep,pitch:E.pitch+d*this._pitchStep,offset:[-g*this._panStep,-w*this._panStep],center:E.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ns(p){return p*(2-p)}const ki=4.000244140625;class fo{constructor(t,a){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=t,this._tr=new on(t),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!t[this._map.cooperativeGestures._bypassKey])return;let a=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const u=B.now(),d=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,a!==0&&a%ki==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(d*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),t.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=t,this._delta-=a,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=M.mousePos(this._map.getCanvas(),t),u=this._tr;this._around=a.y>u.transform.height/2-u.transform.getHorizon()?c.M.convert(this._aroundCenter?u.center:u.unproject(a)):c.M.convert(u.center),this._aroundPoint=u.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(this._delta!==0){const T=this._type==="wheel"&&Math.abs(this._delta)>ki?this._wheelZoomRate:this._defaultZoomRate;let E=2/(1+Math.exp(-Math.abs(this._delta*T)));this._delta<0&&E!==0&&(E=1/E);const C=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(C*E))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,u=this._startZoom,d=this._easing;let g,w=!1;if(this._type==="wheel"&&u&&d){const T=Math.min((B.now()-this._lastWheelEventTime)/200,1),E=d(T);g=c.z.number(u,a,E),T<1?this._frameId||(this._frameId=!0):w=!0}else g=a,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:g-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let a=c.b6;if(this._prevEase){const u=this._prevEase,d=(B.now()-u.start)/u.duration,g=u.easing(d+.01)-u.easing(d),w=.27/Math.sqrt(g*g+1e-4)*.01,T=Math.sqrt(.0729-w*w);a=c.b5(w,T,.25,1)}return this._prevEase={start:B.now(),duration:t,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class _l{constructor(t,a){this._clickZoom=t,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class wh{constructor(t){this._tr=new on(t),this.reset()}reset(){this._active=!1}dblclick(t,a){return t.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Sh{constructor(){this._tap=new Sc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,a,u){if(!this._swipePoint)if(this._tapTime){const d=a[0],g=t.timeStamp-this._tapTime<500,w=this._tapPoint.dist(d)<30;g&&w?u.length>0&&(this._swipePoint=d,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(t,a,u)}touchmove(t,a,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const d=a[0],g=d.y-this._swipePoint.y;return this._swipePoint=d,t.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(t,a,u)}touchend(t,a,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{const d=this._tap.touchend(t,a,u);d&&(this._tapTime=t.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ic{constructor(t,a,u){this._el=t,this._mousePan=a,this._touchPan=u}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Th{constructor(t,a,u){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=a,this._mousePitch=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class On{constructor(t,a,u,d){this._el=t,this._touchZoom=a,this._touchRotate=u,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class po{constructor(t,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=M.create("div","maplibregl-cooperative-gesture-screen",t);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),d=document.createElement("div");d.className="maplibregl-desktop-message",d.textContent=a,this._container.appendChild(d);const g=document.createElement("div");g.className="maplibregl-mobile-message",g.textContent=u,this._container.appendChild(g),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(M.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(t){this._onCooperativeGesture(t.touches.length===1)}wheel(t){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!t[this._bypassKey])}_onCooperativeGesture(t){this._enabled&&t&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const xt=p=>p.zoom||p.drag||p.pitch||p.rotate;class kt extends c.k{}function ma(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class Ac{constructor(t,a){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,g)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=d.type==="renderFrame"?void 0:d,T={needsRenderFrame:!1},E={},C={},k=d.touches,F=k?this._getMapTouches(k):void 0,j=F?M.touchPos(this._map.getCanvas(),F):M.mousePos(this._map.getCanvas(),d);for(const{handlerName:ee,handler:W,allowed:he}of this._handlers){if(!W.isEnabled())continue;let Te;this._blockedByActive(C,he,ee)?W.reset():W[g||d.type]&&(Te=W[g||d.type](d,j,F),this.mergeHandlerResult(T,E,Te,ee,w),Te&&Te.needsRenderFrame&&this._triggerRenderFrame()),(Te||W.isActive())&&(C[ee]=W)}const Q={};for(const ee in this._previousActiveHandlers)C[ee]||(Q[ee]=w);this._previousActiveHandlers=C,(Object.keys(Q).length||ma(T))&&(this._changes.push([T,E,Q]),this._triggerRenderFrame()),(Object.keys(C).length||ma(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=T;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new gh(t),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,g,w]of this._listeners)M.addEventListener(d,g,d===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[t,a,u]of this._listeners)M.removeEventListener(t,a,t===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(t){const a=this._map,u=a.getCanvasContainer();this._add("mapEvent",new _h(a,t));const d=a.boxZoom=new wc(a,t);this._add("boxZoom",d),t.interactive&&t.boxZoom&&d.enable();const g=a.cooperativeGestures=new po(a,t.cooperativeGestures);this._add("cooperativeGestures",g),t.cooperativeGestures&&g.enable();const w=new yf(a),T=new wh(a);a.doubleClickZoom=new _l(T,w),this._add("tapZoom",w),this._add("clickZoom",T),t.interactive&&t.doubleClickZoom&&a.doubleClickZoom.enable();const E=new Sh;this._add("tapDragZoom",E);const C=a.touchPitch=new Ec(a);this._add("touchPitch",C),t.interactive&&t.touchPitch&&a.touchPitch.enable(t.touchPitch);const k=Tc(t),F=pa(t);a.dragRotate=new Th(t,k,F),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]),t.interactive&&t.dragRotate&&a.dragRotate.enable();const j=(({enable:Te,clickTolerance:ne})=>{const ge=new Bs({checkCorrectEvent:Ie=>M.mouseButton(Ie)===0&&!Ie.ctrlKey});return new uo({clickTolerance:ne,move:(Ie,Ee)=>({around:Ee,panDelta:Ee.sub(Ie)}),activateOnStart:!0,moveStateManager:ge,enable:Te,assignEvents:ut})})(t),Q=new ho(t,a);a.dragPan=new Ic(u,j,Q),this._add("mousePan",j),this._add("touchPan",Q,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&a.dragPan.enable(t.dragPan);const X=new ml,ee=new vh;a.touchZoomRotate=new On(u,ee,X,E),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",ee,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&a.touchZoomRotate.enable(t.touchZoomRotate);const W=a.scrollZoom=new fo(a,()=>this._triggerRenderFrame());this._add("scrollZoom",W,["mousePan"]),t.interactive&&t.scrollZoom&&a.scrollZoom.enable(t.scrollZoom);const he=a.keyboard=new bh(a);this._add("keyboard",he),t.interactive&&t.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new zn(a))}_add(t,a,u){this._handlers.push({handlerName:t,handler:a,allowed:u}),this._handlersById[t]=a}stop(t){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!xt(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,a,u){for(const d in t)if(d!==u&&(!a||a.indexOf(d)<0))return!0;return!1}_getMapTouches(t){const a=[];for(const u of t)this._el.contains(u.target)&&a.push(u);return a}mergeHandlerResult(t,a,u,d,g){if(!u)return;c.e(t,u);const w={handlerName:d,originalEvent:u.originalEvent||g};u.zoomDelta!==void 0&&(a.zoom=w),u.panDelta!==void 0&&(a.drag=w),u.pitchDelta!==void 0&&(a.pitch=w),u.bearingDelta!==void 0&&(a.rotate=w)}_applyChanges(){const t={},a={},u={};for(const[d,g,w]of this._changes)d.panDelta&&(t.panDelta=(t.panDelta||new c.P(0,0))._add(d.panDelta)),d.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+d.pitchDelta),d.around!==void 0&&(t.around=d.around),d.pinchAround!==void 0&&(t.pinchAround=d.pinchAround),d.noInertia&&(t.noInertia=d.noInertia),c.e(a,g),c.e(u,w);this._updateMapTransform(t,a,u),this._changes=[]}_updateMapTransform(t,a,u){const d=this._map,g=d._getTransformForUpdate(),w=d.terrain;if(!(ma(t)||w&&this._terrainMovement))return this._fireEvents(a,u,!0);let{panDelta:T,zoomDelta:E,bearingDelta:C,pitchDelta:k,around:F,pinchAround:j}=t;j!==void 0&&(F=j),d._stop(!0),F=F||d.transform.centerPoint;const Q=g.pointLocation(T?F.sub(T):F);C&&(g.bearing+=C),k&&(g.pitch+=k),E&&(g.zoom+=E),w?this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?g.center=g.pointLocation(g.centerPoint.sub(T)):g.setLocationAtPoint(Q,F):(this._terrainMovement=!0,this._map._elevationFreeze=!0,g.setLocationAtPoint(Q,F),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,g.recalculateZoom(d.terrain)})):g.setLocationAtPoint(Q,F),d._applyUpdatedTransform(g),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(a,u,!0)}_fireEvents(t,a,u){const d=xt(this._eventsInProgress),g=xt(t),w={};for(const k in t){const{originalEvent:F}=t[k];this._eventsInProgress[k]||(w[`${k}start`]=F),this._eventsInProgress[k]=t[k]}!d&&g&&this._fireEvent("movestart",g.originalEvent);for(const k in w)this._fireEvent(k,w[k]);g&&this._fireEvent("move",g.originalEvent);for(const k in t){const{originalEvent:F}=t[k];this._fireEvent(k,F)}const T={};let E;for(const k in this._eventsInProgress){const{handlerName:F,originalEvent:j}=this._eventsInProgress[k];this._handlersById[F].isActive()||(delete this._eventsInProgress[k],E=a[F]||j,T[`${k}end`]=E)}for(const k in T)this._fireEvent(k,T[k]);const C=xt(this._eventsInProgress);if(u&&(d||g)&&!C){this._updatingCamera=!0;const k=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),F=j=>j!==0&&-this._bearingSnap<j&&j<this._bearingSnap;!k||!k.essential&&B.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:E})),F(this._map.getBearing())&&this._map.resetNorth()):(F(k.bearing||this._map.getBearing())&&(k.bearing=0),k.freezeElevation=!0,this._map.easeTo(k,{originalEvent:E})),this._updatingCamera=!1}}_fireEvent(t,a){this._map.fire(new c.k(t,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new kt("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Cc extends c.E{constructor(t,a){super(),this._renderFrameCallback=()=>{const u=Math.min((B.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=a.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.M(this.transform.center.lng,this.transform.center.lat)}setCenter(t,a){return this.jumpTo({center:t},a)}panBy(t,a,u){return t=c.P.convert(t).mult(-1),this.panTo(this.transform.center,c.e({offset:t},a),u)}panTo(t,a,u){return this.easeTo(c.e({center:t},a),u)}getZoom(){return this.transform.zoom}setZoom(t,a){return this.jumpTo({zoom:t},a),this}zoomTo(t,a,u){return this.easeTo(c.e({zoom:t},a),u)}zoomIn(t,a){return this.zoomTo(this.getZoom()+1,t,a),this}zoomOut(t,a){return this.zoomTo(this.getZoom()-1,t,a),this}getBearing(){return this.transform.bearing}setBearing(t,a){return this.jumpTo({bearing:t},a),this}getPadding(){return this.transform.padding}setPadding(t,a){return this.jumpTo({padding:t},a),this}rotateTo(t,a,u){return this.easeTo(c.e({bearing:t},a),u)}resetNorth(t,a){return this.rotateTo(0,c.e({duration:1e3},t),a),this}resetNorthPitch(t,a){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},t),a),this}snapToNorth(t,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,a):this}getPitch(){return this.transform.pitch}setPitch(t,a){return this.jumpTo({pitch:t},a),this}cameraForBounds(t,a){t=Y.convert(t);const u=a&&a.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),u,a)}_cameraForBoxAndBearing(t,a,u,d){const g={top:0,bottom:0,right:0,left:0};if(typeof(d=c.e({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const dt=d.padding;d.padding={top:dt,bottom:dt,right:dt,left:dt}}d.padding=c.e(g,d.padding);const w=this.transform,T=w.padding,E=new Y(t,a),C=w.project(E.getNorthWest()),k=w.project(E.getNorthEast()),F=w.project(E.getSouthEast()),j=w.project(E.getSouthWest()),Q=c.b7(-u),X=C.rotate(Q),ee=k.rotate(Q),W=F.rotate(Q),he=j.rotate(Q),Te=new c.P(Math.max(X.x,ee.x,he.x,W.x),Math.max(X.y,ee.y,he.y,W.y)),ne=new c.P(Math.min(X.x,ee.x,he.x,W.x),Math.min(X.y,ee.y,he.y,W.y)),ge=Te.sub(ne),Ie=(w.width-(T.left+T.right+d.padding.left+d.padding.right))/ge.x,Ee=(w.height-(T.top+T.bottom+d.padding.top+d.padding.bottom))/ge.y;if(Ee<0||Ie<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Fe=Math.min(w.scaleZoom(w.scale*Math.min(Ie,Ee)),d.maxZoom),je=c.P.convert(d.offset),Ue=new c.P((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(c.b7(u)),Ze=je.add(Ue).mult(w.scale/w.zoomScale(Fe));return{center:w.unproject(C.add(F).div(2).sub(Ze)),zoom:Fe,bearing:u}}fitBounds(t,a,u){return this._fitInternal(this.cameraForBounds(t,a),a,u)}fitScreenCoordinates(t,a,u,d,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(t)),this.transform.pointLocation(c.P.convert(a)),u,d),d,g)}_fitInternal(t,a,u){return t?(delete(a=c.e(t,a)).padding,a.linear?this.easeTo(a,u):this.flyTo(a,u)):this}jumpTo(t,a){this.stop();const u=this._getTransformForUpdate();let d=!1,g=!1,w=!1;return"zoom"in t&&u.zoom!==+t.zoom&&(d=!0,u.zoom=+t.zoom),t.center!==void 0&&(u.center=c.M.convert(t.center)),"bearing"in t&&u.bearing!==+t.bearing&&(g=!0,u.bearing=+t.bearing),"pitch"in t&&u.pitch!==+t.pitch&&(w=!0,u.pitch=+t.pitch),t.padding==null||u.isPaddingEqual(t.padding)||(u.padding=t.padding),this._applyUpdatedTransform(u),this.fire(new c.k("movestart",a)).fire(new c.k("move",a)),d&&this.fire(new c.k("zoomstart",a)).fire(new c.k("zoom",a)).fire(new c.k("zoomend",a)),g&&this.fire(new c.k("rotatestart",a)).fire(new c.k("rotate",a)).fire(new c.k("rotateend",a)),w&&this.fire(new c.k("pitchstart",a)).fire(new c.k("pitch",a)).fire(new c.k("pitchend",a)),this.fire(new c.k("moveend",a))}calculateCameraOptionsFromTo(t,a,u,d=0){const g=c.Y.fromLngLat(t,a),w=c.Y.fromLngLat(u,d),T=w.x-g.x,E=w.y-g.y,C=w.z-g.z,k=Math.hypot(T,E,C);if(k===0)throw new Error("Can't calculate camera options with same From and To");const F=Math.hypot(T,E),j=this.transform.scaleZoom(this.transform.cameraToCenterDistance/k/this.transform.tileSize),Q=180*Math.atan2(T,-E)/Math.PI;let X=180*Math.acos(F/k)/Math.PI;return X=C<0?90-X:90+X,{center:w.toLngLat(),zoom:j,pitch:X,bearing:Q}}easeTo(t,a){this._stop(!1,t.easeId),((t=c.e({offset:[0,0],duration:500,easing:c.b6},t)).animate===!1||!t.essential&&B.prefersReducedMotion)&&(t.duration=0);const u=this._getTransformForUpdate(),d=this.getZoom(),g=this.getBearing(),w=this.getPitch(),T=this.getPadding(),E="zoom"in t?+t.zoom:d,C="bearing"in t?this._normalizeBearing(t.bearing,g):g,k="pitch"in t?+t.pitch:w,F="padding"in t?t.padding:u.padding,j=c.P.convert(t.offset);let Q=u.centerPoint.add(j);const X=u.pointLocation(Q),ee=c.M.convert(t.center||X);this._normalizeCenter(ee);const W=u.project(X),he=u.project(ee).sub(W),Te=u.zoomScale(E-d);let ne,ge;t.around&&(ne=c.M.convert(t.around),ge=u.locationPoint(ne));const Ie={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||E!==d,this._rotating=this._rotating||g!==C,this._pitching=this._pitching||k!==w,this._padding=!u.isPaddingEqual(F),this._easeId=t.easeId,this._prepareEase(a,t.noMoveStart,Ie),this.terrain&&this._prepareElevation(ee),this._ease(Ee=>{if(this._zooming&&(u.zoom=c.z.number(d,E,Ee)),this._rotating&&(u.bearing=c.z.number(g,C,Ee)),this._pitching&&(u.pitch=c.z.number(w,k,Ee)),this._padding&&(u.interpolatePadding(T,F,Ee),Q=u.centerPoint.add(j)),this.terrain&&!t.freezeElevation&&this._updateElevation(Ee),ne)u.setLocationAtPoint(ne,ge);else{const Fe=u.zoomScale(u.zoom-d),je=E>d?Math.min(2,Te):Math.max(.5,Te),Ue=Math.pow(je,1-Ee),Ze=u.unproject(W.add(he.mult(Ee*Ue)).mult(Fe));u.setLocationAtPoint(u.renderWorldCopies?Ze.wrap():Ze,Q)}this._applyUpdatedTransform(u),this._fireMoveEvents(a)},Ee=>{this.terrain&&this._finalizeElevation(),this._afterEase(a,Ee)},t),this}_prepareEase(t,a,u={}){this._moving=!0,a||u.moving||this.fire(new c.k("movestart",t)),this._zooming&&!u.zooming&&this.fire(new c.k("zoomstart",t)),this._rotating&&!u.rotating&&this.fire(new c.k("rotatestart",t)),this._pitching&&!u.pitching&&this.fire(new c.k("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&a!==this._elevationTarget){const u=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(u-(a-(u*t+this._elevationStart))/(1-t)),this._elevationTarget=a}this.transform.elevation=c.z.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(t){if(!this.transformCameraUpdate)return;const a=t.clone(),{center:u,zoom:d,pitch:g,bearing:w,elevation:T}=this.transformCameraUpdate(a);u&&(a.center=u),d!==void 0&&(a.zoom=d),g!==void 0&&(a.pitch=g),w!==void 0&&(a.bearing=w),T!==void 0&&(a.elevation=T),this.transform.apply(a)}_fireMoveEvents(t){this.fire(new c.k("move",t)),this._zooming&&this.fire(new c.k("zoom",t)),this._rotating&&this.fire(new c.k("rotate",t)),this._pitching&&this.fire(new c.k("pitch",t))}_afterEase(t,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const u=this._zooming,d=this._rotating,g=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new c.k("zoomend",t)),d&&this.fire(new c.k("rotateend",t)),g&&this.fire(new c.k("pitchend",t)),this.fire(new c.k("moveend",t))}flyTo(t,a){if(!t.essential&&B.prefersReducedMotion){const mt=c.L(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(mt,a)}this.stop(),t=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b6},t);const u=this._getTransformForUpdate(),d=this.getZoom(),g=this.getBearing(),w=this.getPitch(),T=this.getPadding(),E="zoom"in t?c.ac(+t.zoom,u.minZoom,u.maxZoom):d,C="bearing"in t?this._normalizeBearing(t.bearing,g):g,k="pitch"in t?+t.pitch:w,F="padding"in t?t.padding:u.padding,j=u.zoomScale(E-d),Q=c.P.convert(t.offset);let X=u.centerPoint.add(Q);const ee=u.pointLocation(X),W=c.M.convert(t.center||ee);this._normalizeCenter(W);const he=u.project(ee),Te=u.project(W).sub(he);let ne=t.curve;const ge=Math.max(u.width,u.height),Ie=ge/j,Ee=Te.mag();if("minZoom"in t){const mt=c.ac(Math.min(t.minZoom,d,E),u.minZoom,u.maxZoom),Li=ge/u.zoomScale(mt-d);ne=Math.sqrt(Li/Ee*2)}const Fe=ne*ne;function je(mt){const Li=(Ie*Ie-ge*ge+(mt?-1:1)*Fe*Fe*Ee*Ee)/(2*(mt?Ie:ge)*Fe*Ee);return Math.log(Math.sqrt(Li*Li+1)-Li)}function Ue(mt){return(Math.exp(mt)-Math.exp(-mt))/2}function Ze(mt){return(Math.exp(mt)+Math.exp(-mt))/2}const dt=je(!1);let Pt=function(mt){return Ze(dt)/Ze(dt+ne*mt)},tt=function(mt){return ge*((Ze(dt)*(Ue(Li=dt+ne*mt)/Ze(Li))-Ue(dt))/Fe)/Ee;var Li},At=(je(!0)-dt)/ne;if(Math.abs(Ee)<1e-6||!isFinite(At)){if(Math.abs(ge-Ie)<1e-6)return this.easeTo(t,a);const mt=Ie<ge?-1:1;At=Math.abs(Math.log(Ie/ge))/ne,tt=function(){return 0},Pt=function(Li){return Math.exp(mt*ne*Li)}}return t.duration="duration"in t?+t.duration:1e3*At/("screenSpeed"in t?+t.screenSpeed/ne:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=g!==C,this._pitching=k!==w,this._padding=!u.isPaddingEqual(F),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(W),this._ease(mt=>{const Li=mt*At,Jt=1/Pt(Li);u.zoom=mt===1?E:d+u.scaleZoom(Jt),this._rotating&&(u.bearing=c.z.number(g,C,mt)),this._pitching&&(u.pitch=c.z.number(w,k,mt)),this._padding&&(u.interpolatePadding(T,F,mt),X=u.centerPoint.add(Q)),this.terrain&&!t.freezeElevation&&this._updateElevation(mt);const $t=mt===1?W:u.unproject(he.add(Te.mult(tt(Li))).mult(Jt));u.setLocationAtPoint(u.renderWorldCopies?$t.wrap():$t,X),this._applyUpdatedTransform(u),this._fireMoveEvents(a)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(a)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,a){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,a)}if(!t){const u=this.handlers;u&&u.stop(!1)}return this}_ease(t,a,u){u.animate===!1||u.duration===0?(t(1),a()):(this._easeStart=B.now(),this._easeOptions=u,this._onEaseFrame=t,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,a){t=c.b0(t,-180,180);const u=Math.abs(t-a);return Math.abs(t-360-a)<u&&(t-=360),Math.abs(t+360-a)<u&&(t+=360),t}_normalizeCenter(t){const a=this.transform;if(!a.renderWorldCopies||a.lngRange)return;const u=t.lng-a.center.lng;t.lng+=u>180?-360:u<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(c.M.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}const jr={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Pc{constructor(t=jr){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=M.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=M.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=M.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){M.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,a){const u=this._map._getUIString(`AttributionControl.${a}`);t.title=u,t.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(d=>typeof d!="string"?"":d)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const a=this._map.style.sourceCaches;for(const d in a){const g=a[d];if(g.used||g.usedForTerrain){const w=g.getSource();w.attribution&&t.indexOf(w.attribution)<0&&t.push(w.attribution)}}t=t.filter(d=>String(d).trim()),t.sort((d,g)=>d.length-g.length),t=t.filter((d,g)=>{for(let w=g+1;w<t.length;w++)if(t[w].indexOf(d)>=0)return!1;return!0});const u=t.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,t.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Fn{constructor(t={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const u=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=M.create("div","maplibregl-ctrl");const a=M.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){M.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class xf{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const a=++this._id;return this._queue.push({callback:t,id:a,cancelled:!1}),a}remove(t){const a=this._currentlyRunning,u=a?this._queue.concat(a):this._queue;for(const d of u)if(d.id===t)return void(d.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const u of a)if(!u.cancelled&&(u.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var mo=c.X([{name:"a_pos3d",type:"Int16",components:3}]);class Hi extends c.E{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,a){this.sourceCache.update(t,a),this._renderableTilesKeys=[];const u={};for(const d of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))u[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.posMatrix=new Float64Array(16),c.aN(d.posMatrix,0,c.W,0,c.W,0,1),this._tiles[d.key]=new oi(d,this.tileSize));for(const d in this._tiles)u[d]||delete this._tiles[d]}freeRtt(t){for(const a in this._tiles){const u=this._tiles[a];(!t||u.tileID.equals(t)||u.tileID.isChildOf(t)||t.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const a={};for(const u of this._renderableTilesKeys){const d=this._tiles[u].tileID;if(d.canonical.equals(t.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16),c.aN(g.posMatrix,0,c.W,0,c.W,0,1),a[u]=g}else if(d.canonical.isChildOf(t.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16);const w=d.canonical.z-t.canonical.z,T=d.canonical.x-(d.canonical.x>>w<<w),E=d.canonical.y-(d.canonical.y>>w<<w),C=c.W>>w;c.aN(g.posMatrix,0,C,0,C,0,1),c.H(g.posMatrix,g.posMatrix,[-T*C,-E*C,0]),a[u]=g}else if(t.canonical.isChildOf(d.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16);const w=t.canonical.z-d.canonical.z,T=t.canonical.x-(t.canonical.x>>w<<w),E=t.canonical.y-(t.canonical.y>>w<<w),C=c.W>>w;c.aN(g.posMatrix,0,c.W,0,c.W,0,1),c.H(g.posMatrix,g.posMatrix,[T*C,E*C,0]),c.J(g.posMatrix,g.posMatrix,[1/2**w,1/2**w,0]),a[u]=g}}return a}getSourceTile(t,a){const u=this.sourceCache._source;let d=t.overscaledZ-this.deltaZoom;if(d>u.maxzoom&&(d=u.maxzoom),d<u.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(d).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!g||!g.dem)&&a)for(;d>=u.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(t.scaledTo(d--).key);return g}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter(a=>a.timeAdded>=t)}}class Ji{constructor(t,a,u){this.painter=t,this.sourceCache=new Hi(a),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,a,u,d=c.W){var g;if(!(a>=0&&a<d&&u>=0&&u<d))return 0;const w=this.getTerrainData(t),T=(g=w.tile)===null||g===void 0?void 0:g.dem;if(!T)return 0;const E=function(X,ee,W){var he=ee[0],Te=ee[1];return X[0]=W[0]*he+W[4]*Te+W[12],X[1]=W[1]*he+W[5]*Te+W[13],X}([],[a/d*c.W,u/d*c.W],w.u_terrain_matrix),C=[E[0]*T.dim,E[1]*T.dim],k=Math.floor(C[0]),F=Math.floor(C[1]),j=C[0]-k,Q=C[1]-F;return T.get(k,F)*(1-j)*(1-Q)+T.get(k+1,F)*j*(1-Q)+T.get(k,F+1)*(1-j)*Q+T.get(k+1,F+1)*j*Q}getElevationForLngLatZoom(t,a){const{tileID:u,mercatorX:d,mercatorY:g}=this._getOverscaledTileIDFromLngLatZoom(t,a);return this.getElevation(u,d%c.W,g%c.W,c.W)}getElevation(t,a,u,d=c.W){return this.getDEMElevation(t,a,u,d)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const d=this.painter.context,g=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new He(d,g,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new He(d,new c.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const a=this.sourceCache.getSourceTile(t,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const d=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new He(d,a.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),a.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const u=a&&a+a.tileID.key+t.key;if(u&&!this._demMatrixCache[u]){const d=this.sourceCache.sourceCache._source.maxzoom;let g=t.canonical.z-a.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=d?g=t.canonical.z-d:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=t.canonical.x-(t.canonical.x>>g<<g),T=t.canonical.y-(t.canonical.y>>g<<g),E=c.b8(new Float64Array(16),[1/(c.W<<g),1/(c.W<<g),0]);c.H(E,E,[w*c.W,T*c.W,0]),this._demMatrixCache[t.key]={matrix:E,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(t){const a=this.painter,u=a.width/devicePixelRatio,d=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new He(a.context,{width:u,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new He(a.context,{width:u,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(u,d,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,u,d))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,w=0;g<this._coordsTextureSize;g++)for(let T=0;T<this._coordsTextureSize;T++,w+=4)a[w+0]=255&T,a[w+1]=255&g,a[w+2]=T>>8<<4|g>>8,a[w+3]=0;const u=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),d=new He(t,u,t.gl.RGBA,{premultiply:!1});return d.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(t){const a=new Uint8Array(4),u=this.painter.context,d=u.gl;u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),u.bindFramebuffer.set(null);const g=a[0]+(a[2]>>4<<8),w=a[1]+((15&a[2])<<8),T=this.coordsIndex[255-a[3]],E=T&&this.sourceCache.getTileByID(T);if(!E)return null;const C=this._coordsTextureSize,k=(1<<E.tileID.canonical.z)*C;return new c.Y((E.tileID.canonical.x*C+g)/k+E.tileID.wrap,(E.tileID.canonical.y*C+w)/k,this.getElevation(E.tileID,g,w,C))}depthAtPoint(t){const a=new Uint8Array(4),u=this.painter.context,d=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),d.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),u.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,a=new c.b9,u=new c.aX,d=this.meshSize,g=c.W/d,w=d*d;for(let F=0;F<=d;F++)for(let j=0;j<=d;j++)a.emplaceBack(j*g,F*g,0);for(let F=0;F<w;F+=d+1)for(let j=0;j<d;j++)u.emplaceBack(j+F,d+j+F+1,d+j+F+2),u.emplaceBack(j+F,d+j+F+2,j+F+1);const T=a.length,E=T+2*(d+1);for(const F of[0,1])for(let j=0;j<=d;j++)for(const Q of[0,1])a.emplaceBack(j*g,F*c.W,Q);for(let F=0;F<2*d;F+=2)u.emplaceBack(E+F,E+F+1,E+F+3),u.emplaceBack(E+F,E+F+3,E+F+2),u.emplaceBack(T+F,T+F+3,T+F+1),u.emplaceBack(T+F,T+F+2,T+F+3);const C=a.length,k=C+2*(d+1);for(const F of[0,1])for(let j=0;j<=d;j++)for(const Q of[0,1])a.emplaceBack(F*c.W,j*g,Q);for(let F=0;F<2*d;F+=2)u.emplaceBack(C+F,C+F+1,C+F+3),u.emplaceBack(C+F,C+F+3,C+F+2),u.emplaceBack(k+F,k+F+3,k+F+1),u.emplaceBack(k+F,k+F+2,k+F+3);return this._mesh={indexBuffer:t.createIndexBuffer(u),vertexBuffer:t.createVertexBuffer(a,mo.members),segments:c.$.simpleSegment(0,0,a.length,u.length)},this._mesh}getMeshFrameDelta(t){return 2*Math.PI*c.ba/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(t,a){var u;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(t,a);return(u=this.getMinMaxElevation(d).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(t){const a=this.getTerrainData(t).tile,u={minElevation:null,maxElevation:null};return a&&a.dem&&(u.minElevation=a.dem.min*this.exaggeration,u.maxElevation=a.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(t,a){const u=c.Y.fromLngLat(t.wrap()),d=(1<<a)*c.W,g=u.x*d,w=u.y*d,T=Math.floor(g/c.W),E=Math.floor(w/c.W);return{tileID:new c.Q(a,0,a,T,E),mercatorX:g,mercatorY:w}}}class Eh{constructor(t,a,u){this._context=t,this._size=a,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new He(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(u.texture),{id:t,fbo:a,texture:u,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>t.id!==a),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const Kn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class yl{constructor(t,a){this.painter=t,this.terrain=a,this.pool=new Eh(t.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(u=>!t._layers[u].isHidden(a)),this._coordsDescendingInv={};for(const u in t.sourceCaches){this._coordsDescendingInv[u]={};const d=t.sourceCaches[u].getVisibleCoordinates();for(const g of d){const w=this.terrain.sourceCache.getTerrainCoords(g);for(const T in w)this._coordsDescendingInv[u][T]||(this._coordsDescendingInv[u][T]=[]),this._coordsDescendingInv[u][T].push(w[T])}}this._coordsDescendingInvStr={};for(const u of t._order){const d=t._layers[u],g=d.source;if(Kn[d.type]&&!this._coordsDescendingInvStr[g]){this._coordsDescendingInvStr[g]={};for(const w in this._coordsDescendingInv[g])this._coordsDescendingInvStr[g][w]=this._coordsDescendingInv[g][w].map(T=>T.key).sort().join()}}for(const u of this._renderableTiles)for(const d in this._coordsDescendingInvStr){const g=this._coordsDescendingInvStr[d][u.tileID.key];g&&g!==u.rttCoords[d]&&(u.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const a=t.type,u=this.painter,d=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Kn[a]&&(this._prevType&&Kn[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(t.id),!d))return!0;if(Kn[this._prevType]||Kn[a]&&d){this._prevType=a;const g=this._stacks.length-1,w=this._stacks[g]||[];for(const T of this._renderableTiles){if(this.pool.isFull()&&(hl(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[g]){const C=this.pool.getObjectForId(T.rtt[g].id);if(C.stamp===T.rtt[g].stamp){this.pool.useObject(C);continue}}const E=this.pool.getOrCreateFreeObject();this.pool.useObject(E),this.pool.stampObject(E),T.rtt[g]={id:E.id,stamp:E.stamp},u.context.bindFramebuffer.set(E.fbo.framebuffer),u.context.clear({color:c.aO.transparent,stencil:0}),u.currentStencilSource=void 0;for(let C=0;C<w.length;C++){const k=u.style._layers[w[C]],F=k.source?this._coordsDescendingInv[k.source][T.tileID.key]:[T.tileID];u.context.viewport.set([0,0,E.fbo.width,E.fbo.height]),u._renderTileClippingMasks(k,F),u.renderLayer(u,u.style.sourceCaches[k.source],k,F),k.source&&(T.rttCoords[k.source]=this._coordsDescendingInvStr[k.source][T.tileID.key])}}return hl(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Kn[a]}return!1}}const Mc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},kc=A,Lc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:jr,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},ga=p=>{p.touchstart=p.dragStart,p.touchmoveWindow=p.dragMove,p.touchend=p.dragEnd},Rc={showCompass:!0,showZoom:!0,visualizePitch:!1};class Dc{constructor(t,a,u=!1){this.mousedown=w=>{this.startMouse(c.e({},w,{ctrlKey:!0,preventDefault:()=>w.preventDefault()}),M.mousePos(this.element,w)),M.addEventListener(window,"mousemove",this.mousemove),M.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.moveMouse(w,M.mousePos(this.element,w))},this.mouseup=w=>{this.mouseRotate.dragEnd(w),this.mousePitch&&this.mousePitch.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=M.touchPos(this.element,w.targetTouches)[0],this.startTouch(w,this._startPos),M.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),M.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=M.touchPos(this.element,w.targetTouches)[0],this.moveTouch(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const d=t.dragRotate._mouseRotate.getClickTolerance(),g=t.dragRotate._mousePitch.getClickTolerance();this.element=a,this.mouseRotate=Tc({clickTolerance:d,enable:!0}),this.touchRotate=(({enable:w,clickTolerance:T,bearingDegreesPerPixelMoved:E=.8})=>{const C=new ts;return new uo({clickTolerance:T,move:(k,F)=>({bearingDelta:(F.x-k.x)*E}),moveStateManager:C,enable:w,assignEvents:ga})})({clickTolerance:d,enable:!0}),this.map=t,u&&(this.mousePitch=pa({clickTolerance:g,enable:!0}),this.touchPitch=(({enable:w,clickTolerance:T,pitchDegreesPerPixelMoved:E=-.5})=>{const C=new ts;return new uo({clickTolerance:T,move:(k,F)=>({pitchDelta:(F.y-k.y)*E}),moveStateManager:C,enable:w,assignEvents:ga})})({clickTolerance:g,enable:!0})),M.addEventListener(a,"mousedown",this.mousedown),M.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),M.addEventListener(a,"touchcancel",this.reset)}startMouse(t,a){this.mouseRotate.dragStart(t,a),this.mousePitch&&this.mousePitch.dragStart(t,a),M.disableDrag()}startTouch(t,a){this.touchRotate.dragStart(t,a),this.touchPitch&&this.touchPitch.dragStart(t,a),M.disableDrag()}moveMouse(t,a){const u=this.map,{bearingDelta:d}=this.mouseRotate.dragMove(t,a)||{};if(d&&u.setBearing(u.getBearing()+d),this.mousePitch){const{pitchDelta:g}=this.mousePitch.dragMove(t,a)||{};g&&u.setPitch(u.getPitch()+g)}}moveTouch(t,a){const u=this.map,{bearingDelta:d}=this.touchRotate.dragMove(t,a)||{};if(d&&u.setBearing(u.getBearing()+d),this.touchPitch){const{pitchDelta:g}=this.touchPitch.dragMove(t,a)||{};g&&u.setPitch(u.getPitch()+g)}}off(){const t=this.element;M.removeEventListener(t,"mousedown",this.mousedown),M.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),M.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),M.removeEventListener(window,"touchend",this.touchend),M.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){M.enableDrag(),M.removeEventListener(window,"mousemove",this.mousemove),M.removeEventListener(window,"mouseup",this.mouseup),M.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),M.removeEventListener(window,"touchend",this.touchend)}}let is;function vl(p,t,a){const u=new c.M(p.lng,p.lat);if(p=new c.M(p.lng,p.lat),t){const d=new c.M(p.lng-360,p.lat),g=new c.M(p.lng+360,p.lat),w=a.locationPoint(p).distSqr(t);a.locationPoint(d).distSqr(t)<w?p=d:a.locationPoint(g).distSqr(t)<w&&(p=g)}for(;Math.abs(p.lng-a.center.lng)>180;){const d=a.locationPoint(p);if(d.x>=0&&d.y>=0&&d.x<=a.width&&d.y<=a.height)break;p.lng>a.center.lng?p.lng-=360:p.lng+=360}return p.lng!==u.lng&&a.locationPoint(p).y>a.height/2-a.getHorizon()?p:u}const go={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xl(p,t,a){const u=p.classList;for(const d in go)u.remove(`maplibregl-${a}-anchor-${d}`);u.add(`maplibregl-${a}-anchor-${t}`)}class _o extends c.E{constructor(t){if(super(),this._onKeyPress=a=>{const u=a.code,d=a.charCode||a.keyCode;u!=="Space"&&u!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=a=>{const u=a.originalEvent.target,d=this._element;this._popup&&(u===d||d.contains(u))&&this.togglePopup()},this._update=a=>{var u;if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?vl(this._lngLat,this._flatPos,this._map.transform):(u=this._lngLat)===null||u===void 0?void 0:u.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),a&&a.type!=="moveend"||(this._pos=this._pos.round()),M.setTransform(this._element,`${go[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${g}`),B.frameAsync(new AbortController).then(()=>{this._updateOpacity(a&&a.type==="moveend")}).catch(()=>{})},this._onMove=a=>{if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(t==null?void 0:t.opacity,t==null?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=c.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=M.create("div"),this._element.setAttribute("aria-label","Map marker");const a=M.createNS("http://www.w3.org/2000/svg","svg"),u=41,d=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${u}px`),a.setAttributeNS(null,"width",`${d}px`),a.setAttributeNS(null,"viewBox",`0 0 ${d} ${u}`);const g=M.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"stroke","none"),g.setAttributeNS(null,"stroke-width","1"),g.setAttributeNS(null,"fill","none"),g.setAttributeNS(null,"fill-rule","evenodd");const w=M.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");const T=M.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const E=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const he of E){const Te=M.createNS("http://www.w3.org/2000/svg","ellipse");Te.setAttributeNS(null,"opacity","0.04"),Te.setAttributeNS(null,"cx","10.5"),Te.setAttributeNS(null,"cy","5.80029008"),Te.setAttributeNS(null,"rx",he.rx),Te.setAttributeNS(null,"ry",he.ry),T.appendChild(Te)}const C=M.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"fill",this._color);const k=M.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),C.appendChild(k);const F=M.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"opacity","0.25"),F.setAttributeNS(null,"fill","#000000");const j=M.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),F.appendChild(j);const Q=M.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Q.setAttributeNS(null,"fill","#FFFFFF");const X=M.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ee=M.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#000000"),ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962");const W=M.createNS("http://www.w3.org/2000/svg","circle");W.setAttributeNS(null,"fill","#FFFFFF"),W.setAttributeNS(null,"cx","5.5"),W.setAttributeNS(null,"cy","5.5"),W.setAttributeNS(null,"r","5.4999962"),X.appendChild(ee),X.appendChild(W),w.appendChild(T),w.appendChild(C),w.appendChild(F),w.appendChild(Q),w.appendChild(X),a.appendChild(w),a.setAttributeNS(null,"height",u*this._scale+"px"),a.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),xl(this._element,this._anchor,"marker"),t&&t.className)for(const a of t.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),M.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=c.M.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const d=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var a;if(!(!((a=this._map)===null||a===void 0)&&a.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const u=this._map,d=u.terrain.depthAtPoint(this._pos),g=u.terrain.getElevationForLngLatZoom(this._lngLat,u.transform.tileZoom);if(u.transform.lngLatToCameraDepth(this._lngLat,g)-d<.006)return void(this._element.style.opacity=this._opacity);const w=-this._offset.y/u.transform._pixelPerMeter,T=Math.sin(u.getPitch()*Math.PI/180)*w,E=u.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),C=u.transform.lngLatToCameraDepth(this._lngLat,g+T);this._element.style.opacity=C-E>.006?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=c.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,a){return t===void 0&&a===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const zc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Vs=0,Us=!1;const Oc={maxWidth:100,unit:"metric"};function yo(p,t,a){const u=a&&a.maxWidth||100,d=p._container.clientHeight/2,g=p.unproject([0,d]),w=p.unproject([u,d]),T=g.distanceTo(w);if(a&&a.unit==="imperial"){const E=3.2808*T;E>5280?$s(t,u,E/5280,p._getUIString("ScaleControl.Miles")):$s(t,u,E,p._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?$s(t,u,T/1852,p._getUIString("ScaleControl.NauticalMiles")):T>=1e3?$s(t,u,T/1e3,p._getUIString("ScaleControl.Kilometers")):$s(t,u,T,p._getUIString("ScaleControl.Meters"))}function $s(p,t,a,u){const d=function(g){const w=Math.pow(10,`${Math.floor(g)}`.length-1);let T=g/w;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(E){const C=Math.pow(10,Math.ceil(-Math.log(E)/Math.LN10));return Math.round(E*C)/C}(T),w*T}(a);p.style.width=t*(d/a)+"px",p.innerHTML=`${d}&nbsp;${u}`}const Fc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Bc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function bl(p){if(p){if(typeof p=="number"){const t=Math.round(Math.abs(p)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,p),"top-left":new c.P(t,t),"top-right":new c.P(-t,t),bottom:new c.P(0,-p),"bottom-left":new c.P(t,-t),"bottom-right":new c.P(-t,-t),left:new c.P(p,0),right:new c.P(-p,0)}}if(p instanceof c.P||Array.isArray(p)){const t=c.P.convert(p);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:c.P.convert(p.center||[0,0]),top:c.P.convert(p.top||[0,0]),"top-left":c.P.convert(p["top-left"]||[0,0]),"top-right":c.P.convert(p["top-right"]||[0,0]),bottom:c.P.convert(p.bottom||[0,0]),"bottom-left":c.P.convert(p["bottom-left"]||[0,0]),"bottom-right":c.P.convert(p["bottom-right"]||[0,0]),left:c.P.convert(p.left||[0,0]),right:c.P.convert(p.right||[0,0])}}return bl(new c.P(0,0))}const Nc=A;v.AJAXError=c.bd,v.Evented=c.E,v.LngLat=c.M,v.MercatorCoordinate=c.Y,v.Point=c.P,v.addProtocol=c.be,v.config=c.a,v.removeProtocol=c.bf,v.AttributionControl=Pc,v.BoxZoomHandler=wc,v.CanvasSource=ct,v.CooperativeGesturesHandler=po,v.DoubleClickZoomHandler=_l,v.DragPanHandler=Ic,v.DragRotateHandler=Th,v.EdgeInsets=da,v.FullscreenControl=class extends c.E{constructor(p={}){super(),this._onFullscreenChange=()=>{var t;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=a==null?void 0:a.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=M.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){M.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const p=this._fullscreenButton=M.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);M.create("span","maplibregl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.title=p}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},v.GeoJSONSource=Me,v.GeolocateControl=class extends c.E{constructor(p){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const a=new c.M(t.coords.longitude,t.coords.latitude),u=t.coords.accuracy,d=this._map.getBearing(),g=c.e({bearing:d},this.options.fitBoundsOptions),w=Y.fromLngLat(a,u);this._map.fitBounds(w,g,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const a=new c.M(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Us)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=t=>{if(this._map){if(this._container.addEventListener("contextmenu",a=>a.preventDefault()),this._geolocateButton=M.create("button","maplibregl-ctrl-geolocate",this._container),M.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",t===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=M.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new _o({element:this._dotElement}),this._circleElement=M.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new _o({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")))})}},this.options=c.e({},zc,p)}onAdd(p){return this._map=p,this._container=M.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(t=!1){return c._(this,void 0,void 0,function*(){if(is!==void 0&&!t)return is;if(window.navigator.permissions===void 0)return is=!!window.navigator.geolocation,is;try{is=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{is=!!window.navigator.geolocation}return is})}().then(t=>this._setupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),M.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Vs=0,Us=!1}_isOutOfMapMaxBounds(p){const t=this._map.getMaxBounds(),a=p.coords;return t&&(a.longitude<t.getWest()||a.longitude>t.getEast()||a.latitude<t.getSouth()||a.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const p=this._map.getBounds(),t=p.getSouthEast(),a=p.getNorthEast(),u=t.distanceTo(a),d=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Vs--,Us=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Vs++,Vs>1?(p={maximumAge:6e5,timeout:0},Us=!0):(p=this.options.positionOptions,Us=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},v.Hash=bc,v.ImageSource=qe,v.KeyboardHandler=bh,v.LngLatBounds=Y,v.LogoControl=Fn,v.Map=class extends Cc{constructor(p){if(c.bb.mark(c.bc.create),(p=c.e({},Lc,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new dl(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),{bearingSnap:p.bearingSnap}),this._contextLost=t=>{t.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:t}))},this._contextRestored=t=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:t}))},this._onMapScroll=t=>{if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=p.interactive,this._maxTileCacheSize=p.maxTileCacheSize,this._maxTileCacheZoomLevels=p.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=p.collectResourceTiming,this._renderTaskQueue=new xf,this._controls=[],this._mapId=c.a3(),this._locale=c.e({},Mc,p.locale),this._clickTolerance=p.clickTolerance,this._overridePixelRatio=p.pixelRatio,this._maxCanvasSize=p.maxCanvasSize,this.transformCameraUpdate=p.transformCameraUpdate,this._imageQueueHandle=Ce.addThrottleControl(()=>this.isMoving()),this._requestManager=new Re(p.transformRequest),typeof p.container=="string"){if(this._container=document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let t=!1;const a=xc(u=>{this._trackResize&&!this._removed&&this.resize(u)._update()},50);this._resizeObserver=new ResizeObserver(u=>{t?a(u):t=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ac(this,p),this._hash=p.hash&&new bc(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,c.e({},p.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=p.localIdeographFontFamily,this._validateStyle=p.validateStyle,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new Pc(typeof p.attributionControl=="boolean"?void 0:p.attributionControl)),p.maplibreLogo&&this.addControl(new Fn,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update(t.dataType==="style"),this.fire(new c.k(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new c.k(`${t.dataType}dataloading`,t))}),this.on("dataabort",t=>{this.fire(new c.k("sourcedataabort",t))})}_getMapId(){return this._mapId}addControl(p,t){if(t===void 0&&(t=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=p.onAdd(this);this._controls.push(p);const u=this._controlPositions[t];return t.indexOf("bottom")!==-1?u.insertBefore(a,u.firstChild):u.appendChild(a),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(p);return t>-1&&this._controls.splice(t,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}calculateCameraOptionsFromTo(p,t,a,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(p,t,a,u)}resize(p){var t;const a=this._containerDimensions(),u=a[0],d=a[1],g=this._getClampedPixelRatio(u,d);if(this._resizeCanvas(u,d,g),this.painter.resize(u,d,g),this.painter.overLimit()){const T=this.painter.context.gl;this._maxCanvasSize=[T.drawingBufferWidth,T.drawingBufferHeight];const E=this._getClampedPixelRatio(u,d);this._resizeCanvas(u,d,E),this.painter.resize(u,d,E)}this.transform.resize(u,d),(t=this._requestedCameraState)===null||t===void 0||t.resize(u,d);const w=!this._moving;return w&&(this.stop(),this.fire(new c.k("movestart",p)).fire(new c.k("move",p))),this.fire(new c.k("resize",p)),w&&this.fire(new c.k("moveend",p)),this}_getClampedPixelRatio(p,t){const{0:a,1:u}=this._maxCanvasSize,d=this.getPixelRatio(),g=p*d,w=t*d;return Math.min(g>a?a/g:1,w>u?u/w:1)*d}getPixelRatio(){var p;return(p=this._overridePixelRatio)!==null&&p!==void 0?p:devicePixelRatio}setPixelRatio(p){this._overridePixelRatio=p,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(p){return this.transform.setMaxBounds(Y.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this._update()}project(p){return this.transform.locationPoint(c.M.convert(p),this.style&&this.terrain)}unproject(p){return this.transform.pointLocation(c.P.convert(p),this.terrain)}isMoving(){var p;return this._moving||((p=this.handlers)===null||p===void 0?void 0:p.isMoving())}isZooming(){var p;return this._zooming||((p=this.handlers)===null||p===void 0?void 0:p.isZooming())}isRotating(){var p;return this._rotating||((p=this.handlers)===null||p===void 0?void 0:p.isRotating())}_createDelegatedListener(p,t,a){if(p==="mouseenter"||p==="mouseover"){let u=!1;return{layer:t,listener:a,delegates:{mousemove:g=>{const w=this.getLayer(t)?this.queryRenderedFeatures(g.point,{layers:[t]}):[];w.length?u||(u=!0,a.call(this,new an(p,this,g.originalEvent,{features:w}))):u=!1},mouseout:()=>{u=!1}}}}if(p==="mouseleave"||p==="mouseout"){let u=!1;return{layer:t,listener:a,delegates:{mousemove:w=>{(this.getLayer(t)?this.queryRenderedFeatures(w.point,{layers:[t]}):[]).length?u=!0:u&&(u=!1,a.call(this,new an(p,this,w.originalEvent)))},mouseout:w=>{u&&(u=!1,a.call(this,new an(p,this,w.originalEvent)))}}}}{const u=d=>{const g=this.getLayer(t)?this.queryRenderedFeatures(d.point,{layers:[t]}):[];g.length&&(d.features=g,a.call(this,d),delete d.features)};return{layer:t,listener:a,delegates:{[p]:u}}}}on(p,t,a){if(a===void 0)return super.on(p,t);const u=this._createDelegatedListener(p,t,a);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(u);for(const d in u.delegates)this.on(d,u.delegates[d]);return this}once(p,t,a){if(a===void 0)return super.once(p,t);const u=this._createDelegatedListener(p,t,a);for(const d in u.delegates)this.once(d,u.delegates[d]);return this}off(p,t,a){return a===void 0?super.off(p,t):(this._delegatedListeners&&this._delegatedListeners[p]&&(u=>{const d=this._delegatedListeners[p];for(let g=0;g<d.length;g++){const w=d[g];if(w.layer===t&&w.listener===a){for(const T in w.delegates)this.off(T,w.delegates[T]);return d.splice(g,1),this}}})(),this)}queryRenderedFeatures(p,t){if(!this.style)return[];let a;const u=p instanceof c.P||Array.isArray(p),d=u?p:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(u?{}:p)||{},d instanceof c.P||typeof d[0]=="number")a=[c.P.convert(d)];else{const g=c.P.convert(d[0]),w=c.P.convert(d[1]);a=[g,new c.P(w.x,g.y),w,new c.P(g.x,w.y),g]}return this.style.queryRenderedFeatures(a,t,this.transform)}querySourceFeatures(p,t){return this.style.querySourceFeatures(p,t)}setStyle(p,t){return(t=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(p,t))}setTransformRequest(p){return this._requestManager.setTransformRequest(p),this}_getUIString(p){const t=this._locale[p];if(t==null)throw new Error(`Missing UI string '${p}'`);return t}_updateStyle(p,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(p,t));const a=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!p)),p?(this.style=new _n(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p,t,a):this.style.loadJSON(p,t,a),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new _n(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,t){if(typeof p=="string"){const a=this._requestManager.transformRequest(p,be.Style);c.h(a,new AbortController).then(u=>{this._updateDiff(u.data,t)}).catch(u=>{u&&this.fire(new c.j(u))})}else typeof p=="object"&&this._updateDiff(p,t)}_updateDiff(p,t){try{this.style.setState(p,t)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(p,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(p,t){return this._lazyInitEmptyStyle(),this.style.addSource(p,t),this._update(!0)}isSourceLoaded(p){const t=this.style&&this.style.sourceCaches[p];if(t!==void 0)return t.loaded();this.fire(new c.j(new Error(`There is no source with ID '${p}'`)))}setTerrain(p){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),p){const t=this.style.sourceCaches[p.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${p.source}`);this.terrain===null&&t.reload();for(const a in this.style._layers){const u=this.style._layers[a];u.type==="hillshade"&&u.source===p.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ji(this.painter,t,p),this.painter.renderToTexture=new yl(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=a=>{a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==p.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:p})),this}getTerrain(){var p,t;return(t=(p=this.terrain)===null||p===void 0?void 0:p.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const p=this.style&&this.style.sourceCaches;for(const t in p){const a=p[t]._tiles;for(const u in a){const d=a[u];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}removeSource(p){return this.style.removeSource(p),this._update(!0)}getSource(p){return this.style.getSource(p)}addImage(p,t,a={}){const{pixelRatio:u=1,sdf:d=!1,stretchX:g,stretchY:w,content:T}=a;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||c.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:C,data:k}=t,F=t;return this.style.addImage(p,{data:new c.R({width:E,height:C},new Uint8Array(k)),pixelRatio:u,stretchX:g,stretchY:w,content:T,sdf:d,version:0,userImage:F}),F.onAdd&&F.onAdd(this,p),this}}{const{width:E,height:C,data:k}=B.getImageData(t);this.style.addImage(p,{data:new c.R({width:E,height:C},k),pixelRatio:u,stretchX:g,stretchY:w,content:T,sdf:d,version:0})}}updateImage(p,t){const a=this.style.getImage(p);if(!a)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=t instanceof HTMLImageElement||c.b(t)?B.getImageData(t):t,{width:d,height:g,data:w}=u;if(d===void 0||g===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==a.data.width||g!==a.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(t instanceof HTMLImageElement||c.b(t));return a.data.replace(w,T),this.style.updateImage(p,a),this}getImage(p){return this.style.getImage(p)}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p){return Ce.getImage(this._requestManager.transformRequest(p,be.Image),new AbortController)}listImages(){return this.style.listImages()}addLayer(p,t){return this._lazyInitEmptyStyle(),this.style.addLayer(p,t),this._update(!0)}moveLayer(p,t){return this.style.moveLayer(p,t),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(p,t,a){return this.style.setLayerZoomRange(p,t,a),this._update(!0)}setFilter(p,t,a={}){return this.style.setFilter(p,t,a),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,t,a,u={}){return this.style.setPaintProperty(p,t,a,u),this._update(!0)}getPaintProperty(p,t){return this.style.getPaintProperty(p,t)}setLayoutProperty(p,t,a,u={}){return this.style.setLayoutProperty(p,t,a,u),this._update(!0)}getLayoutProperty(p,t){return this.style.getLayoutProperty(p,t)}setGlyphs(p,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(p,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(p,t,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(p,t,a,u=>{u||this._update(!0)}),this}removeSprite(p){return this._lazyInitEmptyStyle(),this.style.removeSprite(p),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(p,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(p,t,a=>{a||this._update(!0)}),this}setLight(p,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(p,t){return this.style.setFeatureState(p,t),this._update()}removeFeatureState(p,t){return this.style.removeFeatureState(p,t),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let p=0,t=0;return this._container&&(p=this._container.clientWidth||400,t=this._container.clientHeight||300),[p,t]}_setupContainer(){const p=this._container;p.classList.add("maplibregl-map");const t=this._canvasContainer=M.create("div","maplibregl-canvas-container",p);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=M.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),u=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],u);const d=this._controlContainer=M.create("div","maplibregl-control-container",p),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{g[w]=M.create("div",`maplibregl-ctrl-${w} `,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,t,a){this._canvas.width=Math.floor(a*p),this._canvas.height=Math.floor(a*t),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const p={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{t={requestedAttributes:p},u&&(t.statusMessage=u.statusMessage,t.type=u.type)},{once:!0});const a=this._canvas.getContext("webgl2",p)||this._canvas.getContext("webgl",p);if(!a){const u="Failed to initialize WebGL";throw t?(t.message=u,new Error(JSON.stringify(t))):new Error(u)}this.painter=new dh(a,this.transform),re.testSupport(a)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_render(p){const t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),this._removed)return;let a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const d=this.transform.zoom,g=B.now();this.style.zoomHistory.update(d,g);const w=new c.a8(d,{now:g,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),T=w.crossFadingFactor();T===1&&T===this._crossFadingFactor||(a=!0,this._crossFadingFactor=T),this.style.update(w)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bb.mark(c.bc.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const u=this._sourcesDirty||this._styleDirty||this._placementDirty;return u||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||u||(this._fullyLoaded=!0,c.bb.mark(c.bc.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var p;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Ce.removeThrottleControl(this._imageQueueHandle),(p=this._resizeObserver)===null||p===void 0||p.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),M.remove(this._canvasContainer),M.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.bb.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,B.frameAsync(this._frameRequest).then(p=>{c.bb.frame(p),this._frameRequest=null,this._render(p)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get version(){return kc}getCameraTargetElevation(){return this.transform.elevation}},v.MapMouseEvent=an,v.MapTouchEvent=fa,v.MapWheelEvent=Fs,v.Marker=_o,v.NavigationControl=class{constructor(p){this._updateZoomButtons=()=>{const t=this._map.getZoom(),a=t===this._map.getMaxZoom(),u=t===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,a)=>{const u=this._map._getUIString(`NavigationControl.${a}`);t.title=u,t.setAttribute("aria-label",u)},this.options=c.e({},Rc,p),this._container=M.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),M.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),M.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=M.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Dc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){M.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(p,t){const a=M.create("button",p,this._container);return a.type="button",a.addEventListener("click",t),a}},v.Popup=class extends c.E{constructor(p){super(),this.remove=()=>(this._content&&M.remove(this._content),this._container&&(M.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map),this.fire(new c.k("close")),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var a;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=M.create("div","maplibregl-popup",this._map.getContainer()),this._tip=M.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const T of this.options.className.split(" "))this._container.classList.add(T);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?vl(this._lngLat,this._flatPos,this._map.transform):(a=this._lngLat)===null||a===void 0?void 0:a.wrap(),this._trackPointer&&!t)return;const u=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationPoint(this._lngLat));let d=this.options.anchor;const g=bl(this.options.offset);if(!d){const T=this._container.offsetWidth,E=this._container.offsetHeight;let C;C=u.y+g.bottom.y<E?["top"]:u.y>this._map.transform.height-E?["bottom"]:[],u.x<T/2?C.push("left"):u.x>this._map.transform.width-T/2&&C.push("right"),d=C.length===0?"bottom":C.join("-")}let w=u.add(g[d]);this.options.subpixelPositioning||(w=w.round()),M.setTransform(this._container,`${go[d]} translate(${w.x}px,${w.y}px)`),xl(this._container,d,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Fc),p)}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(p){return this._lngLat=c.M.convert(p),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const t=document.createDocumentFragment(),a=document.createElement("body");let u;for(a.innerHTML=p;u=a.firstChild,u;)t.appendChild(u);return this.setDOMContent(t)}getMaxWidth(){var p;return(p=this._container)===null||p===void 0?void 0:p.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=M.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(p){this._container&&this._container.classList.add(p)}removeClassName(p){this._container&&this._container.classList.remove(p)}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){if(this._container)return this._container.classList.toggle(p)}setSubpixelPositioning(p){this.options.subpixelPositioning=p}_createCloseButton(){this.options.closeButton&&(this._closeButton=M.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Bc);p&&p.focus()}},v.RasterDEMTileSource=Qe,v.RasterTileSource=Be,v.ScaleControl=class{constructor(p){this._onMove=()=>{yo(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,yo(this._map,this._container,this.options)},this.options=c.e({},Oc,p)}getDefaultPosition(){return"bottom-left"}onAdd(p){return this._map=p,this._container=M.create("div","maplibregl-ctrl maplibregl-ctrl-scale",p.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){M.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},v.ScrollZoomHandler=fo,v.Style=_n,v.TerrainControl=class{constructor(p){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=p}onAdd(p){return this._map=p,this._container=M.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=M.create("button","maplibregl-ctrl-terrain",this._container),M.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){M.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},v.TwoFingersTouchPitchHandler=Ec,v.TwoFingersTouchRotateHandler=ml,v.TwoFingersTouchZoomHandler=vh,v.TwoFingersTouchZoomRotateHandler=On,v.VectorTileSource=K,v.VideoSource=ft,v.addSourceType=(p,t)=>c._(void 0,void 0,void 0,function*(){if(Pe(p))throw new Error(`A source type called "${p}" already exists.`);((a,u)=>{xe[a]=u})(p,t)}),v.clearPrewarmedResources=function(){const p=Wt;p&&(p.isPreloaded()&&p.numActive()===1?(p.release(Bi),Wt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},v.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},v.getRTLTextPluginStatus=function(){return Oe().getRTLTextPluginStatus()},v.getVersion=function(){return Nc},v.getWorkerCount=function(){return Pi.workerCount},v.getWorkerUrl=function(){return c.a.WORKER_URL},v.importScriptInWorkers=function(p){return ht().broadcast("importScript",p)},v.prewarm=function(){nt().acquire(Bi)},v.setMaxParallelImageRequests=function(p){c.a.MAX_PARALLEL_IMAGE_REQUESTS=p},v.setRTLTextPlugin=function(p,t){return Oe().setRTLTextPlugin(p,t)},v.setWorkerCount=function(p){Pi.workerCount=p},v.setWorkerUrl=function(p){c.a.WORKER_URL=p}});var x=l;return x})})(Sx);var ia=Sx.exports;function kE(i){return{all:i=i||new Map,on:function(s,l){var f=i.get(s);f?f.push(l):i.set(s,[l])},off:function(s,l){var f=i.get(s);f&&(l?f.splice(f.indexOf(l)>>>0,1):i.set(s,[]))},emit:function(s,l){var f=i.get(s);f&&f.slice().map(function(m){m(l)}),(f=i.get("*"))&&f.slice().map(function(m){m(s,l)})}}}/*!
* vue-maplibre-gl v3.1.3
* (c) 2024 Volker Nauruhn
* @license MIT
*/var LE=Object.defineProperty,RE=(i,s,l)=>s in i?LE(i,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[s]=l,wr=(i,s,l)=>(RE(i,typeof s!="symbol"?s+"":s,l),l);const yr=Symbol("map"),qn=Symbol("isLoaded"),ra=Symbol("isInitialized"),Qr=Symbol("componentId"),en=Symbol("sourceId"),Ga=Symbol("sourceLayerRegistry"),Bm=Symbol("emitter");function Fo(i){return Object.keys(i)}const Kt=Xr({style:"https://demotiles.maplibre.org/style.json",center:Object.freeze([0,0]),zoom:1,trackResize:!1});class ls{static createEventHandler(s,l,f,m){return(x={})=>f.emit(m,{type:x.type,map:l,component:s,event:x})}}wr(ls,"MAP_OPTION_KEYS",["antialias","attributionControl","bearing","bearingSnap","bounds","boxZoom","center","clickTolerance","collectResourceTiming","crossSourceCollisions","container","customAttribution","dragPan","dragRotate","doubleClickZoom","hash","fadeDuration","failIfMajorPerformanceCaveat","fitBoundsOptions","interactive","keyboard","locale","localIdeographFontFamily","logoPosition","maxBounds","maxPitch","maxZoom","minPitch","minZoom","preserveDrawingBuffer","pitch","pitchWithRotate","refreshExpiredTiles","renderWorldCopies","scrollZoom","mapStyle","trackResize","transformRequest","touchZoomRotate","touchPitch","zoom","maxTileCacheSize","pixelRatio","cooperativeGestures"]),wr(ls,"MARKER_OPTION_KEYS",["element","offset","anchor","color","draggable","clickTolerance","rotation","rotationAlignment","pitchAlignment","scale"]),wr(ls,"MAP_EVENT_TYPES",["error","load","idle","remove","render","resize","webglcontextlost","webglcontextrestored","dataloading","data","tiledataloading","sourcedataloading","styledataloading","sourcedata","styledata","boxzoomcancel","boxzoomstart","boxzoomend","touchcancel","touchmove","touchend","touchstart","click","contextmenu","dblclick","mousemove","mouseup","mousedown","mouseout","mouseover","movestart","move","moveend","zoomstart","zoom","zoomend","rotatestart","rotate","rotateend","dragstart","drag","dragend","pitchstart","pitch","pitchend","wheel"]);var qa=(i=>(i.TOP_LEFT="top-left",i.TOP_RIGHT="top-right",i.BOTTOM_LEFT="bottom-left",i.BOTTOM_RIGHT="bottom-right",i))(qa||{});const na=Object.values(qa),Cd=new Map,Ex=Symbol("default");function DE(i=Ex){let s=Cd.get(i);return s||(s=Xr({isLoaded:!1,isMounted:!1,language:null}),Cd.set(i,s)),s}function zE(i,s,l=Ex){var f;let m=Cd.get(l);return m||(m=Xr({isLoaded:!1,isMounted:!1,language:null}),Cd.set(l,m)),m.isLoaded=!1,m.isMounted=!1,m.component=i,m.map=s.value,m.isLoaded=((f=s.value)==null?void 0:f.loaded())||!1,m}function OE(i,s=250,l=!1){let f;function m(){const x=arguments,v=()=>{f=void 0,l!==!0&&i.apply(this,x)};clearTimeout(f),l===!0&&f===void 0&&i.apply(this,x),f=window.setTimeout(v,s)}return m.cancel=()=>{clearTimeout(f)},m}const Ix={AUTO:"auto",STYLE_LOCK:"style_lock",LATIN:"latin",NON_LATIN:"nonlatin",LOCAL:"",ALBANIAN:"sq",AMHARIC:"am",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BASQUE:"eu",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CORSICAN:"co",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HINDI:"hi",HUNGARIAN:"hu",ICELANDIC:"is",INDONESIAN:"id",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",JAPANESE_HIRAGANA:"ja-Hira",JAPANESE_KANA:"ja_kana",JAPANESE_LATIN:"ja_rm",JAPANESE_2018:"ja-Latn",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",KOREAN_LATIN:"ko-Latn",KURDISH:"ku",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALAYALAM:"ml",MALTESE:"mt",NORWEGIAN:"no",OCCITAN:"oc",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SERBIAN_LATIN:"sr-Latn",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",TAMIL:"ta",TELUGU:"te",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"};new Set(Object.values(Ix));new Set(Object.values(Ix));function bp(i,s){const l=i.getStyle().layers,f=/^\s*{\s*name\s*(:\s*(\S*))?\s*}$/,m=/^\s*name\s*(:\s*(\S*))?\s*$/,x=/^\s*{\s*name\s*(:\s*(\S*))?\s*}(\s*){\s*name\s*(:\s*(\S*))?\s*}$/,v=/^(.*)({\s*name\s*(:\s*(\S*))?\s*})(.*)$/,c=s?`name:${s}`:"name",A=["case",["has",c],["get",c],["get","name"]];for(let R=0;R<l.length;R+=1){const z=l[R],B=z.layout;if(!B||!B["text-field"])continue;const M=i.getLayoutProperty(z.id,"text-field");let re;if(Array.isArray(M)&&M.length>=2&&M[0].trim().toLowerCase()==="concat"){const se=M.slice();for(let ue=0;ue<M.length;ue+=1){const ae=M[ue];if((typeof ae=="string"||ae instanceof String)&&f.exec(ae.toString())){se[ue]=A;break}else if(Array.isArray(ae)&&ae.length>=2&&ae[0].trim().toLowerCase()==="get"&&m.exec(ae[1].toString())){se[ue]=A;break}else if(Array.isArray(ae)&&ae.length===4&&ae[0].trim().toLowerCase()==="case"){se[ue]=A;break}}i.setLayoutProperty(z.id,"text-field",se)}else if(Array.isArray(M)&&M.length>=2&&M[0].trim().toLowerCase()==="get"&&m.exec(M[1].toString())){const se=A;i.setLayoutProperty(z.id,"text-field",se)}else if((typeof M=="string"||M instanceof String)&&f.exec(M.toString())){const se=A;i.setLayoutProperty(z.id,"text-field",se)}else if(Array.isArray(M)&&M.length===4&&M[0].trim().toLowerCase()==="case"){const se=A;i.setLayoutProperty(z.id,"text-field",se)}else if((typeof M=="string"||M instanceof String)&&(re=x.exec(M.toString()))!==null){const se=`{${c}}${re[3]}{name${re[4]||""}}`;i.setLayoutProperty(z.id,"text-field",se)}else if((typeof M=="string"||M instanceof String)&&(re=v.exec(M.toString()))!==null){const se=`${re[1]}{${c}}${re[5]}`;i.setLayoutProperty(z.id,"text-field",se)}}}const FE=di({name:"MglMap",props:{width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"100%"},antialias:{type:Boolean,default:()=>Kt.antialias},attributionControl:{type:Boolean,default:()=>Kt.attributionControl},bearing:{type:Number,default:()=>Kt.bearing},bearingSnap:{type:Number,default:()=>Kt.bearingSnap},bounds:{type:[Array,Object],default:()=>Kt.bounds},boxZoom:{type:Boolean,default:()=>Kt.boxZoom},center:{type:[Array,Object],default:()=>Kt.center},clickTolerance:{type:Number,default:()=>Kt.clickTolerance},collectResourceTiming:{type:Boolean,default:()=>Kt.collectResourceTiming},crossSourceCollisions:{type:Boolean,default:()=>Kt.crossSourceCollisions},customAttribution:{type:[String,Array],default:()=>Kt.customAttribution},dragPan:{type:Boolean,default:()=>Kt.dragPan},dragRotate:{type:Boolean,default:()=>Kt.dragRotate},doubleClickZoom:{type:Boolean,default:()=>Kt.doubleClickZoom},hash:{type:[Boolean,String],default:()=>Kt.hash},fadeDuration:{type:Number,default:()=>Kt.fadeDuration},failIfMajorPerformanceCaveat:{type:Boolean,default:()=>Kt.failIfMajorPerformanceCaveat},fitBoundsOptions:{type:Object,default:()=>Kt.fitBoundsOptions},interactive:{type:Boolean,default:()=>Kt.interactive},keyboard:{type:Boolean,default:()=>Kt.keyboard},locale:{type:Object,default:()=>Kt.locale},language:{type:String,default:()=>Kt.language||null},localIdeographFontFamily:{type:String,default:()=>Kt.localIdeographFontFamily},logoPosition:{type:[String],validator:i=>i in qa,default:()=>Kt.logoPosition},maxBounds:{type:[Array,Object],default:()=>Kt.maxBounds},maxPitch:{type:Number,default:()=>Kt.maxPitch},maxZoom:{type:Number,default:()=>Kt.maxZoom},minPitch:{type:Number,default:()=>Kt.minPitch},minZoom:{type:Number,default:()=>Kt.minZoom},preserveDrawingBuffer:{type:Boolean,default:()=>Kt.preserveDrawingBuffer},pitch:{type:Number,default:()=>Kt.pitch},pitchWithRotate:{type:Boolean,default:()=>Kt.pitchWithRotate},refreshExpiredTiles:{type:Boolean,default:()=>Kt.refreshExpiredTiles},renderWorldCopies:{type:Boolean,default:()=>Kt.renderWorldCopies},scrollZoom:{type:Boolean,default:()=>Kt.scrollZoom},mapStyle:{type:[String,Object],default:()=>Kt.style},trackResize:{type:Boolean,default:()=>Kt.trackResize},transformRequest:{type:Function,default:Kt.transformRequest},touchZoomRotate:{type:Boolean,default:()=>Kt.touchZoomRotate},touchPitch:{type:Boolean,default:()=>Kt.touchPitch},zoom:{type:Number,default:()=>Kt.zoom},maxTileCacheSize:{type:Number,default:()=>Kt.maxTileCacheSize},mapKey:{type:[String,Symbol]},pixelRatio:{type:Number,default:()=>Kt.pixelRatio},cooperativeGestures:{type:[Boolean,Object],default:()=>Kt.cooperativeGestures}},emits:["map:error","map:load","map:idle","map:remove","map:render","map:resize","map:webglcontextlost","map:webglcontextrestored","map:dataloading","map:data","map:tiledataloading","map:sourcedataloading","map:styledataloading","map:sourcedata","map:styledata","map:boxzoomcancel","map:boxzoomstart","map:boxzoomend","map:touchcancel","map:touchmove","map:touchend","map:touchstart","map:click","map:contextmenu","map:dblclick","map:mousemove","map:mouseup","map:mousedown","map:mouseout","map:mouseover","map:movestart","map:move","map:moveend","map:zoomstart","map:zoom","map:zoomend","map:rotatestart","map:rotate","map:rotateend","map:dragstart","map:drag","map:dragend","map:pitchstart","map:pitch","map:pitchend","map:wheel"],slots:Object,setup(i,s){const l=ql(Nr()),f=En(),m=En(),x=yi(!1),v=yi(!1),c=yi(!1),A=new Map,R=kE(),z=zE(l,m,i.mapKey);let B;Ai(yr,m),Ai(qn,v),Ai(ra,x),Ai(Qr,l.uid),Ai(en,""),Ai(Bm,R),Mt(()=>i.bearing,ae=>{var Z;ae&&((Z=m.value)==null||Z.setBearing(ae))}),Mt(()=>i.bounds,ae=>{var Z;ae&&((Z=m.value)==null||Z.fitBounds(ae,i.fitBoundsOptions))}),Mt(()=>i.center,ae=>{var Z;ae&&((Z=m.value)==null||Z.setCenter(ae))}),Mt(()=>i.maxBounds,ae=>{var Z;ae&&((Z=m.value)==null||Z.setMaxBounds(ae))}),Mt(()=>i.maxPitch,ae=>{var Z;ae&&((Z=m.value)==null||Z.setMaxPitch(ae))}),Mt(()=>i.maxZoom,ae=>{var Z;ae&&((Z=m.value)==null||Z.setMaxZoom(ae))}),Mt(()=>i.minPitch,ae=>{var Z;ae&&((Z=m.value)==null||Z.setMinPitch(ae))}),Mt(()=>i.minZoom,ae=>{var Z;ae&&((Z=m.value)==null||Z.setMinZoom(ae))}),Mt(()=>i.pitch,ae=>{var Z;ae&&((Z=m.value)==null||Z.setPitch(ae))}),Mt(()=>i.renderWorldCopies,ae=>{var Z;ae&&((Z=m.value)==null||Z.setRenderWorldCopies(ae))}),Mt(()=>i.mapStyle,ae=>{var Z;ae&&((Z=m.value)==null||Z.setStyle(ae))}),Mt(()=>i.transformRequest,ae=>{var Z;ae&&((Z=m.value)==null||Z.setTransformRequest(ae))}),Mt(()=>i.zoom,ae=>{var Z;ae&&((Z=m.value)==null||Z.setZoom(ae))}),Mt(()=>i.zoom,ae=>{var Z;ae&&((Z=m.value)==null||Z.setZoom(ae))}),Mt(()=>i.language,ae=>{c.value&&m.value&&z.language!==(ae||null)&&(bp(m.value,ae||""),z.language=ae||null)}),Mt(()=>z.language,ae=>{c.value&&m.value&&bp(m.value,ae||"")});function M(){c.value=!0,i.language?z.language=i.language:z.language&&bp(m.value,i.language||"")}function re(){z.isMounted=!0;const ae=Object.keys(i).filter(Z=>i[Z]!==void 0&&ls.MAP_OPTION_KEYS.indexOf(Z)!==-1).reduce((Z,me)=>(Z[me==="mapStyle"?"style":me]=Sr(i[me]),Z),{container:f.value});if(m.value=ql(new ia.Map(ae)),z.map=m.value,x.value=!0,A.set("__load",()=>(v.value=!0,z.isLoaded=!0)),m.value.once("styledata",M),m.value.on("load",A.get("__load")),l.vnode.props){for(let Z=0,me=ls.MAP_EVENT_TYPES.length;Z<me;Z++)if(l.vnode.props["onMap:"+ls.MAP_EVENT_TYPES[Z]]){const Ce=ls.createEventHandler(l,m.value,s,"map:"+ls.MAP_EVENT_TYPES[Z]);A.set(ls.MAP_EVENT_TYPES[Z],Ce),m.value.on(ls.MAP_EVENT_TYPES[Z],Ce)}}m.value.getCanvas().addEventListener("webglcontextlost",ue)}async function se(){z.isMounted=!1,z.isLoaded=!1,v.value=!1,m.value&&(m.value.getCanvas().removeEventListener("webglcontextlost",ue),m.value._controls.forEach(ae=>{m.value.removeControl(ae)}),x.value=!1,A.forEach((ae,Z)=>{m.value.off(Z.startsWith("__")?Z.substring(2):Z,ae)}),m.value.remove())}function ue(){se(),Ha(re)}return ic(()=>{re(),m.value&&(B=new ResizeObserver(OE(m.value.resize.bind(m.value),100)),B.observe(f.value))}),pn(()=>{B!==void 0&&(B.disconnect(),B=void 0),se()}),s.expose({map:m}),()=>Fr("div",{class:"mgl-container",style:{height:i.height,width:i.width}},[Fr("div",{ref:f,class:"mgl-wrapper"}),x.value&&s.slots.default?s.slots.default({}):void 0])}});function Wa(i,s,l){Mt(i,f=>{var m,x;f&&na.indexOf(f)===-1||((m=s.value)!=null&&m.hasControl(l)&&s.value.removeControl(l),(x=s.value)==null||x.addControl(l,f))},{immediate:!0})}const BE=di({name:"MglAttributionControl",props:{position:{type:String,validator:i=>na.indexOf(i)!==-1},compact:Boolean,customAttribution:[String,Array]},setup(i){const s=et(yr),l=et(ra),f=new ia.AttributionControl({compact:i.compact,customAttribution:i.customAttribution});Wa(()=>i.position,s,f),pn(()=>l.value&&s.value.removeControl(f))},render(){}}),Wp=class uu{constructor(s,l){wr(this,"container"),this.isAdded=s,this.container=document.createElement("div"),this.setClasses(l)}getDefaultPosition(){return qa.TOP_LEFT}onAdd(){return Ha(()=>this.isAdded.value=!0),this.container}onRemove(){this.isAdded.value=!1,this.container.remove()}setClasses(s){s?(this.container.classList.remove(uu.CONTROL_CLASS),this.container.classList.remove(uu.CONTROL_GROUP_CLASS)):(this.container.classList.add(uu.CONTROL_CLASS),this.container.classList.add(uu.CONTROL_GROUP_CLASS))}};wr(Wp,"CONTROL_CLASS","maplibregl-ctrl"),wr(Wp,"CONTROL_GROUP_CLASS","maplibregl-ctrl-group");let Ax=Wp;const NE=di({name:"MglCustomControl",props:{position:{type:String,validator:i=>na.indexOf(i)!==-1},noClasses:{type:Boolean,default:!1}},slots:Object,setup(i,{slots:s}){const l=et(yr),f=et(ra),m=yi(!1),x=new Ax(m,i.noClasses);return Wa(()=>i.position,l,x),Mt(()=>i.noClasses,v=>x.setClasses(v)),pn(()=>{var v;return f.value&&((v=l.value)==null?void 0:v.removeControl(x))}),()=>{var v;return m.value?Fr(B0,{to:x.container},(v=s.default)==null?void 0:v.call(s,{})):Mr("custom-component")}}}),VE=di({name:"MglFullscreenControl",props:{position:{type:String,default:qa.TOP_RIGHT,validator:i=>na.indexOf(i)!==-1},container:{type:Object,default:null}},setup(i){const s=et(yr),l=et(ra),f=new ia.FullscreenControl({container:i.container||void 0});function m(){Ha(()=>{var x;return(x=s.value)==null?void 0:x.resize()})}f.on("fullscreenstart",m),f.on("fullscreenend",m),Wa(()=>i.position,s,f),pn(()=>{var x;f.off("fullscreenstart",m),f.off("fullscreenend",m),l.value&&((x=s.value)==null||x.removeControl(f))})},render(){}});class UE{constructor(s="rgba(0,0,0,0.9)",l=4*window.devicePixelRatio,f="#7cf859",m="Monaco, Consolas, Courier, monospace",x=60*window.devicePixelRatio,v=90*window.devicePixelRatio,c=0,A=5*window.devicePixelRatio,R=100*window.devicePixelRatio){wr(this,"frames",0),wr(this,"totalTime",0),wr(this,"totalFrames",0),wr(this,"time",null),wr(this,"map"),wr(this,"container"),wr(this,"readOutput"),wr(this,"canvas"),wr(this,"eventHandlers",new Map),this.background=s,this.barWidth=l,this.color=f,this.font=m,this.graphHeight=x,this.graphWidth=v,this.graphTop=c,this.graphRight=A,this.width=R}getDefaultPosition(){return qa.TOP_RIGHT}onAdd(s){this.map=s;const l=this.container=document.createElement("div");return l.className="maplibregl-ctrl maplibregl-ctrl-fps",l.style.backgroundColor=this.background,l.style.borderRadius="6px",this.readOutput=document.createElement("div"),this.readOutput.style.color=this.color,this.readOutput.style.fontFamily=this.font,this.readOutput.style.padding="0 5px 5px",this.readOutput.style.fontSize="9px",this.readOutput.style.fontWeight="bold",this.readOutput.textContent="Waiting",this.canvas=document.createElement("canvas"),this.canvas.className="maplibregl-ctrl-canvas",this.canvas.width=this.width,this.canvas.height=this.graphHeight,this.canvas.style.cssText=`width: ${this.width/window.devicePixelRatio}px; height: ${this.graphHeight/window.devicePixelRatio}px;`,l.appendChild(this.readOutput),l.appendChild(this.canvas),this.eventHandlers.set("movestart",this.onMoveStart.bind(this)),this.eventHandlers.set("moveend",this.onMoveEnd.bind(this)),this.map.on("movestart",this.eventHandlers.get("movestart")),this.map.on("moveend",this.eventHandlers.get("moveend")),this.container}onRemove(){this.map.off("movestart",this.eventHandlers.get("movestart")),this.map.off("moveend",this.eventHandlers.get("moveend")),this.eventHandlers.clear(),this.container.parentNode.removeChild(this.container),this.map=void 0}onMoveStart(){this.frames=0,this.time=performance.now(),this.eventHandlers.set("render",this.onRender.bind(this)),this.map.on("render",this.eventHandlers.get("render"))}onMoveEnd(){const s=performance.now();this.updateGraph(this.getFPS(s)),this.frames=0,this.time=null,this.map.off("render",this.eventHandlers.get("render"))}onRender(){if(this.time){this.frames++;const s=performance.now();s>=this.time+1e3&&(this.updateGraph(this.getFPS(s)),this.frames=0,this.time=performance.now())}}getFPS(s){return this.totalTime+=s-this.time,this.totalFrames+=this.frames,Math.round(1e3*this.frames/(s-this.time))||0}updateGraph(s){const l=this.canvas.getContext("2d"),f=Math.round(1e3*this.totalFrames/this.totalTime)||0,m=(this.graphHeight,this.barWidth);l.fillStyle=this.background,l.globalAlpha=1,l.fillRect(0,0,this.graphWidth,this.graphTop),l.fillStyle=this.color,this.readOutput.textContent=`${s} FPS (${f} Avg)`,l.drawImage(this.canvas,this.graphRight+m,this.graphTop,this.graphWidth-m,this.graphHeight,this.graphRight,this.graphTop,this.graphWidth-m,this.graphHeight),l.fillRect(this.graphRight+this.graphWidth-m,this.graphTop,m,this.graphHeight),l.fillStyle=this.background,l.globalAlpha=.75,l.fillRect(this.graphRight+this.graphWidth-m,this.graphTop,m,(1-s/100)*this.graphHeight)}}const $E=di({name:"MglFrameRateControl",props:{position:{type:String,validator:i=>na.indexOf(i)!==-1},background:{type:String,default:"rgba(0,0,0,0.9)"},barWidth:{type:Number,default:4*window.devicePixelRatio},color:{type:String,default:"#7cf859"},font:{type:String,default:"Monaco, Consolas, Courier, monospace"},graphHeight:{type:Number,default:60*window.devicePixelRatio},graphWidth:{type:Number,default:90*window.devicePixelRatio},graphTop:{type:Number,default:0},graphRight:{type:Number,default:5*window.devicePixelRatio},width:{type:Number,default:100*window.devicePixelRatio}},setup(i){const s=et(yr),l=et(ra),f=new UE(i.background,i.barWidth,i.color,i.font,i.graphHeight,i.graphWidth,i.graphTop,i.graphRight,i.width);Wa(()=>i.position,s,f),pn(()=>{var m;return l.value&&((m=s.value)==null?void 0:m.removeControl(f))})},render(){}}),jE=di({name:"MglGeolocationControl",props:{position:{type:String,default:qa.TOP_RIGHT,validator:i=>na.indexOf(i)!==-1},positionOptions:{type:Object,default:{enableHighAccuracy:!1,timeout:6e3}},fitBoundsOptions:{type:Object,default:{maxZoom:15}},trackUserLocation:{type:Boolean,default:!1},showAccuracyCircle:{type:Boolean,default:!0},showUserLocation:{type:Boolean,default:!0}},setup(i){const s=et(yr),l=et(ra),f=new ia.GeolocateControl({positionOptions:i.positionOptions,fitBoundsOptions:i.fitBoundsOptions,trackUserLocation:i.trackUserLocation,showAccuracyCircle:i.showAccuracyCircle,showUserLocation:i.showUserLocation});Wa(()=>i.position,s,f),pn(()=>{var m;return l.value&&((m=s.value)==null?void 0:m.removeControl(f))})},render(){}}),HE=di({name:"MglNavigationControl",props:{position:{type:String,default:qa.TOP_RIGHT,validator:i=>na.indexOf(i)!==-1},showCompass:{type:Boolean,default:!0},showZoom:{type:Boolean,default:!0},visualizePitch:Boolean},setup(i){const s=et(yr),l=et(ra),f=new ia.NavigationControl({showCompass:i.showCompass,showZoom:i.showZoom,visualizePitch:i.visualizePitch});Wa(()=>i.position,s,f),pn(()=>{var m;return l.value&&((m=s.value)==null?void 0:m.removeControl(f))})},render(){}});var Cx=(i=>(i.IMPERIAL="imperial",i.METRIC="metric",i.NAUTICAL="nautical",i))(Cx||{});const GE=Object.values(Cx),qE=di({name:"MglScaleControl",props:{position:{type:String,validator:i=>na.indexOf(i)!==-1},maxWidth:{type:Number,default:100},unit:{type:String,default:"metric",validator:i=>GE.indexOf(i)!==-1}},setup(i){const s=et(yr),l=et(ra),f=new ia.ScaleControl({maxWidth:i.maxWidth,unit:i.unit});Wa(()=>i.position,s,f),pn(()=>{var m;return l.value&&((m=s.value)==null?void 0:m.removeControl(f))})},render(){}});var Pd=(i=>(i.DEFAULT="default",i.TEXT="text",i.MDI="mdi",i.SIMPLE_ICON="simple-icons",i))(Pd||{});const WE=Object.values(Pd),cd={text:void 0,mdi:{size:21,viewbox:"0 0 24 24"},"simple-icons":{size:21,viewbox:"0 0 24 24"},default:{size:0,viewbox:"0 0 0 0"}},Zp=di({name:"MglButton",props:{type:{type:String,default:"default",validator:i=>WE.indexOf(i)!==-1},path:{type:String},size:Number,viewbox:String},slots:Object,setup(i,{slots:s}){!i.path&&i.type!=="text"&&JS();const l=yi(cd[i.type]||cd.default);return Mt(()=>i.type,f=>l.value=cd[f]||cd.default),()=>{var f,m;return i.type==="text"?Fr("button",{type:"button"},(f=s.default)==null?void 0:f.call(s,{})):Fr("button",{type:"button",class:"maplibregl-ctrl-icon"},[Fr("svg",{width:i.size||l.value.size,height:i.size||l.value.size,viewBox:i.viewbox||l.value.viewbox},Fr("path",{fill:"currentColor",d:i.path})),(m=s.default)==null?void 0:m.call(s,{})])}}});function Ny(i){return i&&!!i.stopPropagation}const ZE=di({name:"MglStyleSwitchControl",props:{position:{type:String,validator:i=>na.indexOf(i)!==-1},mapStyles:{type:Array,required:!0,default:[]},modelValue:{type:Object},isOpen:{type:Boolean,default:void 0}},slots:Object,emits:["update:modelValue","update:isOpen"],setup(i,{emit:s,slots:l}){const f=et(yr),m=et(ra),x=et(qn),v=et(Bm),c=yi(!1),A=yi(i.isOpen===void 0?!1:i.isOpen),R=En(i.modelValue===void 0?i.mapStyles.length?i.mapStyles[0]:null:i.modelValue),z=new Ax(c,!1),B=se.bind(null,!1);function M(){const ue=f.value.getStyle().name;for(let ae=0,Z=i.mapStyles.length;ae<Z;ae++)if(i.mapStyles[ae].name===ue){re(i.mapStyles[ae]);break}}Mt(x,ue=>{ue&&M()},{immediate:!0}),f.value.on("style.load",M),document.addEventListener("click",B),Wa(()=>i.position,f,z),i.modelValue!==void 0&&Mt(()=>i.modelValue,ue=>{ue!==void 0&&(R.value=ue)}),i.isOpen!==void 0&&Mt(()=>i.isOpen,ue=>{ue!==void 0&&(A.value=ue)}),pn(()=>{m.value&&(f.value.removeControl(z),f.value.off("style.load",M)),document.removeEventListener("click",B)});function re(ue){var ae;((ae=R.value)==null?void 0:ae.name)!==ue.name&&(v.emit("styleSwitched",ue),f.value.setStyle(ue.style,{diff:!1}),i.modelValue===void 0&&(R.value=ue),s("update:modelValue",ue),se(!1))}function se(ue,ae){Ny(ae)?ae.stopPropagation():Ny(ue)&&ue.stopPropagation(),!(i.isOpen!==void 0&&i.isOpen===ue||A.value===ue)&&(i.isOpen===void 0?(A.value=typeof ue=="boolean"?ue:!A.value,s("update:isOpen",A.value)):s("update:isOpen",typeof ue=="boolean"?ue:!i.isOpen))}return()=>{if(!c.value)return Mr("style-switch-control");const ue={isOpen:A,toggleOpen:se,setStyle:re,mapStyles:i.mapStyles,currentStyle:R};return Fr(B0,{to:z.container},l.default?l.default(ue):[l.button?l.button(ue):Fr(Zp,{type:Pd.MDI,path:"M12,18.54L19.37,12.8L21,14.07L12,21.07L3,14.07L4.62,12.81L12,18.54M12,16L3,9L12,2L21,9L12,16M12,4.53L6.26,9L12,13.47L17.74,9L12,4.53Z",class:["maplibregl-ctrl-icon maplibregl-style-switch",A.value?"is-open":""],onClick:se.bind(null,!0)}),l.styleList?l.styleList(ue):Fr("div",{class:["maplibregl-style-list",A.value?"is-open":""]},i.mapStyles.map(ae=>{var Z,me;return ae.icon?Fr(Zp,{type:Pd.MDI,path:ae.icon.path,class:((Z=R.value)==null?void 0:Z.name)===ae.name?"is-active":"",onClick:()=>re(ae)},Np(ae.label)):Fr("button",{type:"button",class:((me=R.value)==null?void 0:me.name)===ae.name?"is-active":"",onClick:()=>re(ae)},Np(ae.label))}))])}},template:`
		<slot>
		<slot name="button"></slot>
		<slot name="styleList"></slot>
		</slot>
	`}),KE=di({name:"MglMarker",props:{coordinates:{type:[Object,Array],required:!0},offset:[Object,Array],anchor:String,color:String,clickTolerance:Number,rotation:Number,rotationAlignment:String,pitchAlignment:String,scale:Number},setup(i){const s=et(yr),l=Object.keys(i).filter(m=>i[m]!==void 0&&ls.MARKER_OPTION_KEYS.indexOf(m)!==-1).reduce((m,x)=>(m[x]=Sr(i[x]),m),{}),f=new ia.Marker(l);return f.setLngLat(i.coordinates).addTo(s.value),Mt(()=>i.coordinates,m=>f.setLngLat(m)),Mt(()=>i.offset,m=>f.setOffset(m||[0,0])),Mt(()=>i.pitchAlignment,m=>f.setPitchAlignment(m||"auto")),Mt(()=>i.rotationAlignment,m=>f.setRotationAlignment(m||"auto")),pn(f.remove.bind(f)),{marker:f}},render(){}});class Bo{constructor(){wr(this,"unmountHandlers",new Map)}registerUnmountHandler(s,l){this.unmountHandlers.set(s,l)}unregisterUnmountHandler(s){this.unmountHandlers.delete(s)}unmount(){this.unmountHandlers.forEach(s=>s())}}const Px=class Kp{static genSourceOpts(s,l,f){return Object.keys(l).filter(m=>l[m]!==void 0&&f.indexOf(m)!==-1).reduce((m,x)=>(m[x]=Sr(l[x]),m),{type:s})}static getSourceRef(s,l){const f=typeof l=="string",m=String(s)+(f?l:"");let x=Kp.REFS.get(m);return x||(x=yi(f?null:void 0),Kp.REFS.set(m,x)),x}};wr(Px,"REFS",new Map);let tn=Px;function No(i,s,l,f,m){const x=et(yr),v=et(qn),c=et(Bm);function A(){v.value&&(x.value.addSource(s.sourceId,tn.genSourceOpts(l,s,f)),i.value=x.value.getSource(s.sourceId))}function R(){i.value=null}return Mt(v,A,{immediate:!0}),x.value.on("style.load",A),c.on("styleSwitched",R),pn(()=>{v.value&&(m.unmount(),x.value.removeSource(s.sourceId)),x.value.off("style.load",A),c.off("styleSwitched",R)})}const YE=Fo({animate:void 0,canvas:void 0,coordinates:void 0}),XE=di({name:"MglCanvasSource",props:{sourceId:{type:String,required:!0},coordinates:Array,animate:Boolean,canvas:[Object,String]},slots:Object,setup(i,{slots:s}){const l=et(Qr),f=tn.getSourceRef(l,i.sourceId),m=new Bo;return Ai(en,i.sourceId),Ai(Ga,m),No(f,i,"canvas",YE,m),Mt(Fi(i.coordinates)?i.coordinates:()=>i.coordinates,x=>{var v;(v=f.value)==null||v.setCoordinates(x)},{immediate:!0}),()=>[Mr("Canvas Source"),f.value&&s.default?s.default({}):void 0]}}),JE=Fo({data:void 0,maxzoom:void 0,attribution:void 0,buffer:void 0,tolerance:void 0,cluster:void 0,clusterRadius:void 0,clusterMaxZoom:void 0,clusterMinPoints:void 0,clusterProperties:void 0,lineMetrics:void 0,generateId:void 0,promoteId:void 0,filter:void 0}),QE=di({name:"MglGeoJsonSource",props:{sourceId:{type:String,required:!0},data:[Object,String],maxzoom:Number,attribution:String,buffer:Number,tolerance:Number,cluster:[Number,Boolean],clusterRadius:Number,clusterMaxZoom:Number,clusterMinPoints:Number,clusterProperties:Object,lineMetrics:Boolean,generateId:Boolean,promoteId:[Object,String],filter:[Array,String,Object]},slots:Object,setup(i,{slots:s}){const l=et(Qr),f=tn.getSourceRef(l,i.sourceId),m=new Bo;return Ai(en,i.sourceId),Ai(Ga,m),No(f,i,"geojson",JE,m),Mt(Fi(i.data)?i.data:()=>i.data,x=>{var v;(v=f.value)==null||v.setData(x||{type:"FeatureCollection",features:[]})},{immediate:!0}),()=>[Mr("GeoJSON Source"),f.value&&s.default?s.default({}):void 0]}}),eI=Fo({url:void 0,coordinates:void 0}),tI=di({name:"MglImageSource",props:{sourceId:{type:String,required:!0},url:String,coordinates:Array},slots:Object,setup(i,{slots:s}){const l=et(Qr),f=tn.getSourceRef(l,i.sourceId),m=new Bo;return Ai(en,i.sourceId),Ai(Ga,m),No(f,i,"image",eI,m),Mt(Fi(i.coordinates)?i.coordinates:()=>i.coordinates,x=>{var v;(v=f.value)==null||v.setCoordinates(x)},{immediate:!0}),()=>[Mr("Image Source"),f.value&&s.default?s.default({}):void 0]}}),iI=Fo({url:void 0,tiles:void 0,bounds:void 0,minzoom:void 0,maxzoom:void 0,tileSize:void 0,scheme:void 0,attribution:void 0,volatile:void 0}),rI=di({name:"MglRasterSource",props:{sourceId:{type:String,required:!0},url:String,tiles:Array,bounds:Array,minzoom:Number,maxzoom:Number,tileSize:Number,scheme:String,attribution:String,volatile:Boolean},slots:Object,setup(i,{slots:s}){const l=et(Qr),f=tn.getSourceRef(l,i.sourceId),m=new Bo;return Ai(en,i.sourceId),Ai(Ga,m),No(f,i,"raster",iI,m),()=>[Mr("Raster Source"),f.value&&s.default?s.default({}):void 0]}}),nI=Fo({url:void 0,tiles:void 0,bounds:void 0,minzoom:void 0,maxzoom:void 0,tileSize:void 0,attribution:void 0,encoding:void 0,volatile:void 0,redFactor:void 0,blueFactor:void 0,greenFactor:void 0,baseShift:void 0}),sI=di({name:"MglRasterDemSource",props:{sourceId:{type:String,required:!0},url:String,tiles:Array,bounds:Array,minzoom:Number,maxzoom:Number,tileSize:Number,attribution:String,encoding:String,volatile:Boolean,redFactor:Number,blueFactor:Number,greenFactor:Number,baseShift:Number},slots:Object,setup(i,{slots:s}){const l=et(Qr),f=tn.getSourceRef(l,i.sourceId),m=new Bo;return Ai(en,i.sourceId),Ai(Ga,m),No(f,i,"raster-dem",nI,m),()=>[Mr("RasterDem Source"),f.value&&s.default?s.default({}):void 0]}}),aI=Fo({url:void 0,tiles:void 0,bounds:void 0,scheme:void 0,minzoom:void 0,maxzoom:void 0,attribution:void 0,promoteId:void 0,volatile:void 0}),oI=di({name:"MglVectorSource",props:{sourceId:{type:String,required:!0},url:String,tiles:Array,bounds:Array,scheme:String,minzoom:Number,maxzoom:Number,attribution:String,promoteId:[Object,String],volatile:Boolean},slots:Object,setup(i,{slots:s}){const l=et(Qr),f=tn.getSourceRef(l,i.sourceId),m=new Bo;return Ai(en,i.sourceId),Ai(Ga,m),No(f,i,"vector",aI,m),Mt(Fi(i.tiles)?i.tiles:()=>i.tiles,x=>{var v;(v=f.value)==null||v.setTiles(x||[])},{immediate:!0}),Mt(Fi(i.url)?i.url:()=>i.url,x=>{var v;(v=f.value)==null||v.setUrl(x||"")},{immediate:!0}),()=>[Mr("Vector Source"),f.value&&s.default?s.default({}):void 0]}}),lI=Fo({urls:void 0,coordinates:void 0}),cI=di({name:"MglVideoSource",props:{sourceId:{type:String,required:!0},urls:Array,coordinates:Array},slots:Object,setup(i,{slots:s}){const l=et(Qr),f=tn.getSourceRef(l,i.sourceId),m=new Bo;return Ai(en,i.sourceId),Ai(Ga,m),No(f,i,"video",lI,m),Mt(Fi(i.coordinates)?i.coordinates:()=>i.coordinates,x=>{var v;(v=f.value)==null||v.setCoordinates(x)},{immediate:!0}),()=>[Mr("Video Source"),f.value&&s.default?s.default({}):void 0]}}),md=class Ts{static genLayerOpts(s,l,f,m){return Object.keys(f).filter(x=>f[x]!==void 0&&Ts.SOURCE_OPTS.indexOf(x)!==-1).reduce((x,v)=>(x[v==="sourceLayer"?"source-layer":v]=Sr(f[v]),x),{type:l,source:f.source||m,id:s})}static registerLayerEvents(s,l,f){if(f.props)for(let m=0,x=Ts.LAYER_EVENTS.length;m<x;m++){const v="on"+Ts.LAYER_EVENTS[m].charAt(0).toUpperCase()+Ts.LAYER_EVENTS[m].substr(1);f.props[v]&&s.on(Ts.LAYER_EVENTS[m],l,f.props[v])}}static unregisterLayerEvents(s,l,f){if(f.props)for(let m=0,x=Ts.LAYER_EVENTS.length;m<x;m++){const v="on"+Ts.LAYER_EVENTS[m].charAt(0).toUpperCase()+Ts.LAYER_EVENTS[m].substr(1);f.props[v]&&s.off(Ts.LAYER_EVENTS[m],l,f.props[v])}}};wr(md,"SOURCE_OPTS",["metadata","ref","source","sourceLayer","minzoom","maxzoom","interactive","filter","layout","paint"]),wr(md,"LAYER_EVENTS",["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","mouseover","mouseout","contextmenu","touchstart","touchend","touchcancel"]),wr(md,"SHARED",{props:{layerId:{type:String,required:!0},source:[String,Object],metadata:[Object,Array,String,Number],sourceLayer:String,minzoom:Number,maxzoom:Number,interactive:Boolean,filter:Array,before:String},emits:["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","mouseover","mouseout","contextmenu","touchstart","touchend","touchcancel"]});let ui=md;function sa(i,s){const l=et(yr),f=et(qn),m=et(Ga);function x(){f.value&&(s&&ui.unregisterLayerEvents(l.value,i,s.vnode),l.value.getLayer(i)&&l.value.removeLayer(i))}m.registerUnmountHandler(i,x),pn(()=>{m.unregisterUnmountHandler(i),x()})}const uI=di({name:"MglBackgroundLayer",props:{...ui.SHARED.props,layout:Object,paint:Object},emits:[...ui.SHARED.emits],setup(i){const s=et(en);if(!s&&!i.source)return;const l=et(yr),f=et(qn),m=et(Qr),x=tn.getSourceRef(m,i.source||s);return sa(i.layerId),Mt([f,x],([v,c])=>{v&&(c||c===void 0)&&l.value.addLayer(ui.genLayerOpts(i.layerId,"background",i,s),i.before||void 0)},{immediate:!0}),()=>Mr("Background Layer")}}),hI=di({name:"MglCircleLayer",props:{...ui.SHARED.props,layout:Object,paint:Object},emits:[...ui.SHARED.emits],setup(i){const s=et(en);if(!s&&!i.source)return;const l=Nr(),f=et(yr),m=et(qn),x=et(Qr),v=tn.getSourceRef(x,i.source||s);return sa(i.layerId,l),Mt([m,v],([c,A])=>{c&&(A||A===void 0)&&(f.value.addLayer(ui.genLayerOpts(i.layerId,"circle",i,s),i.before||void 0),ui.registerLayerEvents(f.value,i.layerId,l.vnode))},{immediate:!0}),()=>Mr("Circle Layer")}}),dI=di({name:"MglFillLayer",props:{...ui.SHARED.props,layout:Object,paint:Object},emits:[...ui.SHARED.emits],setup(i){const s=et(en);if(!s&&!i.source)return;const l=Nr(),f=et(yr),m=et(qn),x=et(Qr),v=tn.getSourceRef(x,i.source||s);return sa(i.layerId,l),Mt([m,v],([c,A])=>{c&&(A||A===void 0)&&(f.value.addLayer(ui.genLayerOpts(i.layerId,"fill",i,s),i.before||void 0),ui.registerLayerEvents(f.value,i.layerId,l.vnode))},{immediate:!0}),()=>Mr("Fill Layer")}}),fI=di({name:"MglFillExtrusionLayer",props:{...ui.SHARED.props,layout:Object,paint:Object},emits:[...ui.SHARED.emits],setup(i){const s=et(en);if(!s&&!i.source)return;const l=Nr(),f=et(yr),m=et(qn),x=et(Qr),v=tn.getSourceRef(x,i.source||s);return sa(i.layerId,l),Mt([m,v],([c,A])=>{c&&(A||A===void 0)&&(f.value.addLayer(ui.genLayerOpts(i.layerId,"fill-extrusion",i,s),i.before||void 0),ui.registerLayerEvents(f.value,i.layerId,l.vnode))},{immediate:!0}),()=>Mr("Fill Extrusion Layer")}}),pI=di({name:"MglHeatmapLayer",props:{...ui.SHARED.props,layout:Object,paint:Object},emits:[...ui.SHARED.emits],setup(i){const s=et(en);if(!s&&!i.source)return;const l=Nr(),f=et(yr),m=et(qn),x=et(Qr),v=tn.getSourceRef(x,i.source||s);return sa(i.layerId,l),Mt([m,v],([c,A])=>{c&&(A||A===void 0)&&(f.value.addLayer(ui.genLayerOpts(i.layerId,"heatmap",i,s),i.before||void 0),ui.registerLayerEvents(f.value,i.layerId,l.vnode))},{immediate:!0}),()=>Mr("Heatmap Layer")}}),mI=di({name:"MglHillshadeLayer",props:{...ui.SHARED.props,layout:Object,paint:Object},emits:[...ui.SHARED.emits],setup(i){const s=et(en);if(!s&&!i.source)return;const l=Nr(),f=et(yr),m=et(qn),x=et(Qr),v=tn.getSourceRef(x,i.source||s);return sa(i.layerId,l),Mt([m,v],([c,A])=>{c&&(A||A===void 0)&&(f.value.addLayer(ui.genLayerOpts(i.layerId,"hillshade",i,s),i.before||void 0),ui.registerLayerEvents(f.value,i.layerId,l.vnode))},{immediate:!0}),()=>Mr("Hillshade Layer")}}),gI=di({name:"MglLineLayer",props:{...ui.SHARED.props,layout:Object,paint:Object},emits:[...ui.SHARED.emits],setup(i){const s=et(en);if(!s&&!i.source)return;const l=Nr(),f=et(yr),m=et(qn),x=et(Qr),v=tn.getSourceRef(x,i.source||s);return sa(i.layerId,l),Mt([m,v],([c,A])=>{c&&(A||A===void 0)&&(f.value.addLayer(ui.genLayerOpts(i.layerId,"line",i,s),i.before||void 0),ui.registerLayerEvents(f.value,i.layerId,l.vnode))},{immediate:!0}),()=>Mr("Line Layer")}}),_I=di({name:"MglRasterLayer",props:{...ui.SHARED.props,layout:Object,paint:Object},emits:[...ui.SHARED.emits],setup(i){const s=et(en);if(!s&&!i.source)return;const l=Nr(),f=et(yr),m=et(qn),x=et(Qr),v=tn.getSourceRef(x,i.source||s);return sa(i.layerId,l),Mt([m,v],([c,A])=>{c&&(A||A===void 0)&&(f.value.addLayer(ui.genLayerOpts(i.layerId,"raster",i,s),i.before||void 0),ui.registerLayerEvents(f.value,i.layerId,l.vnode))},{immediate:!0}),()=>Mr("Raster Layer")}}),yI=di({name:"MglSymbolLayer",props:{...ui.SHARED.props,layout:Object,paint:Object},emits:[...ui.SHARED.emits],setup(i){const s=et(en);if(!s&&!i.source)return;const l=Nr(),f=et(yr),m=et(qn),x=et(Qr),v=tn.getSourceRef(x,i.source||s);return sa(i.layerId,l),Mt([m,v],([c,A])=>{c&&(A||A===void 0)&&(f.value.addLayer(ui.genLayerOpts(i.layerId,"symbol",i,s),i.before||void 0),ui.registerLayerEvents(f.value,i.layerId,l.vnode))},{immediate:!0}),()=>Mr("Symbol Layer")}}),vI=Object.freeze(Object.defineProperty({__proto__:null,MglAttributionControl:BE,MglBackgroundLayer:uI,MglButton:Zp,MglCanvasSource:XE,MglCircleLayer:hI,MglCustomControl:NE,MglFillExtrusionLayer:fI,MglFillLayer:dI,MglFrameRateControl:$E,MglFullscreenControl:VE,MglGeoJsonSource:QE,MglGeolocationControl:jE,MglHeatmapLayer:pI,MglHillshadeLayer:mI,MglImageSource:tI,MglLineLayer:gI,MglMap:FE,MglMarker:KE,MglNavigationControl:HE,MglRasterDemSource:sI,MglRasterLayer:_I,MglRasterSource:rI,MglScaleControl:qE,MglStyleSwitchControl:ZE,MglSymbolLayer:yI,MglVectorSource:oI,MglVideoSource:cI},Symbol.toStringTag,{value:"Module"})),xI=function(i){Object.entries(vI).forEach(([s,l])=>{i.component(s,l)})};var bI=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let Mx;const Kd=i=>Mx=i,kx=Symbol();function Yp(i){return i&&typeof i=="object"&&Object.prototype.toString.call(i)==="[object Object]"&&typeof i.toJSON!="function"}var gu;(function(i){i.direct="direct",i.patchObject="patch object",i.patchFunction="patch function"})(gu||(gu={}));function wI(){const i=Fd(!0),s=i.run(()=>yi({}));let l=[],f=[];const m=ql({install(x){Kd(m),m._a=x,x.provide(kx,m),x.config.globalProperties.$pinia=m,f.forEach(v=>l.push(v)),f=[]},use(x){return!this._a&&!bI?f.push(x):l.push(x),this},_p:l,_a:null,_e:i,_s:new Map,state:s});return m}const Lx=()=>{};function Vy(i,s,l,f=Lx){i.push(s);const m=()=>{const x=i.indexOf(s);x>-1&&(i.splice(x,1),f())};return!l&&Wv()&&Zv(m),m}function Fl(i,...s){i.slice().forEach(l=>{l(...s)})}const SI=i=>i();function Xp(i,s){i instanceof Map&&s instanceof Map&&s.forEach((l,f)=>i.set(f,l)),i instanceof Set&&s instanceof Set&&s.forEach(i.add,i);for(const l in s){if(!s.hasOwnProperty(l))continue;const f=s[l],m=i[l];Yp(m)&&Yp(f)&&i.hasOwnProperty(l)&&!Fi(f)&&!Ba(f)?i[l]=Xp(m,f):i[l]=f}return i}const TI=Symbol();function EI(i){return!Yp(i)||!i.hasOwnProperty(TI)}const{assign:ka}=Object;function II(i){return!!(Fi(i)&&i.effect)}function AI(i,s,l,f){const{state:m,actions:x,getters:v}=s,c=l.state.value[i];let A;function R(){c||(l.state.value[i]=m?m():{});const z=Sm(l.state.value[i]);return ka(z,x,Object.keys(v||{}).reduce((B,M)=>(B[M]=ql(Rt(()=>{Kd(l);const re=l._s.get(i);return v[M].call(re,re)})),B),{}))}return A=Rx(i,R,s,l,f,!0),A}function Rx(i,s,l={},f,m,x){let v;const c=ka({actions:{}},l),A={deep:!0};let R,z,B=[],M=[],re;const se=f.state.value[i];!x&&!se&&(f.state.value[i]={}),yi({});let ue;function ae(Se){let Ge;R=z=!1,typeof Se=="function"?(Se(f.state.value[i]),Ge={type:gu.patchFunction,storeId:i,events:re}):(Xp(f.state.value[i],Se),Ge={type:gu.patchObject,payload:Se,storeId:i,events:re});const ot=ue=Symbol();Ha().then(()=>{ue===ot&&(R=!0)}),z=!0,Fl(B,Ge,f.state.value[i])}const Z=x?function(){const{state:Ge}=l,ot=Ge?Ge():{};this.$patch(_t=>{ka(_t,ot)})}:Lx;function me(){v.stop(),B=[],M=[],f._s.delete(i)}function Ce(Se,Ge){return function(){Kd(f);const ot=Array.from(arguments),_t=[],He=[];function bt(Lt){_t.push(Lt)}function qt(Lt){He.push(Lt)}Fl(M,{args:ot,name:Se,store:Re,after:bt,onError:qt});let pi;try{pi=Ge.apply(this&&this.$id===i?this:Re,ot)}catch(Lt){throw Fl(He,Lt),Lt}return pi instanceof Promise?pi.then(Lt=>(Fl(_t,Lt),Lt)).catch(Lt=>(Fl(He,Lt),Promise.reject(Lt))):(Fl(_t,pi),pi)}}const be={_p:f,$id:i,$onAction:Vy.bind(null,M),$patch:ae,$reset:Z,$subscribe(Se,Ge={}){const ot=Vy(B,Se,Ge.detached,()=>_t()),_t=v.run(()=>Mt(()=>f.state.value[i],He=>{(Ge.flush==="sync"?z:R)&&Se({storeId:i,type:gu.direct,events:re},He)},ka({},A,Ge)));return ot},$dispose:me},Re=Xr(be);f._s.set(i,Re);const $e=(f._a&&f._a.runWithContext||SI)(()=>f._e.run(()=>(v=Fd()).run(s)));for(const Se in $e){const Ge=$e[Se];if(Fi(Ge)&&!II(Ge)||Ba(Ge))x||(se&&EI(Ge)&&(Fi(Ge)?Ge.value=se[Se]:Xp(Ge,se[Se])),f.state.value[i][Se]=Ge);else if(typeof Ge=="function"){const ot=Ce(Se,Ge);$e[Se]=ot,c.actions[Se]=Ge}}return ka(Re,$e),ka(hi(Re),$e),Object.defineProperty(Re,"$state",{get:()=>f.state.value[i],set:Se=>{ae(Ge=>{ka(Ge,Se)})}}),f._p.forEach(Se=>{ka(Re,v.run(()=>Se({store:Re,app:f._a,pinia:f,options:c})))}),se&&x&&l.hydrate&&l.hydrate(Re.$state,se),R=!0,z=!0,Re}function CI(i,s,l){let f,m;const x=typeof s=="function";typeof i=="string"?(f=i,m=x?l:s):(m=i,f=i.id);function v(c,A){const R=IS();return c=c||(R?et(kx,null):null),c&&Kd(c),c=Mx,c._s.has(f)||(x?Rx(f,s,m,c):AI(f,m,c)),c._s.get(f)}return v.$id=f,v}const PI=wI(),MI="modulepreload",kI=function(i){return"/CHANGE_ME_BASE_URL/"+i},Uy={},Mu=function(s,l,f){let m=Promise.resolve();if(l&&l.length>0){const x=document.getElementsByTagName("link");m=Promise.all(l.map(v=>{if(v=kI(v),v in Uy)return;Uy[v]=!0;const c=v.endsWith(".css"),A=c?'[rel="stylesheet"]':"";if(!!f)for(let B=x.length-1;B>=0;B--){const M=x[B];if(M.href===v&&(!c||M.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${v}"]${A}`))return;const z=document.createElement("link");if(z.rel=c?"stylesheet":MI,c||(z.as="script",z.crossOrigin=""),z.href=v,document.head.appendChild(z),c)return new Promise((B,M)=>{z.addEventListener("load",B),z.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${v}`)))})}))}return m.then(()=>s()).catch(x=>{const v=new Event("vite:preloadError",{cancelable:!0});if(v.payload=x,window.dispatchEvent(v),!v.defaultPrevented)throw x})},LI=(i,s)=>{const l=i[s];return l?typeof l=="function"?l():Promise.resolve(l):new Promise((f,m)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(m.bind(null,new Error("Unknown variable dynamic import: "+s)))})};/*!
  * shared v9.9.1
  * (c) 2024 kazuya kawaguchi
  * Released under the MIT License.
  */const Md=typeof window<"u",Za=(i,s=!1)=>s?Symbol.for(i):Symbol(i),RI=(i,s,l)=>DI({l:i,k:s,s:l}),DI=i=>JSON.stringify(i).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),Cr=i=>typeof i=="number"&&isFinite(i),zI=i=>zx(i)==="[object Date]",$a=i=>zx(i)==="[object RegExp]",Yd=i=>Gt(i)&&Object.keys(i).length===0,Jr=Object.assign;let $y;const Js=()=>$y||($y=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function jy(i){return i.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}const OI=Object.prototype.hasOwnProperty;function kd(i,s){return OI.call(i,s)}const Zi=Array.isArray,Vi=i=>typeof i=="function",gt=i=>typeof i=="string",si=i=>typeof i=="boolean",Ei=i=>i!==null&&typeof i=="object",FI=i=>Ei(i)&&Vi(i.then)&&Vi(i.catch),Dx=Object.prototype.toString,zx=i=>Dx.call(i),Gt=i=>{if(!Ei(i))return!1;const s=Object.getPrototypeOf(i);return s===null||s.constructor===Object},BI=i=>i==null?"":Zi(i)||Gt(i)&&i.toString===Dx?JSON.stringify(i,null,2):String(i);function NI(i,s=""){return i.reduce((l,f,m)=>m===0?l+f:l+s+f,"")}function Nm(i){let s=i;return()=>++s}function VI(i,s){typeof console<"u"&&(console.warn("[intlify] "+i),s&&console.warn(s.stack))}const ud=i=>!Ei(i)||Zi(i);function gd(i,s){if(ud(i)||ud(s))throw new Error("Invalid value");const l=[{src:i,des:s}];for(;l.length;){const{src:f,des:m}=l.pop();Object.keys(f).forEach(x=>{ud(f[x])||ud(m[x])?m[x]=f[x]:l.push({src:f[x],des:m[x]})})}}/*!
  * message-compiler v9.9.1
  * (c) 2024 kazuya kawaguchi
  * Released under the MIT License.
  */function UI(i,s,l){return{line:i,column:s,offset:l}}function Jp(i,s,l){const f={start:i,end:s};return l!=null&&(f.source=l),f}const $I=/\{([0-9a-zA-Z]+)\}/g;function jI(i,...s){return s.length===1&&HI(s[0])&&(s=s[0]),(!s||!s.hasOwnProperty)&&(s={}),i.replace($I,(l,f)=>s.hasOwnProperty(f)?s[f]:"")}const Ox=Object.assign,Hy=i=>typeof i=="string",HI=i=>i!==null&&typeof i=="object";function Fx(i,s=""){return i.reduce((l,f,m)=>m===0?l+f:l+s+f,"")}const Nt={EXPECTED_TOKEN:1,INVALID_TOKEN_IN_PLACEHOLDER:2,UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER:3,UNKNOWN_ESCAPE_SEQUENCE:4,INVALID_UNICODE_ESCAPE_SEQUENCE:5,UNBALANCED_CLOSING_BRACE:6,UNTERMINATED_CLOSING_BRACE:7,EMPTY_PLACEHOLDER:8,NOT_ALLOW_NEST_PLACEHOLDER:9,INVALID_LINKED_FORMAT:10,MUST_HAVE_MESSAGES_IN_PLURAL:11,UNEXPECTED_EMPTY_LINKED_MODIFIER:12,UNEXPECTED_EMPTY_LINKED_KEY:13,UNEXPECTED_LEXICAL_ANALYSIS:14,UNHANDLED_CODEGEN_NODE_TYPE:15,UNHANDLED_MINIFIER_NODE_TYPE:16,__EXTEND_POINT__:17},GI={[Nt.EXPECTED_TOKEN]:"Expected token: '{0}'",[Nt.INVALID_TOKEN_IN_PLACEHOLDER]:"Invalid token in placeholder: '{0}'",[Nt.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER]:"Unterminated single quote in placeholder",[Nt.UNKNOWN_ESCAPE_SEQUENCE]:"Unknown escape sequence: \\{0}",[Nt.INVALID_UNICODE_ESCAPE_SEQUENCE]:"Invalid unicode escape sequence: {0}",[Nt.UNBALANCED_CLOSING_BRACE]:"Unbalanced closing brace",[Nt.UNTERMINATED_CLOSING_BRACE]:"Unterminated closing brace",[Nt.EMPTY_PLACEHOLDER]:"Empty placeholder",[Nt.NOT_ALLOW_NEST_PLACEHOLDER]:"Not allowed nest placeholder",[Nt.INVALID_LINKED_FORMAT]:"Invalid linked format",[Nt.MUST_HAVE_MESSAGES_IN_PLURAL]:"Plural must have messages",[Nt.UNEXPECTED_EMPTY_LINKED_MODIFIER]:"Unexpected empty linked modifier",[Nt.UNEXPECTED_EMPTY_LINKED_KEY]:"Unexpected empty linked key",[Nt.UNEXPECTED_LEXICAL_ANALYSIS]:"Unexpected lexical analysis in token: '{0}'",[Nt.UNHANDLED_CODEGEN_NODE_TYPE]:"unhandled codegen node type: '{0}'",[Nt.UNHANDLED_MINIFIER_NODE_TYPE]:"unhandled mimifier node type: '{0}'"};function rc(i,s,l={}){const{domain:f,messages:m,args:x}=l,v=jI((m||GI)[i]||"",...x||[]),c=new SyntaxError(String(v));return c.code=i,s&&(c.location=s),c.domain=f,c}function qI(i){throw i}const Ks=" ",WI="\r",Tn=`
`,ZI="\u2028",KI="\u2029";function YI(i){const s=i;let l=0,f=1,m=1,x=0;const v=$e=>s[$e]===WI&&s[$e+1]===Tn,c=$e=>s[$e]===Tn,A=$e=>s[$e]===KI,R=$e=>s[$e]===ZI,z=$e=>v($e)||c($e)||A($e)||R($e),B=()=>l,M=()=>f,re=()=>m,se=()=>x,ue=$e=>v($e)||A($e)||R($e)?Tn:s[$e],ae=()=>ue(l),Z=()=>ue(l+x);function me(){return x=0,z(l)&&(f++,m=0),v(l)&&l++,l++,m++,s[l]}function Ce(){return v(l+x)&&x++,x++,s[l+x]}function be(){l=0,f=1,m=1,x=0}function Re($e=0){x=$e}function Ae(){const $e=l+x;for(;$e!==l;)me();x=0}return{index:B,line:M,column:re,peekOffset:se,charAt:ue,currentChar:ae,currentPeek:Z,next:me,peek:Ce,reset:be,resetPeek:Re,skipToPeek:Ae}}const Aa=void 0,XI=".",Gy="'",JI="tokenizer";function QI(i,s={}){const l=s.location!==!1,f=YI(i),m=()=>f.index(),x=()=>UI(f.line(),f.column(),f.index()),v=x(),c=m(),A={currentType:14,offset:c,startLoc:v,endLoc:v,lastType:14,lastOffset:c,lastStartLoc:v,lastEndLoc:v,braceNest:0,inLinked:!1,text:""},R=()=>A,{onError:z}=s;function B(O,D,Y,...ye){const K=R();if(D.column+=Y,D.offset+=Y,z){const Be=l?Jp(K.startLoc,D):null,Qe=rc(O,Be,{domain:JI,args:ye});z(Qe)}}function M(O,D,Y){O.endLoc=x(),O.currentType=D;const ye={type:D};return l&&(ye.loc=Jp(O.startLoc,O.endLoc)),Y!=null&&(ye.value=Y),ye}const re=O=>M(O,14);function se(O,D){return O.currentChar()===D?(O.next(),D):(B(Nt.EXPECTED_TOKEN,x(),0,D),"")}function ue(O){let D="";for(;O.currentPeek()===Ks||O.currentPeek()===Tn;)D+=O.currentPeek(),O.peek();return D}function ae(O){const D=ue(O);return O.skipToPeek(),D}function Z(O){if(O===Aa)return!1;const D=O.charCodeAt(0);return D>=97&&D<=122||D>=65&&D<=90||D===95}function me(O){if(O===Aa)return!1;const D=O.charCodeAt(0);return D>=48&&D<=57}function Ce(O,D){const{currentType:Y}=D;if(Y!==2)return!1;ue(O);const ye=Z(O.currentPeek());return O.resetPeek(),ye}function be(O,D){const{currentType:Y}=D;if(Y!==2)return!1;ue(O);const ye=O.currentPeek()==="-"?O.peek():O.currentPeek(),K=me(ye);return O.resetPeek(),K}function Re(O,D){const{currentType:Y}=D;if(Y!==2)return!1;ue(O);const ye=O.currentPeek()===Gy;return O.resetPeek(),ye}function Ae(O,D){const{currentType:Y}=D;if(Y!==8)return!1;ue(O);const ye=O.currentPeek()===".";return O.resetPeek(),ye}function $e(O,D){const{currentType:Y}=D;if(Y!==9)return!1;ue(O);const ye=Z(O.currentPeek());return O.resetPeek(),ye}function Se(O,D){const{currentType:Y}=D;if(!(Y===8||Y===12))return!1;ue(O);const ye=O.currentPeek()===":";return O.resetPeek(),ye}function Ge(O,D){const{currentType:Y}=D;if(Y!==10)return!1;const ye=()=>{const Be=O.currentPeek();return Be==="{"?Z(O.peek()):Be==="@"||Be==="%"||Be==="|"||Be===":"||Be==="."||Be===Ks||!Be?!1:Be===Tn?(O.peek(),ye()):Z(Be)},K=ye();return O.resetPeek(),K}function ot(O){ue(O);const D=O.currentPeek()==="|";return O.resetPeek(),D}function _t(O){const D=ue(O),Y=O.currentPeek()==="%"&&O.peek()==="{";return O.resetPeek(),{isModulo:Y,hasSpace:D.length>0}}function He(O,D=!0){const Y=(K=!1,Be="",Qe=!1)=>{const Me=O.currentPeek();return Me==="{"?Be==="%"?!1:K:Me==="@"||!Me?Be==="%"?!0:K:Me==="%"?(O.peek(),Y(K,"%",!0)):Me==="|"?Be==="%"||Qe?!0:!(Be===Ks||Be===Tn):Me===Ks?(O.peek(),Y(!0,Ks,Qe)):Me===Tn?(O.peek(),Y(!0,Tn,Qe)):!0},ye=Y();return D&&O.resetPeek(),ye}function bt(O,D){const Y=O.currentChar();return Y===Aa?Aa:D(Y)?(O.next(),Y):null}function qt(O){return bt(O,Y=>{const ye=Y.charCodeAt(0);return ye>=97&&ye<=122||ye>=65&&ye<=90||ye>=48&&ye<=57||ye===95||ye===36})}function pi(O){return bt(O,Y=>{const ye=Y.charCodeAt(0);return ye>=48&&ye<=57})}function Lt(O){return bt(O,Y=>{const ye=Y.charCodeAt(0);return ye>=48&&ye<=57||ye>=65&&ye<=70||ye>=97&&ye<=102})}function jt(O){let D="",Y="";for(;D=pi(O);)Y+=D;return Y}function Dt(O){ae(O);const D=O.currentChar();return D!=="%"&&B(Nt.EXPECTED_TOKEN,x(),0,D),O.next(),"%"}function Ci(O){let D="";for(;;){const Y=O.currentChar();if(Y==="{"||Y==="}"||Y==="@"||Y==="|"||!Y)break;if(Y==="%")if(He(O))D+=Y,O.next();else break;else if(Y===Ks||Y===Tn)if(He(O))D+=Y,O.next();else{if(ot(O))break;D+=Y,O.next()}else D+=Y,O.next()}return D}function mi(O){ae(O);let D="",Y="";for(;D=qt(O);)Y+=D;return O.currentChar()===Aa&&B(Nt.UNTERMINATED_CLOSING_BRACE,x(),0),Y}function ai(O){ae(O);let D="";return O.currentChar()==="-"?(O.next(),D+=`-${jt(O)}`):D+=jt(O),O.currentChar()===Aa&&B(Nt.UNTERMINATED_CLOSING_BRACE,x(),0),D}function Xt(O){ae(O),se(O,"'");let D="",Y="";const ye=Be=>Be!==Gy&&Be!==Tn;for(;D=bt(O,ye);)D==="\\"?Y+=Bi(O):Y+=D;const K=O.currentChar();return K===Tn||K===Aa?(B(Nt.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER,x(),0),K===Tn&&(O.next(),se(O,"'")),Y):(se(O,"'"),Y)}function Bi(O){const D=O.currentChar();switch(D){case"\\":case"'":return O.next(),`\\${D}`;case"u":return Pi(O,D,4);case"U":return Pi(O,D,6);default:return B(Nt.UNKNOWN_ESCAPE_SEQUENCE,x(),0,D),""}}function Pi(O,D,Y){se(O,D);let ye="";for(let K=0;K<Y;K++){const Be=Lt(O);if(!Be){B(Nt.INVALID_UNICODE_ESCAPE_SEQUENCE,x(),0,`\\${D}${ye}${O.currentChar()}`);break}ye+=Be}return`\\${D}${ye}`}function Yi(O){ae(O);let D="",Y="";const ye=K=>K!=="{"&&K!=="}"&&K!==Ks&&K!==Tn;for(;D=bt(O,ye);)Y+=D;return Y}function Wt(O){let D="",Y="";for(;D=qt(O);)Y+=D;return Y}function ke(O){const D=(Y=!1,ye)=>{const K=O.currentChar();return K==="{"||K==="%"||K==="@"||K==="|"||K==="("||K===")"||!K||K===Ks?ye:K===Tn||K===XI?(ye+=K,O.next(),D(Y,ye)):(ye+=K,O.next(),D(!0,ye))};return D(!1,"")}function nt(O){ae(O);const D=se(O,"|");return ae(O),D}function it(O,D){let Y=null;switch(O.currentChar()){case"{":return D.braceNest>=1&&B(Nt.NOT_ALLOW_NEST_PLACEHOLDER,x(),0),O.next(),Y=M(D,2,"{"),ae(O),D.braceNest++,Y;case"}":return D.braceNest>0&&D.currentType===2&&B(Nt.EMPTY_PLACEHOLDER,x(),0),O.next(),Y=M(D,3,"}"),D.braceNest--,D.braceNest>0&&ae(O),D.inLinked&&D.braceNest===0&&(D.inLinked=!1),Y;case"@":return D.braceNest>0&&B(Nt.UNTERMINATED_CLOSING_BRACE,x(),0),Y=ht(O,D)||re(D),D.braceNest=0,Y;default:let K=!0,Be=!0,Qe=!0;if(ot(O))return D.braceNest>0&&B(Nt.UNTERMINATED_CLOSING_BRACE,x(),0),Y=M(D,1,nt(O)),D.braceNest=0,D.inLinked=!1,Y;if(D.braceNest>0&&(D.currentType===5||D.currentType===6||D.currentType===7))return B(Nt.UNTERMINATED_CLOSING_BRACE,x(),0),D.braceNest=0,Ht(O,D);if(K=Ce(O,D))return Y=M(D,5,mi(O)),ae(O),Y;if(Be=be(O,D))return Y=M(D,6,ai(O)),ae(O),Y;if(Qe=Re(O,D))return Y=M(D,7,Xt(O)),ae(O),Y;if(!K&&!Be&&!Qe)return Y=M(D,13,Yi(O)),B(Nt.INVALID_TOKEN_IN_PLACEHOLDER,x(),0,Y.value),ae(O),Y;break}return Y}function ht(O,D){const{currentType:Y}=D;let ye=null;const K=O.currentChar();switch((Y===8||Y===9||Y===12||Y===10)&&(K===Tn||K===Ks)&&B(Nt.INVALID_LINKED_FORMAT,x(),0),K){case"@":return O.next(),ye=M(D,8,"@"),D.inLinked=!0,ye;case".":return ae(O),O.next(),M(D,9,".");case":":return ae(O),O.next(),M(D,10,":");default:return ot(O)?(ye=M(D,1,nt(O)),D.braceNest=0,D.inLinked=!1,ye):Ae(O,D)||Se(O,D)?(ae(O),ht(O,D)):$e(O,D)?(ae(O),M(D,12,Wt(O))):Ge(O,D)?(ae(O),K==="{"?it(O,D)||ye:M(D,11,ke(O))):(Y===8&&B(Nt.INVALID_LINKED_FORMAT,x(),0),D.braceNest=0,D.inLinked=!1,Ht(O,D))}}function Ht(O,D){let Y={type:14};if(D.braceNest>0)return it(O,D)||re(D);if(D.inLinked)return ht(O,D)||re(D);switch(O.currentChar()){case"{":return it(O,D)||re(D);case"}":return B(Nt.UNBALANCED_CLOSING_BRACE,x(),0),O.next(),M(D,3,"}");case"@":return ht(O,D)||re(D);default:if(ot(O))return Y=M(D,1,nt(O)),D.braceNest=0,D.inLinked=!1,Y;const{isModulo:K,hasSpace:Be}=_t(O);if(K)return Be?M(D,0,Ci(O)):M(D,4,Dt(O));if(He(O))return M(D,0,Ci(O));break}return Y}function ei(){const{currentType:O,offset:D,startLoc:Y,endLoc:ye}=A;return A.lastType=O,A.lastOffset=D,A.lastStartLoc=Y,A.lastEndLoc=ye,A.offset=m(),A.startLoc=x(),f.currentChar()===Aa?M(A,14):Ht(f,A)}return{nextToken:ei,currentOffset:m,currentPosition:x,context:R}}const eA="parser",tA=/(?:\\\\|\\'|\\u([0-9a-fA-F]{4})|\\U([0-9a-fA-F]{6}))/g;function iA(i,s,l){switch(i){case"\\\\":return"\\";case"\\'":return"'";default:{const f=parseInt(s||l,16);return f<=55295||f>=57344?String.fromCodePoint(f):""}}}function rA(i={}){const s=i.location!==!1,{onError:l}=i;function f(Z,me,Ce,be,...Re){const Ae=Z.currentPosition();if(Ae.offset+=be,Ae.column+=be,l){const $e=s?Jp(Ce,Ae):null,Se=rc(me,$e,{domain:eA,args:Re});l(Se)}}function m(Z,me,Ce){const be={type:Z};return s&&(be.start=me,be.end=me,be.loc={start:Ce,end:Ce}),be}function x(Z,me,Ce,be){be&&(Z.type=be),s&&(Z.end=me,Z.loc&&(Z.loc.end=Ce))}function v(Z,me){const Ce=Z.context(),be=m(3,Ce.offset,Ce.startLoc);return be.value=me,x(be,Z.currentOffset(),Z.currentPosition()),be}function c(Z,me){const Ce=Z.context(),{lastOffset:be,lastStartLoc:Re}=Ce,Ae=m(5,be,Re);return Ae.index=parseInt(me,10),Z.nextToken(),x(Ae,Z.currentOffset(),Z.currentPosition()),Ae}function A(Z,me){const Ce=Z.context(),{lastOffset:be,lastStartLoc:Re}=Ce,Ae=m(4,be,Re);return Ae.key=me,Z.nextToken(),x(Ae,Z.currentOffset(),Z.currentPosition()),Ae}function R(Z,me){const Ce=Z.context(),{lastOffset:be,lastStartLoc:Re}=Ce,Ae=m(9,be,Re);return Ae.value=me.replace(tA,iA),Z.nextToken(),x(Ae,Z.currentOffset(),Z.currentPosition()),Ae}function z(Z){const me=Z.nextToken(),Ce=Z.context(),{lastOffset:be,lastStartLoc:Re}=Ce,Ae=m(8,be,Re);return me.type!==12?(f(Z,Nt.UNEXPECTED_EMPTY_LINKED_MODIFIER,Ce.lastStartLoc,0),Ae.value="",x(Ae,be,Re),{nextConsumeToken:me,node:Ae}):(me.value==null&&f(Z,Nt.UNEXPECTED_LEXICAL_ANALYSIS,Ce.lastStartLoc,0,Ss(me)),Ae.value=me.value||"",x(Ae,Z.currentOffset(),Z.currentPosition()),{node:Ae})}function B(Z,me){const Ce=Z.context(),be=m(7,Ce.offset,Ce.startLoc);return be.value=me,x(be,Z.currentOffset(),Z.currentPosition()),be}function M(Z){const me=Z.context(),Ce=m(6,me.offset,me.startLoc);let be=Z.nextToken();if(be.type===9){const Re=z(Z);Ce.modifier=Re.node,be=Re.nextConsumeToken||Z.nextToken()}switch(be.type!==10&&f(Z,Nt.UNEXPECTED_LEXICAL_ANALYSIS,me.lastStartLoc,0,Ss(be)),be=Z.nextToken(),be.type===2&&(be=Z.nextToken()),be.type){case 11:be.value==null&&f(Z,Nt.UNEXPECTED_LEXICAL_ANALYSIS,me.lastStartLoc,0,Ss(be)),Ce.key=B(Z,be.value||"");break;case 5:be.value==null&&f(Z,Nt.UNEXPECTED_LEXICAL_ANALYSIS,me.lastStartLoc,0,Ss(be)),Ce.key=A(Z,be.value||"");break;case 6:be.value==null&&f(Z,Nt.UNEXPECTED_LEXICAL_ANALYSIS,me.lastStartLoc,0,Ss(be)),Ce.key=c(Z,be.value||"");break;case 7:be.value==null&&f(Z,Nt.UNEXPECTED_LEXICAL_ANALYSIS,me.lastStartLoc,0,Ss(be)),Ce.key=R(Z,be.value||"");break;default:f(Z,Nt.UNEXPECTED_EMPTY_LINKED_KEY,me.lastStartLoc,0);const Re=Z.context(),Ae=m(7,Re.offset,Re.startLoc);return Ae.value="",x(Ae,Re.offset,Re.startLoc),Ce.key=Ae,x(Ce,Re.offset,Re.startLoc),{nextConsumeToken:be,node:Ce}}return x(Ce,Z.currentOffset(),Z.currentPosition()),{node:Ce}}function re(Z){const me=Z.context(),Ce=me.currentType===1?Z.currentOffset():me.offset,be=me.currentType===1?me.endLoc:me.startLoc,Re=m(2,Ce,be);Re.items=[];let Ae=null;do{const Ge=Ae||Z.nextToken();switch(Ae=null,Ge.type){case 0:Ge.value==null&&f(Z,Nt.UNEXPECTED_LEXICAL_ANALYSIS,me.lastStartLoc,0,Ss(Ge)),Re.items.push(v(Z,Ge.value||""));break;case 6:Ge.value==null&&f(Z,Nt.UNEXPECTED_LEXICAL_ANALYSIS,me.lastStartLoc,0,Ss(Ge)),Re.items.push(c(Z,Ge.value||""));break;case 5:Ge.value==null&&f(Z,Nt.UNEXPECTED_LEXICAL_ANALYSIS,me.lastStartLoc,0,Ss(Ge)),Re.items.push(A(Z,Ge.value||""));break;case 7:Ge.value==null&&f(Z,Nt.UNEXPECTED_LEXICAL_ANALYSIS,me.lastStartLoc,0,Ss(Ge)),Re.items.push(R(Z,Ge.value||""));break;case 8:const ot=M(Z);Re.items.push(ot.node),Ae=ot.nextConsumeToken||null;break}}while(me.currentType!==14&&me.currentType!==1);const $e=me.currentType===1?me.lastOffset:Z.currentOffset(),Se=me.currentType===1?me.lastEndLoc:Z.currentPosition();return x(Re,$e,Se),Re}function se(Z,me,Ce,be){const Re=Z.context();let Ae=be.items.length===0;const $e=m(1,me,Ce);$e.cases=[],$e.cases.push(be);do{const Se=re(Z);Ae||(Ae=Se.items.length===0),$e.cases.push(Se)}while(Re.currentType!==14);return Ae&&f(Z,Nt.MUST_HAVE_MESSAGES_IN_PLURAL,Ce,0),x($e,Z.currentOffset(),Z.currentPosition()),$e}function ue(Z){const me=Z.context(),{offset:Ce,startLoc:be}=me,Re=re(Z);return me.currentType===14?Re:se(Z,Ce,be,Re)}function ae(Z){const me=QI(Z,Ox({},i)),Ce=me.context(),be=m(0,Ce.offset,Ce.startLoc);return s&&be.loc&&(be.loc.source=Z),be.body=ue(me),i.onCacheKey&&(be.cacheKey=i.onCacheKey(Z)),Ce.currentType!==14&&f(me,Nt.UNEXPECTED_LEXICAL_ANALYSIS,Ce.lastStartLoc,0,Z[Ce.offset]||""),x(be,me.currentOffset(),me.currentPosition()),be}return{parse:ae}}function Ss(i){if(i.type===14)return"EOF";const s=(i.value||"").replace(/\r?\n/gu,"\\n");return s.length>10?s.slice(0,9)+"":s}function nA(i,s={}){const l={ast:i,helpers:new Set};return{context:()=>l,helper:x=>(l.helpers.add(x),x)}}function qy(i,s){for(let l=0;l<i.length;l++)Vm(i[l],s)}function Vm(i,s){switch(i.type){case 1:qy(i.cases,s),s.helper("plural");break;case 2:qy(i.items,s);break;case 6:Vm(i.key,s),s.helper("linked"),s.helper("type");break;case 5:s.helper("interpolate"),s.helper("list");break;case 4:s.helper("interpolate"),s.helper("named");break}}function sA(i,s={}){const l=nA(i);l.helper("normalize"),i.body&&Vm(i.body,l);const f=l.context();i.helpers=Array.from(f.helpers)}function aA(i){const s=i.body;return s.type===2?Wy(s):s.cases.forEach(l=>Wy(l)),i}function Wy(i){if(i.items.length===1){const s=i.items[0];(s.type===3||s.type===9)&&(i.static=s.value,delete s.value)}else{const s=[];for(let l=0;l<i.items.length;l++){const f=i.items[l];if(!(f.type===3||f.type===9)||f.value==null)break;s.push(f.value)}if(s.length===i.items.length){i.static=Fx(s);for(let l=0;l<i.items.length;l++){const f=i.items[l];(f.type===3||f.type===9)&&delete f.value}}}}const oA="minifier";function Bl(i){switch(i.t=i.type,i.type){case 0:const s=i;Bl(s.body),s.b=s.body,delete s.body;break;case 1:const l=i,f=l.cases;for(let z=0;z<f.length;z++)Bl(f[z]);l.c=f,delete l.cases;break;case 2:const m=i,x=m.items;for(let z=0;z<x.length;z++)Bl(x[z]);m.i=x,delete m.items,m.static&&(m.s=m.static,delete m.static);break;case 3:case 9:case 8:case 7:const v=i;v.value&&(v.v=v.value,delete v.value);break;case 6:const c=i;Bl(c.key),c.k=c.key,delete c.key,c.modifier&&(Bl(c.modifier),c.m=c.modifier,delete c.modifier);break;case 5:const A=i;A.i=A.index,delete A.index;break;case 4:const R=i;R.k=R.key,delete R.key;break;default:throw rc(Nt.UNHANDLED_MINIFIER_NODE_TYPE,null,{domain:oA,args:[i.type]})}delete i.type}const lA="parser";function cA(i,s){const{sourceMap:l,filename:f,breakLineCode:m,needIndent:x}=s,v=s.location!==!1,c={filename:f,code:"",column:1,line:1,offset:0,map:void 0,breakLineCode:m,needIndent:x,indentLevel:0};v&&i.loc&&(c.source=i.loc.source);const A=()=>c;function R(ae,Z){c.code+=ae}function z(ae,Z=!0){const me=Z?m:"";R(x?me+"  ".repeat(ae):me)}function B(ae=!0){const Z=++c.indentLevel;ae&&z(Z)}function M(ae=!0){const Z=--c.indentLevel;ae&&z(Z)}function re(){z(c.indentLevel)}return{context:A,push:R,indent:B,deindent:M,newline:re,helper:ae=>`_${ae}`,needIndent:()=>c.needIndent}}function uA(i,s){const{helper:l}=i;i.push(`${l("linked")}(`),Kl(i,s.key),s.modifier?(i.push(", "),Kl(i,s.modifier),i.push(", _type")):i.push(", undefined, _type"),i.push(")")}function hA(i,s){const{helper:l,needIndent:f}=i;i.push(`${l("normalize")}([`),i.indent(f());const m=s.items.length;for(let x=0;x<m&&(Kl(i,s.items[x]),x!==m-1);x++)i.push(", ");i.deindent(f()),i.push("])")}function dA(i,s){const{helper:l,needIndent:f}=i;if(s.cases.length>1){i.push(`${l("plural")}([`),i.indent(f());const m=s.cases.length;for(let x=0;x<m&&(Kl(i,s.cases[x]),x!==m-1);x++)i.push(", ");i.deindent(f()),i.push("])")}}function fA(i,s){s.body?Kl(i,s.body):i.push("null")}function Kl(i,s){const{helper:l}=i;switch(s.type){case 0:fA(i,s);break;case 1:dA(i,s);break;case 2:hA(i,s);break;case 6:uA(i,s);break;case 8:i.push(JSON.stringify(s.value),s);break;case 7:i.push(JSON.stringify(s.value),s);break;case 5:i.push(`${l("interpolate")}(${l("list")}(${s.index}))`,s);break;case 4:i.push(`${l("interpolate")}(${l("named")}(${JSON.stringify(s.key)}))`,s);break;case 9:i.push(JSON.stringify(s.value),s);break;case 3:i.push(JSON.stringify(s.value),s);break;default:throw rc(Nt.UNHANDLED_CODEGEN_NODE_TYPE,null,{domain:lA,args:[s.type]})}}const pA=(i,s={})=>{const l=Hy(s.mode)?s.mode:"normal",f=Hy(s.filename)?s.filename:"message.intl",m=!!s.sourceMap,x=s.breakLineCode!=null?s.breakLineCode:l==="arrow"?";":`
`,v=s.needIndent?s.needIndent:l!=="arrow",c=i.helpers||[],A=cA(i,{mode:l,filename:f,sourceMap:m,breakLineCode:x,needIndent:v});A.push(l==="normal"?"function __msg__ (ctx) {":"(ctx) => {"),A.indent(v),c.length>0&&(A.push(`const { ${Fx(c.map(B=>`${B}: _${B}`),", ")} } = ctx`),A.newline()),A.push("return "),Kl(A,i),A.deindent(v),A.push("}"),delete i.helpers;const{code:R,map:z}=A.context();return{ast:i,code:R,map:z?z.toJSON():void 0}};function mA(i,s={}){const l=Ox({},s),f=!!l.jit,m=!!l.minify,x=l.optimize==null?!0:l.optimize,c=rA(l).parse(i);return f?(x&&aA(c),m&&Bl(c),{ast:c,code:""}):(sA(c,l),pA(c,l))}/*!
  * core-base v9.9.1
  * (c) 2024 kazuya kawaguchi
  * Released under the MIT License.
  */function gA(){typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(Js().__INTLIFY_PROD_DEVTOOLS__=!1),typeof __INTLIFY_JIT_COMPILATION__!="boolean"&&(Js().__INTLIFY_JIT_COMPILATION__=!1),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(Js().__INTLIFY_DROP_MESSAGE_COMPILER__=!1)}const Ka=[];Ka[0]={w:[0],i:[3,0],"[":[4],o:[7]};Ka[1]={w:[1],".":[2],"[":[4],o:[7]};Ka[2]={w:[2],i:[3,0],0:[3,0]};Ka[3]={i:[3,0],0:[3,0],w:[1,1],".":[2,1],"[":[4,1],o:[7,1]};Ka[4]={"'":[5,0],'"':[6,0],"[":[4,2],"]":[1,3],o:8,l:[4,0]};Ka[5]={"'":[4,0],o:8,l:[5,0]};Ka[6]={'"':[4,0],o:8,l:[6,0]};const _A=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function yA(i){return _A.test(i)}function vA(i){const s=i.charCodeAt(0),l=i.charCodeAt(i.length-1);return s===l&&(s===34||s===39)?i.slice(1,-1):i}function xA(i){if(i==null)return"o";switch(i.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return i;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function bA(i){const s=i.trim();return i.charAt(0)==="0"&&isNaN(parseInt(i))?!1:yA(s)?vA(s):"*"+s}function wA(i){const s=[];let l=-1,f=0,m=0,x,v,c,A,R,z,B;const M=[];M[0]=()=>{v===void 0?v=c:v+=c},M[1]=()=>{v!==void 0&&(s.push(v),v=void 0)},M[2]=()=>{M[0](),m++},M[3]=()=>{if(m>0)m--,f=4,M[0]();else{if(m=0,v===void 0||(v=bA(v),v===!1))return!1;M[1]()}};function re(){const se=i[l+1];if(f===5&&se==="'"||f===6&&se==='"')return l++,c="\\"+se,M[0](),!0}for(;f!==null;)if(l++,x=i[l],!(x==="\\"&&re())){if(A=xA(x),B=Ka[f],R=B[A]||B.l||8,R===8||(f=R[0],R[1]!==void 0&&(z=M[R[1]],z&&(c=x,z()===!1))))return;if(f===7)return s}}const Zy=new Map;function SA(i,s){return Ei(i)?i[s]:null}function TA(i,s){if(!Ei(i))return null;let l=Zy.get(s);if(l||(l=wA(s),l&&Zy.set(s,l)),!l)return null;const f=l.length;let m=i,x=0;for(;x<f;){const v=m[l[x]];if(v===void 0||Vi(m))return null;m=v,x++}return m}const EA=i=>i,IA=i=>"",AA="text",CA=i=>i.length===0?"":NI(i),PA=BI;function Ky(i,s){return i=Math.abs(i),s===2?i?i>1?1:0:1:i?Math.min(i,2):0}function MA(i){const s=Cr(i.pluralIndex)?i.pluralIndex:-1;return i.named&&(Cr(i.named.count)||Cr(i.named.n))?Cr(i.named.count)?i.named.count:Cr(i.named.n)?i.named.n:s:s}function kA(i,s){s.count||(s.count=i),s.n||(s.n=i)}function LA(i={}){const s=i.locale,l=MA(i),f=Ei(i.pluralRules)&&gt(s)&&Vi(i.pluralRules[s])?i.pluralRules[s]:Ky,m=Ei(i.pluralRules)&&gt(s)&&Vi(i.pluralRules[s])?Ky:void 0,x=Z=>Z[f(l,Z.length,m)],v=i.list||[],c=Z=>v[Z],A=i.named||{};Cr(i.pluralIndex)&&kA(l,A);const R=Z=>A[Z];function z(Z){const me=Vi(i.messages)?i.messages(Z):Ei(i.messages)?i.messages[Z]:!1;return me||(i.parent?i.parent.message(Z):IA)}const B=Z=>i.modifiers?i.modifiers[Z]:EA,M=Gt(i.processor)&&Vi(i.processor.normalize)?i.processor.normalize:CA,re=Gt(i.processor)&&Vi(i.processor.interpolate)?i.processor.interpolate:PA,se=Gt(i.processor)&&gt(i.processor.type)?i.processor.type:AA,ae={list:c,named:R,plural:x,linked:(Z,...me)=>{const[Ce,be]=me;let Re="text",Ae="";me.length===1?Ei(Ce)?(Ae=Ce.modifier||Ae,Re=Ce.type||Re):gt(Ce)&&(Ae=Ce||Ae):me.length===2&&(gt(Ce)&&(Ae=Ce||Ae),gt(be)&&(Re=be||Re));const $e=z(Z)(ae),Se=Re==="vnode"&&Zi($e)&&Ae?$e[0]:$e;return Ae?B(Ae)(Se,Re):Se},message:z,type:se,interpolate:re,normalize:M,values:Jr({},v,A)};return ae}let ku=null;function RA(i){ku=i}function DA(i,s,l){ku&&ku.emit("i18n:init",{timestamp:Date.now(),i18n:i,version:s,meta:l})}const zA=OA("function:translate");function OA(i){return s=>ku&&ku.emit(i,s)}const FA={NOT_FOUND_KEY:1,FALLBACK_TO_TRANSLATE:2,CANNOT_FORMAT_NUMBER:3,FALLBACK_TO_NUMBER_FORMAT:4,CANNOT_FORMAT_DATE:5,FALLBACK_TO_DATE_FORMAT:6,EXPERIMENTAL_CUSTOM_MESSAGE_COMPILER:7,__EXTEND_POINT__:8},Bx=Nt.__EXTEND_POINT__,Co=Nm(Bx),us={INVALID_ARGUMENT:Bx,INVALID_DATE_ARGUMENT:Co(),INVALID_ISO_DATE_ARGUMENT:Co(),NOT_SUPPORT_NON_STRING_MESSAGE:Co(),NOT_SUPPORT_LOCALE_PROMISE_VALUE:Co(),NOT_SUPPORT_LOCALE_ASYNC_FUNCTION:Co(),NOT_SUPPORT_LOCALE_TYPE:Co(),__EXTEND_POINT__:Co()};function As(i){return rc(i,null,void 0)}function Um(i,s){return s.locale!=null?Yy(s.locale):Yy(i.locale)}let wp;function Yy(i){if(gt(i))return i;if(Vi(i)){if(i.resolvedOnce&&wp!=null)return wp;if(i.constructor.name==="Function"){const s=i();if(FI(s))throw As(us.NOT_SUPPORT_LOCALE_PROMISE_VALUE);return wp=s}else throw As(us.NOT_SUPPORT_LOCALE_ASYNC_FUNCTION)}else throw As(us.NOT_SUPPORT_LOCALE_TYPE)}function BA(i,s,l){return[...new Set([l,...Zi(s)?s:Ei(s)?Object.keys(s):gt(s)?[s]:[l]])]}function Nx(i,s,l){const f=gt(l)?l:Yl,m=i;m.__localeChainCache||(m.__localeChainCache=new Map);let x=m.__localeChainCache.get(f);if(!x){x=[];let v=[l];for(;Zi(v);)v=Xy(x,v,s);const c=Zi(s)||!Gt(s)?s:s.default?s.default:null;v=gt(c)?[c]:c,Zi(v)&&Xy(x,v,!1),m.__localeChainCache.set(f,x)}return x}function Xy(i,s,l){let f=!0;for(let m=0;m<s.length&&si(f);m++){const x=s[m];gt(x)&&(f=NA(i,s[m],l))}return f}function NA(i,s,l){let f;const m=s.split("-");do{const x=m.join("-");f=VA(i,x,l),m.splice(-1,1)}while(m.length&&f===!0);return f}function VA(i,s,l){let f=!1;if(!i.includes(s)&&(f=!0,s)){f=s[s.length-1]!=="!";const m=s.replace(/!/g,"");i.push(m),(Zi(l)||Gt(l))&&l[m]&&(f=l[m])}return f}const UA="9.9.1",Xd=-1,Yl="en-US",Jy="",Qy=i=>`${i.charAt(0).toLocaleUpperCase()}${i.substr(1)}`;function $A(){return{upper:(i,s)=>s==="text"&&gt(i)?i.toUpperCase():s==="vnode"&&Ei(i)&&"__v_isVNode"in i?i.children.toUpperCase():i,lower:(i,s)=>s==="text"&&gt(i)?i.toLowerCase():s==="vnode"&&Ei(i)&&"__v_isVNode"in i?i.children.toLowerCase():i,capitalize:(i,s)=>s==="text"&&gt(i)?Qy(i):s==="vnode"&&Ei(i)&&"__v_isVNode"in i?Qy(i.children):i}}let Vx;function ev(i){Vx=i}let Ux;function jA(i){Ux=i}let $x;function HA(i){$x=i}let jx=null;const GA=i=>{jx=i},qA=()=>jx;let Hx=null;const tv=i=>{Hx=i},WA=()=>Hx;let iv=0;function ZA(i={}){const s=Vi(i.onWarn)?i.onWarn:VI,l=gt(i.version)?i.version:UA,f=gt(i.locale)||Vi(i.locale)?i.locale:Yl,m=Vi(f)?Yl:f,x=Zi(i.fallbackLocale)||Gt(i.fallbackLocale)||gt(i.fallbackLocale)||i.fallbackLocale===!1?i.fallbackLocale:m,v=Gt(i.messages)?i.messages:{[m]:{}},c=Gt(i.datetimeFormats)?i.datetimeFormats:{[m]:{}},A=Gt(i.numberFormats)?i.numberFormats:{[m]:{}},R=Jr({},i.modifiers||{},$A()),z=i.pluralRules||{},B=Vi(i.missing)?i.missing:null,M=si(i.missingWarn)||$a(i.missingWarn)?i.missingWarn:!0,re=si(i.fallbackWarn)||$a(i.fallbackWarn)?i.fallbackWarn:!0,se=!!i.fallbackFormat,ue=!!i.unresolving,ae=Vi(i.postTranslation)?i.postTranslation:null,Z=Gt(i.processor)?i.processor:null,me=si(i.warnHtmlMessage)?i.warnHtmlMessage:!0,Ce=!!i.escapeParameter,be=Vi(i.messageCompiler)?i.messageCompiler:Vx,Re=Vi(i.messageResolver)?i.messageResolver:Ux||SA,Ae=Vi(i.localeFallbacker)?i.localeFallbacker:$x||BA,$e=Ei(i.fallbackContext)?i.fallbackContext:void 0,Se=i,Ge=Ei(Se.__datetimeFormatters)?Se.__datetimeFormatters:new Map,ot=Ei(Se.__numberFormatters)?Se.__numberFormatters:new Map,_t=Ei(Se.__meta)?Se.__meta:{};iv++;const He={version:l,cid:iv,locale:f,fallbackLocale:x,messages:v,modifiers:R,pluralRules:z,missing:B,missingWarn:M,fallbackWarn:re,fallbackFormat:se,unresolving:ue,postTranslation:ae,processor:Z,warnHtmlMessage:me,escapeParameter:Ce,messageCompiler:be,messageResolver:Re,localeFallbacker:Ae,fallbackContext:$e,onWarn:s,__meta:_t};return He.datetimeFormats=c,He.numberFormats=A,He.__datetimeFormatters=Ge,He.__numberFormatters=ot,__INTLIFY_PROD_DEVTOOLS__&&DA(He,l,_t),He}function $m(i,s,l,f,m){const{missing:x,onWarn:v}=i;if(x!==null){const c=x(i,l,s,m);return gt(c)?c:s}else return s}function ou(i,s,l){const f=i;f.__localeChainCache=new Map,i.localeFallbacker(i,l,s)}function Sp(i){return l=>KA(l,i)}function KA(i,s){const l=s.b||s.body;if((l.t||l.type)===1){const f=l,m=f.c||f.cases;return i.plural(m.reduce((x,v)=>[...x,rv(i,v)],[]))}else return rv(i,l)}function rv(i,s){const l=s.s||s.static;if(l)return i.type==="text"?l:i.normalize([l]);{const f=(s.i||s.items).reduce((m,x)=>[...m,Qp(i,x)],[]);return i.normalize(f)}}function Qp(i,s){const l=s.t||s.type;switch(l){case 3:const f=s;return f.v||f.value;case 9:const m=s;return m.v||m.value;case 4:const x=s;return i.interpolate(i.named(x.k||x.key));case 5:const v=s;return i.interpolate(i.list(v.i!=null?v.i:v.index));case 6:const c=s,A=c.m||c.modifier;return i.linked(Qp(i,c.k||c.key),A?Qp(i,A):void 0,i.type);case 7:const R=s;return R.v||R.value;case 8:const z=s;return z.v||z.value;default:throw new Error(`unhandled node type on format message part: ${l}`)}}const Gx=i=>i;let Vl=Object.create(null);const Xl=i=>Ei(i)&&(i.t===0||i.type===0)&&("b"in i||"body"in i);function qx(i,s={}){let l=!1;const f=s.onError||qI;return s.onError=m=>{l=!0,f(m)},{...mA(i,s),detectError:l}}const YA=(i,s)=>{if(!gt(i))throw As(us.NOT_SUPPORT_NON_STRING_MESSAGE);{si(s.warnHtmlMessage)&&s.warnHtmlMessage;const f=(s.onCacheKey||Gx)(i),m=Vl[f];if(m)return m;const{code:x,detectError:v}=qx(i,s),c=new Function(`return ${x}`)();return v?c:Vl[f]=c}};function XA(i,s){if(__INTLIFY_JIT_COMPILATION__&&!__INTLIFY_DROP_MESSAGE_COMPILER__&&gt(i)){si(s.warnHtmlMessage)&&s.warnHtmlMessage;const f=(s.onCacheKey||Gx)(i),m=Vl[f];if(m)return m;const{ast:x,detectError:v}=qx(i,{...s,location:!1,jit:!0}),c=Sp(x);return v?c:Vl[f]=c}else{const l=i.cacheKey;if(l){const f=Vl[l];return f||(Vl[l]=Sp(i))}else return Sp(i)}}const nv=()=>"",Qn=i=>Vi(i);function sv(i,...s){const{fallbackFormat:l,postTranslation:f,unresolving:m,messageCompiler:x,fallbackLocale:v,messages:c}=i,[A,R]=em(...s),z=si(R.missingWarn)?R.missingWarn:i.missingWarn,B=si(R.fallbackWarn)?R.fallbackWarn:i.fallbackWarn,M=si(R.escapeParameter)?R.escapeParameter:i.escapeParameter,re=!!R.resolvedMessage,se=gt(R.default)||si(R.default)?si(R.default)?x?A:()=>A:R.default:l?x?A:()=>A:"",ue=l||se!=="",ae=Um(i,R);M&&JA(R);let[Z,me,Ce]=re?[A,ae,c[ae]||{}]:Wx(i,A,ae,v,B,z),be=Z,Re=A;if(!re&&!(gt(be)||Xl(be)||Qn(be))&&ue&&(be=se,Re=be),!re&&(!(gt(be)||Xl(be)||Qn(be))||!gt(me)))return m?Xd:A;let Ae=!1;const $e=()=>{Ae=!0},Se=Qn(be)?be:Zx(i,A,me,be,Re,$e);if(Ae)return be;const Ge=tC(i,me,Ce,R),ot=LA(Ge),_t=QA(i,Se,ot),He=f?f(_t,A):_t;if(__INTLIFY_PROD_DEVTOOLS__){const bt={timestamp:Date.now(),key:gt(A)?A:Qn(be)?be.key:"",locale:me||(Qn(be)?be.locale:""),format:gt(be)?be:Qn(be)?be.source:"",message:He};bt.meta=Jr({},i.__meta,qA()||{}),zA(bt)}return He}function JA(i){Zi(i.list)?i.list=i.list.map(s=>gt(s)?jy(s):s):Ei(i.named)&&Object.keys(i.named).forEach(s=>{gt(i.named[s])&&(i.named[s]=jy(i.named[s]))})}function Wx(i,s,l,f,m,x){const{messages:v,onWarn:c,messageResolver:A,localeFallbacker:R}=i,z=R(i,f,l);let B={},M,re=null;const se="translate";for(let ue=0;ue<z.length&&(M=z[ue],B=v[M]||{},(re=A(B,s))===null&&(re=B[s]),!(gt(re)||Xl(re)||Qn(re)));ue++){const ae=$m(i,s,M,x,se);ae!==s&&(re=ae)}return[re,M,B]}function Zx(i,s,l,f,m,x){const{messageCompiler:v,warnHtmlMessage:c}=i;if(Qn(f)){const R=f;return R.locale=R.locale||l,R.key=R.key||s,R}if(v==null){const R=()=>f;return R.locale=l,R.key=s,R}const A=v(f,eC(i,l,m,f,c,x));return A.locale=l,A.key=s,A.source=f,A}function QA(i,s,l){return s(l)}function em(...i){const[s,l,f]=i,m={};if(!gt(s)&&!Cr(s)&&!Qn(s)&&!Xl(s))throw As(us.INVALID_ARGUMENT);const x=Cr(s)?String(s):(Qn(s),s);return Cr(l)?m.plural=l:gt(l)?m.default=l:Gt(l)&&!Yd(l)?m.named=l:Zi(l)&&(m.list=l),Cr(f)?m.plural=f:gt(f)?m.default=f:Gt(f)&&Jr(m,f),[x,m]}function eC(i,s,l,f,m,x){return{locale:s,key:l,warnHtmlMessage:m,onError:v=>{throw x&&x(v),v},onCacheKey:v=>RI(s,l,v)}}function tC(i,s,l,f){const{modifiers:m,pluralRules:x,messageResolver:v,fallbackLocale:c,fallbackWarn:A,missingWarn:R,fallbackContext:z}=i,M={locale:s,modifiers:m,pluralRules:x,messages:re=>{let se=v(l,re);if(se==null&&z){const[,,ue]=Wx(z,re,s,c,A,R);se=v(ue,re)}if(gt(se)||Xl(se)){let ue=!1;const Z=Zx(i,re,s,se,re,()=>{ue=!0});return ue?nv:Z}else return Qn(se)?se:nv}};return i.processor&&(M.processor=i.processor),f.list&&(M.list=f.list),f.named&&(M.named=f.named),Cr(f.plural)&&(M.pluralIndex=f.plural),M}function av(i,...s){const{datetimeFormats:l,unresolving:f,fallbackLocale:m,onWarn:x,localeFallbacker:v}=i,{__datetimeFormatters:c}=i,[A,R,z,B]=tm(...s),M=si(z.missingWarn)?z.missingWarn:i.missingWarn;si(z.fallbackWarn)?z.fallbackWarn:i.fallbackWarn;const re=!!z.part,se=Um(i,z),ue=v(i,m,se);if(!gt(A)||A==="")return new Intl.DateTimeFormat(se,B).format(R);let ae={},Z,me=null;const Ce="datetime format";for(let Ae=0;Ae<ue.length&&(Z=ue[Ae],ae=l[Z]||{},me=ae[A],!Gt(me));Ae++)$m(i,A,Z,M,Ce);if(!Gt(me)||!gt(Z))return f?Xd:A;let be=`${Z}__${A}`;Yd(B)||(be=`${be}__${JSON.stringify(B)}`);let Re=c.get(be);return Re||(Re=new Intl.DateTimeFormat(Z,Jr({},me,B)),c.set(be,Re)),re?Re.formatToParts(R):Re.format(R)}const Kx=["localeMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName","formatMatcher","hour12","timeZone","dateStyle","timeStyle","calendar","dayPeriod","numberingSystem","hourCycle","fractionalSecondDigits"];function tm(...i){const[s,l,f,m]=i,x={};let v={},c;if(gt(s)){const A=s.match(/(\d{4}-\d{2}-\d{2})(T|\s)?(.*)/);if(!A)throw As(us.INVALID_ISO_DATE_ARGUMENT);const R=A[3]?A[3].trim().startsWith("T")?`${A[1].trim()}${A[3].trim()}`:`${A[1].trim()}T${A[3].trim()}`:A[1].trim();c=new Date(R);try{c.toISOString()}catch{throw As(us.INVALID_ISO_DATE_ARGUMENT)}}else if(zI(s)){if(isNaN(s.getTime()))throw As(us.INVALID_DATE_ARGUMENT);c=s}else if(Cr(s))c=s;else throw As(us.INVALID_ARGUMENT);return gt(l)?x.key=l:Gt(l)&&Object.keys(l).forEach(A=>{Kx.includes(A)?v[A]=l[A]:x[A]=l[A]}),gt(f)?x.locale=f:Gt(f)&&(v=f),Gt(m)&&(v=m),[x.key||"",c,x,v]}function ov(i,s,l){const f=i;for(const m in l){const x=`${s}__${m}`;f.__datetimeFormatters.has(x)&&f.__datetimeFormatters.delete(x)}}function lv(i,...s){const{numberFormats:l,unresolving:f,fallbackLocale:m,onWarn:x,localeFallbacker:v}=i,{__numberFormatters:c}=i,[A,R,z,B]=im(...s),M=si(z.missingWarn)?z.missingWarn:i.missingWarn;si(z.fallbackWarn)?z.fallbackWarn:i.fallbackWarn;const re=!!z.part,se=Um(i,z),ue=v(i,m,se);if(!gt(A)||A==="")return new Intl.NumberFormat(se,B).format(R);let ae={},Z,me=null;const Ce="number format";for(let Ae=0;Ae<ue.length&&(Z=ue[Ae],ae=l[Z]||{},me=ae[A],!Gt(me));Ae++)$m(i,A,Z,M,Ce);if(!Gt(me)||!gt(Z))return f?Xd:A;let be=`${Z}__${A}`;Yd(B)||(be=`${be}__${JSON.stringify(B)}`);let Re=c.get(be);return Re||(Re=new Intl.NumberFormat(Z,Jr({},me,B)),c.set(be,Re)),re?Re.formatToParts(R):Re.format(R)}const Yx=["localeMatcher","style","currency","currencyDisplay","currencySign","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","notation","signDisplay","unit","unitDisplay","roundingMode","roundingPriority","roundingIncrement","trailingZeroDisplay"];function im(...i){const[s,l,f,m]=i,x={};let v={};if(!Cr(s))throw As(us.INVALID_ARGUMENT);const c=s;return gt(l)?x.key=l:Gt(l)&&Object.keys(l).forEach(A=>{Yx.includes(A)?v[A]=l[A]:x[A]=l[A]}),gt(f)?x.locale=f:Gt(f)&&(v=f),Gt(m)&&(v=m),[x.key||"",c,x,v]}function cv(i,s,l){const f=i;for(const m in l){const x=`${s}__${m}`;f.__numberFormatters.has(x)&&f.__numberFormatters.delete(x)}}gA();/*!
  * vue-i18n v9.9.1
  * (c) 2024 kazuya kawaguchi
  * Released under the MIT License.
  */const iC="9.9.1";function rC(){typeof __VUE_I18N_FULL_INSTALL__!="boolean"&&(Js().__VUE_I18N_FULL_INSTALL__=!0),typeof __VUE_I18N_LEGACY_API__!="boolean"&&(Js().__VUE_I18N_LEGACY_API__=!0),typeof __INTLIFY_JIT_COMPILATION__!="boolean"&&(Js().__INTLIFY_JIT_COMPILATION__=!1),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(Js().__INTLIFY_DROP_MESSAGE_COMPILER__=!1),typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(Js().__INTLIFY_PROD_DEVTOOLS__=!1)}const Xx=FA.__EXTEND_POINT__,Ca=Nm(Xx);Ca(),Ca(),Ca(),Ca(),Ca(),Ca(),Ca(),Ca();const Jx=us.__EXTEND_POINT__,kn=Nm(Jx),Pr={UNEXPECTED_RETURN_TYPE:Jx,INVALID_ARGUMENT:kn(),MUST_BE_CALL_SETUP_TOP:kn(),NOT_INSTALLED:kn(),NOT_AVAILABLE_IN_LEGACY_MODE:kn(),REQUIRED_VALUE:kn(),INVALID_VALUE:kn(),CANNOT_SETUP_VUE_DEVTOOLS_PLUGIN:kn(),NOT_INSTALLED_WITH_PROVIDE:kn(),UNEXPECTED_ERROR:kn(),NOT_COMPATIBLE_LEGACY_VUE_I18N:kn(),BRIDGE_SUPPORT_VUE_2_ONLY:kn(),MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION:kn(),NOT_AVAILABLE_COMPOSITION_IN_LEGACY:kn(),__EXTEND_POINT__:kn()};function Br(i,...s){return rc(i,null,void 0)}const rm=Za("__translateVNode"),nm=Za("__datetimeParts"),sm=Za("__numberParts"),Qx=Za("__setPluralRules"),eb=Za("__injectWithOption"),am=Za("__dispose");function Lu(i){if(!Ei(i))return i;for(const s in i)if(kd(i,s))if(!s.includes("."))Ei(i[s])&&Lu(i[s]);else{const l=s.split("."),f=l.length-1;let m=i,x=!1;for(let v=0;v<f;v++){if(l[v]in m||(m[l[v]]={}),!Ei(m[l[v]])){x=!0;break}m=m[l[v]]}x||(m[l[f]]=i[s],delete i[s]),Ei(m[l[f]])&&Lu(m[l[f]])}return i}function Jd(i,s){const{messages:l,__i18n:f,messageResolver:m,flatJson:x}=s,v=Gt(l)?l:Zi(f)?{}:{[i]:{}};if(Zi(f)&&f.forEach(c=>{if("locale"in c&&"resource"in c){const{locale:A,resource:R}=c;A?(v[A]=v[A]||{},gd(R,v[A])):gd(R,v)}else gt(c)&&gd(JSON.parse(c),v)}),m==null&&x)for(const c in v)kd(v,c)&&Lu(v[c]);return v}function tb(i){return i.type}function ib(i,s,l){let f=Ei(s.messages)?s.messages:{};"__i18nGlobal"in l&&(f=Jd(i.locale.value,{messages:f,__i18n:l.__i18nGlobal}));const m=Object.keys(f);m.length&&m.forEach(x=>{i.mergeLocaleMessage(x,f[x])});{if(Ei(s.datetimeFormats)){const x=Object.keys(s.datetimeFormats);x.length&&x.forEach(v=>{i.mergeDateTimeFormat(v,s.datetimeFormats[v])})}if(Ei(s.numberFormats)){const x=Object.keys(s.numberFormats);x.length&&x.forEach(v=>{i.mergeNumberFormat(v,s.numberFormats[v])})}}}function uv(i){return ci(Vu,null,i,0)}const hv="__INTLIFY_META__",dv=()=>[],nC=()=>!1;let fv=0;function pv(i){return(s,l,f,m)=>i(l,f,Nr()||void 0,m)}const sC=()=>{const i=Nr();let s=null;return i&&(s=tb(i)[hv])?{[hv]:s}:null};function jm(i={},s){const{__root:l,__injectWithOption:f}=i,m=l===void 0,x=i.flatJson,v=Md?yi:En;let c=si(i.inheritLocale)?i.inheritLocale:!0;const A=v(l&&c?l.locale.value:gt(i.locale)?i.locale:Yl),R=v(l&&c?l.fallbackLocale.value:gt(i.fallbackLocale)||Zi(i.fallbackLocale)||Gt(i.fallbackLocale)||i.fallbackLocale===!1?i.fallbackLocale:A.value),z=v(Jd(A.value,i)),B=v(Gt(i.datetimeFormats)?i.datetimeFormats:{[A.value]:{}}),M=v(Gt(i.numberFormats)?i.numberFormats:{[A.value]:{}});let re=l?l.missingWarn:si(i.missingWarn)||$a(i.missingWarn)?i.missingWarn:!0,se=l?l.fallbackWarn:si(i.fallbackWarn)||$a(i.fallbackWarn)?i.fallbackWarn:!0,ue=l?l.fallbackRoot:si(i.fallbackRoot)?i.fallbackRoot:!0,ae=!!i.fallbackFormat,Z=Vi(i.missing)?i.missing:null,me=Vi(i.missing)?pv(i.missing):null,Ce=Vi(i.postTranslation)?i.postTranslation:null,be=l?l.warnHtmlMessage:si(i.warnHtmlMessage)?i.warnHtmlMessage:!0,Re=!!i.escapeParameter;const Ae=l?l.modifiers:Gt(i.modifiers)?i.modifiers:{};let $e=i.pluralRules||l&&l.pluralRules,Se;Se=(()=>{m&&tv(null);const xe={version:iC,locale:A.value,fallbackLocale:R.value,messages:z.value,modifiers:Ae,pluralRules:$e,missing:me===null?void 0:me,missingWarn:re,fallbackWarn:se,fallbackFormat:ae,unresolving:!0,postTranslation:Ce===null?void 0:Ce,warnHtmlMessage:be,escapeParameter:Re,messageResolver:i.messageResolver,messageCompiler:i.messageCompiler,__meta:{framework:"vue"}};xe.datetimeFormats=B.value,xe.numberFormats=M.value,xe.__datetimeFormatters=Gt(Se)?Se.__datetimeFormatters:void 0,xe.__numberFormatters=Gt(Se)?Se.__numberFormatters:void 0;const Pe=ZA(xe);return m&&tv(Pe),Pe})(),ou(Se,A.value,R.value);function ot(){return[A.value,R.value,z.value,B.value,M.value]}const _t=Rt({get:()=>A.value,set:xe=>{A.value=xe,Se.locale=A.value}}),He=Rt({get:()=>R.value,set:xe=>{R.value=xe,Se.fallbackLocale=R.value,ou(Se,A.value,xe)}}),bt=Rt(()=>z.value),qt=Rt(()=>B.value),pi=Rt(()=>M.value);function Lt(){return Vi(Ce)?Ce:null}function jt(xe){Ce=xe,Se.postTranslation=xe}function Dt(){return Z}function Ci(xe){xe!==null&&(me=pv(xe)),Z=xe,Se.missing=me}const mi=(xe,Pe,yt,Ct,Oe,oi)=>{ot();let fi;try{__INTLIFY_PROD_DEVTOOLS__,m||(Se.fallbackContext=l?WA():void 0),fi=xe(Se)}finally{__INTLIFY_PROD_DEVTOOLS__,m||(Se.fallbackContext=void 0)}if(yt!=="translate exists"&&Cr(fi)&&fi===Xd||yt==="translate exists"&&!fi){const[rn,rr]=Pe();return l&&ue?Ct(l):Oe(rn)}else{if(oi(fi))return fi;throw Br(Pr.UNEXPECTED_RETURN_TYPE)}};function ai(...xe){return mi(Pe=>Reflect.apply(sv,null,[Pe,...xe]),()=>em(...xe),"translate",Pe=>Reflect.apply(Pe.t,Pe,[...xe]),Pe=>Pe,Pe=>gt(Pe))}function Xt(...xe){const[Pe,yt,Ct]=xe;if(Ct&&!Ei(Ct))throw Br(Pr.INVALID_ARGUMENT);return ai(Pe,yt,Jr({resolvedMessage:!0},Ct||{}))}function Bi(...xe){return mi(Pe=>Reflect.apply(av,null,[Pe,...xe]),()=>tm(...xe),"datetime format",Pe=>Reflect.apply(Pe.d,Pe,[...xe]),()=>Jy,Pe=>gt(Pe))}function Pi(...xe){return mi(Pe=>Reflect.apply(lv,null,[Pe,...xe]),()=>im(...xe),"number format",Pe=>Reflect.apply(Pe.n,Pe,[...xe]),()=>Jy,Pe=>gt(Pe))}function Yi(xe){return xe.map(Pe=>gt(Pe)||Cr(Pe)||si(Pe)?uv(String(Pe)):Pe)}const ke={normalize:Yi,interpolate:xe=>xe,type:"vnode"};function nt(...xe){return mi(Pe=>{let yt;const Ct=Pe;try{Ct.processor=ke,yt=Reflect.apply(sv,null,[Ct,...xe])}finally{Ct.processor=null}return yt},()=>em(...xe),"translate",Pe=>Pe[rm](...xe),Pe=>[uv(Pe)],Pe=>Zi(Pe))}function it(...xe){return mi(Pe=>Reflect.apply(lv,null,[Pe,...xe]),()=>im(...xe),"number format",Pe=>Pe[sm](...xe),dv,Pe=>gt(Pe)||Zi(Pe))}function ht(...xe){return mi(Pe=>Reflect.apply(av,null,[Pe,...xe]),()=>tm(...xe),"datetime format",Pe=>Pe[nm](...xe),dv,Pe=>gt(Pe)||Zi(Pe))}function Ht(xe){$e=xe,Se.pluralRules=$e}function ei(xe,Pe){return mi(()=>{if(!xe)return!1;const yt=gt(Pe)?Pe:A.value,Ct=Y(yt),Oe=Se.messageResolver(Ct,xe);return Xl(Oe)||Qn(Oe)||gt(Oe)},()=>[xe],"translate exists",yt=>Reflect.apply(yt.te,yt,[xe,Pe]),nC,yt=>si(yt))}function O(xe){let Pe=null;const yt=Nx(Se,R.value,A.value);for(let Ct=0;Ct<yt.length;Ct++){const Oe=z.value[yt[Ct]]||{},oi=Se.messageResolver(Oe,xe);if(oi!=null){Pe=oi;break}}return Pe}function D(xe){const Pe=O(xe);return Pe??(l?l.tm(xe)||{}:{})}function Y(xe){return z.value[xe]||{}}function ye(xe,Pe){if(x){const yt={[xe]:Pe};for(const Ct in yt)kd(yt,Ct)&&Lu(yt[Ct]);Pe=yt[xe]}z.value[xe]=Pe,Se.messages=z.value}function K(xe,Pe){z.value[xe]=z.value[xe]||{};const yt={[xe]:Pe};if(x)for(const Ct in yt)kd(yt,Ct)&&Lu(yt[Ct]);Pe=yt[xe],gd(Pe,z.value[xe]),Se.messages=z.value}function Be(xe){return B.value[xe]||{}}function Qe(xe,Pe){B.value[xe]=Pe,Se.datetimeFormats=B.value,ov(Se,xe,Pe)}function Me(xe,Pe){B.value[xe]=Jr(B.value[xe]||{},Pe),Se.datetimeFormats=B.value,ov(Se,xe,Pe)}function Ke(xe){return M.value[xe]||{}}function qe(xe,Pe){M.value[xe]=Pe,Se.numberFormats=M.value,cv(Se,xe,Pe)}function ft(xe,Pe){M.value[xe]=Jr(M.value[xe]||{},Pe),Se.numberFormats=M.value,cv(Se,xe,Pe)}fv++,l&&Md&&(Mt(l.locale,xe=>{c&&(A.value=xe,Se.locale=xe,ou(Se,A.value,R.value))}),Mt(l.fallbackLocale,xe=>{c&&(R.value=xe,Se.fallbackLocale=xe,ou(Se,A.value,R.value))}));const ct={id:fv,locale:_t,fallbackLocale:He,get inheritLocale(){return c},set inheritLocale(xe){c=xe,xe&&l&&(A.value=l.locale.value,R.value=l.fallbackLocale.value,ou(Se,A.value,R.value))},get availableLocales(){return Object.keys(z.value).sort()},messages:bt,get modifiers(){return Ae},get pluralRules(){return $e||{}},get isGlobal(){return m},get missingWarn(){return re},set missingWarn(xe){re=xe,Se.missingWarn=re},get fallbackWarn(){return se},set fallbackWarn(xe){se=xe,Se.fallbackWarn=se},get fallbackRoot(){return ue},set fallbackRoot(xe){ue=xe},get fallbackFormat(){return ae},set fallbackFormat(xe){ae=xe,Se.fallbackFormat=ae},get warnHtmlMessage(){return be},set warnHtmlMessage(xe){be=xe,Se.warnHtmlMessage=xe},get escapeParameter(){return Re},set escapeParameter(xe){Re=xe,Se.escapeParameter=xe},t:ai,getLocaleMessage:Y,setLocaleMessage:ye,mergeLocaleMessage:K,getPostTranslationHandler:Lt,setPostTranslationHandler:jt,getMissingHandler:Dt,setMissingHandler:Ci,[Qx]:Ht};return ct.datetimeFormats=qt,ct.numberFormats=pi,ct.rt=Xt,ct.te=ei,ct.tm=D,ct.d=Bi,ct.n=Pi,ct.getDateTimeFormat=Be,ct.setDateTimeFormat=Qe,ct.mergeDateTimeFormat=Me,ct.getNumberFormat=Ke,ct.setNumberFormat=qe,ct.mergeNumberFormat=ft,ct[eb]=f,ct[rm]=nt,ct[nm]=ht,ct[sm]=it,ct}function aC(i){const s=gt(i.locale)?i.locale:Yl,l=gt(i.fallbackLocale)||Zi(i.fallbackLocale)||Gt(i.fallbackLocale)||i.fallbackLocale===!1?i.fallbackLocale:s,f=Vi(i.missing)?i.missing:void 0,m=si(i.silentTranslationWarn)||$a(i.silentTranslationWarn)?!i.silentTranslationWarn:!0,x=si(i.silentFallbackWarn)||$a(i.silentFallbackWarn)?!i.silentFallbackWarn:!0,v=si(i.fallbackRoot)?i.fallbackRoot:!0,c=!!i.formatFallbackMessages,A=Gt(i.modifiers)?i.modifiers:{},R=i.pluralizationRules,z=Vi(i.postTranslation)?i.postTranslation:void 0,B=gt(i.warnHtmlInMessage)?i.warnHtmlInMessage!=="off":!0,M=!!i.escapeParameterHtml,re=si(i.sync)?i.sync:!0;let se=i.messages;if(Gt(i.sharedMessages)){const Re=i.sharedMessages;se=Object.keys(Re).reduce(($e,Se)=>{const Ge=$e[Se]||($e[Se]={});return Jr(Ge,Re[Se]),$e},se||{})}const{__i18n:ue,__root:ae,__injectWithOption:Z}=i,me=i.datetimeFormats,Ce=i.numberFormats,be=i.flatJson;return{locale:s,fallbackLocale:l,messages:se,flatJson:be,datetimeFormats:me,numberFormats:Ce,missing:f,missingWarn:m,fallbackWarn:x,fallbackRoot:v,fallbackFormat:c,modifiers:A,pluralRules:R,postTranslation:z,warnHtmlMessage:B,escapeParameter:M,messageResolver:i.messageResolver,inheritLocale:re,__i18n:ue,__root:ae,__injectWithOption:Z}}function om(i={},s){{const l=jm(aC(i)),{__extender:f}=i,m={id:l.id,get locale(){return l.locale.value},set locale(x){l.locale.value=x},get fallbackLocale(){return l.fallbackLocale.value},set fallbackLocale(x){l.fallbackLocale.value=x},get messages(){return l.messages.value},get datetimeFormats(){return l.datetimeFormats.value},get numberFormats(){return l.numberFormats.value},get availableLocales(){return l.availableLocales},get formatter(){return{interpolate(){return[]}}},set formatter(x){},get missing(){return l.getMissingHandler()},set missing(x){l.setMissingHandler(x)},get silentTranslationWarn(){return si(l.missingWarn)?!l.missingWarn:l.missingWarn},set silentTranslationWarn(x){l.missingWarn=si(x)?!x:x},get silentFallbackWarn(){return si(l.fallbackWarn)?!l.fallbackWarn:l.fallbackWarn},set silentFallbackWarn(x){l.fallbackWarn=si(x)?!x:x},get modifiers(){return l.modifiers},get formatFallbackMessages(){return l.fallbackFormat},set formatFallbackMessages(x){l.fallbackFormat=x},get postTranslation(){return l.getPostTranslationHandler()},set postTranslation(x){l.setPostTranslationHandler(x)},get sync(){return l.inheritLocale},set sync(x){l.inheritLocale=x},get warnHtmlInMessage(){return l.warnHtmlMessage?"warn":"off"},set warnHtmlInMessage(x){l.warnHtmlMessage=x!=="off"},get escapeParameterHtml(){return l.escapeParameter},set escapeParameterHtml(x){l.escapeParameter=x},get preserveDirectiveContent(){return!0},set preserveDirectiveContent(x){},get pluralizationRules(){return l.pluralRules||{}},__composer:l,t(...x){const[v,c,A]=x,R={};let z=null,B=null;if(!gt(v))throw Br(Pr.INVALID_ARGUMENT);const M=v;return gt(c)?R.locale=c:Zi(c)?z=c:Gt(c)&&(B=c),Zi(A)?z=A:Gt(A)&&(B=A),Reflect.apply(l.t,l,[M,z||B||{},R])},rt(...x){return Reflect.apply(l.rt,l,[...x])},tc(...x){const[v,c,A]=x,R={plural:1};let z=null,B=null;if(!gt(v))throw Br(Pr.INVALID_ARGUMENT);const M=v;return gt(c)?R.locale=c:Cr(c)?R.plural=c:Zi(c)?z=c:Gt(c)&&(B=c),gt(A)?R.locale=A:Zi(A)?z=A:Gt(A)&&(B=A),Reflect.apply(l.t,l,[M,z||B||{},R])},te(x,v){return l.te(x,v)},tm(x){return l.tm(x)},getLocaleMessage(x){return l.getLocaleMessage(x)},setLocaleMessage(x,v){l.setLocaleMessage(x,v)},mergeLocaleMessage(x,v){l.mergeLocaleMessage(x,v)},d(...x){return Reflect.apply(l.d,l,[...x])},getDateTimeFormat(x){return l.getDateTimeFormat(x)},setDateTimeFormat(x,v){l.setDateTimeFormat(x,v)},mergeDateTimeFormat(x,v){l.mergeDateTimeFormat(x,v)},n(...x){return Reflect.apply(l.n,l,[...x])},getNumberFormat(x){return l.getNumberFormat(x)},setNumberFormat(x,v){l.setNumberFormat(x,v)},mergeNumberFormat(x,v){l.mergeNumberFormat(x,v)},getChoiceIndex(x,v){return-1}};return m.__extender=f,m}}const Hm={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:i=>i==="parent"||i==="global",default:"parent"},i18n:{type:Object}};function oC({slots:i},s){return s.length===1&&s[0]==="default"?(i.default?i.default():[]).reduce((f,m)=>[...f,...m.type===Yr?m.children:[m]],[]):s.reduce((l,f)=>{const m=i[f];return m&&(l[f]=m()),l},{})}function rb(i){return Yr}const lC=di({name:"i18n-t",props:Jr({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:i=>Cr(i)||!isNaN(i)}},Hm),setup(i,s){const{slots:l,attrs:f}=s,m=i.i18n||Gm({useScope:i.scope,__useComponent:!0});return()=>{const x=Object.keys(l).filter(B=>B!=="_"),v={};i.locale&&(v.locale=i.locale),i.plural!==void 0&&(v.plural=gt(i.plural)?+i.plural:i.plural);const c=oC(s,x),A=m[rm](i.keypath,c,v),R=Jr({},f),z=gt(i.tag)||Ei(i.tag)?i.tag:rb();return Fr(z,R,A)}}}),mv=lC;function cC(i){return Zi(i)&&!gt(i[0])}function nb(i,s,l,f){const{slots:m,attrs:x}=s;return()=>{const v={part:!0};let c={};i.locale&&(v.locale=i.locale),gt(i.format)?v.key=i.format:Ei(i.format)&&(gt(i.format.key)&&(v.key=i.format.key),c=Object.keys(i.format).reduce((M,re)=>l.includes(re)?Jr({},M,{[re]:i.format[re]}):M,{}));const A=f(i.value,v,c);let R=[v.key];Zi(A)?R=A.map((M,re)=>{const se=m[M.type],ue=se?se({[M.type]:M.value,index:re,parts:A}):[M.value];return cC(ue)&&(ue[0].key=`${M.type}-${re}`),ue}):gt(A)&&(R=[A]);const z=Jr({},x),B=gt(i.tag)||Ei(i.tag)?i.tag:rb();return Fr(B,z,R)}}const uC=di({name:"i18n-n",props:Jr({value:{type:Number,required:!0},format:{type:[String,Object]}},Hm),setup(i,s){const l=i.i18n||Gm({useScope:"parent",__useComponent:!0});return nb(i,s,Yx,(...f)=>l[sm](...f))}}),gv=uC,hC=di({name:"i18n-d",props:Jr({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},Hm),setup(i,s){const l=i.i18n||Gm({useScope:"parent",__useComponent:!0});return nb(i,s,Kx,(...f)=>l[nm](...f))}}),_v=hC;function dC(i,s){const l=i;if(i.mode==="composition")return l.__getInstance(s)||i.global;{const f=l.__getInstance(s);return f!=null?f.__composer:i.global.__composer}}function fC(i){const s=v=>{const{instance:c,modifiers:A,value:R}=v;if(!c||!c.$)throw Br(Pr.UNEXPECTED_ERROR);const z=dC(i,c.$),B=yv(R);return[Reflect.apply(z.t,z,[...vv(B)]),z]};return{created:(v,c)=>{const[A,R]=s(c);Md&&i.global===R&&(v.__i18nWatcher=Mt(R.locale,()=>{c.instance&&c.instance.$forceUpdate()})),v.__composer=R,v.textContent=A},unmounted:v=>{Md&&v.__i18nWatcher&&(v.__i18nWatcher(),v.__i18nWatcher=void 0,delete v.__i18nWatcher),v.__composer&&(v.__composer=void 0,delete v.__composer)},beforeUpdate:(v,{value:c})=>{if(v.__composer){const A=v.__composer,R=yv(c);v.textContent=Reflect.apply(A.t,A,[...vv(R)])}},getSSRProps:v=>{const[c]=s(v);return{textContent:c}}}}function yv(i){if(gt(i))return{path:i};if(Gt(i)){if(!("path"in i))throw Br(Pr.REQUIRED_VALUE,"path");return i}else throw Br(Pr.INVALID_VALUE)}function vv(i){const{path:s,locale:l,args:f,choice:m,plural:x}=i,v={},c=f||{};return gt(l)&&(v.locale=l),Cr(m)&&(v.plural=m),Cr(x)&&(v.plural=x),[s,c,v]}function pC(i,s,...l){const f=Gt(l[0])?l[0]:{},m=!!f.useI18nComponentName;(si(f.globalInstall)?f.globalInstall:!0)&&([m?"i18n":mv.name,"I18nT"].forEach(v=>i.component(v,mv)),[gv.name,"I18nN"].forEach(v=>i.component(v,gv)),[_v.name,"I18nD"].forEach(v=>i.component(v,_v))),i.directive("t",fC(s))}function mC(i,s,l){return{beforeCreate(){const f=Nr();if(!f)throw Br(Pr.UNEXPECTED_ERROR);const m=this.$options;if(m.i18n){const x=m.i18n;if(m.__i18n&&(x.__i18n=m.__i18n),x.__root=s,this===this.$root)this.$i18n=xv(i,x);else{x.__injectWithOption=!0,x.__extender=l.__vueI18nExtend,this.$i18n=om(x);const v=this.$i18n;v.__extender&&(v.__disposer=v.__extender(this.$i18n))}}else if(m.__i18n)if(this===this.$root)this.$i18n=xv(i,m);else{this.$i18n=om({__i18n:m.__i18n,__injectWithOption:!0,__extender:l.__vueI18nExtend,__root:s});const x=this.$i18n;x.__extender&&(x.__disposer=x.__extender(this.$i18n))}else this.$i18n=i;m.__i18nGlobal&&ib(s,m,m),this.$t=(...x)=>this.$i18n.t(...x),this.$rt=(...x)=>this.$i18n.rt(...x),this.$tc=(...x)=>this.$i18n.tc(...x),this.$te=(x,v)=>this.$i18n.te(x,v),this.$d=(...x)=>this.$i18n.d(...x),this.$n=(...x)=>this.$i18n.n(...x),this.$tm=x=>this.$i18n.tm(x),l.__setInstance(f,this.$i18n)},mounted(){},unmounted(){const f=Nr();if(!f)throw Br(Pr.UNEXPECTED_ERROR);const m=this.$i18n;delete this.$t,delete this.$rt,delete this.$tc,delete this.$te,delete this.$d,delete this.$n,delete this.$tm,m.__disposer&&(m.__disposer(),delete m.__disposer,delete m.__extender),l.__deleteInstance(f),delete this.$i18n}}}function xv(i,s){i.locale=s.locale||i.locale,i.fallbackLocale=s.fallbackLocale||i.fallbackLocale,i.missing=s.missing||i.missing,i.silentTranslationWarn=s.silentTranslationWarn||i.silentFallbackWarn,i.silentFallbackWarn=s.silentFallbackWarn||i.silentFallbackWarn,i.formatFallbackMessages=s.formatFallbackMessages||i.formatFallbackMessages,i.postTranslation=s.postTranslation||i.postTranslation,i.warnHtmlInMessage=s.warnHtmlInMessage||i.warnHtmlInMessage,i.escapeParameterHtml=s.escapeParameterHtml||i.escapeParameterHtml,i.sync=s.sync||i.sync,i.__composer[Qx](s.pluralizationRules||i.pluralizationRules);const l=Jd(i.locale,{messages:s.messages,__i18n:s.__i18n});return Object.keys(l).forEach(f=>i.mergeLocaleMessage(f,l[f])),s.datetimeFormats&&Object.keys(s.datetimeFormats).forEach(f=>i.mergeDateTimeFormat(f,s.datetimeFormats[f])),s.numberFormats&&Object.keys(s.numberFormats).forEach(f=>i.mergeNumberFormat(f,s.numberFormats[f])),i}const gC=Za("global-vue-i18n");function _C(i={},s){const l=__VUE_I18N_LEGACY_API__&&si(i.legacy)?i.legacy:__VUE_I18N_LEGACY_API__,f=si(i.globalInjection)?i.globalInjection:!0,m=__VUE_I18N_LEGACY_API__&&l?!!i.allowComposition:!0,x=new Map,[v,c]=yC(i,l),A=Za("");function R(M){return x.get(M)||null}function z(M,re){x.set(M,re)}function B(M){x.delete(M)}{const M={get mode(){return __VUE_I18N_LEGACY_API__&&l?"legacy":"composition"},get allowComposition(){return m},async install(re,...se){if(re.__VUE_I18N_SYMBOL__=A,re.provide(re.__VUE_I18N_SYMBOL__,M),Gt(se[0])){const Z=se[0];M.__composerExtend=Z.__composerExtend,M.__vueI18nExtend=Z.__vueI18nExtend}let ue=null;!l&&f&&(ue=AC(re,M.global)),__VUE_I18N_FULL_INSTALL__&&pC(re,M,...se),__VUE_I18N_LEGACY_API__&&l&&re.mixin(mC(c,c.__composer,M));const ae=re.unmount;re.unmount=()=>{ue&&ue(),M.dispose(),ae()}},get global(){return c},dispose(){v.stop()},__instances:x,__getInstance:R,__setInstance:z,__deleteInstance:B};return M}}function Gm(i={}){const s=Nr();if(s==null)throw Br(Pr.MUST_BE_CALL_SETUP_TOP);if(!s.isCE&&s.appContext.app!=null&&!s.appContext.app.__VUE_I18N_SYMBOL__)throw Br(Pr.NOT_INSTALLED);const l=vC(s),f=bC(l),m=tb(s),x=xC(i,m);if(__VUE_I18N_LEGACY_API__&&l.mode==="legacy"&&!i.__useComponent){if(!l.allowComposition)throw Br(Pr.NOT_AVAILABLE_IN_LEGACY_MODE);return EC(s,x,f,i)}if(x==="global")return ib(f,i,m),f;if(x==="parent"){let A=wC(l,s,i.__useComponent);return A==null&&(A=f),A}const v=l;let c=v.__getInstance(s);if(c==null){const A=Jr({},i);"__i18n"in m&&(A.__i18n=m.__i18n),f&&(A.__root=f),c=jm(A),v.__composerExtend&&(c[am]=v.__composerExtend(c)),TC(v,s,c),v.__setInstance(s,c)}return c}function yC(i,s,l){const f=Fd();{const m=__VUE_I18N_LEGACY_API__&&s?f.run(()=>om(i)):f.run(()=>jm(i));if(m==null)throw Br(Pr.UNEXPECTED_ERROR);return[f,m]}}function vC(i){{const s=et(i.isCE?gC:i.appContext.app.__VUE_I18N_SYMBOL__);if(!s)throw Br(i.isCE?Pr.NOT_INSTALLED_WITH_PROVIDE:Pr.UNEXPECTED_ERROR);return s}}function xC(i,s){return Yd(i)?"__i18n"in s?"local":"global":i.useScope?i.useScope:"local"}function bC(i){return i.mode==="composition"?i.global:i.global.__composer}function wC(i,s,l=!1){let f=null;const m=s.root;let x=SC(s,l);for(;x!=null;){const v=i;if(i.mode==="composition")f=v.__getInstance(x);else if(__VUE_I18N_LEGACY_API__){const c=v.__getInstance(x);c!=null&&(f=c.__composer,l&&f&&!f[eb]&&(f=null))}if(f!=null||m===x)break;x=x.parent}return f}function SC(i,s=!1){return i==null?null:s&&i.vnode.ctx||i.parent}function TC(i,s,l){ic(()=>{},s),Pm(()=>{const f=l;i.__deleteInstance(s);const m=f[am];m&&(m(),delete f[am])},s)}function EC(i,s,l,f={}){const m=s==="local",x=En(null);if(m&&i.proxy&&!(i.proxy.$options.i18n||i.proxy.$options.__i18n))throw Br(Pr.MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION);const v=si(f.inheritLocale)?f.inheritLocale:!gt(f.locale),c=yi(!m||v?l.locale.value:gt(f.locale)?f.locale:Yl),A=yi(!m||v?l.fallbackLocale.value:gt(f.fallbackLocale)||Zi(f.fallbackLocale)||Gt(f.fallbackLocale)||f.fallbackLocale===!1?f.fallbackLocale:c.value),R=yi(Jd(c.value,f)),z=yi(Gt(f.datetimeFormats)?f.datetimeFormats:{[c.value]:{}}),B=yi(Gt(f.numberFormats)?f.numberFormats:{[c.value]:{}}),M=m?l.missingWarn:si(f.missingWarn)||$a(f.missingWarn)?f.missingWarn:!0,re=m?l.fallbackWarn:si(f.fallbackWarn)||$a(f.fallbackWarn)?f.fallbackWarn:!0,se=m?l.fallbackRoot:si(f.fallbackRoot)?f.fallbackRoot:!0,ue=!!f.fallbackFormat,ae=Vi(f.missing)?f.missing:null,Z=Vi(f.postTranslation)?f.postTranslation:null,me=m?l.warnHtmlMessage:si(f.warnHtmlMessage)?f.warnHtmlMessage:!0,Ce=!!f.escapeParameter,be=m?l.modifiers:Gt(f.modifiers)?f.modifiers:{},Re=f.pluralRules||m&&l.pluralRules;function Ae(){return[c.value,A.value,R.value,z.value,B.value]}const $e=Rt({get:()=>x.value?x.value.locale.value:c.value,set:D=>{x.value&&(x.value.locale.value=D),c.value=D}}),Se=Rt({get:()=>x.value?x.value.fallbackLocale.value:A.value,set:D=>{x.value&&(x.value.fallbackLocale.value=D),A.value=D}}),Ge=Rt(()=>x.value?x.value.messages.value:R.value),ot=Rt(()=>z.value),_t=Rt(()=>B.value);function He(){return x.value?x.value.getPostTranslationHandler():Z}function bt(D){x.value&&x.value.setPostTranslationHandler(D)}function qt(){return x.value?x.value.getMissingHandler():ae}function pi(D){x.value&&x.value.setMissingHandler(D)}function Lt(D){return Ae(),D()}function jt(...D){return x.value?Lt(()=>Reflect.apply(x.value.t,null,[...D])):Lt(()=>"")}function Dt(...D){return x.value?Reflect.apply(x.value.rt,null,[...D]):""}function Ci(...D){return x.value?Lt(()=>Reflect.apply(x.value.d,null,[...D])):Lt(()=>"")}function mi(...D){return x.value?Lt(()=>Reflect.apply(x.value.n,null,[...D])):Lt(()=>"")}function ai(D){return x.value?x.value.tm(D):{}}function Xt(D,Y){return x.value?x.value.te(D,Y):!1}function Bi(D){return x.value?x.value.getLocaleMessage(D):{}}function Pi(D,Y){x.value&&(x.value.setLocaleMessage(D,Y),R.value[D]=Y)}function Yi(D,Y){x.value&&x.value.mergeLocaleMessage(D,Y)}function Wt(D){return x.value?x.value.getDateTimeFormat(D):{}}function ke(D,Y){x.value&&(x.value.setDateTimeFormat(D,Y),z.value[D]=Y)}function nt(D,Y){x.value&&x.value.mergeDateTimeFormat(D,Y)}function it(D){return x.value?x.value.getNumberFormat(D):{}}function ht(D,Y){x.value&&(x.value.setNumberFormat(D,Y),B.value[D]=Y)}function Ht(D,Y){x.value&&x.value.mergeNumberFormat(D,Y)}const ei={get id(){return x.value?x.value.id:-1},locale:$e,fallbackLocale:Se,messages:Ge,datetimeFormats:ot,numberFormats:_t,get inheritLocale(){return x.value?x.value.inheritLocale:v},set inheritLocale(D){x.value&&(x.value.inheritLocale=D)},get availableLocales(){return x.value?x.value.availableLocales:Object.keys(R.value)},get modifiers(){return x.value?x.value.modifiers:be},get pluralRules(){return x.value?x.value.pluralRules:Re},get isGlobal(){return x.value?x.value.isGlobal:!1},get missingWarn(){return x.value?x.value.missingWarn:M},set missingWarn(D){x.value&&(x.value.missingWarn=D)},get fallbackWarn(){return x.value?x.value.fallbackWarn:re},set fallbackWarn(D){x.value&&(x.value.missingWarn=D)},get fallbackRoot(){return x.value?x.value.fallbackRoot:se},set fallbackRoot(D){x.value&&(x.value.fallbackRoot=D)},get fallbackFormat(){return x.value?x.value.fallbackFormat:ue},set fallbackFormat(D){x.value&&(x.value.fallbackFormat=D)},get warnHtmlMessage(){return x.value?x.value.warnHtmlMessage:me},set warnHtmlMessage(D){x.value&&(x.value.warnHtmlMessage=D)},get escapeParameter(){return x.value?x.value.escapeParameter:Ce},set escapeParameter(D){x.value&&(x.value.escapeParameter=D)},t:jt,getPostTranslationHandler:He,setPostTranslationHandler:bt,getMissingHandler:qt,setMissingHandler:pi,rt:Dt,d:Ci,n:mi,tm:ai,te:Xt,getLocaleMessage:Bi,setLocaleMessage:Pi,mergeLocaleMessage:Yi,getDateTimeFormat:Wt,setDateTimeFormat:ke,mergeDateTimeFormat:nt,getNumberFormat:it,setNumberFormat:ht,mergeNumberFormat:Ht};function O(D){D.locale.value=c.value,D.fallbackLocale.value=A.value,Object.keys(R.value).forEach(Y=>{D.mergeLocaleMessage(Y,R.value[Y])}),Object.keys(z.value).forEach(Y=>{D.mergeDateTimeFormat(Y,z.value[Y])}),Object.keys(B.value).forEach(Y=>{D.mergeNumberFormat(Y,B.value[Y])}),D.escapeParameter=Ce,D.fallbackFormat=ue,D.fallbackRoot=se,D.fallbackWarn=re,D.missingWarn=M,D.warnHtmlMessage=me}return A0(()=>{if(i.proxy==null||i.proxy.$i18n==null)throw Br(Pr.NOT_AVAILABLE_COMPOSITION_IN_LEGACY);const D=x.value=i.proxy.$i18n.__composer;s==="global"?(c.value=D.locale.value,A.value=D.fallbackLocale.value,R.value=D.messages.value,z.value=D.datetimeFormats.value,B.value=D.numberFormats.value):m&&O(D)}),ei}const IC=["locale","fallbackLocale","availableLocales"],bv=["t","rt","d","n","tm","te"];function AC(i,s){const l=Object.create(null);return IC.forEach(m=>{const x=Object.getOwnPropertyDescriptor(s,m);if(!x)throw Br(Pr.UNEXPECTED_ERROR);const v=Fi(x.value)?{get(){return x.value.value},set(c){x.value.value=c}}:{get(){return x.get&&x.get()}};Object.defineProperty(l,m,v)}),i.config.globalProperties.$i18n=l,bv.forEach(m=>{const x=Object.getOwnPropertyDescriptor(s,m);if(!x||!x.value)throw Br(Pr.UNEXPECTED_ERROR);Object.defineProperty(i.config.globalProperties,`$${m}`,x)}),()=>{delete i.config.globalProperties.$i18n,bv.forEach(m=>{delete i.config.globalProperties[`$${m}`]})}}rC();__INTLIFY_JIT_COMPILATION__?ev(XA):ev(YA);jA(TA);HA(Nx);if(__INTLIFY_PROD_DEVTOOLS__){const i=Js();i.__INTLIFY__=!0,RA(i.__INTLIFY_DEVTOOLS_GLOBAL_HOOK__)}/*!
  * vue-router v4.2.5
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const Nl=typeof window<"u";function CC(i){return i.__esModule||i[Symbol.toStringTag]==="Module"}const Ii=Object.assign;function Tp(i,s){const l={};for(const f in s){const m=s[f];l[f]=ds(m)?m.map(i):i(m)}return l}const _u=()=>{},ds=Array.isArray,PC=/\/$/,MC=i=>i.replace(PC,"");function Ep(i,s,l="/"){let f,m={},x="",v="";const c=s.indexOf("#");let A=s.indexOf("?");return c<A&&c>=0&&(A=-1),A>-1&&(f=s.slice(0,A),x=s.slice(A+1,c>-1?c:s.length),m=i(x)),c>-1&&(f=f||s.slice(0,c),v=s.slice(c,s.length)),f=DC(f??s,l),{fullPath:f+(x&&"?")+x+v,path:f,query:m,hash:v}}function kC(i,s){const l=s.query?i(s.query):"";return s.path+(l&&"?")+l+(s.hash||"")}function wv(i,s){return!s||!i.toLowerCase().startsWith(s.toLowerCase())?i:i.slice(s.length)||"/"}function LC(i,s,l){const f=s.matched.length-1,m=l.matched.length-1;return f>-1&&f===m&&Jl(s.matched[f],l.matched[m])&&sb(s.params,l.params)&&i(s.query)===i(l.query)&&s.hash===l.hash}function Jl(i,s){return(i.aliasOf||i)===(s.aliasOf||s)}function sb(i,s){if(Object.keys(i).length!==Object.keys(s).length)return!1;for(const l in i)if(!RC(i[l],s[l]))return!1;return!0}function RC(i,s){return ds(i)?Sv(i,s):ds(s)?Sv(s,i):i===s}function Sv(i,s){return ds(s)?i.length===s.length&&i.every((l,f)=>l===s[f]):i.length===1&&i[0]===s}function DC(i,s){if(i.startsWith("/"))return i;if(!i)return s;const l=s.split("/"),f=i.split("/"),m=f[f.length-1];(m===".."||m===".")&&f.push("");let x=l.length-1,v,c;for(v=0;v<f.length;v++)if(c=f[v],c!==".")if(c==="..")x>1&&x--;else break;return l.slice(0,x).join("/")+"/"+f.slice(v-(v===f.length?1:0)).join("/")}var Ru;(function(i){i.pop="pop",i.push="push"})(Ru||(Ru={}));var yu;(function(i){i.back="back",i.forward="forward",i.unknown=""})(yu||(yu={}));function zC(i){if(!i)if(Nl){const s=document.querySelector("base");i=s&&s.getAttribute("href")||"/",i=i.replace(/^\w+:\/\/[^\/]+/,"")}else i="/";return i[0]!=="/"&&i[0]!=="#"&&(i="/"+i),MC(i)}const OC=/^[^#]+#/;function FC(i,s){return i.replace(OC,"#")+s}function BC(i,s){const l=document.documentElement.getBoundingClientRect(),f=i.getBoundingClientRect();return{behavior:s.behavior,left:f.left-l.left-(s.left||0),top:f.top-l.top-(s.top||0)}}const Qd=()=>({left:window.pageXOffset,top:window.pageYOffset});function NC(i){let s;if("el"in i){const l=i.el,f=typeof l=="string"&&l.startsWith("#"),m=typeof l=="string"?f?document.getElementById(l.slice(1)):document.querySelector(l):l;if(!m)return;s=BC(m,i)}else s=i;"scrollBehavior"in document.documentElement.style?window.scrollTo(s):window.scrollTo(s.left!=null?s.left:window.pageXOffset,s.top!=null?s.top:window.pageYOffset)}function Tv(i,s){return(history.state?history.state.position-s:-1)+i}const lm=new Map;function VC(i,s){lm.set(i,s)}function UC(i){const s=lm.get(i);return lm.delete(i),s}let $C=()=>location.protocol+"//"+location.host;function ab(i,s){const{pathname:l,search:f,hash:m}=s,x=i.indexOf("#");if(x>-1){let c=m.includes(i.slice(x))?i.slice(x).length:1,A=m.slice(c);return A[0]!=="/"&&(A="/"+A),wv(A,"")}return wv(l,i)+f+m}function jC(i,s,l,f){let m=[],x=[],v=null;const c=({state:M})=>{const re=ab(i,location),se=l.value,ue=s.value;let ae=0;if(M){if(l.value=re,s.value=M,v&&v===se){v=null;return}ae=ue?M.position-ue.position:0}else f(re);m.forEach(Z=>{Z(l.value,se,{delta:ae,type:Ru.pop,direction:ae?ae>0?yu.forward:yu.back:yu.unknown})})};function A(){v=l.value}function R(M){m.push(M);const re=()=>{const se=m.indexOf(M);se>-1&&m.splice(se,1)};return x.push(re),re}function z(){const{history:M}=window;M.state&&M.replaceState(Ii({},M.state,{scroll:Qd()}),"")}function B(){for(const M of x)M();x=[],window.removeEventListener("popstate",c),window.removeEventListener("beforeunload",z)}return window.addEventListener("popstate",c),window.addEventListener("beforeunload",z,{passive:!0}),{pauseListeners:A,listen:R,destroy:B}}function Ev(i,s,l,f=!1,m=!1){return{back:i,current:s,forward:l,replaced:f,position:window.history.length,scroll:m?Qd():null}}function HC(i){const{history:s,location:l}=window,f={value:ab(i,l)},m={value:s.state};m.value||x(f.value,{back:null,current:f.value,forward:null,position:s.length-1,replaced:!0,scroll:null},!0);function x(A,R,z){const B=i.indexOf("#"),M=B>-1?(l.host&&document.querySelector("base")?i:i.slice(B))+A:$C()+i+A;try{s[z?"replaceState":"pushState"](R,"",M),m.value=R}catch(re){console.error(re),l[z?"replace":"assign"](M)}}function v(A,R){const z=Ii({},s.state,Ev(m.value.back,A,m.value.forward,!0),R,{position:m.value.position});x(A,z,!0),f.value=A}function c(A,R){const z=Ii({},m.value,s.state,{forward:A,scroll:Qd()});x(z.current,z,!0);const B=Ii({},Ev(f.value,A,null),{position:z.position+1},R);x(A,B,!1),f.value=A}return{location:f,state:m,push:c,replace:v}}function GC(i){i=zC(i);const s=HC(i),l=jC(i,s.state,s.location,s.replace);function f(x,v=!0){v||l.pauseListeners(),history.go(x)}const m=Ii({location:"",base:i,go:f,createHref:FC.bind(null,i)},s,l);return Object.defineProperty(m,"location",{enumerable:!0,get:()=>s.location.value}),Object.defineProperty(m,"state",{enumerable:!0,get:()=>s.state.value}),m}function qC(i){return typeof i=="string"||i&&typeof i=="object"}function ob(i){return typeof i=="string"||typeof i=="symbol"}const Pa={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},lb=Symbol("");var Iv;(function(i){i[i.aborted=4]="aborted",i[i.cancelled=8]="cancelled",i[i.duplicated=16]="duplicated"})(Iv||(Iv={}));function Ql(i,s){return Ii(new Error,{type:i,[lb]:!0},s)}function Ys(i,s){return i instanceof Error&&lb in i&&(s==null||!!(i.type&s))}const Av="[^/]+?",WC={sensitive:!1,strict:!1,start:!0,end:!0},ZC=/[.+*?^${}()[\]/\\]/g;function KC(i,s){const l=Ii({},WC,s),f=[];let m=l.start?"^":"";const x=[];for(const R of i){const z=R.length?[]:[90];l.strict&&!R.length&&(m+="/");for(let B=0;B<R.length;B++){const M=R[B];let re=40+(l.sensitive?.25:0);if(M.type===0)B||(m+="/"),m+=M.value.replace(ZC,"\\$&"),re+=40;else if(M.type===1){const{value:se,repeatable:ue,optional:ae,regexp:Z}=M;x.push({name:se,repeatable:ue,optional:ae});const me=Z||Av;if(me!==Av){re+=10;try{new RegExp(`(${me})`)}catch(be){throw new Error(`Invalid custom RegExp for param "${se}" (${me}): `+be.message)}}let Ce=ue?`((?:${me})(?:/(?:${me}))*)`:`(${me})`;B||(Ce=ae&&R.length<2?`(?:/${Ce})`:"/"+Ce),ae&&(Ce+="?"),m+=Ce,re+=20,ae&&(re+=-8),ue&&(re+=-20),me===".*"&&(re+=-50)}z.push(re)}f.push(z)}if(l.strict&&l.end){const R=f.length-1;f[R][f[R].length-1]+=.7000000000000001}l.strict||(m+="/?"),l.end?m+="$":l.strict&&(m+="(?:/|$)");const v=new RegExp(m,l.sensitive?"":"i");function c(R){const z=R.match(v),B={};if(!z)return null;for(let M=1;M<z.length;M++){const re=z[M]||"",se=x[M-1];B[se.name]=re&&se.repeatable?re.split("/"):re}return B}function A(R){let z="",B=!1;for(const M of i){(!B||!z.endsWith("/"))&&(z+="/"),B=!1;for(const re of M)if(re.type===0)z+=re.value;else if(re.type===1){const{value:se,repeatable:ue,optional:ae}=re,Z=se in R?R[se]:"";if(ds(Z)&&!ue)throw new Error(`Provided param "${se}" is an array but it is not repeatable (* or + modifiers)`);const me=ds(Z)?Z.join("/"):Z;if(!me)if(ae)M.length<2&&(z.endsWith("/")?z=z.slice(0,-1):B=!0);else throw new Error(`Missing required param "${se}"`);z+=me}}return z||"/"}return{re:v,score:f,keys:x,parse:c,stringify:A}}function YC(i,s){let l=0;for(;l<i.length&&l<s.length;){const f=s[l]-i[l];if(f)return f;l++}return i.length<s.length?i.length===1&&i[0]===80?-1:1:i.length>s.length?s.length===1&&s[0]===80?1:-1:0}function XC(i,s){let l=0;const f=i.score,m=s.score;for(;l<f.length&&l<m.length;){const x=YC(f[l],m[l]);if(x)return x;l++}if(Math.abs(m.length-f.length)===1){if(Cv(f))return 1;if(Cv(m))return-1}return m.length-f.length}function Cv(i){const s=i[i.length-1];return i.length>0&&s[s.length-1]<0}const JC={type:0,value:""},QC=/[a-zA-Z0-9_]/;function eP(i){if(!i)return[[]];if(i==="/")return[[JC]];if(!i.startsWith("/"))throw new Error(`Invalid path "${i}"`);function s(re){throw new Error(`ERR (${l})/"${R}": ${re}`)}let l=0,f=l;const m=[];let x;function v(){x&&m.push(x),x=[]}let c=0,A,R="",z="";function B(){R&&(l===0?x.push({type:0,value:R}):l===1||l===2||l===3?(x.length>1&&(A==="*"||A==="+")&&s(`A repeatable param (${R}) must be alone in its segment. eg: '/:ids+.`),x.push({type:1,value:R,regexp:z,repeatable:A==="*"||A==="+",optional:A==="*"||A==="?"})):s("Invalid state to consume buffer"),R="")}function M(){R+=A}for(;c<i.length;){if(A=i[c++],A==="\\"&&l!==2){f=l,l=4;continue}switch(l){case 0:A==="/"?(R&&B(),v()):A===":"?(B(),l=1):M();break;case 4:M(),l=f;break;case 1:A==="("?l=2:QC.test(A)?M():(B(),l=0,A!=="*"&&A!=="?"&&A!=="+"&&c--);break;case 2:A===")"?z[z.length-1]=="\\"?z=z.slice(0,-1)+A:l=3:z+=A;break;case 3:B(),l=0,A!=="*"&&A!=="?"&&A!=="+"&&c--,z="";break;default:s("Unknown state");break}}return l===2&&s(`Unfinished custom RegExp for param "${R}"`),B(),v(),m}function tP(i,s,l){const f=KC(eP(i.path),l),m=Ii(f,{record:i,parent:s,children:[],alias:[]});return s&&!m.record.aliasOf==!s.record.aliasOf&&s.children.push(m),m}function iP(i,s){const l=[],f=new Map;s=kv({strict:!1,end:!0,sensitive:!1},s);function m(z){return f.get(z)}function x(z,B,M){const re=!M,se=rP(z);se.aliasOf=M&&M.record;const ue=kv(s,z),ae=[se];if("alias"in z){const Ce=typeof z.alias=="string"?[z.alias]:z.alias;for(const be of Ce)ae.push(Ii({},se,{components:M?M.record.components:se.components,path:be,aliasOf:M?M.record:se}))}let Z,me;for(const Ce of ae){const{path:be}=Ce;if(B&&be[0]!=="/"){const Re=B.record.path,Ae=Re[Re.length-1]==="/"?"":"/";Ce.path=B.record.path+(be&&Ae+be)}if(Z=tP(Ce,B,ue),M?M.alias.push(Z):(me=me||Z,me!==Z&&me.alias.push(Z),re&&z.name&&!Mv(Z)&&v(z.name)),se.children){const Re=se.children;for(let Ae=0;Ae<Re.length;Ae++)x(Re[Ae],Z,M&&M.children[Ae])}M=M||Z,(Z.record.components&&Object.keys(Z.record.components).length||Z.record.name||Z.record.redirect)&&A(Z)}return me?()=>{v(me)}:_u}function v(z){if(ob(z)){const B=f.get(z);B&&(f.delete(z),l.splice(l.indexOf(B),1),B.children.forEach(v),B.alias.forEach(v))}else{const B=l.indexOf(z);B>-1&&(l.splice(B,1),z.record.name&&f.delete(z.record.name),z.children.forEach(v),z.alias.forEach(v))}}function c(){return l}function A(z){let B=0;for(;B<l.length&&XC(z,l[B])>=0&&(z.record.path!==l[B].record.path||!cb(z,l[B]));)B++;l.splice(B,0,z),z.record.name&&!Mv(z)&&f.set(z.record.name,z)}function R(z,B){let M,re={},se,ue;if("name"in z&&z.name){if(M=f.get(z.name),!M)throw Ql(1,{location:z});ue=M.record.name,re=Ii(Pv(B.params,M.keys.filter(me=>!me.optional).map(me=>me.name)),z.params&&Pv(z.params,M.keys.map(me=>me.name))),se=M.stringify(re)}else if("path"in z)se=z.path,M=l.find(me=>me.re.test(se)),M&&(re=M.parse(se),ue=M.record.name);else{if(M=B.name?f.get(B.name):l.find(me=>me.re.test(B.path)),!M)throw Ql(1,{location:z,currentLocation:B});ue=M.record.name,re=Ii({},B.params,z.params),se=M.stringify(re)}const ae=[];let Z=M;for(;Z;)ae.unshift(Z.record),Z=Z.parent;return{name:ue,path:se,params:re,matched:ae,meta:sP(ae)}}return i.forEach(z=>x(z)),{addRoute:x,resolve:R,removeRoute:v,getRoutes:c,getRecordMatcher:m}}function Pv(i,s){const l={};for(const f of s)f in i&&(l[f]=i[f]);return l}function rP(i){return{path:i.path,redirect:i.redirect,name:i.name,meta:i.meta||{},aliasOf:void 0,beforeEnter:i.beforeEnter,props:nP(i),children:i.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in i?i.components||null:i.component&&{default:i.component}}}function nP(i){const s={},l=i.props||!1;if("component"in i)s.default=l;else for(const f in i.components)s[f]=typeof l=="object"?l[f]:l;return s}function Mv(i){for(;i;){if(i.record.aliasOf)return!0;i=i.parent}return!1}function sP(i){return i.reduce((s,l)=>Ii(s,l.meta),{})}function kv(i,s){const l={};for(const f in i)l[f]=f in s?s[f]:i[f];return l}function cb(i,s){return s.children.some(l=>l===i||cb(i,l))}const ub=/#/g,aP=/&/g,oP=/\//g,lP=/=/g,cP=/\?/g,hb=/\+/g,uP=/%5B/g,hP=/%5D/g,db=/%5E/g,dP=/%60/g,fb=/%7B/g,fP=/%7C/g,pb=/%7D/g,pP=/%20/g;function qm(i){return encodeURI(""+i).replace(fP,"|").replace(uP,"[").replace(hP,"]")}function mP(i){return qm(i).replace(fb,"{").replace(pb,"}").replace(db,"^")}function cm(i){return qm(i).replace(hb,"%2B").replace(pP,"+").replace(ub,"%23").replace(aP,"%26").replace(dP,"`").replace(fb,"{").replace(pb,"}").replace(db,"^")}function gP(i){return cm(i).replace(lP,"%3D")}function _P(i){return qm(i).replace(ub,"%23").replace(cP,"%3F")}function yP(i){return i==null?"":_P(i).replace(oP,"%2F")}function Ld(i){try{return decodeURIComponent(""+i)}catch{}return""+i}function vP(i){const s={};if(i===""||i==="?")return s;const f=(i[0]==="?"?i.slice(1):i).split("&");for(let m=0;m<f.length;++m){const x=f[m].replace(hb," "),v=x.indexOf("="),c=Ld(v<0?x:x.slice(0,v)),A=v<0?null:Ld(x.slice(v+1));if(c in s){let R=s[c];ds(R)||(R=s[c]=[R]),R.push(A)}else s[c]=A}return s}function Lv(i){let s="";for(let l in i){const f=i[l];if(l=gP(l),f==null){f!==void 0&&(s+=(s.length?"&":"")+l);continue}(ds(f)?f.map(x=>x&&cm(x)):[f&&cm(f)]).forEach(x=>{x!==void 0&&(s+=(s.length?"&":"")+l,x!=null&&(s+="="+x))})}return s}function xP(i){const s={};for(const l in i){const f=i[l];f!==void 0&&(s[l]=ds(f)?f.map(m=>m==null?null:""+m):f==null?f:""+f)}return s}const bP=Symbol(""),Rv=Symbol(""),ef=Symbol(""),Wm=Symbol(""),um=Symbol("");function lu(){let i=[];function s(f){return i.push(f),()=>{const m=i.indexOf(f);m>-1&&i.splice(m,1)}}function l(){i=[]}return{add:s,list:()=>i.slice(),reset:l}}function Oa(i,s,l,f,m){const x=f&&(f.enterCallbacks[m]=f.enterCallbacks[m]||[]);return()=>new Promise((v,c)=>{const A=B=>{B===!1?c(Ql(4,{from:l,to:s})):B instanceof Error?c(B):qC(B)?c(Ql(2,{from:s,to:B})):(x&&f.enterCallbacks[m]===x&&typeof B=="function"&&x.push(B),v())},R=i.call(f&&f.instances[m],s,l,A);let z=Promise.resolve(R);i.length<3&&(z=z.then(A)),z.catch(B=>c(B))})}function Ip(i,s,l,f){const m=[];for(const x of i)for(const v in x.components){let c=x.components[v];if(!(s!=="beforeRouteEnter"&&!x.instances[v]))if(wP(c)){const R=(c.__vccOpts||c)[s];R&&m.push(Oa(R,l,f,x,v))}else{let A=c();m.push(()=>A.then(R=>{if(!R)return Promise.reject(new Error(`Couldn't resolve component "${v}" at "${x.path}"`));const z=CC(R)?R.default:R;x.components[v]=z;const M=(z.__vccOpts||z)[s];return M&&Oa(M,l,f,x,v)()}))}}return m}function wP(i){return typeof i=="object"||"displayName"in i||"props"in i||"__vccOpts"in i}function Dv(i){const s=et(ef),l=et(Wm),f=Rt(()=>s.resolve(Sr(i.to))),m=Rt(()=>{const{matched:A}=f.value,{length:R}=A,z=A[R-1],B=l.matched;if(!z||!B.length)return-1;const M=B.findIndex(Jl.bind(null,z));if(M>-1)return M;const re=zv(A[R-2]);return R>1&&zv(z)===re&&B[B.length-1].path!==re?B.findIndex(Jl.bind(null,A[R-2])):M}),x=Rt(()=>m.value>-1&&IP(l.params,f.value.params)),v=Rt(()=>m.value>-1&&m.value===l.matched.length-1&&sb(l.params,f.value.params));function c(A={}){return EP(A)?s[Sr(i.replace)?"replace":"push"](Sr(i.to)).catch(_u):Promise.resolve()}return{route:f,href:Rt(()=>f.value.href),isActive:x,isExactActive:v,navigate:c}}const SP=di({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Dv,setup(i,{slots:s}){const l=Xr(Dv(i)),{options:f}=et(ef),m=Rt(()=>({[Ov(i.activeClass,f.linkActiveClass,"router-link-active")]:l.isActive,[Ov(i.exactActiveClass,f.linkExactActiveClass,"router-link-exact-active")]:l.isExactActive}));return()=>{const x=s.default&&s.default(l);return i.custom?x:Fr("a",{"aria-current":l.isExactActive?i.ariaCurrentValue:null,href:l.href,onClick:l.navigate,class:m.value},x)}}}),TP=SP;function EP(i){if(!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)&&!i.defaultPrevented&&!(i.button!==void 0&&i.button!==0)){if(i.currentTarget&&i.currentTarget.getAttribute){const s=i.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(s))return}return i.preventDefault&&i.preventDefault(),!0}}function IP(i,s){for(const l in s){const f=s[l],m=i[l];if(typeof f=="string"){if(f!==m)return!1}else if(!ds(m)||m.length!==f.length||f.some((x,v)=>x!==m[v]))return!1}return!0}function zv(i){return i?i.aliasOf?i.aliasOf.path:i.path:""}const Ov=(i,s,l)=>i??s??l,AP=di({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(i,{attrs:s,slots:l}){const f=et(um),m=Rt(()=>i.route||f.value),x=et(Rv,0),v=Rt(()=>{let R=Sr(x);const{matched:z}=m.value;let B;for(;(B=z[R])&&!B.components;)R++;return R}),c=Rt(()=>m.value.matched[v.value]);Ai(Rv,Rt(()=>v.value+1)),Ai(bP,c),Ai(um,m);const A=yi();return Mt(()=>[A.value,c.value,i.name],([R,z,B],[M,re,se])=>{z&&(z.instances[B]=R,re&&re!==z&&R&&R===M&&(z.leaveGuards.size||(z.leaveGuards=re.leaveGuards),z.updateGuards.size||(z.updateGuards=re.updateGuards))),R&&z&&(!re||!Jl(z,re)||!M)&&(z.enterCallbacks[B]||[]).forEach(ue=>ue(R))},{flush:"post"}),()=>{const R=m.value,z=i.name,B=c.value,M=B&&B.components[z];if(!M)return Fv(l.default,{Component:M,route:R});const re=B.props[z],se=re?re===!0?R.params:typeof re=="function"?re(R):re:null,ae=Fr(M,Ii({},se,s,{onVnodeUnmounted:Z=>{Z.component.isUnmounted&&(B.instances[z]=null)},ref:A}));return Fv(l.default,{Component:ae,route:R})||ae}}});function Fv(i,s){if(!i)return null;const l=i(s);return l.length===1?l[0]:l}const CP=AP;function PP(i){const s=iP(i.routes,i),l=i.parseQuery||vP,f=i.stringifyQuery||Lv,m=i.history,x=lu(),v=lu(),c=lu(),A=En(Pa);let R=Pa;Nl&&i.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const z=Tp.bind(null,ke=>""+ke),B=Tp.bind(null,yP),M=Tp.bind(null,Ld);function re(ke,nt){let it,ht;return ob(ke)?(it=s.getRecordMatcher(ke),ht=nt):ht=ke,s.addRoute(ht,it)}function se(ke){const nt=s.getRecordMatcher(ke);nt&&s.removeRoute(nt)}function ue(){return s.getRoutes().map(ke=>ke.record)}function ae(ke){return!!s.getRecordMatcher(ke)}function Z(ke,nt){if(nt=Ii({},nt||A.value),typeof ke=="string"){const D=Ep(l,ke,nt.path),Y=s.resolve({path:D.path},nt),ye=m.createHref(D.fullPath);return Ii(D,Y,{params:M(Y.params),hash:Ld(D.hash),redirectedFrom:void 0,href:ye})}let it;if("path"in ke)it=Ii({},ke,{path:Ep(l,ke.path,nt.path).path});else{const D=Ii({},ke.params);for(const Y in D)D[Y]==null&&delete D[Y];it=Ii({},ke,{params:B(D)}),nt.params=B(nt.params)}const ht=s.resolve(it,nt),Ht=ke.hash||"";ht.params=z(M(ht.params));const ei=kC(f,Ii({},ke,{hash:mP(Ht),path:ht.path})),O=m.createHref(ei);return Ii({fullPath:ei,hash:Ht,query:f===Lv?xP(ke.query):ke.query||{}},ht,{redirectedFrom:void 0,href:O})}function me(ke){return typeof ke=="string"?Ep(l,ke,A.value.path):Ii({},ke)}function Ce(ke,nt){if(R!==ke)return Ql(8,{from:nt,to:ke})}function be(ke){return $e(ke)}function Re(ke){return be(Ii(me(ke),{replace:!0}))}function Ae(ke){const nt=ke.matched[ke.matched.length-1];if(nt&&nt.redirect){const{redirect:it}=nt;let ht=typeof it=="function"?it(ke):it;return typeof ht=="string"&&(ht=ht.includes("?")||ht.includes("#")?ht=me(ht):{path:ht},ht.params={}),Ii({query:ke.query,hash:ke.hash,params:"path"in ht?{}:ke.params},ht)}}function $e(ke,nt){const it=R=Z(ke),ht=A.value,Ht=ke.state,ei=ke.force,O=ke.replace===!0,D=Ae(it);if(D)return $e(Ii(me(D),{state:typeof D=="object"?Ii({},Ht,D.state):Ht,force:ei,replace:O}),nt||it);const Y=it;Y.redirectedFrom=nt;let ye;return!ei&&LC(f,ht,it)&&(ye=Ql(16,{to:Y,from:ht}),ai(ht,ht,!0,!1)),(ye?Promise.resolve(ye):ot(Y,ht)).catch(K=>Ys(K)?Ys(K,2)?K:mi(K):Dt(K,Y,ht)).then(K=>{if(K){if(Ys(K,2))return $e(Ii({replace:O},me(K.to),{state:typeof K.to=="object"?Ii({},Ht,K.to.state):Ht,force:ei}),nt||Y)}else K=He(Y,ht,!0,O,Ht);return _t(Y,ht,K),K})}function Se(ke,nt){const it=Ce(ke,nt);return it?Promise.reject(it):Promise.resolve()}function Ge(ke){const nt=Pi.values().next().value;return nt&&typeof nt.runWithContext=="function"?nt.runWithContext(ke):ke()}function ot(ke,nt){let it;const[ht,Ht,ei]=MP(ke,nt);it=Ip(ht.reverse(),"beforeRouteLeave",ke,nt);for(const D of ht)D.leaveGuards.forEach(Y=>{it.push(Oa(Y,ke,nt))});const O=Se.bind(null,ke,nt);return it.push(O),Wt(it).then(()=>{it=[];for(const D of x.list())it.push(Oa(D,ke,nt));return it.push(O),Wt(it)}).then(()=>{it=Ip(Ht,"beforeRouteUpdate",ke,nt);for(const D of Ht)D.updateGuards.forEach(Y=>{it.push(Oa(Y,ke,nt))});return it.push(O),Wt(it)}).then(()=>{it=[];for(const D of ei)if(D.beforeEnter)if(ds(D.beforeEnter))for(const Y of D.beforeEnter)it.push(Oa(Y,ke,nt));else it.push(Oa(D.beforeEnter,ke,nt));return it.push(O),Wt(it)}).then(()=>(ke.matched.forEach(D=>D.enterCallbacks={}),it=Ip(ei,"beforeRouteEnter",ke,nt),it.push(O),Wt(it))).then(()=>{it=[];for(const D of v.list())it.push(Oa(D,ke,nt));return it.push(O),Wt(it)}).catch(D=>Ys(D,8)?D:Promise.reject(D))}function _t(ke,nt,it){c.list().forEach(ht=>Ge(()=>ht(ke,nt,it)))}function He(ke,nt,it,ht,Ht){const ei=Ce(ke,nt);if(ei)return ei;const O=nt===Pa,D=Nl?history.state:{};it&&(ht||O?m.replace(ke.fullPath,Ii({scroll:O&&D&&D.scroll},Ht)):m.push(ke.fullPath,Ht)),A.value=ke,ai(ke,nt,it,O),mi()}let bt;function qt(){bt||(bt=m.listen((ke,nt,it)=>{if(!Yi.listening)return;const ht=Z(ke),Ht=Ae(ht);if(Ht){$e(Ii(Ht,{replace:!0}),ht).catch(_u);return}R=ht;const ei=A.value;Nl&&VC(Tv(ei.fullPath,it.delta),Qd()),ot(ht,ei).catch(O=>Ys(O,12)?O:Ys(O,2)?($e(O.to,ht).then(D=>{Ys(D,20)&&!it.delta&&it.type===Ru.pop&&m.go(-1,!1)}).catch(_u),Promise.reject()):(it.delta&&m.go(-it.delta,!1),Dt(O,ht,ei))).then(O=>{O=O||He(ht,ei,!1),O&&(it.delta&&!Ys(O,8)?m.go(-it.delta,!1):it.type===Ru.pop&&Ys(O,20)&&m.go(-1,!1)),_t(ht,ei,O)}).catch(_u)}))}let pi=lu(),Lt=lu(),jt;function Dt(ke,nt,it){mi(ke);const ht=Lt.list();return ht.length?ht.forEach(Ht=>Ht(ke,nt,it)):console.error(ke),Promise.reject(ke)}function Ci(){return jt&&A.value!==Pa?Promise.resolve():new Promise((ke,nt)=>{pi.add([ke,nt])})}function mi(ke){return jt||(jt=!ke,qt(),pi.list().forEach(([nt,it])=>ke?it(ke):nt()),pi.reset()),ke}function ai(ke,nt,it,ht){const{scrollBehavior:Ht}=i;if(!Nl||!Ht)return Promise.resolve();const ei=!it&&UC(Tv(ke.fullPath,0))||(ht||!it)&&history.state&&history.state.scroll||null;return Ha().then(()=>Ht(ke,nt,ei)).then(O=>O&&NC(O)).catch(O=>Dt(O,ke,nt))}const Xt=ke=>m.go(ke);let Bi;const Pi=new Set,Yi={currentRoute:A,listening:!0,addRoute:re,removeRoute:se,hasRoute:ae,getRoutes:ue,resolve:Z,options:i,push:be,replace:Re,go:Xt,back:()=>Xt(-1),forward:()=>Xt(1),beforeEach:x.add,beforeResolve:v.add,afterEach:c.add,onError:Lt.add,isReady:Ci,install(ke){const nt=this;ke.component("RouterLink",TP),ke.component("RouterView",CP),ke.config.globalProperties.$router=nt,Object.defineProperty(ke.config.globalProperties,"$route",{enumerable:!0,get:()=>Sr(A)}),Nl&&!Bi&&A.value===Pa&&(Bi=!0,be(m.location).catch(Ht=>{}));const it={};for(const Ht in Pa)Object.defineProperty(it,Ht,{get:()=>A.value[Ht],enumerable:!0});ke.provide(ef,nt),ke.provide(Wm,a0(it)),ke.provide(um,A);const ht=ke.unmount;Pi.add(ke),ke.unmount=function(){Pi.delete(ke),Pi.size<1&&(R=Pa,bt&&bt(),bt=null,A.value=Pa,Bi=!1,jt=!1),ht()}}};function Wt(ke){return ke.reduce((nt,it)=>nt.then(()=>Ge(it)),Promise.resolve())}return Yi}function MP(i,s){const l=[],f=[],m=[],x=Math.max(s.matched.length,i.matched.length);for(let v=0;v<x;v++){const c=s.matched[v];c&&(i.matched.find(R=>Jl(R,c))?f.push(c):l.push(c));const A=i.matched[v];A&&(s.matched.find(R=>Jl(R,A))||m.push(A))}return[l,f,m]}function kP(){return et(ef)}function UM(){return et(Wm)}const ja=PP({history:GC("/CHANGE_ME_BASE_URL/"),routes:[{path:"/",name:"home",components:{}},{path:"/overlays/:prefab/:id",name:"overlay",props:!0,components:{controlInfo:()=>Mu(()=>import("./OverlayCard-DZ0JD8zH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))}},{path:"/route/:places([+-]?[0-9]+\\.?[0-9]+;[+-]?[0-9]+\\.?[0-9]+)+",name:"route",props:!0,components:{controlInfo:()=>Mu(()=>import("./RouteCard-B-y6faXK.js"),__vite__mapDeps([11,1,2,3,4,5,6,12,13,14]))}}]});ja.getFullPath=i=>decodeURI(new URL(ja.options.history.createHref(i),window.location.origin).href);ja.beforeEach((i,s,l)=>{const f=DE();i.name=="home"&&l();const m=Mt(()=>f.isLoaded,l);f.isLoaded&&(m(),l())});function LP(i){return new Worker("/CHANGE_ME_BASE_URL/assets/exp-DzpC5lYc.js",{name:i==null?void 0:i.name})}const Ap=new LP;function Du(i,s=!0){return new Promise(l=>{const f=m=>{m.data[0].path===i&&(Ap.removeEventListener("message",f),l(m.data[1]))};Ap.addEventListener("message",f),Ap.postMessage({path:i,save:s})})}function Bv(i){const s=yi(void 0);return Du(i).then(l=>{s.value=l}),s}function $M(i){const s=yi(void 0),l=f=>{Du(f).then(m=>{s.value=m})};return l(i.value||i),Mt(i,l),s}async function Zm(i,s){localStorage.setItem("language",s);const l=await Promise.all([(async()=>{try{return await LI(Object.assign({"../locales/en_us.json":()=>Mu(()=>import("./en_us-kRRUOIkr.js"),__vite__mapDeps([]))}),`../locales/${s}.json`)}catch{return console.info(`No translations found for ${s}`),{}}})(),Du(`translations/locales/${s}`),Du("translations/keys")]),f={...l[0],...Object.fromEntries(l[1].map((m,x)=>[l[2].keys[x],m]))};return i.global.setLocaleMessage(s,f),Ha()}const hs=_C({locale:"en_us",fallbackLocale:"en_us",messages:{},legacy:!1,globalInjection:!0});async function RP(){var l;const i=(await Du("translations/keys")).locales;let s="en_us";for(const f in[(l=ja.currentRoute.value.query.locale)==null?void 0:l.toString(),localStorage.getItem("language"),navigator.language]){const m=f==null?void 0:f.replace(/-/,"_").toLowerCase();if(Object.keys(i).includes(m)){s=m;break}}Object.keys(i).forEach(f=>hs.global.setLocaleMessage(f,{lang_name:i[f]})),hs.global.locale.value=s,Zm(hs,hs.global.locale.value)}RP();Mt(hs.global.locale,i=>{Zm(hs,i)});ja.beforeEach(async(i,s,l)=>{var m;const f=(m=i.query.locale)==null?void 0:m.replace(/-/,"_").toLowerCase();return hs.global.availableLocales.includes(f)&&(await Zm(hs,f),hs.global.locale.value=f),l()});const Cp=hs.global;function DP(i){i.use(PI),i.use(PE),i.use(xI),i.use(hs),i.use(ja)}function hm(i,s,l){return i.mapSettings.uiCorrections&&s<=-31100&&s>=-60720&&l<=-5500&&l>=-56300&&(s=(s+31100)*.75-31700,l=(l+5500)*.75-5100),[s,l]}function zP(i,s,l){const f=hm(i,-60720,-56300),m=hm(i,-31100,-5500);return i.mapSettings.uiCorrections&&s<=m[0]&&s>=f[0]&&l<=m[1]&&l>=f[1]&&(s=(s+31700)/.75-31100,l=(l+5100)/.75-5500),[s,l]}function OP(i,s){if(i.type==="Point"){const l=s(i.coordinates[0],i.coordinates[1]);return{...i,coordinates:l}}if(i.type==="LineString"){const l=i.coordinates.map(f=>s(f[0],f[1]));return{...i,coordinates:l}}if(i.type==="Polygon"){const l=i.coordinates.map(f=>f.map(m=>s(m[0],m[1])));return{...i,coordinates:l}}return i}function zu(i){return Math.max(Math.abs(i.size.maxX-i.size.minX),Math.abs(i.size.maxZ-i.size.minZ))}function FP(i,s,l){return[s,l]=hm(i,s,l),new ia.MercatorCoordinate((s-i.size.minX)/zu(i),(l-i.size.minZ)/zu(i)).toLngLat()}function jM(i,s){const l=ia.MercatorCoordinate.fromLngLat(s),f=l.x*zu(i)+i.size.minX,m=l.y*zu(i)+i.size.minZ;return zP(i,f,m)}function BP(i,s,l){const f=FP(i,s,l);return[f.lng,f.lat]}function HM(i,s){return OP(s,BP.bind(null,i))}const NP=CI("map",{state:()=>({map:Bv("map"),countries:Bv("countries"),colorRoads:!0}),getters:{canLoad(i){return!!i.map&&!!i.countries},style(i){var s;return{version:8,name:"SimRoads default style",sprite:ja.getFullPath("/exp/overlays/sprite"),glyphs:"https://raw.githubusercontent.com/korywka/fonts.pbf/master/{fontstack}/{range}.pbf",sources:{tiles:{type:"vector",attribution:"SimRoads",tiles:[ja.getFullPath("/exp/mvt/{z}/{x}/{y}.mvt")],maxzoom:(s=i.map)==null?void 0:s.zoomLimit}},layers:Object.entries(this.layers).map(([l,f])=>({id:l,...f}))}},layers(i){if(!i.map||!i.countries)return{};const s=zu(i.map),l=["case",["boolean",["feature-state","route"],!1],"rgb(255,0,0)",i.colorRoads?i.countries.reduce((v,c,A)=>[...v,c.id,`hsl(${A*360/i.countries.length}, 50%, 50%)`],["match",["get","country"]]).concat(["rgb(255, 200, 76)"]):"rgb(255, 200, 76)"],f=["literal",i.countries.map(v=>v.id)],m=v=>v*i.map.zoomLimit/7,x=v=>Math.log2(s/v);return{background:{paint:{"background-color":"rgb(37, 37, 37)"},type:"background"},bounds:{source:"tiles","source-layer":"bounds",type:"line",paint:{"line-width":["interpolate",["linear"],["zoom"],0,["/",["get","size"],["/",s,["^",2,["-",["zoom"],Math.log2(s)]]]]],"line-color":"rgb(60, 60, 60)"},layout:{"line-cap":"round","line-join":"round"}},"bounds-names":{source:"tiles","source-layer":"bounds",type:"symbol",minzoom:m(4.5),layout:{"symbol-placement":"line","text-field":["get","name_"+Cp.locale.value],"text-font":["Roboto Thin"],"text-allow-overlap":!0,"text-size":15},paint:{"text-color":"rgb(255, 200, 76)"}},ferries:{source:"tiles","source-layer":"ferries",type:"line",paint:{"line-width":1,"line-color":["case",["boolean",["feature-state","route"],!1],"rgb(255,0,0)","rgb(105, 105, 105)"],"line-dasharray":[10,10,10]},layout:{"line-cap":"round","line-join":"round"}},prefabs:{source:"tiles","source-layer":"prefabs",type:"fill",paint:{"fill-color":["match",["get","area"],"field","rgb(236, 203, 153)","grass","rgb(170, 203, 150)",l],"fill-antialias":!0},filter:["!=","area","building"]},"prefab-roads":{source:"tiles","source-layer":"roads",type:"fill",paint:{"fill-color":l,"fill-antialias":!0,"fill-outline-color":"rgba(0,0,0,0)","fill-opacity":["case",["boolean",["feature-state","route"],!1],0,1]},layout:{"fill-sort-key":1},filter:["==",["geometry-type"],"Polygon"]},roads:{source:"tiles","source-layer":"roads",type:"line",paint:{"line-color":l,"line-width":["interpolate",["linear"],["zoom"],0,["max",1,["zoom"]],m(3),["*",["get","size"],["^",2,["-",["zoom"],Math.log2(s)-9]]]]},layout:{"line-cap":"round","line-join":"round"},filter:["!=",["geometry-type"],"Polygon"]},"prefab-roads-route":{source:"tiles","source-layer":"roads",type:"fill",paint:{"fill-color":"rgb(255,0,0)","fill-antialias":!0,"fill-outline-color":"rgba(0,0,0,0)","fill-opacity":["case",["boolean",["feature-state","route"],!1],1,0]},filter:["==",["geometry-type"],"Polygon"]},buildings:{source:"tiles","source-layer":"prefabs",type:"fill-extrusion",paint:{"fill-extrusion-color":"rgb(225, 163, 56)","fill-extrusion-height":1e3,"fill-extrusion-base":0},filter:["==","area","building"]},"overlays-non-prefabs":{source:"tiles","source-layer":"overlays",type:"symbol",minzoom:x(2e4),layout:{"icon-image":["get","overlay"],"icon-anchor":"center","icon-size":["interpolate",["linear"],["zoom"],x(2e4),0,x(4e3),1]},paint:{"icon-opacity":["interpolate",["linear"],["zoom"],x(2e4),0,x(4e3),1]},filter:["all",["==",["get","prefab"],["id"]],["!",["in",["id"],f]]]},"overlays-prefabs":{source:"tiles","source-layer":"overlays",type:"symbol",minzoom:x(5e3),layout:{"icon-image":["get","overlay"],"icon-anchor":"center","icon-size":["interpolate",["linear"],["zoom"],x(5e3),0,x(1e3),1]},paint:{"icon-opacity":["interpolate",["linear"],["zoom"],x(5e3),0,x(1e3),1]},filter:["all",["!=",["get","prefab"],["id"]],["!",["in",["id"],f]]]},"overlays-cities":{source:"tiles","source-layer":"overlays",type:"symbol",minzoom:m(2.5),layout:{"text-field":["get","name_"+Cp.locale.value],"text-font":["Roboto Medium"],"icon-anchor":"center","text-allow-overlap":!0},paint:{"text-color":"rgb(255, 200, 76)","text-halo-color":"rgb(0, 0, 0)","text-halo-width":2,"text-opacity":["interpolate",["linear"],["zoom"],m(2.5),0,m(3.5),1]},filter:["!",["to-boolean",["get","overlay"]]]},"overlays-countries":{source:"tiles","source-layer":"overlays",type:"symbol",layout:{"text-field":["get","name_"+Cp.locale.value],"text-font":["Roboto Medium"],"icon-image":["get","overlay"],"icon-anchor":"bottom","icon-offset":[0,-5],"icon-size":1,"icon-allow-overlap":!0,"text-allow-overlap":!0},paint:{"text-color":"rgb(255, 200, 76)","text-halo-color":"rgb(0, 0, 0)","text-halo-width":2},filter:["in",["id"],f]}}}},actions:{}}),VP=di({__name:"MapView",setup(i){const s=S0(()=>Mu(()=>import("./MapControls-C7-lX9r0.js"),__vite__mapDeps([15,16,8,2,3,9,17,7,12,13,4,5,18]))),l=NP(),f=kP(),m=Rt(()=>{var c;let v="#000";for(const A of l.style.layers)A.type==="background"&&A.paint&&(v=((c=A.paint["background-color"])==null?void 0:c.toString())||v);return v}),x=v=>{var c;for(const A of Object.keys(l.layers).filter(R=>R.startsWith("overlays-")))v.map.on("click",A,R=>{R.features&&f.push({name:"overlay",params:{prefab:R.features[0].properties.prefab||R.features[0].id,id:R.features[0].id}})}),v.map.on("mouseenter",A,()=>{v.map.getCanvas().style.cursor="pointer"}),v.map.on("mouseleave",A,()=>{v.map.getCanvas().style.cursor=""});document.title=((c=l.map)==null?void 0:c.mapName)+" - SimRoads"};return(v,c)=>{const A=rS("mgl-map");return Tu(),VS("div",{class:"map",style:Fu({backgroundColor:m.value})},[Sr(l).canLoad?(Tu(),Gd(A,{key:0,mapStyle:Sr(l).style,renderWorldCopies:!1,attributionControl:!1,"onMap:load":x},{default:bd(()=>[ci(Sr(s))]),_:1},8,["mapStyle"])):Mr("",!0)],4)}}}),UP=(i,s)=>{const l=i.__vccOpts||i;for(const[f,m]of s)l[f]=m;return l},$P=UP(VP,[["__scopeId","data-v-ba888753"]]),jP=Ps({...ux(),...TE()},"VLayout"),HP=Om()({name:"VLayout",props:jP(),setup(i,s){let{slots:l}=s;const{layoutClasses:f,layoutStyles:m,getLayoutItem:x,items:v,layoutRef:c}=AE(i);return dx(()=>{var A;return ci("div",{ref:c,class:[f.value,i.class],style:[m.value,i.style]},[(A=l.default)==null?void 0:A.call(l)])}),{getLayoutItem:x,items:v}}});function GP(){const i=En(!1);return ic(()=>{window.requestAnimationFrame(()=>{i.value=!0})}),{ssrBootStyles:Rt(()=>i.value?void 0:{transition:"none !important"}),isBooted:Nd(i)}}const qP=Ps({tag:{type:String,default:"div"}},"tag"),WP=Ps({scrollable:Boolean,...ux(),...qP({tag:"main"})},"VMain"),ZP=Om()({name:"VMain",props:WP(),setup(i,s){let{slots:l}=s;const{mainStyles:f}=EE(),{ssrBootStyles:m}=GP();return dx(()=>ci(i.tag,{class:["v-main",{"v-main--scrollable":i.scrollable},i.class],style:[f.value,m.value,i.style]},{default:()=>{var x,v;return[i.scrollable?ci("div",{class:"v-main__scroller"},[(x=l.default)==null?void 0:x.call(l)]):(v=l.default)==null?void 0:v.call(l)]}})),{}}}),KP=di({__name:"App",setup(i){const s=S0(()=>Mu(()=>import("./SettingsDrawer-nmVBJ-qW.js"),__vite__mapDeps([19,16,8,2,3,9,17,20])));return(l,f)=>(Tu(),Gd(HP,null,{default:bd(()=>[ci(Sr(s)),ci(ZP,null,{default:bd(()=>[ci($P)]),_:1})]),_:1}))}}),mb=C2(KP);DP(mb);mb.mount("#app");export{eM as $,MM as A,j0 as B,yM as C,Ha as D,Fm as E,Yr as F,mM as G,di as H,NP as I,Gm as J,Tu as K,Gd as L,bd as M,Np as N,Sr as O,XP as P,DE as Q,$M as R,sM as S,W0 as T,HM as U,ia as V,VS as W,Mr as X,nM as Y,$0 as Z,QP as _,qP as a,fy as a$,UP as a0,yE as a1,Pm as a2,FP as a3,rM as a4,iM as a5,kM as a6,gM as a7,oM as a8,aM as a9,F2 as aA,Ai as aB,et as aC,vT as aD,vM as aE,U2 as aF,Fd as aG,AM as aH,Ms as aI,Xr as aJ,hi as aK,Nd as aL,B0 as aM,lM as aN,H2 as aO,G2 as aP,q2 as aQ,B2 as aR,Ua as aS,TM as aT,_M as aU,Cp as aV,cM as aW,Cs as aX,ju as aY,CM as aZ,BM as a_,YP as aa,$S as ab,jd as ac,dM as ad,N2 as ae,Rn as af,W2 as ag,EM as ah,IM as ai,kP as aj,Du as ak,Mu as al,rS as am,Fu as an,dy as ao,Zv as ap,UM as aq,jM as ar,Fr as as,uM as at,Nr as au,tM as av,pM as aw,bM as ax,CI as ay,wM as az,NM as b,xM as b0,Ou as b1,Fi as b2,oT as b3,PM as b4,Qs as b5,mT as b6,fd as b7,Sm as b8,zM as b9,j2 as ba,Vu as bb,hM as bc,SM as bd,hy as be,fM as bf,ci as c,OM as d,FM as e,SE as f,Om as g,Rt as h,VM as i,nd as j,pn as k,RM as l,ux as m,LM as n,ic as o,Ps as p,DM as q,bT as r,En as s,JP as t,dx as u,GP as v,Mt as w,yi as x,k2 as y,A0 as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/OverlayCard-DZ0JD8zH.js","assets/BaseCard-YwwZ8Pbe.js","assets/VAvatar-dmscyC76.js","assets/VAvatar-D1FlB-R1.css","assets/VBtn-DlegZ2NC.js","assets/VBtn-BRB0UwUq.css","assets/BaseCard-CH5QhIAF.css","assets/data-DHvaU8Dv.js","assets/VList-t7JIXIjE.js","assets/VList-C6uiSejw.css","assets/OverlayCard-BfhBNNYR.css","assets/RouteCard-B-y6faXK.js","assets/VBadge-MtHYe8_s.js","assets/VBadge-BCFiac4Q.css","assets/RouteCard-C1tjSCHt.css","assets/MapControls-C7-lX9r0.js","assets/VSelect-B1224IQV.js","assets/VSelect-CTjEHVl2.css","assets/MapControls-Br79HEPw.css","assets/SettingsDrawer-nmVBJ-qW.js","assets/SettingsDrawer-DYynqMD1.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
